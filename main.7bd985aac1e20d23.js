(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{3630:(Qn,Vt,re)=>{"use strict";re.d(Vt,{c:()=>Ye,r:()=>Le});const Ye=(me,ve)=>{me.componentOnReady?me.componentOnReady().then(Ue=>ve(Ue)):Le(()=>ve(me))},Le=me=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(me):"function"==typeof requestAnimationFrame?requestAnimationFrame(me):setTimeout(me)},191:(Qn,Vt,re)=>{"use strict";re.d(Vt,{L:()=>p,a:()=>se,b:()=>Ye,c:()=>Pe,d:()=>ft,g:()=>me});const p="ionViewWillEnter",se="ionViewDidEnter",Ye="ionViewWillLeave",Pe="ionViewDidLeave",ft="ionViewWillUnload",me=ve=>ve.classList.contains("ion-page")?ve:ve.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||ve},4913:(Qn,Vt,re)=>{"use strict";re.d(Vt,{c:()=>Rt});var p=re(1848),se=re(512);let Ye;const ft=Ze=>Ze.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fe=Ze=>(void 0===Ye&&(Ye=void 0===Ze.style.animationName&&void 0!==Ze.style.webkitAnimationName?"-webkit-":""),Ye),Be=(Ze,Je,et)=>{const $t=Je.startsWith("animation")?Fe(Ze):"";Ze.style.setProperty($t+Je,et)},Dt=(Ze,Je)=>{const et=Je.startsWith("animation")?Fe(Ze):"";Ze.style.removeProperty(et+Je)},Le=[],je=(Ze=[],Je)=>{if(void 0!==Je){const et=Array.isArray(Je)?Je:[Je];return[...Ze,...et]}return Ze},Rt=Ze=>{let Je,et,$t,st,ot,bt,Ce,Oe,ye,Ie,xe,Mn,yn,$e=[],me=[],ve=[],Ue=!1,at={},lt=[],dt=[],ln={},$n=0,Mi=!1,Lt=!1,wt=!0,ut=!1,un=!0,Ln=!1;const ai=Ze,Si=[],Xt=[],Ft=[],It=[],tn=[],Ut=[],ti=[],li=[],Gn=[],ki=[],Ci=[],ar="function"==typeof AnimationEffect||void 0!==p.w&&"function"==typeof p.w.AnimationEffect,Rn="function"==typeof Element&&"function"==typeof Element.prototype.animate&&ar,hi=()=>Ci,fr=(U,q)=>{const pe=q.findIndex(Ne=>Ne.c===U);pe>-1&&q.splice(pe,1)},Ei=(U,q)=>((null!=q&&q.oneTimeCallback?Xt:Si).push({c:U,o:q}),yn),Jn=()=>{if(Rn)Ci.forEach(U=>{U.cancel()}),Ci.length=0;else{const U=It.slice();(0,se.r)(()=>{U.forEach(q=>{Dt(q,"animation-name"),Dt(q,"animation-duration"),Dt(q,"animation-timing-function"),Dt(q,"animation-iteration-count"),Dt(q,"animation-delay"),Dt(q,"animation-play-state"),Dt(q,"animation-fill-mode"),Dt(q,"animation-direction")})})}},Ar=()=>{Ut.forEach(U=>{null!=U&&U.parentNode&&U.parentNode.removeChild(U)}),Ut.length=0},qe=()=>void 0!==ot?ot:Ce?Ce.getFill():"both",_t=()=>void 0!==ye?ye:void 0!==bt?bt:Ce?Ce.getDirection():"normal",ke=()=>Mi?"linear":void 0!==$t?$t:Ce?Ce.getEasing():"linear",gt=()=>Lt?0:void 0!==Ie?Ie:void 0!==et?et:Ce?Ce.getDuration():0,sn=()=>void 0!==st?st:Ce?Ce.getIterations():1,Sn=()=>void 0!==xe?xe:void 0!==Je?Je:Ce?Ce.getDelay():0,nr=()=>{0!==$n&&($n--,0===$n&&((()=>{_r(),Gn.forEach(Et=>Et()),ki.forEach(Et=>Et());const U=wt?1:0,q=lt,pe=dt,Ne=ln;It.forEach(Et=>{const Xe=Et.classList;q.forEach(Wt=>Xe.add(Wt)),pe.forEach(Wt=>Xe.remove(Wt));for(const Wt in Ne)Ne.hasOwnProperty(Wt)&&Be(Et,Wt,Ne[Wt])}),Ie=void 0,ye=void 0,xe=void 0,Si.forEach(Et=>Et.c(U,yn)),Xt.forEach(Et=>Et.c(U,yn)),Xt.length=0,un=!0,wt&&(ut=!0),wt=!0})(),Ce&&Ce.animationFinish()))},ps=(U=!0)=>{Ar();const q=(Ze=>(Ze.forEach(Je=>{for(const et in Je)if(Je.hasOwnProperty(et)){const $t=Je[et];if("easing"===et)Je["animation-timing-function"]=$t,delete Je[et];else{const st=ft(et);st!==et&&(Je[st]=$t,delete Je[et])}}}),Ze))($e);It.forEach(pe=>{if(q.length>0){const Ne=((Ze=[])=>Ze.map(Je=>{const et=Je.offset,$t=[];for(const st in Je)Je.hasOwnProperty(st)&&"offset"!==st&&$t.push(`${st}: ${Je[st]};`);return`${100*et}% { ${$t.join(" ")} }`}).join(" "))(q);Mn=void 0!==Ze?Ze:(Ze=>{let Je=Le.indexOf(Ze);return Je<0&&(Je=Le.push(Ze)-1),`ion-animation-${Je}`})(Ne);const Et=((Ze,Je,et)=>{var $t;const st=(Ze=>{const Je=void 0!==Ze.getRootNode?Ze.getRootNode():Ze;return Je.head||Je})(et),ot=Fe(et),bt=st.querySelector("#"+Ze);if(bt)return bt;const $e=(null!==($t=et.ownerDocument)&&void 0!==$t?$t:document).createElement("style");return $e.id=Ze,$e.textContent=`@${ot}keyframes ${Ze} { ${Je} } @${ot}keyframes ${Ze}-alt { ${Je} }`,st.appendChild($e),$e})(Mn,Ne,pe);Ut.push(Et),Be(pe,"animation-duration",`${gt()}ms`),Be(pe,"animation-timing-function",ke()),Be(pe,"animation-delay",`${Sn()}ms`),Be(pe,"animation-fill-mode",qe()),Be(pe,"animation-direction",_t());const Xe=sn()===1/0?"infinite":sn().toString();Be(pe,"animation-iteration-count",Xe),Be(pe,"animation-play-state","paused"),U&&Be(pe,"animation-name",`${Et.id}-alt`),(0,se.r)(()=>{Be(pe,"animation-name",Et.id||null)})}})},Ds=(U=!0)=>{(()=>{ti.forEach(Ne=>Ne()),li.forEach(Ne=>Ne());const U=me,q=ve,pe=at;It.forEach(Ne=>{const Et=Ne.classList;U.forEach(Xe=>Et.add(Xe)),q.forEach(Xe=>Et.remove(Xe));for(const Xe in pe)pe.hasOwnProperty(Xe)&&Be(Ne,Xe,pe[Xe])})})(),$e.length>0&&(Rn?(It.forEach(U=>{const q=U.animate($e,{id:ai,delay:Sn(),duration:gt(),easing:ke(),iterations:sn(),fill:qe(),direction:_t()});q.pause(),Ci.push(q)}),Ci.length>0&&(Ci[0].onfinish=()=>{nr()})):ps(U)),Ue=!0},Tr=U=>{if(U=Math.min(Math.max(U,0),.9999),Rn)Ci.forEach(q=>{q.currentTime=q.effect.getComputedTiming().delay+gt()*U,q.pause()});else{const q=`-${gt()*U}ms`;It.forEach(pe=>{$e.length>0&&(Be(pe,"animation-delay",q),Be(pe,"animation-play-state","paused"))})}},ms=U=>{Ci.forEach(q=>{q.effect.updateTiming({delay:Sn(),duration:gt(),easing:ke(),iterations:sn(),fill:qe(),direction:_t()})}),void 0!==U&&Tr(U)},Is=(U=!0,q)=>{(0,se.r)(()=>{It.forEach(pe=>{Be(pe,"animation-name",Mn||null),Be(pe,"animation-duration",`${gt()}ms`),Be(pe,"animation-timing-function",ke()),Be(pe,"animation-delay",void 0!==q?`-${q*gt()}ms`:`${Sn()}ms`),Be(pe,"animation-fill-mode",qe()||null),Be(pe,"animation-direction",_t()||null);const Ne=sn()===1/0?"infinite":sn().toString();Be(pe,"animation-iteration-count",Ne),U&&Be(pe,"animation-name",`${Mn}-alt`),(0,se.r)(()=>{Be(pe,"animation-name",Mn||null)})})})},Or=(U=!1,q=!0,pe)=>(U&&tn.forEach(Ne=>{Ne.update(U,q,pe)}),Rn?ms(pe):Is(q,pe),yn),ci=()=>{Ue&&(Rn?Ci.forEach(U=>{U.pause()}):It.forEach(U=>{Be(U,"animation-play-state","paused")}),Ln=!0)},xs=()=>{Oe=void 0,nr()},_r=()=>{Oe&&clearTimeout(Oe)},K=U=>new Promise(q=>{null!=U&&U.sync&&(Lt=!0,Ei(()=>Lt=!1,{oneTimeCallback:!0})),Ue||Ds(),ut&&(Rn?(Tr(0),ms()):Is(),ut=!1),un&&($n=tn.length+1,un=!1);const pe=()=>{fr(Ne,Xt),q()},Ne=()=>{fr(pe,Ft),q()};Ei(Ne,{oneTimeCallback:!0}),((U,q)=>{Ft.push({c:U,o:{oneTimeCallback:!0}})})(pe),tn.forEach(Et=>{Et.play()}),Rn?(Ci.forEach(U=>{U.play()}),(0===$e.length||0===It.length)&&nr()):(()=>{if(_r(),(0,se.r)(()=>{It.forEach(U=>{$e.length>0&&Be(U,"animation-play-state","running")})}),0===$e.length||0===It.length)nr();else{const U=Sn()||0,q=gt()||0,pe=sn()||1;isFinite(pe)&&(Oe=setTimeout(xs,U+q*pe+100)),((Ze,Je)=>{let et;const $t={passive:!0},ot=bt=>{Ze===bt.target&&(et&&et(),_r(),(0,se.r)(()=>{It.forEach(U=>{Dt(U,"animation-duration"),Dt(U,"animation-delay"),Dt(U,"animation-play-state")}),(0,se.r)(nr)}))};Ze&&(Ze.addEventListener("webkitAnimationEnd",ot,$t),Ze.addEventListener("animationend",ot,$t),et=()=>{Ze.removeEventListener("webkitAnimationEnd",ot,$t),Ze.removeEventListener("animationend",ot,$t)})})(It[0])}})(),Ln=!1}),Qe=(U,q)=>{const pe=$e[0];return void 0===pe||void 0!==pe.offset&&0!==pe.offset?$e=[{offset:0,[U]:q},...$e]:pe[U]=q,yn};return yn={parentAnimation:Ce,elements:It,childAnimations:tn,id:ai,animationFinish:nr,from:Qe,to:(U,q)=>{const pe=$e[$e.length-1];return void 0===pe||void 0!==pe.offset&&1!==pe.offset?$e=[...$e,{offset:1,[U]:q}]:pe[U]=q,yn},fromTo:(U,q,pe)=>Qe(U,q).to(U,pe),parent:U=>(Ce=U,yn),play:K,pause:()=>(tn.forEach(U=>{U.pause()}),ci(),yn),stop:()=>{tn.forEach(U=>{U.stop()}),Ue&&(Jn(),Ue=!1),Mi=!1,Lt=!1,un=!0,ye=void 0,Ie=void 0,xe=void 0,$n=0,ut=!1,wt=!0,Ln=!1,Ft.forEach(U=>U.c(0,yn)),Ft.length=0},destroy:U=>(tn.forEach(q=>{q.destroy(U)}),(U=>{Jn(),U&&Ar()})(U),It.length=0,tn.length=0,$e.length=0,Si.length=0,Xt.length=0,Ue=!1,un=!0,yn),keyframes:U=>{const q=$e!==U;return $e=U,q&&(U=>{Rn?hi().forEach(q=>{const pe=q.effect;if(pe.setKeyframes)pe.setKeyframes(U);else{const Ne=new KeyframeEffect(pe.target,U,pe.getTiming());q.effect=Ne}}):ps()})($e),yn},addAnimation:U=>{if(null!=U)if(Array.isArray(U))for(const q of U)q.parent(yn),tn.push(q);else U.parent(yn),tn.push(U);return yn},addElement:U=>{if(null!=U)if(1===U.nodeType)It.push(U);else if(U.length>=0)for(let q=0;q<U.length;q++)It.push(U[q]);else console.error("Invalid addElement value");return yn},update:Or,fill:U=>(ot=U,Or(!0),yn),direction:U=>(bt=U,Or(!0),yn),iterations:U=>(st=U,Or(!0),yn),duration:U=>(!Rn&&0===U&&(U=1),et=U,Or(!0),yn),easing:U=>($t=U,Or(!0),yn),delay:U=>(Je=U,Or(!0),yn),getWebAnimations:hi,getKeyframes:()=>$e,getFill:qe,getDirection:_t,getDelay:Sn,getIterations:sn,getEasing:ke,getDuration:gt,afterAddRead:U=>(Gn.push(U),yn),afterAddWrite:U=>(ki.push(U),yn),afterClearStyles:(U=[])=>{for(const q of U)ln[q]="";return yn},afterStyles:(U={})=>(ln=U,yn),afterRemoveClass:U=>(dt=je(dt,U),yn),afterAddClass:U=>(lt=je(lt,U),yn),beforeAddRead:U=>(ti.push(U),yn),beforeAddWrite:U=>(li.push(U),yn),beforeClearStyles:(U=[])=>{for(const q of U)at[q]="";return yn},beforeStyles:(U={})=>(at=U,yn),beforeRemoveClass:U=>(ve=je(ve,U),yn),beforeAddClass:U=>(me=je(me,U),yn),onFinish:Ei,isRunning:()=>0!==$n&&!Ln,progressStart:(U=!1,q)=>(tn.forEach(pe=>{pe.progressStart(U,q)}),ci(),Mi=U,Ue||Ds(),Or(!1,!0,q),yn),progressStep:U=>(tn.forEach(q=>{q.progressStep(U)}),Tr(U),yn),progressEnd:(U,q,pe)=>(Mi=!1,tn.forEach(Ne=>{Ne.progressEnd(U,q,pe)}),void 0!==pe&&(Ie=pe),ut=!1,wt=!0,0===U?(ye="reverse"===_t()?"normal":"reverse","reverse"===ye&&(wt=!1),Rn?(Or(),Tr(1-q)):(xe=(1-q)*gt()*-1,Or(!1,!1))):1===U&&(Rn?(Or(),Tr(q)):(xe=q*gt()*-1,Or(!1,!1))),void 0!==U&&!Ce&&K(),yn)}}},8958:(Qn,Vt,re)=>{"use strict";re.d(Vt,{E:()=>yt,a:()=>p,s:()=>Dt});const p=Le=>{try{if(Le instanceof Be)return Le.value;if(!Pe()||"string"!=typeof Le||""===Le)return Le;if(Le.includes("onload="))return"";const mt=document.createDocumentFragment(),ct=document.createElement("div");mt.appendChild(ct),ct.innerHTML=Le,Fe.forEach(Ze=>{const Je=mt.querySelectorAll(Ze);for(let et=Je.length-1;et>=0;et--){const $t=Je[et];$t.parentNode?$t.parentNode.removeChild($t):mt.removeChild($t);const st=Ye($t);for(let ot=0;ot<st.length;ot++)se(st[ot])}});const tt=Ye(mt);for(let Ze=0;Ze<tt.length;Ze++)se(tt[Ze]);const je=document.createElement("div");je.appendChild(mt);const Rt=je.querySelector("div");return null!==Rt?Rt.innerHTML:je.innerHTML}catch(mt){return console.error(mt),""}},se=Le=>{if(Le.nodeType&&1!==Le.nodeType)return;if(typeof NamedNodeMap<"u"&&!(Le.attributes instanceof NamedNodeMap))return void Le.remove();for(let ct=Le.attributes.length-1;ct>=0;ct--){const tt=Le.attributes.item(ct),je=tt.name;if(!ft.includes(je.toLowerCase())){Le.removeAttribute(je);continue}const Rt=tt.value,Ze=Le[je];(null!=Rt&&Rt.toLowerCase().includes("javascript:")||null!=Ze&&Ze.toLowerCase().includes("javascript:"))&&Le.removeAttribute(je)}const mt=Ye(Le);for(let ct=0;ct<mt.length;ct++)se(mt[ct])},Ye=Le=>null!=Le.children?Le.children:Le.childNodes,Pe=()=>{var Le;const mt=window,ct=null===(Le=null==mt?void 0:mt.Ionic)||void 0===Le?void 0:Le.config;return!ct||(ct.get?ct.get("sanitizerEnabled",!0):!0===ct.sanitizerEnabled||void 0===ct.sanitizerEnabled)},ft=["class","id","href","src","name","slot"],Fe=["script","style","iframe","meta","link","object","embed"];class Be{constructor(mt){this.value=mt}}const Dt=Le=>{const mt=window,ct=mt.Ionic;if(!ct||!ct.config||"Object"===ct.config.constructor.name)return mt.Ionic=mt.Ionic||{},mt.Ionic.config=Object.assign(Object.assign({},mt.Ionic.config),Le),mt.Ionic.config},yt=!1},3254:(Qn,Vt,re)=>{"use strict";re.d(Vt,{C:()=>ft,a:()=>Ye,d:()=>Pe});var p=re(5861),se=re(512);const Ye=function(){var Fe=(0,p.Z)(function*(Be,Dt,Pt,yt,Le,mt){var ct;if(Be)return Be.attachViewToDom(Dt,Pt,Le,yt);if(!(mt||"string"==typeof Pt||Pt instanceof HTMLElement))throw new Error("framework delegate is missing");const tt="string"==typeof Pt?null===(ct=Dt.ownerDocument)||void 0===ct?void 0:ct.createElement(Pt):Pt;return yt&&yt.forEach(je=>tt.classList.add(je)),Le&&Object.assign(tt,Le),Dt.appendChild(tt),yield new Promise(je=>(0,se.c)(tt,je)),tt});return function(Dt,Pt,yt,Le,mt,ct){return Fe.apply(this,arguments)}}(),Pe=(Fe,Be)=>{if(Be){if(Fe)return Fe.removeViewFromDom(Be.parentElement,Be);Be.remove()}return Promise.resolve()},ft=()=>{let Fe,Be;return{attachViewToDom:function(){var yt=(0,p.Z)(function*(Le,mt,ct={},tt=[]){var je,Rt;let Ze;if(Fe=Le,mt){const et="string"==typeof mt?null===(je=Fe.ownerDocument)||void 0===je?void 0:je.createElement(mt):mt;tt.forEach($t=>et.classList.add($t)),Object.assign(et,ct),Fe.appendChild(et),Ze=et,yield new Promise($t=>(0,se.c)(et,$t))}else if(Fe.children.length>0&&("ION-MODAL"===Fe.tagName||"ION-POPOVER"===Fe.tagName)&&!(Ze=Fe.children[0]).classList.contains("ion-delegate-host")){const $t=null===(Rt=Fe.ownerDocument)||void 0===Rt?void 0:Rt.createElement("div");$t.classList.add("ion-delegate-host"),tt.forEach(st=>$t.classList.add(st)),$t.append(...Fe.children),Fe.appendChild($t),Ze=$t}const Je=document.querySelector("ion-app")||document.body;return Be=document.createComment("ionic teleport"),Fe.parentNode.insertBefore(Be,Fe),Je.appendChild(Fe),null!=Ze?Ze:Fe});return function(mt,ct){return yt.apply(this,arguments)}}(),removeViewFromDom:()=>(Fe&&Be&&(Be.parentNode.insertBefore(Fe,Be),Be.remove()),Promise.resolve())}}},2019:(Qn,Vt,re)=>{"use strict";re.d(Vt,{G:()=>ft});class se{constructor(Be,Dt,Pt,yt,Le){this.id=Dt,this.name=Pt,this.disableScroll=Le,this.priority=1e6*yt+Dt,this.ctrl=Be}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const Be=this.ctrl.capture(this.name,this.id,this.priority);return Be&&this.disableScroll&&this.ctrl.disableScroll(this.id),Be}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Ye{constructor(Be,Dt,Pt,yt){this.id=Dt,this.disable=Pt,this.disableScroll=yt,this.ctrl=Be}block(){if(this.ctrl){if(this.disable)for(const Be of this.disable)this.ctrl.disableGesture(Be,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const Be of this.disable)this.ctrl.enableGesture(Be,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const Pe="backdrop-no-scroll",ft=new class p{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(Be){var Dt;return new se(this,this.newID(),Be.name,null!==(Dt=Be.priority)&&void 0!==Dt?Dt:0,!!Be.disableScroll)}createBlocker(Be={}){return new Ye(this,this.newID(),Be.disable,!!Be.disableScroll)}start(Be,Dt,Pt){return this.canStart(Be)?(this.requestedStart.set(Dt,Pt),!0):(this.requestedStart.delete(Dt),!1)}capture(Be,Dt,Pt){if(!this.start(Be,Dt,Pt))return!1;const yt=this.requestedStart;let Le=-1e4;if(yt.forEach(mt=>{Le=Math.max(Le,mt)}),Le===Pt){this.capturedId=Dt,yt.clear();const mt=new CustomEvent("ionGestureCaptured",{detail:{gestureName:Be}});return document.dispatchEvent(mt),!0}return yt.delete(Dt),!1}release(Be){this.requestedStart.delete(Be),this.capturedId===Be&&(this.capturedId=void 0)}disableGesture(Be,Dt){let Pt=this.disabledGestures.get(Be);void 0===Pt&&(Pt=new Set,this.disabledGestures.set(Be,Pt)),Pt.add(Dt)}enableGesture(Be,Dt){const Pt=this.disabledGestures.get(Be);void 0!==Pt&&Pt.delete(Dt)}disableScroll(Be){this.disabledScroll.add(Be),1===this.disabledScroll.size&&document.body.classList.add(Pe)}enableScroll(Be){this.disabledScroll.delete(Be),0===this.disabledScroll.size&&document.body.classList.remove(Pe)}canStart(Be){return!(void 0!==this.capturedId||this.isDisabled(Be))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(Be){const Dt=this.disabledGestures.get(Be);return!!(Dt&&Dt.size>0)}newID(){return this.gestureId++,this.gestureId}}},4393:(Qn,Vt,re)=>{"use strict";re.r(Vt),re.d(Vt,{MENU_BACK_BUTTON_PRIORITY:()=>ft,OVERLAY_BACK_BUTTON_PRIORITY:()=>Pe,blockHardwareBackButton:()=>se,startHardwareBackButton:()=>Ye});var p=re(5861);const se=()=>{document.addEventListener("backbutton",()=>{})},Ye=()=>{const Fe=document;let Be=!1;Fe.addEventListener("backbutton",()=>{if(Be)return;let Dt=0,Pt=[];const yt=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(ct,tt){Pt.push({priority:ct,handler:tt,id:Dt++})}}});Fe.dispatchEvent(yt);const Le=function(){var ct=(0,p.Z)(function*(tt){try{if(null!=tt&&tt.handler){const je=tt.handler(mt);null!=je&&(yield je)}}catch(je){console.error(je)}});return function(je){return ct.apply(this,arguments)}}(),mt=()=>{if(Pt.length>0){let ct={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Pt.forEach(tt=>{tt.priority>=ct.priority&&(ct=tt)}),Be=!0,Pt=Pt.filter(tt=>tt.id!==ct.id),Le(ct).then(()=>Be=!1)}};mt()})},Pe=100,ft=99},512:(Qn,Vt,re)=>{"use strict";re.d(Vt,{a:()=>Dt,b:()=>Pt,c:()=>Ye,d:()=>Rt,e:()=>je,f:()=>tt,g:()=>yt,h:()=>ct,i:()=>Be,j:()=>ot,k:()=>ft,l:()=>Ze,m:()=>Pe,n:()=>mt,o:()=>Je,p:()=>st,q:()=>bt,r:()=>Le,s:()=>$e,t:()=>p,u:()=>et,v:()=>$t});const p=(me,ve=0)=>new Promise(Ue=>{se(me,ve,Ue)}),se=(me,ve=0,Ue)=>{let Ce,at;const lt={passive:!0},ln=()=>{Ce&&Ce()},$n=Mi=>{(void 0===Mi||me===Mi.target)&&(ln(),Ue(Mi))};return me&&(me.addEventListener("webkitTransitionEnd",$n,lt),me.addEventListener("transitionend",$n,lt),at=setTimeout($n,ve+500),Ce=()=>{at&&(clearTimeout(at),at=void 0),me.removeEventListener("webkitTransitionEnd",$n,lt),me.removeEventListener("transitionend",$n,lt)}),ln},Ye=(me,ve)=>{me.componentOnReady?me.componentOnReady().then(Ue=>ve(Ue)):Le(()=>ve(me))},Pe=me=>void 0!==me.componentOnReady,ft=(me,ve=[])=>{const Ue={};return ve.forEach(Ce=>{me.hasAttribute(Ce)&&(null!==me.getAttribute(Ce)&&(Ue[Ce]=me.getAttribute(Ce)),me.removeAttribute(Ce))}),Ue},Fe=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Be=(me,ve)=>{let Ue=Fe;return ve&&ve.length>0&&(Ue=Ue.filter(Ce=>!ve.includes(Ce))),ft(me,Ue)},Dt=(me,ve,Ue,Ce)=>{var at;if(typeof window<"u"){const lt=window,dt=null===(at=null==lt?void 0:lt.Ionic)||void 0===at?void 0:at.config;if(dt){const ln=dt.get("_ael");if(ln)return ln(me,ve,Ue,Ce);if(dt._ael)return dt._ael(me,ve,Ue,Ce)}}return me.addEventListener(ve,Ue,Ce)},Pt=(me,ve,Ue,Ce)=>{var at;if(typeof window<"u"){const lt=window,dt=null===(at=null==lt?void 0:lt.Ionic)||void 0===at?void 0:at.config;if(dt){const ln=dt.get("_rel");if(ln)return ln(me,ve,Ue,Ce);if(dt._rel)return dt._rel(me,ve,Ue,Ce)}}return me.removeEventListener(ve,Ue,Ce)},yt=(me,ve=me)=>me.shadowRoot||ve,Le=me=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(me):"function"==typeof requestAnimationFrame?requestAnimationFrame(me):setTimeout(me),mt=me=>!!me.shadowRoot&&!!me.attachShadow,ct=me=>{const ve=me.closest("ion-item");return ve?ve.querySelector("ion-label"):null},tt=me=>{if(me.focus(),me.classList.contains("ion-focusable")){const ve=me.closest("ion-app");ve&&ve.setFocus([me])}},je=(me,ve)=>{let Ue;const Ce=me.getAttribute("aria-labelledby"),at=me.id;let lt=null!==Ce&&""!==Ce.trim()?Ce:ve+"-lbl",dt=null!==Ce&&""!==Ce.trim()?document.getElementById(Ce):ct(me);return dt?(null===Ce&&(dt.id=lt),Ue=dt.textContent,dt.setAttribute("aria-hidden","true")):""!==at.trim()&&(dt=document.querySelector(`label[for="${at}"]`),dt&&(""!==dt.id?lt=dt.id:dt.id=lt=`${at}-lbl`,Ue=dt.textContent)),{label:dt,labelId:lt,labelText:Ue}},Rt=(me,ve,Ue,Ce,at)=>{if(me||mt(ve)){let lt=ve.querySelector("input.aux-input");lt||(lt=ve.ownerDocument.createElement("input"),lt.type="hidden",lt.classList.add("aux-input"),ve.appendChild(lt)),lt.disabled=at,lt.name=Ue,lt.value=Ce||""}},Ze=(me,ve,Ue)=>Math.max(me,Math.min(ve,Ue)),Je=(me,ve)=>{if(!me){const Ue="ASSERT: "+ve;throw console.error(Ue),new Error(Ue)}},et=me=>me.timeStamp||Date.now(),$t=me=>{if(me){const ve=me.changedTouches;if(ve&&ve.length>0){const Ue=ve[0];return{x:Ue.clientX,y:Ue.clientY}}if(void 0!==me.pageX)return{x:me.pageX,y:me.pageY}}return{x:0,y:0}},st=me=>{const ve="rtl"===document.dir;switch(me){case"start":return ve;case"end":return!ve;default:throw new Error(`"${me}" is not a valid value for [side]. Use "start" or "end" instead.`)}},ot=(me,ve)=>{const Ue=me._original||me;return{_original:me,emit:bt(Ue.emit.bind(Ue),ve)}},bt=(me,ve=0)=>{let Ue;return(...Ce)=>{clearTimeout(Ue),Ue=setTimeout(me,ve,...Ce)}},$e=(me,ve)=>{if(null!=me||(me={}),null!=ve||(ve={}),me===ve)return!0;const Ue=Object.keys(me);if(Ue.length!==Object.keys(ve).length)return!1;for(const Ce of Ue)if(!(Ce in ve)||me[Ce]!==ve[Ce])return!1;return!0}},5613:(Qn,Vt,re)=>{"use strict";re.d(Vt,{m:()=>ct});var p=re(5861),se=re(1848),Ye=re(4393),Pe=re(2400),ft=re(512),Fe=re(2905),Be=re(4913);const Dt=tt=>(0,Be.c)().duration(tt?400:300),Pt=tt=>{let je,Rt;const Ze=tt.width+8,Je=(0,Be.c)(),et=(0,Be.c)();tt.isEndSide?(je=Ze+"px",Rt="0px"):(je=-Ze+"px",Rt="0px"),Je.addElement(tt.menuInnerEl).fromTo("transform",`translateX(${je})`,`translateX(${Rt})`);const st="ios"===(0,Fe.b)(tt),ot=st?.2:.25;return et.addElement(tt.backdropEl).fromTo("opacity",.01,ot),Dt(st).addAnimation([Je,et])},yt=tt=>{let je,Rt;const Ze=(0,Fe.b)(tt),Je=tt.width;tt.isEndSide?(je=-Je+"px",Rt=Je+"px"):(je=Je+"px",Rt=-Je+"px");const et=(0,Be.c)().addElement(tt.menuInnerEl).fromTo("transform",`translateX(${Rt})`,"translateX(0px)"),$t=(0,Be.c)().addElement(tt.contentEl).fromTo("transform","translateX(0px)",`translateX(${je})`),st=(0,Be.c)().addElement(tt.backdropEl).fromTo("opacity",.01,.32);return Dt("ios"===Ze).addAnimation([et,$t,st])},Le=tt=>{const je=(0,Fe.b)(tt),Rt=tt.width*(tt.isEndSide?-1:1)+"px",Ze=(0,Be.c)().addElement(tt.contentEl).fromTo("transform","translateX(0px)",`translateX(${Rt})`);return Dt("ios"===je).addAnimation(Ze)},ct=(()=>{const tt=new Map,je=[],Rt=function(){var ye=(0,p.Z)(function*(Ie){const xe=yield bt(Ie,!0);return!!xe&&xe.open()});return function(xe){return ye.apply(this,arguments)}}(),Ze=function(){var ye=(0,p.Z)(function*(Ie){const xe=yield void 0!==Ie?bt(Ie,!0):$e();return void 0!==xe&&xe.close()});return function(xe){return ye.apply(this,arguments)}}(),Je=function(){var ye=(0,p.Z)(function*(Ie){const xe=yield bt(Ie,!0);return!!xe&&xe.toggle()});return function(xe){return ye.apply(this,arguments)}}(),et=function(){var ye=(0,p.Z)(function*(Ie,xe){const wt=yield bt(xe);return wt&&(wt.disabled=!Ie),wt});return function(xe,wt){return ye.apply(this,arguments)}}(),$t=function(){var ye=(0,p.Z)(function*(Ie,xe){const wt=yield bt(xe);return wt&&(wt.swipeGesture=Ie),wt});return function(xe,wt){return ye.apply(this,arguments)}}(),st=function(){var ye=(0,p.Z)(function*(Ie){if(null!=Ie){const xe=yield bt(Ie);return void 0!==xe&&xe.isOpen()}return void 0!==(yield $e())});return function(xe){return ye.apply(this,arguments)}}(),ot=function(){var ye=(0,p.Z)(function*(Ie){const xe=yield bt(Ie);return!!xe&&!xe.disabled});return function(xe){return ye.apply(this,arguments)}}(),bt=function(){var ye=(0,p.Z)(function*(Ie,xe=!1){if(yield Oe(),"start"===Ie||"end"===Ie){const ut=je.filter(Mn=>Mn.side===Ie&&!Mn.disabled);if(ut.length>=1)return ut.length>1&&xe&&(0,Pe.p)(`menuController queried for a menu on the "${Ie}" side, but ${ut.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,ut.map(Mn=>Mn.el)),ut[0].el;const un=je.filter(Mn=>Mn.side===Ie);if(un.length>=1)return un.length>1&&xe&&(0,Pe.p)(`menuController queried for a menu on the "${Ie}" side, but ${un.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,un.map(Mn=>Mn.el)),un[0].el}else if(null!=Ie)return Lt(ut=>ut.menuId===Ie);return Lt(ut=>!ut.disabled)||(je.length>0?je[0].el:void 0)});return function(xe){return ye.apply(this,arguments)}}(),$e=function(){var ye=(0,p.Z)(function*(){return yield Oe(),ln()});return function(){return ye.apply(this,arguments)}}(),me=function(){var ye=(0,p.Z)(function*(){return yield Oe(),$n()});return function(){return ye.apply(this,arguments)}}(),ve=function(){var ye=(0,p.Z)(function*(){return yield Oe(),Mi()});return function(){return ye.apply(this,arguments)}}(),Ue=(ye,Ie)=>{tt.set(ye,Ie)},lt=function(){var ye=(0,p.Z)(function*(Ie,xe,wt){if(Mi())return!1;if(xe){const ut=yield $e();ut&&Ie.el!==ut&&(yield ut.setOpen(!1,!1))}return Ie._setOpen(xe,wt)});return function(xe,wt,ut){return ye.apply(this,arguments)}}(),ln=()=>Lt(ye=>ye._isOpen),$n=()=>je.map(ye=>ye.el),Mi=()=>je.some(ye=>ye.isAnimating),Lt=ye=>{const Ie=je.find(ye);if(void 0!==Ie)return Ie.el},Oe=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(ye=>new Promise(Ie=>(0,ft.c)(ye,Ie))));return Ue("reveal",Le),Ue("push",yt),Ue("overlay",Pt),null==se.d||se.d.addEventListener("ionBackButton",ye=>{const Ie=ln();Ie&&ye.detail.register(Ye.MENU_BACK_BUTTON_PRIORITY,()=>Ie.close())}),{registerAnimation:Ue,get:bt,getMenus:me,getOpen:$e,isEnabled:ot,swipeGesture:$t,isAnimating:ve,isOpen:st,enable:et,toggle:Je,close:Ze,open:Rt,_getOpenSync:ln,_createAnimation:(ye,Ie)=>{const xe=tt.get(ye);if(!xe)throw new Error("animation not registered");return xe(Ie)},_register:ye=>{je.indexOf(ye)<0&&je.push(ye)},_unregister:ye=>{const Ie=je.indexOf(ye);Ie>-1&&je.splice(Ie,1)},_setOpen:lt}})()},6535:(Qn,Vt,re)=>{"use strict";re.r(Vt),re.d(Vt,{GESTURE_CONTROLLER:()=>p.G,createGesture:()=>Pt});var p=re(2019);const se=(ct,tt,je,Rt)=>{const Ze=Ye(ct)?{capture:!!Rt.capture,passive:!!Rt.passive}:!!Rt.capture;let Je,et;return ct.__zone_symbol__addEventListener?(Je="__zone_symbol__addEventListener",et="__zone_symbol__removeEventListener"):(Je="addEventListener",et="removeEventListener"),ct[Je](tt,je,Ze),()=>{ct[et](tt,je,Ze)}},Ye=ct=>{if(void 0===Pe)try{const tt=Object.defineProperty({},"passive",{get:()=>{Pe=!0}});ct.addEventListener("optsTest",()=>{},tt)}catch{Pe=!1}return!!Pe};let Pe;const Be=ct=>ct instanceof Document?ct:ct.ownerDocument,Pt=ct=>{let tt=!1,je=!1,Rt=!0,Ze=!1;const Je=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},ct),et=Je.canStart,$t=Je.onWillStart,st=Je.onStart,ot=Je.onEnd,bt=Je.notCaptured,$e=Je.onMove,me=Je.threshold,ve=Je.passive,Ue=Je.blurOnStart,Ce={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},at=((ct,tt,je)=>{const Rt=je*(Math.PI/180),Ze="x"===ct,Je=Math.cos(Rt),et=tt*tt;let $t=0,st=0,ot=!1,bt=0;return{start($e,me){$t=$e,st=me,bt=0,ot=!0},detect($e,me){if(!ot)return!1;const ve=$e-$t,Ue=me-st,Ce=ve*ve+Ue*Ue;if(Ce<et)return!1;const at=Math.sqrt(Ce),lt=(Ze?ve:Ue)/at;return bt=lt>Je?1:lt<-Je?-1:0,ot=!1,!0},isGesture:()=>0!==bt,getDirection:()=>bt}})(Je.direction,Je.threshold,Je.maxAngle),lt=p.G.createGesture({name:ct.gestureName,priority:ct.gesturePriority,disableScroll:ct.disableScroll}),$n=()=>{tt&&(Ze=!1,$e&&$e(Ce))},Mi=()=>!!lt.capture()&&(tt=!0,Rt=!1,Ce.startX=Ce.currentX,Ce.startY=Ce.currentY,Ce.startTime=Ce.currentTime,$t?$t(Ce).then(Oe):Oe(),!0),Oe=()=>{Ue&&(()=>{if(typeof document<"u"){const ut=document.activeElement;null!=ut&&ut.blur&&ut.blur()}})(),st&&st(Ce),Rt=!0},ye=()=>{tt=!1,je=!1,Ze=!1,Rt=!0,lt.release()},Ie=ut=>{const un=tt,Mn=Rt;if(ye(),Mn){if(yt(Ce,ut),un)return void(ot&&ot(Ce));bt&&bt(Ce)}},xe=((ct,tt,je,Rt,Ze)=>{let Je,et,$t,st,ot,bt,$e,me=0;const ve=Lt=>{me=Date.now()+2e3,tt(Lt)&&(!et&&je&&(et=se(ct,"touchmove",je,Ze)),$t||($t=se(Lt.target,"touchend",Ce,Ze)),st||(st=se(Lt.target,"touchcancel",Ce,Ze)))},Ue=Lt=>{me>Date.now()||tt(Lt)&&(!bt&&je&&(bt=se(Be(ct),"mousemove",je,Ze)),$e||($e=se(Be(ct),"mouseup",at,Ze)))},Ce=Lt=>{lt(),Rt&&Rt(Lt)},at=Lt=>{dt(),Rt&&Rt(Lt)},lt=()=>{et&&et(),$t&&$t(),st&&st(),et=$t=st=void 0},dt=()=>{bt&&bt(),$e&&$e(),bt=$e=void 0},ln=()=>{lt(),dt()},$n=(Lt=!0)=>{Lt?(Je||(Je=se(ct,"touchstart",ve,Ze)),ot||(ot=se(ct,"mousedown",Ue,Ze))):(Je&&Je(),ot&&ot(),Je=ot=void 0,ln())};return{enable:$n,stop:ln,destroy:()=>{$n(!1),Rt=je=tt=void 0}}})(Je.el,ut=>{const un=mt(ut);return!(je||!Rt||(Le(ut,Ce),Ce.startX=Ce.currentX,Ce.startY=Ce.currentY,Ce.startTime=Ce.currentTime=un,Ce.velocityX=Ce.velocityY=Ce.deltaX=Ce.deltaY=0,Ce.event=ut,et&&!1===et(Ce))||(lt.release(),!lt.start()))&&(je=!0,0===me?Mi():(at.start(Ce.startX,Ce.startY),!0))},ut=>{tt?!Ze&&Rt&&(Ze=!0,yt(Ce,ut),requestAnimationFrame($n)):(yt(Ce,ut),at.detect(Ce.currentX,Ce.currentY)&&(!at.isGesture()||!Mi())&&wt())},Ie,{capture:!1,passive:ve}),wt=()=>{ye(),xe.stop(),bt&&bt(Ce)};return{enable(ut=!0){ut||(tt&&Ie(void 0),ye()),xe.enable(ut)},destroy(){lt.destroy(),xe.destroy()}}},yt=(ct,tt)=>{if(!tt)return;const je=ct.currentX,Rt=ct.currentY,Ze=ct.currentTime;Le(tt,ct);const Je=ct.currentX,et=ct.currentY,st=(ct.currentTime=mt(tt))-Ze;if(st>0&&st<100){const bt=(et-Rt)/st;ct.velocityX=(Je-je)/st*.7+.3*ct.velocityX,ct.velocityY=.7*bt+.3*ct.velocityY}ct.deltaX=Je-ct.startX,ct.deltaY=et-ct.startY,ct.event=tt},Le=(ct,tt)=>{let je=0,Rt=0;if(ct){const Ze=ct.changedTouches;if(Ze&&Ze.length>0){const Je=Ze[0];je=Je.clientX,Rt=Je.clientY}else void 0!==ct.pageX&&(je=ct.pageX,Rt=ct.pageY)}tt.currentX=je,tt.currentY=Rt},mt=ct=>ct.timeStamp||Date.now()},2325:(Qn,Vt,re)=>{"use strict";re.d(Vt,{b:()=>Fe,c:()=>Be,d:()=>Dt,e:()=>me,g:()=>Ce,l:()=>bt,s:()=>ve,t:()=>Le,w:()=>$e});var p=re(5861),se=re(771),Ye=re(512);const Fe="ionViewWillLeave",Be="ionViewDidLeave",Dt="ionViewWillUnload",Le=at=>new Promise((lt,dt)=>{(0,se.w)(()=>{mt(at),ct(at).then(ln=>{ln.animation&&ln.animation.destroy(),tt(at),lt(ln)},ln=>{tt(at),dt(ln)})})}),mt=at=>{const lt=at.enteringEl,dt=at.leavingEl;Ue(lt,dt,at.direction),at.showGoBack?lt.classList.add("can-go-back"):lt.classList.remove("can-go-back"),ve(lt,!1),lt.style.setProperty("pointer-events","none"),dt&&(ve(dt,!1),dt.style.setProperty("pointer-events","none"))},ct=function(){var at=(0,p.Z)(function*(lt){const dt=yield je(lt);return dt&&se.B.isBrowser?Rt(dt,lt):Ze(lt)});return function(dt){return at.apply(this,arguments)}}(),tt=at=>{const lt=at.enteringEl,dt=at.leavingEl;lt.classList.remove("ion-page-invisible"),lt.style.removeProperty("pointer-events"),void 0!==dt&&(dt.classList.remove("ion-page-invisible"),dt.style.removeProperty("pointer-events"))},je=function(){var at=(0,p.Z)(function*(lt){return lt.leavingEl&&lt.animated&&0!==lt.duration?lt.animationBuilder?lt.animationBuilder:"ios"===lt.mode?(yield Promise.resolve().then(re.bind(re,3433))).iosTransitionAnimation:(yield Promise.resolve().then(re.bind(re,6615))).mdTransitionAnimation:void 0});return function(dt){return at.apply(this,arguments)}}(),Rt=function(){var at=(0,p.Z)(function*(lt,dt){yield Je(dt,!0);const ln=lt(dt.baseEl,dt);st(dt.enteringEl,dt.leavingEl);const $n=yield $t(ln,dt);return dt.progressCallback&&dt.progressCallback(void 0),$n&&ot(dt.enteringEl,dt.leavingEl),{hasCompleted:$n,animation:ln}});return function(dt,ln){return at.apply(this,arguments)}}(),Ze=function(){var at=(0,p.Z)(function*(lt){const dt=lt.enteringEl,ln=lt.leavingEl;return yield Je(lt,!1),st(dt,ln),ot(dt,ln),{hasCompleted:!0}});return function(dt){return at.apply(this,arguments)}}(),Je=function(){var at=(0,p.Z)(function*(lt,dt){(void 0!==lt.deepWait?lt.deepWait:dt)&&(yield Promise.all([me(lt.enteringEl),me(lt.leavingEl)])),yield et(lt.viewIsReady,lt.enteringEl)});return function(dt,ln){return at.apply(this,arguments)}}(),et=function(){var at=(0,p.Z)(function*(lt,dt){lt&&(yield lt(dt))});return function(dt,ln){return at.apply(this,arguments)}}(),$t=(at,lt)=>{const dt=lt.progressCallback,ln=new Promise($n=>{at.onFinish(Mi=>$n(1===Mi))});return dt?(at.progressStart(!0),dt(at)):at.play(),ln},st=(at,lt)=>{bt(lt,Fe),bt(at,"ionViewWillEnter")},ot=(at,lt)=>{bt(at,"ionViewDidEnter"),bt(lt,Be)},bt=(at,lt)=>{if(at){const dt=new CustomEvent(lt,{bubbles:!1,cancelable:!1});at.dispatchEvent(dt)}},$e=()=>new Promise(at=>(0,Ye.r)(()=>(0,Ye.r)(()=>at()))),me=function(){var at=(0,p.Z)(function*(lt){const dt=lt;if(dt){if(null!=dt.componentOnReady){if(null!=(yield dt.componentOnReady()))return}else if(null!=dt.__registerHost)return void(yield new Promise($n=>(0,Ye.r)($n)));yield Promise.all(Array.from(dt.children).map(me))}});return function(dt){return at.apply(this,arguments)}}(),ve=(at,lt)=>{lt?(at.setAttribute("aria-hidden","true"),at.classList.add("ion-page-hidden")):(at.hidden=!1,at.removeAttribute("aria-hidden"),at.classList.remove("ion-page-hidden"))},Ue=(at,lt,dt)=>{void 0!==at&&(at.style.zIndex="back"===dt?"99":"101"),void 0!==lt&&(lt.style.zIndex="100")},Ce=at=>at.classList.contains("ion-page")?at:at.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||at},2400:(Qn,Vt,re)=>{"use strict";re.d(Vt,{a:()=>se,b:()=>Ye,p:()=>p});const p=(Pe,...ft)=>console.warn(`[Ionic Warning]: ${Pe}`,...ft),se=(Pe,...ft)=>console.error(`[Ionic Error]: ${Pe}`,...ft),Ye=(Pe,...ft)=>console.error(`<${Pe.tagName.toLowerCase()}> must be used inside ${ft.join(" or ")}.`)},1848:(Qn,Vt,re)=>{"use strict";re.d(Vt,{d:()=>se,w:()=>p});const p=typeof window<"u"?window:void 0,se=typeof document<"u"?document:void 0},771:(Qn,Vt,re)=>{"use strict";re.d(Vt,{B:()=>mt,H:()=>Mi,a:()=>Co,b:()=>io,c:()=>Mn,d:()=>Si,e:()=>Gt,f:()=>ai,g:()=>yn,h:()=>ln,i:()=>qe,j:()=>ct,r:()=>ps,w:()=>_n});var p=re(5861);let Pe,ft,Fe,Be=!1,Dt=!1,Pt=!1,yt=!1,Le=!1;const mt={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},ct=U=>{const q=new URL(U,ci.$resourcesUrl$);return q.origin!==os.location.origin?q.href:q.pathname},$t="s-id",st="sty-id",$e="slot-fb{display:contents}slot-fb[hidden]{display:none}",me="http://www.w3.org/1999/xlink",ve={},lt=U=>"object"==(U=typeof U)||"function"===U;function dt(U){var q,pe,Ne;return null!==(Ne=null===(pe=null===(q=U.head)||void 0===q?void 0:q.querySelector('meta[name="csp-nonce"]'))||void 0===pe?void 0:pe.getAttribute("content"))&&void 0!==Ne?Ne:void 0}const ln=(U,q,...pe)=>{let Ne=null,Et=null,Xe=null,Wt=!1,Yt=!1;const cn=[],Zt=Wn=>{for(let On=0;On<Wn.length;On++)Ne=Wn[On],Array.isArray(Ne)?Zt(Ne):null!=Ne&&"boolean"!=typeof Ne&&((Wt="function"!=typeof U&&!lt(Ne))&&(Ne=String(Ne)),Wt&&Yt?cn[cn.length-1].$text$+=Ne:cn.push(Wt?$n(null,Ne):Ne),Yt=Wt)};if(Zt(pe),q){q.key&&(Et=q.key),q.name&&(Xe=q.name);{const Wn=q.className||q.class;Wn&&(q.class="object"!=typeof Wn?Wn:Object.keys(Wn).filter(On=>Wn[On]).join(" "))}}if("function"==typeof U)return U(null===q?{}:q,cn,Oe);const En=$n(U,null);return En.$attrs$=q,cn.length>0&&(En.$children$=cn),En.$key$=Et,En.$name$=Xe,En},$n=(U,q)=>({$flags$:0,$tag$:U,$text$:q,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),Mi={},Oe={forEach:(U,q)=>U.map(ye).forEach(q),map:(U,q)=>U.map(ye).map(q).map(Ie)},ye=U=>({vattrs:U.$attrs$,vchildren:U.$children$,vkey:U.$key$,vname:U.$name$,vtag:U.$tag$,vtext:U.$text$}),Ie=U=>{if("function"==typeof U.vtag){const pe=Object.assign({},U.vattrs);return U.vkey&&(pe.key=U.vkey),U.vname&&(pe.name=U.vname),ln(U.vtag,pe,...U.vchildren||[])}const q=$n(U.vtag,U.vtext);return q.$attrs$=U.vattrs,q.$children$=U.vchildren,q.$key$=U.vkey,q.$name$=U.vname,q},wt=(U,q,pe,Ne,Et,Xe,Wt)=>{let Yt,cn,Zt,En;if(1===Xe.nodeType){for(Yt=Xe.getAttribute("c-id"),Yt&&(cn=Yt.split("."),(cn[0]===Wt||"0"===cn[0])&&(Zt={$flags$:0,$hostId$:cn[0],$nodeId$:cn[1],$depth$:cn[2],$index$:cn[3],$tag$:Xe.tagName.toLowerCase(),$elm$:Xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},q.push(Zt),Xe.removeAttribute("c-id"),U.$children$||(U.$children$=[]),U.$children$[Zt.$index$]=Zt,U=Zt,Ne&&"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$))),En=Xe.childNodes.length-1;En>=0;En--)wt(U,q,pe,Ne,Et,Xe.childNodes[En],Wt);if(Xe.shadowRoot)for(En=Xe.shadowRoot.childNodes.length-1;En>=0;En--)wt(U,q,pe,Ne,Et,Xe.shadowRoot.childNodes[En],Wt)}else if(8===Xe.nodeType)cn=Xe.nodeValue.split("."),(cn[1]===Wt||"0"===cn[1])&&(Yt=cn[0],Zt={$flags$:0,$hostId$:cn[1],$nodeId$:cn[2],$depth$:cn[3],$index$:cn[4],$elm$:Xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Yt?(Zt.$elm$=Xe.nextSibling,Zt.$elm$&&3===Zt.$elm$.nodeType&&(Zt.$text$=Zt.$elm$.textContent,q.push(Zt),Xe.remove(),U.$children$||(U.$children$=[]),U.$children$[Zt.$index$]=Zt,Ne&&"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$))):Zt.$hostId$===Wt&&("s"===Yt?(Zt.$tag$="slot",Xe["s-sn"]=cn[5]?Zt.$name$=cn[5]:"",Xe["s-sr"]=!0,Ne&&(Zt.$elm$=ir.createElement(Zt.$tag$),Zt.$name$&&Zt.$elm$.setAttribute("name",Zt.$name$),Xe.parentNode.insertBefore(Zt.$elm$,Xe),Xe.remove(),"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$)),pe.push(Zt),U.$children$||(U.$children$=[]),U.$children$[Zt.$index$]=Zt):"r"===Yt&&(Ne?Xe.remove():(Et["s-cr"]=Xe,Xe["s-cn"]=!0))));else if(U&&"style"===U.$tag$){const Wn=$n(null,Xe.textContent);Wn.$elm$=Xe,Wn.$index$="0",U.$children$=[Wn]}},ut=(U,q)=>{if(1===U.nodeType){let pe=0;for(;pe<U.childNodes.length;pe++)ut(U.childNodes[pe],q);if(U.shadowRoot)for(pe=0;pe<U.shadowRoot.childNodes.length;pe++)ut(U.shadowRoot.childNodes[pe],q)}else if(8===U.nodeType){const pe=U.nodeValue.split(".");"o"===pe[0]&&(q.set(pe[1]+"."+pe[2],U),U.nodeValue="",U["s-en"]=pe[3])}},Mn=U=>Di.push(U),yn=U=>nr(U).$modeName$,ai=U=>nr(U).$hostElement$,Si=(U,q,pe)=>{const Ne=ai(U);return{emit:Et=>Xt(Ne,q,{bubbles:!!(4&pe),composed:!!(2&pe),cancelable:!!(1&pe),detail:Et})}},Xt=(U,q,pe)=>{const Ne=ci.ce(q,pe);return U.dispatchEvent(Ne),Ne},Ft=new WeakMap,It=(U,q,pe)=>{let Ne=Or.get(U);Os&&pe?(Ne=Ne||new CSSStyleSheet,"string"==typeof Ne?Ne=q:Ne.replaceSync(q)):Ne=q,Or.set(U,Ne)},tn=(U,q,pe)=>{var Ne;const Et=ti(q,pe),Xe=Or.get(Et);if(U=11===U.nodeType?U:ir,Xe)if("string"==typeof Xe){let Yt,Wt=Ft.get(U=U.head||U);if(Wt||Ft.set(U,Wt=new Set),!Wt.has(Et)){if(U.host&&(Yt=U.querySelector(`[${st}="${Et}"]`)))Yt.innerHTML=Xe;else{Yt=ir.createElement("style"),Yt.innerHTML=Xe;const cn=null!==(Ne=ci.$nonce$)&&void 0!==Ne?Ne:dt(ir);null!=cn&&Yt.setAttribute("nonce",cn),U.insertBefore(Yt,U.querySelector("link"))}4&q.$flags$&&(Yt.innerHTML+=$e),Wt&&Wt.add(Et)}}else U.adoptedStyleSheets.includes(Xe)||(U.adoptedStyleSheets=[...U.adoptedStyleSheets,Xe]);return Et},ti=(U,q)=>"sc-"+(q&&32&U.$flags$?U.$tagName$+"-"+q:U.$tagName$),li=U=>U.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),Gn=(U,q,pe,Ne,Et,Xe)=>{if(pe!==Ne){let Wt=Ds(U,q),Yt=q.toLowerCase();if("class"===q){const cn=U.classList,Zt=Ci(pe),En=Ci(Ne);cn.remove(...Zt.filter(Wn=>Wn&&!En.includes(Wn))),cn.add(...En.filter(Wn=>Wn&&!Zt.includes(Wn)))}else if("style"===q){for(const cn in pe)(!Ne||null==Ne[cn])&&(cn.includes("-")?U.style.removeProperty(cn):U.style[cn]="");for(const cn in Ne)(!pe||Ne[cn]!==pe[cn])&&(cn.includes("-")?U.style.setProperty(cn,Ne[cn]):U.style[cn]=Ne[cn])}else if("key"!==q)if("ref"===q)Ne&&Ne(U);else if(Wt||"o"!==q[0]||"n"!==q[1]){const cn=lt(Ne);if((Wt||cn&&null!==Ne)&&!Et)try{if(U.tagName.includes("-"))U[q]=Ne;else{const En=null==Ne?"":Ne;"list"===q?Wt=!1:(null==pe||U[q]!=En)&&(U[q]=En)}}catch{}let Zt=!1;Yt!==(Yt=Yt.replace(/^xlink\:?/,""))&&(q=Yt,Zt=!0),null==Ne||!1===Ne?(!1!==Ne||""===U.getAttribute(q))&&(Zt?U.removeAttributeNS(me,q):U.removeAttribute(q)):(!Wt||4&Xe||Et)&&!cn&&(Ne=!0===Ne?"":Ne,Zt?U.setAttributeNS(me,q,Ne):U.setAttribute(q,Ne))}else if(q="-"===q[2]?q.slice(3):Ds(os,Yt)?Yt.slice(2):Yt[2]+q.slice(3),pe||Ne){const cn=q.endsWith(ar);q=q.replace(Rn,""),pe&&ci.rel(U,q,pe,cn),Ne&&ci.ael(U,q,Ne,cn)}}},ki=/\s/,Ci=U=>U?U.split(ki):[],ar="Capture",Rn=new RegExp(ar+"$"),mi=(U,q,pe,Ne)=>{const Et=11===q.$elm$.nodeType&&q.$elm$.host?q.$elm$.host:q.$elm$,Xe=U&&U.$attrs$||ve,Wt=q.$attrs$||ve;for(Ne in Xe)Ne in Wt||Gn(Et,Ne,Xe[Ne],void 0,pe,q.$flags$);for(Ne in Wt)Gn(Et,Ne,Xe[Ne],Wt[Ne],pe,q.$flags$)},hi=(U,q,pe,Ne)=>{var Et;const Xe=q.$children$[pe];let Yt,cn,Zt,Wt=0;if(Be||(Pt=!0,"slot"===Xe.$tag$&&(Pe&&Ne.classList.add(Pe+"-s"),Xe.$flags$|=Xe.$children$?2:1)),null!==Xe.$text$)Yt=Xe.$elm$=ir.createTextNode(Xe.$text$);else if(1&Xe.$flags$)Yt=Xe.$elm$=ir.createTextNode("");else{if(yt||(yt="svg"===Xe.$tag$),Yt=Xe.$elm$=ir.createElementNS(yt?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Xe.$flags$?"slot-fb":Xe.$tag$),yt&&"foreignObject"===Xe.$tag$&&(yt=!1),mi(null,Xe,yt),(U=>null!=U)(Pe)&&Yt["s-si"]!==Pe&&Yt.classList.add(Yt["s-si"]=Pe),Xe.$children$)for(Wt=0;Wt<Xe.$children$.length;++Wt)cn=hi(U,Xe,Wt,Yt),cn&&Yt.appendChild(cn);"svg"===Xe.$tag$?yt=!1:"foreignObject"===Yt.tagName&&(yt=!0)}return Yt["s-hn"]=Fe,3&Xe.$flags$&&(Yt["s-sr"]=!0,Yt["s-fs"]=null===(Et=Xe.$attrs$)||void 0===Et?void 0:Et.slot,Yt["s-cr"]=ft,Yt["s-sn"]=Xe.$name$||"",Zt=U&&U.$children$&&U.$children$[pe],Zt&&Zt.$tag$===Xe.$tag$&&U.$elm$&&Sr(U.$elm$,!1)),Yt},Sr=(U,q)=>{var pe;ci.$flags$|=1;const Ne=U.childNodes;for(let Et=Ne.length-1;Et>=0;Et--){const Xe=Ne[Et];Xe["s-hn"]!==Fe&&Xe["s-ol"]&&(Ei(Xe).insertBefore(Xe,jr(Xe)),Xe["s-ol"].remove(),Xe["s-ol"]=void 0,Xe["s-sh"]=void 0,1===Xe.nodeType&&Xe.setAttribute("slot",null!==(pe=Xe["s-sn"])&&void 0!==pe?pe:""),Pt=!0),q&&Sr(Xe,q)}ci.$flags$&=-2},Fr=(U,q,pe,Ne,Et,Xe)=>{let Yt,Wt=U["s-cr"]&&U["s-cr"].parentNode||U;for(Wt.shadowRoot&&Wt.tagName===Fe&&(Wt=Wt.shadowRoot);Et<=Xe;++Et)Ne[Et]&&(Yt=hi(null,pe,Et,U),Yt&&(Ne[Et].$elm$=Yt,Wt.insertBefore(Yt,jr(q))))},vn=(U,q,pe)=>{for(let Ne=q;Ne<=pe;++Ne){const Et=U[Ne];if(Et){const Xe=Et.$elm$;wi(Et),Xe&&(Dt=!0,Xe["s-ol"]?Xe["s-ol"].remove():Sr(Xe,!0),Xe.remove())}}},fr=(U,q)=>U.$tag$===q.$tag$&&("slot"===U.$tag$?U.$name$===q.$name$:U.$key$===q.$key$),jr=U=>U&&U["s-ol"]||U,Ei=U=>(U["s-ol"]?U["s-ol"]:U).parentNode,Zr=(U,q)=>{const pe=q.$elm$=U.$elm$,Ne=U.$children$,Et=q.$children$,Xe=q.$tag$,Wt=q.$text$;let Yt;null===Wt?(yt="svg"===Xe||"foreignObject"!==Xe&&yt,"slot"===Xe||mi(U,q,yt),null!==Ne&&null!==Et?((U,q,pe,Ne)=>{let pr,I,Et=0,Xe=0,Wt=0,Yt=0,cn=q.length-1,Zt=q[0],En=q[cn],Wn=Ne.length-1,On=Ne[0],$i=Ne[Wn];for(;Et<=cn&&Xe<=Wn;)if(null==Zt)Zt=q[++Et];else if(null==En)En=q[--cn];else if(null==On)On=Ne[++Xe];else if(null==$i)$i=Ne[--Wn];else if(fr(Zt,On))Zr(Zt,On),Zt=q[++Et],On=Ne[++Xe];else if(fr(En,$i))Zr(En,$i),En=q[--cn],$i=Ne[--Wn];else if(fr(Zt,$i))("slot"===Zt.$tag$||"slot"===$i.$tag$)&&Sr(Zt.$elm$.parentNode,!1),Zr(Zt,$i),U.insertBefore(Zt.$elm$,En.$elm$.nextSibling),Zt=q[++Et],$i=Ne[--Wn];else if(fr(En,On))("slot"===Zt.$tag$||"slot"===$i.$tag$)&&Sr(En.$elm$.parentNode,!1),Zr(En,On),U.insertBefore(En.$elm$,Zt.$elm$),En=q[--cn],On=Ne[++Xe];else{for(Wt=-1,Yt=Et;Yt<=cn;++Yt)if(q[Yt]&&null!==q[Yt].$key$&&q[Yt].$key$===On.$key$){Wt=Yt;break}Wt>=0?(I=q[Wt],I.$tag$!==On.$tag$?pr=hi(q&&q[Xe],pe,Wt,U):(Zr(I,On),q[Wt]=void 0,pr=I.$elm$),On=Ne[++Xe]):(pr=hi(q&&q[Xe],pe,Xe,U),On=Ne[++Xe]),pr&&Ei(Zt.$elm$).insertBefore(pr,jr(Zt.$elm$))}Et>cn?Fr(U,null==Ne[Wn+1]?null:Ne[Wn+1].$elm$,pe,Ne,Xe,Wn):Xe>Wn&&vn(q,Et,cn)})(pe,Ne,q,Et):null!==Et?(null!==U.$text$&&(pe.textContent=""),Fr(pe,null,q,Et,0,Et.length-1)):null!==Ne&&vn(Ne,0,Ne.length-1),yt&&"svg"===Xe&&(yt=!1)):(Yt=pe["s-cr"])?Yt.parentNode.textContent=Wt:U.$text$!==Wt&&(pe.data=Wt)},Jn=U=>{const q=U.childNodes;for(const pe of q)if(1===pe.nodeType){if(pe["s-sr"]){const Ne=pe["s-sn"];pe.hidden=!1;for(const Et of q)if(Et!==pe)if(Et["s-hn"]!==pe["s-hn"]||""!==Ne){if(1===Et.nodeType&&(Ne===Et.getAttribute("slot")||Ne===Et["s-sn"])){pe.hidden=!0;break}}else if(1===Et.nodeType||3===Et.nodeType&&""!==Et.textContent.trim()){pe.hidden=!0;break}}Jn(pe)}},Ar=[],fs=U=>{let q,pe,Ne;for(const Et of U.childNodes){if(Et["s-sr"]&&(q=Et["s-cr"])&&q.parentNode){pe=q.parentNode.childNodes;const Xe=Et["s-sn"];for(Ne=pe.length-1;Ne>=0;Ne--)if(q=pe[Ne],!q["s-cn"]&&!q["s-nr"]&&q["s-hn"]!==Et["s-hn"])if(xn(q,Xe)){let Wt=Ar.find(Yt=>Yt.$nodeToRelocate$===q);Dt=!0,q["s-sn"]=q["s-sn"]||Xe,Wt?(Wt.$nodeToRelocate$["s-sh"]=Et["s-hn"],Wt.$slotRefNode$=Et):(q["s-sh"]=Et["s-hn"],Ar.push({$slotRefNode$:Et,$nodeToRelocate$:q})),q["s-sr"]&&Ar.map(Yt=>{xn(Yt.$nodeToRelocate$,q["s-sn"])&&(Wt=Ar.find(cn=>cn.$nodeToRelocate$===q),Wt&&!Yt.$slotRefNode$&&(Yt.$slotRefNode$=Wt.$slotRefNode$))})}else Ar.some(Wt=>Wt.$nodeToRelocate$===q)||Ar.push({$nodeToRelocate$:q})}1===Et.nodeType&&fs(Et)}},xn=(U,q)=>1===U.nodeType?null===U.getAttribute("slot")&&""===q||U.getAttribute("slot")===q:U["s-sn"]===q||""===q,wi=U=>{U.$attrs$&&U.$attrs$.ref&&U.$attrs$.ref(null),U.$children$&&U.$children$.map(wi)},ss=(U,q)=>{q&&!U.$onRenderResolve$&&q["s-p"]&&q["s-p"].push(new Promise(pe=>U.$onRenderResolve$=pe))},no=(U,q)=>{if(U.$flags$|=16,!(4&U.$flags$))return ss(U,U.$ancestorComponent$),_n(()=>Br(U,q));U.$flags$|=512},Br=(U,q)=>{const Ne=U.$lazyInstance$;let Et;return q&&(U.$flags$|=256,U.$queuedListeners$&&(U.$queuedListeners$.map(([Xe,Wt])=>ke(Ne,Xe,Wt)),U.$queuedListeners$=void 0),Et=ke(Ne,"componentWillLoad")),Et=ts(Et,()=>ke(Ne,"componentWillRender")),ts(Et,()=>yr(U,Ne,q))},ts=(U,q)=>kr(U)?U.then(q):q(),kr=U=>U instanceof Promise||U&&U.then&&"function"==typeof U.then,yr=function(){var U=(0,p.Z)(function*(q,pe,Ne){var Et;const Xe=q.$hostElement$,Yt=Xe["s-rc"];Ne&&(U=>{const q=U.$cmpMeta$,pe=U.$hostElement$,Ne=q.$flags$,Xe=tn(pe.shadowRoot?pe.shadowRoot:pe.getRootNode(),q,U.$modeName$);10&Ne&&(pe["s-sc"]=Xe,pe.classList.add(Xe+"-h"),2&Ne&&pe.classList.add(Xe+"-s"))})(q);_s(q,pe,Xe,Ne),Yt&&(Yt.map(Zt=>Zt()),Xe["s-rc"]=void 0);{const Zt=null!==(Et=Xe["s-p"])&&void 0!==Et?Et:[],En=()=>kt(q);0===Zt.length?En():(Promise.all(Zt).then(En),q.$flags$|=4,Zt.length=0)}});return function(pe,Ne,Et){return U.apply(this,arguments)}}(),_s=(U,q,pe,Ne)=>{try{q=q.render&&q.render(),U.$flags$&=-17,U.$flags$|=2,((U,q,pe=!1)=>{var Ne,Et,Xe,Wt;const Yt=U.$hostElement$,cn=U.$cmpMeta$,Zt=U.$vnode$||$n(null,null),En=(U=>U&&U.$tag$===Mi)(q)?q:ln(null,null,q);if(Fe=Yt.tagName,cn.$attrsToReflect$&&(En.$attrs$=En.$attrs$||{},cn.$attrsToReflect$.map(([Wn,On])=>En.$attrs$[On]=Yt[Wn])),pe&&En.$attrs$)for(const Wn of Object.keys(En.$attrs$))Yt.hasAttribute(Wn)&&!["key","ref","style","class"].includes(Wn)&&(En.$attrs$[Wn]=Yt[Wn]);if(En.$tag$=null,En.$flags$|=4,U.$vnode$=En,En.$elm$=Zt.$elm$=Yt.shadowRoot||Yt,Pe=Yt["s-sc"],ft=Yt["s-cr"],Be=0!=(1&cn.$flags$),Dt=!1,Zr(Zt,En),ci.$flags$|=1,Pt){fs(En.$elm$);for(const Wn of Ar){const On=Wn.$nodeToRelocate$;if(!On["s-ol"]){const $i=ir.createTextNode("");$i["s-nr"]=On,On.parentNode.insertBefore(On["s-ol"]=$i,On)}}for(const Wn of Ar){const On=Wn.$nodeToRelocate$,$i=Wn.$slotRefNode$;if($i){const pr=$i.parentNode;let I=$i.nextSibling;{let ie=null===(Ne=On["s-ol"])||void 0===Ne?void 0:Ne.previousSibling;for(;ie;){let k=null!==(Et=ie["s-nr"])&&void 0!==Et?Et:null;if(k&&k["s-sn"]===On["s-sn"]&&pr===k.parentNode&&(k=k.nextSibling,!k||!k["s-nr"])){I=k;break}ie=ie.previousSibling}}(!I&&pr!==On.parentNode||On.nextSibling!==I)&&On!==I&&(!On["s-hn"]&&On["s-ol"]&&(On["s-hn"]=On["s-ol"].parentNode.nodeName),pr.insertBefore(On,I),1===On.nodeType&&(On.hidden=null!==(Xe=On["s-ih"])&&void 0!==Xe&&Xe))}else 1===On.nodeType&&(pe&&(On["s-ih"]=null!==(Wt=On.hidden)&&void 0!==Wt&&Wt),On.hidden=!0)}}Dt&&Jn(En.$elm$),ci.$flags$&=-2,Ar.length=0})(U,q,Ne)}catch(Et){Tr(Et,U.$hostElement$)}return null},kt=U=>{const pe=U.$hostElement$,Et=U.$lazyInstance$,Xe=U.$ancestorComponent$;ke(Et,"componentDidRender"),64&U.$flags$?ke(Et,"componentDidUpdate"):(U.$flags$|=64,gt(pe),ke(Et,"componentDidLoad"),U.$onReadyResolve$(pe),Xe||_t()),U.$onInstanceResolve$(pe),U.$onRenderResolve$&&(U.$onRenderResolve$(),U.$onRenderResolve$=void 0),512&U.$flags$&&Qe(()=>no(U,!1)),U.$flags$&=-517},qe=U=>{{const q=nr(U),pe=q.$hostElement$.isConnected;return pe&&2==(18&q.$flags$)&&no(q,!1),pe}},_t=U=>{gt(ir.documentElement),Qe(()=>Xt(os,"appload",{detail:{namespace:"ionic"}}))},ke=(U,q,pe)=>{if(U&&U[q])try{return U[q](pe)}catch(Ne){Tr(Ne)}},gt=U=>U.classList.add("hydrated"),ni=(U,q,pe)=>{var Ne;const Et=U.prototype;if(q.$members$){U.watchers&&(q.$watchers$=U.watchers);const Xe=Object.entries(q.$members$);if(Xe.map(([Wt,[Yt]])=>{31&Yt||2&pe&&32&Yt?Object.defineProperty(Et,Wt,{get(){return((U,q)=>nr(this).$instanceValues$.get(q))(0,Wt)},set(cn){((U,q,pe,Ne)=>{const Et=nr(U),Xe=Et.$hostElement$,Wt=Et.$instanceValues$.get(q),Yt=Et.$flags$,cn=Et.$lazyInstance$;pe=((U,q)=>null==U||lt(U)?U:4&q?"false"!==U&&(""===U||!!U):2&q?parseFloat(U):1&q?String(U):U)(pe,Ne.$members$[q][0]);const Zt=Number.isNaN(Wt)&&Number.isNaN(pe);if((!(8&Yt)||void 0===Wt)&&pe!==Wt&&!Zt&&(Et.$instanceValues$.set(q,pe),cn)){if(Ne.$watchers$&&128&Yt){const Wn=Ne.$watchers$[q];Wn&&Wn.map(On=>{try{cn[On](pe,Wt,q)}catch($i){Tr($i,Xe)}})}2==(18&Yt)&&no(Et,!1)}})(this,Wt,cn,q)},configurable:!0,enumerable:!0}):1&pe&&64&Yt&&Object.defineProperty(Et,Wt,{value(...cn){var Zt;const En=nr(this);return null===(Zt=null==En?void 0:En.$onInstancePromise$)||void 0===Zt?void 0:Zt.then(()=>{var Wn;return null===(Wn=En.$lazyInstance$)||void 0===Wn?void 0:Wn[Wt](...cn)})}})}),1&pe){const Wt=new Map;Et.attributeChangedCallback=function(Yt,cn,Zt){ci.jmp(()=>{var En;const Wn=Wt.get(Yt);if(this.hasOwnProperty(Wn))Zt=this[Wn],delete this[Wn];else{if(Et.hasOwnProperty(Wn)&&"number"==typeof this[Wn]&&this[Wn]==Zt)return;if(null==Wn){const On=nr(this),$i=null==On?void 0:On.$flags$;if($i&&!(8&$i)&&128&$i&&Zt!==cn){const pr=On.$lazyInstance$,I=null===(En=q.$watchers$)||void 0===En?void 0:En[Yt];null==I||I.forEach(ie=>{null!=pr[ie]&&pr[ie].call(pr,Zt,cn,Yt)})}return}}this[Wn]=(null!==Zt||"boolean"!=typeof this[Wn])&&Zt})},U.observedAttributes=Array.from(new Set([...Object.keys(null!==(Ne=q.$watchers$)&&void 0!==Ne?Ne:{}),...Xe.filter(([Yt,cn])=>15&cn[0]).map(([Yt,cn])=>{var Zt;const En=cn[1]||Yt;return Wt.set(En,Yt),512&cn[0]&&(null===(Zt=q.$attrsToReflect$)||void 0===Zt||Zt.push([Yt,En])),En})]))}}return U},Ri=function(){var U=(0,p.Z)(function*(q,pe,Ne,Et){let Xe;if(!(32&pe.$flags$)){pe.$flags$|=32;{if(Xe=Is(Ne),Xe.then){const Zt=()=>{};Xe=yield Xe,Zt()}Xe.isProxied||(Ne.$watchers$=Xe.watchers,ni(Xe,Ne,2),Xe.isProxied=!0);const cn=()=>{};pe.$flags$|=8;try{new Xe(pe)}catch(Zt){Tr(Zt)}pe.$flags$&=-9,pe.$flags$|=128,cn(),Ui(pe.$lazyInstance$)}if(Xe.style){let cn=Xe.style;"string"!=typeof cn&&(cn=cn[pe.$modeName$=(U=>Di.map(q=>q(U)).find(q=>!!q))(q)]);const Zt=ti(Ne,pe.$modeName$);if(!Or.has(Zt)){const En=()=>{};It(Zt,cn,!!(1&Ne.$flags$)),En()}}}const Wt=pe.$ancestorComponent$,Yt=()=>no(pe,!0);Wt&&Wt["s-rc"]?Wt["s-rc"].push(Yt):Yt()});return function(pe,Ne,Et,Xe){return U.apply(this,arguments)}}(),Ui=U=>{ke(U,"connectedCallback")},cr=U=>{const q=U["s-cr"]=ir.createComment("");q["s-cn"]=!0,U.insertBefore(q,U.firstChild)},qn=U=>{ke(U,"disconnectedCallback")},Ws=function(){var U=(0,p.Z)(function*(q){if(!(1&ci.$flags$)){const pe=nr(q);pe.$rmListeners$&&(pe.$rmListeners$.map(Ne=>Ne()),pe.$rmListeners$=void 0),null!=pe&&pe.$lazyInstance$?qn(pe.$lazyInstance$):null!=pe&&pe.$onReadyPromise$&&pe.$onReadyPromise$.then(()=>qn(pe.$lazyInstance$))}});return function(pe){return U.apply(this,arguments)}}(),io=(U,q={})=>{var pe;const Et=[],Xe=q.exclude||[],Wt=os.customElements,Yt=ir.head,cn=Yt.querySelector("meta[charset]"),Zt=ir.createElement("style"),En=[],Wn=ir.querySelectorAll(`[${st}]`);let On,$i=!0,pr=0;for(Object.assign(ci,q),ci.$resourcesUrl$=new URL(q.resourcesUrl||"./",ir.baseURI).href,ci.$flags$|=2;pr<Wn.length;pr++)It(Wn[pr].getAttribute(st),li(Wn[pr].innerHTML),!0);let I=!1;if(U.map(ie=>{ie[1].map(k=>{var oe;const Ke={$flags$:k[0],$tagName$:k[1],$members$:k[2],$listeners$:k[3]};4&Ke.$flags$&&(I=!0),Ke.$members$=k[2],Ke.$listeners$=k[3],Ke.$attrsToReflect$=[],Ke.$watchers$=null!==(oe=k[4])&&void 0!==oe?oe:{};const yi=Ke.$tagName$,Nr=class extends HTMLElement{constructor(as){super(as),vo(as=this,Ke),1&Ke.$flags$&&as.attachShadow({mode:"open",delegatesFocus:!!(16&Ke.$flags$)})}connectedCallback(){On&&(clearTimeout(On),On=null),$i?En.push(this):ci.jmp(()=>(U=>{if(!(1&ci.$flags$)){const q=nr(U),pe=q.$cmpMeta$,Ne=()=>{};if(1&q.$flags$)js(U,q,pe.$listeners$),null!=q&&q.$lazyInstance$?Ui(q.$lazyInstance$):null!=q&&q.$onReadyPromise$&&q.$onReadyPromise$.then(()=>Ui(q.$lazyInstance$));else{let Et;if(q.$flags$|=1,Et=U.getAttribute($t),Et){if(1&pe.$flags$){const Xe=tn(U.shadowRoot,pe,U.getAttribute("s-mode"));U.classList.remove(Xe+"-h",Xe+"-s")}((U,q,pe,Ne)=>{const Xe=U.shadowRoot,Wt=[],cn=Xe?[]:null,Zt=Ne.$vnode$=$n(q,null);ci.$orgLocNodes$||ut(ir.body,ci.$orgLocNodes$=new Map),U[$t]=pe,U.removeAttribute($t),wt(Zt,Wt,[],cn,U,U,pe),Wt.map(En=>{const Wn=En.$hostId$+"."+En.$nodeId$,On=ci.$orgLocNodes$.get(Wn),$i=En.$elm$;On&&xs&&""===On["s-en"]&&On.parentNode.insertBefore($i,On.nextSibling),Xe||($i["s-hn"]=q,On&&($i["s-ol"]=On,$i["s-ol"]["s-nr"]=$i)),ci.$orgLocNodes$.delete(Wn)}),Xe&&cn.map(En=>{En&&Xe.appendChild(En)})})(U,pe.$tagName$,Et,q)}Et||12&pe.$flags$&&cr(U);{let Xe=U;for(;Xe=Xe.parentNode||Xe.host;)if(1===Xe.nodeType&&Xe.hasAttribute("s-id")&&Xe["s-p"]||Xe["s-p"]){ss(q,q.$ancestorComponent$=Xe);break}}pe.$members$&&Object.entries(pe.$members$).map(([Xe,[Wt]])=>{if(31&Wt&&U.hasOwnProperty(Xe)){const Yt=U[Xe];delete U[Xe],U[Xe]=Yt}}),Ri(U,q,pe)}Ne()}})(this))}disconnectedCallback(){ci.jmp(()=>Ws(this))}componentOnReady(){return nr(this).$onReadyPromise$}};Ke.$lazyBundleId$=ie[0],!Xe.includes(yi)&&!Wt.get(yi)&&(Et.push(yi),Wt.define(yi,ni(Nr,Ke,1)))})}),I&&(Zt.innerHTML+=$e),Zt.innerHTML+=Et+"{visibility:hidden}.hydrated{visibility:inherit}",Zt.innerHTML.length){Zt.setAttribute("data-styles","");const ie=null!==(pe=ci.$nonce$)&&void 0!==pe?pe:dt(ir);null!=ie&&Zt.setAttribute("nonce",ie),Yt.insertBefore(Zt,cn?cn.nextSibling:Yt.firstChild)}$i=!1,En.length?En.map(ie=>ie.connectedCallback()):ci.jmp(()=>On=setTimeout(_t,30))},js=(U,q,pe,Ne)=>{pe&&pe.map(([Et,Xe,Wt])=>{const Yt=Hi(U,Et),cn=go(q,Wt),Zt=Ys(Et);ci.ael(Yt,Xe,cn,Zt),(q.$rmListeners$=q.$rmListeners$||[]).push(()=>ci.rel(Yt,Xe,cn,Zt))})},go=(U,q)=>pe=>{try{256&U.$flags$?U.$lazyInstance$[q](pe):(U.$queuedListeners$=U.$queuedListeners$||[]).push([q,pe])}catch(Ne){Tr(Ne)}},Hi=(U,q)=>4&q?ir:8&q?os:16&q?ir.body:U,Ys=U=>0!=(2&U),Ts=new WeakMap,nr=U=>Ts.get(U),ps=(U,q)=>Ts.set(q.$lazyInstance$=U,q),vo=(U,q)=>{const pe={$flags$:0,$hostElement$:U,$cmpMeta$:q,$instanceValues$:new Map};return pe.$onInstancePromise$=new Promise(Ne=>pe.$onInstanceResolve$=Ne),pe.$onReadyPromise$=new Promise(Ne=>pe.$onReadyResolve$=Ne),U["s-p"]=[],U["s-rc"]=[],js(U,pe,q.$listeners$),Ts.set(U,pe)},Ds=(U,q)=>q in U,Tr=(U,q)=>(0,console.error)(U,q),ms=new Map,Is=(U,q,pe)=>{const Ne=U.$tagName$.replace(/-/g,"_"),Et=U.$lazyBundleId$,Xe=ms.get(Et);return Xe?Xe[Ne]:re(863)(`./${Et}.entry.js`).then(Wt=>(ms.set(Et,Wt),Wt[Ne]),Tr)},Or=new Map,Di=[],os=typeof window<"u"?window:{},ir=os.document||{head:{}},ci={$flags$:0,$resourcesUrl$:"",jmp:U=>U(),raf:U=>requestAnimationFrame(U),ael:(U,q,pe,Ne)=>U.addEventListener(q,pe,Ne),rel:(U,q,pe,Ne)=>U.removeEventListener(q,pe,Ne),ce:(U,q)=>new CustomEvent(U,q)},Co=U=>{Object.assign(ci,U)},xs=!0,Os=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),ro=[],de=[],be=(U,q)=>pe=>{U.push(pe),Le||(Le=!0,q&&4&ci.$flags$?Qe(ge):ci.raf(ge))},K=U=>{for(let q=0;q<U.length;q++)try{U[q](performance.now())}catch(pe){Tr(pe)}U.length=0},ge=()=>{K(ro),K(de),(Le=ro.length>0)&&ci.raf(ge)},Qe=U=>Promise.resolve(void 0).then(U),Gt=be(ro,!1),_n=be(de,!0)},2905:(Qn,Vt,re)=>{"use strict";re.d(Vt,{a:()=>Le,b:()=>$n,c:()=>Ye,i:()=>Mi});var p=re(771);class se{constructor(){this.m=new Map}reset(Oe){this.m=new Map(Object.entries(Oe))}get(Oe,ye){const Ie=this.m.get(Oe);return void 0!==Ie?Ie:ye}getBoolean(Oe,ye=!1){const Ie=this.m.get(Oe);return void 0===Ie?ye:"string"==typeof Ie?"true"===Ie:!!Ie}getNumber(Oe,ye){const Ie=parseFloat(this.m.get(Oe));return isNaN(Ie)?void 0!==ye?ye:NaN:Ie}set(Oe,ye){this.m.set(Oe,ye)}}const Ye=new se,Pt="ionic-persist-config",Le=(Lt,Oe)=>("string"==typeof Lt&&(Oe=Lt,Lt=void 0),(Lt=>mt(Lt))(Lt).includes(Oe)),mt=(Lt=window)=>{if(typeof Lt>"u")return[];Lt.Ionic=Lt.Ionic||{};let Oe=Lt.Ionic.platforms;return null==Oe&&(Oe=Lt.Ionic.platforms=ct(Lt),Oe.forEach(ye=>Lt.document.documentElement.classList.add(`plt-${ye}`))),Oe},ct=Lt=>{const Oe=Ye.get("platform");return Object.keys(dt).filter(ye=>{const Ie=null==Oe?void 0:Oe[ye];return"function"==typeof Ie?Ie(Lt):dt[ye](Lt)})},je=Lt=>!!(at(Lt,/iPad/i)||at(Lt,/Macintosh/i)&&ot(Lt)),Je=Lt=>at(Lt,/android|sink/i),ot=Lt=>lt(Lt,"(any-pointer:coarse)"),$e=Lt=>me(Lt)||ve(Lt),me=Lt=>!!(Lt.cordova||Lt.phonegap||Lt.PhoneGap),ve=Lt=>{const Oe=Lt.Capacitor;return!(null==Oe||!Oe.isNative)},at=(Lt,Oe)=>Oe.test(Lt.navigator.userAgent),lt=(Lt,Oe)=>{var ye;return null===(ye=Lt.matchMedia)||void 0===ye?void 0:ye.call(Lt,Oe).matches},dt={ipad:je,iphone:Lt=>at(Lt,/iPhone/i),ios:Lt=>at(Lt,/iPhone|iPod/i)||je(Lt),android:Je,phablet:Lt=>{const Oe=Lt.innerWidth,ye=Lt.innerHeight,Ie=Math.min(Oe,ye),xe=Math.max(Oe,ye);return Ie>390&&Ie<520&&xe>620&&xe<800},tablet:Lt=>{const Oe=Lt.innerWidth,ye=Lt.innerHeight,Ie=Math.min(Oe,ye),xe=Math.max(Oe,ye);return je(Lt)||(Lt=>Je(Lt)&&!at(Lt,/mobile/i))(Lt)||Ie>460&&Ie<820&&xe>780&&xe<1400},cordova:me,capacitor:ve,electron:Lt=>at(Lt,/electron/i),pwa:Lt=>{var Oe;return!!(null!==(Oe=Lt.matchMedia)&&void 0!==Oe&&Oe.call(Lt,"(display-mode: standalone)").matches||Lt.navigator.standalone)},mobile:ot,mobileweb:Lt=>ot(Lt)&&!$e(Lt),desktop:Lt=>!ot(Lt),hybrid:$e};let ln;const $n=Lt=>Lt&&(0,p.g)(Lt)||ln,Mi=(Lt={})=>{if(typeof window>"u")return;const Oe=window.document,ye=window,Ie=ye.Ionic=ye.Ionic||{},xe={};Lt._ael&&(xe.ael=Lt._ael),Lt._rel&&(xe.rel=Lt._rel),Lt._ce&&(xe.ce=Lt._ce),(0,p.a)(xe);const wt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Lt=>{try{const Oe=Lt.sessionStorage.getItem(Pt);return null!==Oe?JSON.parse(Oe):{}}catch{return{}}})(ye)),{persistConfig:!1}),Ie.config),(Lt=>{const Oe={};return Lt.location.search.slice(1).split("&").map(ye=>ye.split("=")).map(([ye,Ie])=>[decodeURIComponent(ye),decodeURIComponent(Ie)]).filter(([ye])=>((Lt,Oe)=>Lt.substr(0,Oe.length)===Oe)(ye,"ionic:")).map(([ye,Ie])=>[ye.slice(6),Ie]).forEach(([ye,Ie])=>{Oe[ye]=Ie}),Oe})(ye)),Lt);Ye.reset(wt),Ye.getBoolean("persistConfig")&&((Lt,Oe)=>{try{Lt.sessionStorage.setItem(Pt,JSON.stringify(Oe))}catch{return}})(ye,wt),mt(ye),Ie.config=Ye,Ie.mode=ln=Ye.get("mode",Oe.documentElement.getAttribute("mode")||(Le(ye,"ios")?"ios":"md")),Ye.set("mode",ln),Oe.documentElement.setAttribute("mode",ln),Oe.documentElement.classList.add(ln),Ye.getBoolean("_testing")&&Ye.set("animated",!1);const ut=Mn=>{var yn;return null===(yn=Mn.tagName)||void 0===yn?void 0:yn.startsWith("ION-")},un=Mn=>["ios","md"].includes(Mn);(0,p.c)(Mn=>{for(;Mn;){const yn=Mn.mode||Mn.getAttribute("mode");if(yn){if(un(yn))return yn;ut(Mn)&&console.warn('Invalid ionic mode: "'+yn+'", expected: "ios" or "md"')}Mn=Mn.parentElement}return ln})}},3433:(Qn,Vt,re)=>{"use strict";re.r(Vt),re.d(Vt,{iosTransitionAnimation:()=>ct,shadow:()=>Be});var p=re(4913),se=re(2325);re(1848),re(771);const Fe=je=>document.querySelector(`${je}.ion-cloned-element`),Be=je=>je.shadowRoot||je,Dt=je=>{const Rt="ION-TABS"===je.tagName?je:je.querySelector("ion-tabs"),Ze="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=Rt){const Je=Rt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Je?Je.querySelector(Ze):null}return je.querySelector(Ze)},Pt=(je,Rt)=>{const Ze="ION-TABS"===je.tagName?je:je.querySelector("ion-tabs");let Je=[];if(null!=Ze){const et=Ze.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=et&&(Je=et.querySelectorAll("ion-buttons"))}else Je=je.querySelectorAll("ion-buttons");for(const et of Je){const $t=et.closest("ion-header"),st=$t&&!$t.classList.contains("header-collapse-condense-inactive"),ot=et.querySelector("ion-back-button"),bt=et.classList.contains("buttons-collapse");if(null!==ot&&("start"===et.slot||""===et.slot)&&(bt&&st&&Rt||!bt))return ot}return null},Le=(je,Rt,Ze,Je,et,$t,st,ot,bt)=>{var $e,me;const ve=Rt?`calc(100% - ${et.right+4}px)`:et.left-4+"px",Ue=Rt?"right":"left",Ce=Rt?"left":"right",at=Rt?"right":"left",lt=(null===($e=$t.textContent)||void 0===$e?void 0:$e.trim())===(null===(me=ot.textContent)||void 0===me?void 0:me.trim()),ln=(bt.height-tt)/st.height,$n=lt?`scale(${bt.width/st.width}, ${ln})`:`scale(${ln})`,Mi="scale(1)",Oe=Be(Je).querySelector("ion-icon").getBoundingClientRect(),ye=Rt?Oe.width/2-(Oe.right-et.right)+"px":et.left-Oe.width/2+"px",Ie=Rt?`-${window.innerWidth-et.right}px`:`${et.left}px`,xe=`${bt.top}px`,wt=`${et.top}px`,Mn=Ze?[{offset:0,transform:`translate3d(${Ie}, ${wt}, 0)`},{offset:1,transform:`translate3d(${ye}, ${xe}, 0)`}]:[{offset:0,transform:`translate3d(${ye}, ${xe}, 0)`},{offset:1,transform:`translate3d(${Ie}, ${wt}, 0)`}],ai=Ze?[{offset:0,opacity:1,transform:Mi},{offset:1,opacity:0,transform:$n}]:[{offset:0,opacity:0,transform:$n},{offset:1,opacity:1,transform:Mi}],Ft=Ze?[{offset:0,opacity:1,transform:"scale(1)"},{offset:.2,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:0,transform:"scale(0.6)"}]:[{offset:0,opacity:0,transform:"scale(0.6)"},{offset:.6,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:1,transform:"scale(1)"}],It=(0,p.c)(),tn=(0,p.c)(),Ut=(0,p.c)(),ti=Fe("ion-back-button"),li=Be(ti).querySelector(".button-text"),Gn=Be(ti).querySelector("ion-icon");ti.text=Je.text,ti.mode=Je.mode,ti.icon=Je.icon,ti.color=Je.color,ti.disabled=Je.disabled,ti.style.setProperty("display","block"),ti.style.setProperty("position","fixed"),tn.addElement(Gn),It.addElement(li),Ut.addElement(ti),Ut.beforeStyles({position:"absolute",top:"0px",[at]:"0px"}).keyframes(Mn),It.beforeStyles({"transform-origin":`${Ue} top`}).beforeAddWrite(()=>{Je.style.setProperty("display","none"),ti.style.setProperty(Ue,ve)}).afterAddWrite(()=>{Je.style.setProperty("display",""),ti.style.setProperty("display","none"),ti.style.removeProperty(Ue)}).keyframes(ai),tn.beforeStyles({"transform-origin":`${Ce} center`}).keyframes(Ft),je.addAnimation([It,tn,Ut])},mt=(je,Rt,Ze,Je,et,$t,st,ot)=>{var bt,$e;const me=Rt?"right":"left",ve=Rt?`calc(100% - ${et.right}px)`:`${et.left}px`,Ce=`${et.top}px`,lt=Rt?`-${window.innerWidth-ot.right-8}px`:ot.x-8+"px",ln=ot.y-2+"px",$n=(null===(bt=st.textContent)||void 0===bt?void 0:bt.trim())===(null===($e=Je.textContent)||void 0===$e?void 0:$e.trim()),Lt=ot.height/($t.height-tt),Oe="scale(1)",ye=$n?`scale(${ot.width/$t.width}, ${Lt})`:`scale(${Lt})`,wt=Ze?[{offset:0,opacity:0,transform:`translate3d(${lt}, ${ln}, 0) ${ye}`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0px, ${Ce}, 0) ${Oe}`}]:[{offset:0,opacity:.99,transform:`translate3d(0px, ${Ce}, 0) ${Oe}`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${lt}, ${ln}, 0) ${ye}`}],ut=Fe("ion-title"),un=(0,p.c)();ut.innerText=Je.innerText,ut.size=Je.size,ut.color=Je.color,un.addElement(ut),un.beforeStyles({"transform-origin":`${me} top`,height:`${et.height}px`,display:"",position:"relative",[me]:ve}).beforeAddWrite(()=>{Je.style.setProperty("opacity","0")}).afterAddWrite(()=>{Je.style.setProperty("opacity",""),ut.style.setProperty("display","none")}).keyframes(wt),je.addAnimation(un)},ct=(je,Rt)=>{var Ze;try{const Je="cubic-bezier(0.32,0.72,0,1)",et="opacity",$t="transform",st="0%",bt="rtl"===je.ownerDocument.dir,$e=bt?"-99.5%":"99.5%",me=bt?"33%":"-33%",ve=Rt.enteringEl,Ue=Rt.leavingEl,Ce="back"===Rt.direction,at=ve.querySelector(":scope > ion-content"),lt=ve.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),dt=ve.querySelectorAll(":scope > ion-header > ion-toolbar"),ln=(0,p.c)(),$n=(0,p.c)();if(ln.addElement(ve).duration((null!==(Ze=Rt.duration)&&void 0!==Ze?Ze:0)||540).easing(Rt.easing||Je).fill("both").beforeRemoveClass("ion-page-invisible"),Ue&&null!=je){const ye=(0,p.c)();ye.addElement(je),ln.addAnimation(ye)}if(at||0!==dt.length||0!==lt.length?($n.addElement(at),$n.addElement(lt)):$n.addElement(ve.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ln.addAnimation($n),Ce?$n.beforeClearStyles([et]).fromTo("transform",`translateX(${me})`,`translateX(${st})`).fromTo(et,.8,1):$n.beforeClearStyles([et]).fromTo("transform",`translateX(${$e})`,`translateX(${st})`),at){const ye=Be(at).querySelector(".transition-effect");if(ye){const Ie=ye.querySelector(".transition-cover"),xe=ye.querySelector(".transition-shadow"),wt=(0,p.c)(),ut=(0,p.c)(),un=(0,p.c)();wt.addElement(ye).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),ut.addElement(Ie).beforeClearStyles([et]).fromTo(et,0,.1),un.addElement(xe).beforeClearStyles([et]).fromTo(et,.03,.7),wt.addAnimation([ut,un]),$n.addAnimation([wt])}}const Mi=ve.querySelector("ion-header.header-collapse-condense"),{forward:Lt,backward:Oe}=((je,Rt,Ze,Je,et)=>{const $t=Pt(Je,Ze),st=Dt(et),ot=Dt(Je),bt=Pt(et,Ze),$e=null!==$t&&null!==st&&!Ze,me=null!==ot&&null!==bt&&Ze;if($e){const ve=st.getBoundingClientRect(),Ue=$t.getBoundingClientRect(),Ce=Be($t).querySelector(".button-text"),at=Ce.getBoundingClientRect(),dt=Be(st).querySelector(".toolbar-title").getBoundingClientRect();mt(je,Rt,Ze,st,ve,dt,Ce,at),Le(je,Rt,Ze,$t,Ue,Ce,at,st,dt)}else if(me){const ve=ot.getBoundingClientRect(),Ue=bt.getBoundingClientRect(),Ce=Be(bt).querySelector(".button-text"),at=Ce.getBoundingClientRect(),dt=Be(ot).querySelector(".toolbar-title").getBoundingClientRect();mt(je,Rt,Ze,ot,ve,dt,Ce,at),Le(je,Rt,Ze,bt,Ue,Ce,at,ot,dt)}return{forward:$e,backward:me}})(ln,bt,Ce,ve,Ue);if(dt.forEach(ye=>{const Ie=(0,p.c)();Ie.addElement(ye),ln.addAnimation(Ie);const xe=(0,p.c)();xe.addElement(ye.querySelector("ion-title"));const wt=(0,p.c)(),ut=Array.from(ye.querySelectorAll("ion-buttons,[menuToggle]")),un=ye.closest("ion-header"),Mn=null==un?void 0:un.classList.contains("header-collapse-condense-inactive");let yn;yn=ut.filter(Ce?Ft=>{const It=Ft.classList.contains("buttons-collapse");return It&&!Mn||!It}:Ft=>!Ft.classList.contains("buttons-collapse")),wt.addElement(yn);const Ln=(0,p.c)();Ln.addElement(ye.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const ai=(0,p.c)();ai.addElement(Be(ye).querySelector(".toolbar-background"));const Si=(0,p.c)(),Xt=ye.querySelector("ion-back-button");if(Xt&&Si.addElement(Xt),Ie.addAnimation([xe,wt,Ln,ai,Si]),wt.fromTo(et,.01,1),Ln.fromTo(et,.01,1),Ce)Mn||xe.fromTo("transform",`translateX(${me})`,`translateX(${st})`).fromTo(et,.01,1),Ln.fromTo("transform",`translateX(${me})`,`translateX(${st})`),Si.fromTo(et,.01,1);else if(Mi||xe.fromTo("transform",`translateX(${$e})`,`translateX(${st})`).fromTo(et,.01,1),Ln.fromTo("transform",`translateX(${$e})`,`translateX(${st})`),ai.beforeClearStyles([et,"transform"]),(null==un?void 0:un.translucent)?ai.fromTo("transform",bt?"translateX(-100%)":"translateX(100%)","translateX(0px)"):ai.fromTo(et,.01,"var(--opacity)"),Lt||Si.fromTo(et,.01,1),Xt&&!Lt){const It=(0,p.c)();It.addElement(Be(Xt).querySelector(".button-text")).fromTo("transform",bt?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Ie.addAnimation(It)}}),Ue){const ye=(0,p.c)(),Ie=Ue.querySelector(":scope > ion-content"),xe=Ue.querySelectorAll(":scope > ion-header > ion-toolbar"),wt=Ue.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Ie||0!==xe.length||0!==wt.length?(ye.addElement(Ie),ye.addElement(wt)):ye.addElement(Ue.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ln.addAnimation(ye),Ce){ye.beforeClearStyles([et]).fromTo("transform",`translateX(${st})`,bt?"translateX(-100%)":"translateX(100%)");const ut=(0,se.g)(Ue);ln.afterAddWrite(()=>{"normal"===ln.getDirection()&&ut.style.setProperty("display","none")})}else ye.fromTo("transform",`translateX(${st})`,`translateX(${me})`).fromTo(et,1,.8);if(Ie){const ut=Be(Ie).querySelector(".transition-effect");if(ut){const un=ut.querySelector(".transition-cover"),Mn=ut.querySelector(".transition-shadow"),yn=(0,p.c)(),Ln=(0,p.c)(),ai=(0,p.c)();yn.addElement(ut).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Ln.addElement(un).beforeClearStyles([et]).fromTo(et,.1,0),ai.addElement(Mn).beforeClearStyles([et]).fromTo(et,.7,.03),yn.addAnimation([Ln,ai]),ye.addAnimation([yn])}}xe.forEach(ut=>{const un=(0,p.c)();un.addElement(ut);const Mn=(0,p.c)();Mn.addElement(ut.querySelector("ion-title"));const yn=(0,p.c)(),Ln=ut.querySelectorAll("ion-buttons,[menuToggle]"),ai=ut.closest("ion-header"),Si=null==ai?void 0:ai.classList.contains("header-collapse-condense-inactive"),Xt=Array.from(Ln).filter(li=>{const Gn=li.classList.contains("buttons-collapse");return Gn&&!Si||!Gn});yn.addElement(Xt);const Ft=(0,p.c)(),It=ut.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");It.length>0&&Ft.addElement(It);const tn=(0,p.c)();tn.addElement(Be(ut).querySelector(".toolbar-background"));const Ut=(0,p.c)(),ti=ut.querySelector("ion-back-button");if(ti&&Ut.addElement(ti),un.addAnimation([Mn,yn,Ft,Ut,tn]),ln.addAnimation(un),Ut.fromTo(et,.99,0),yn.fromTo(et,.99,0),Ft.fromTo(et,.99,0),Ce){if(Si||Mn.fromTo("transform",`translateX(${st})`,bt?"translateX(-100%)":"translateX(100%)").fromTo(et,.99,0),Ft.fromTo("transform",`translateX(${st})`,bt?"translateX(-100%)":"translateX(100%)"),tn.beforeClearStyles([et,"transform"]),(null==ai?void 0:ai.translucent)?tn.fromTo("transform","translateX(0px)",bt?"translateX(-100%)":"translateX(100%)"):tn.fromTo(et,"var(--opacity)",0),ti&&!Oe){const Gn=(0,p.c)();Gn.addElement(Be(ti).querySelector(".button-text")).fromTo("transform",`translateX(${st})`,`translateX(${(bt?-124:124)+"px"})`),un.addAnimation(Gn)}}else Si||Mn.fromTo("transform",`translateX(${st})`,`translateX(${me})`).fromTo(et,.99,0).afterClearStyles([$t,et]),Ft.fromTo("transform",`translateX(${st})`,`translateX(${me})`).afterClearStyles([$t,et]),Ut.afterClearStyles([et]),Mn.afterClearStyles([et]),yn.afterClearStyles([et])})}return ln}catch(Je){throw Je}},tt=10},6615:(Qn,Vt,re)=>{"use strict";re.r(Vt),re.d(Vt,{mdTransitionAnimation:()=>ft});var p=re(4913),se=re(2325);re(1848),re(771);const ft=(Fe,Be)=>{var Dt,Pt,yt;const ct="back"===Be.direction,je=Be.leavingEl,Rt=(0,se.g)(Be.enteringEl),Ze=Rt.querySelector("ion-toolbar"),Je=(0,p.c)();if(Je.addElement(Rt).fill("both").beforeRemoveClass("ion-page-invisible"),ct?Je.duration((null!==(Dt=Be.duration)&&void 0!==Dt?Dt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):Je.duration((null!==(Pt=Be.duration)&&void 0!==Pt?Pt:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Ze){const et=(0,p.c)();et.addElement(Ze),Je.addAnimation(et)}if(je&&ct){Je.duration((null!==(yt=Be.duration)&&void 0!==yt?yt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const et=(0,p.c)();et.addElement((0,se.g)(je)).onFinish($t=>{1===$t&&et.elements.length>0&&et.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),Je.addAnimation(et)}return Je}},9207:(Qn,Vt,re)=>{"use strict";re.d(Vt,{B:()=>Mn,G:()=>yn,O:()=>Ln,a:()=>mt,b:()=>ct,c:()=>Ze,d:()=>ai,e:()=>Si,f:()=>$n,g:()=>Lt,h:()=>Ie,i:()=>wt,j:()=>et,k:()=>$t,m:()=>je,n:()=>yt,o:()=>bt,q:()=>dt,s:()=>un});var p=re(5861),se=re(1848),Ye=re(2905),Pe=re(3254),ft=re(4393),Fe=re(512),Be=re(2400);let Dt=0,Pt=0;const yt=new WeakMap,Le=Xt=>({create:Ft=>st(Xt,Ft),dismiss:(Ft,It,tn)=>Ce(document,Ft,It,Xt,tn),getTop:()=>(0,p.Z)(function*(){return dt(document,Xt)})()}),mt=Le("ion-alert"),ct=Le("ion-action-sheet"),je=Le("ion-modal"),Ze=Le("ion-popover"),et=Xt=>{typeof document<"u"&&Ue(document);const Ft=Dt++;Xt.overlayIndex=Ft},$t=Xt=>(Xt.hasAttribute("id")||(Xt.id="ion-overlay-"+ ++Pt),Xt.id),st=(Xt,Ft)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(Xt).then(()=>{const It=document.createElement(Xt);return It.classList.add("overlay-hidden"),Object.assign(It,Object.assign(Object.assign({},Ft),{hasController:!0})),Oe(document).appendChild(It),new Promise(tn=>(0,Fe.c)(It,tn))}):Promise.resolve(),ot='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',bt=(Xt,Ft)=>{let It=Xt.querySelector(ot);const tn=null==It?void 0:It.shadowRoot;tn&&(It=tn.querySelector(ot)||It),It?(0,Fe.f)(It):Ft.focus()},me=(Xt,Ft)=>{const It=Array.from(Xt.querySelectorAll(ot));let tn=It.length>0?It[It.length-1]:null;const Ut=null==tn?void 0:tn.shadowRoot;Ut&&(tn=Ut.querySelector(ot)||tn),tn?tn.focus():Ft.focus()},Ue=Xt=>{0===Dt&&(Dt=1,Xt.addEventListener("focus",Ft=>{((Xt,Ft)=>{const It=dt(Ft,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),tn=Xt.target;It&&tn&&!It.classList.contains("ion-disable-focus-trap")&&(It.shadowRoot?(()=>{if(It.contains(tn))It.lastFocus=tn;else{const li=It.lastFocus;bt(It,It),li===Ft.activeElement&&me(It,It),It.lastFocus=Ft.activeElement}})():(()=>{if(It===tn)It.lastFocus=void 0;else{const li=(0,Fe.g)(It);if(!li.contains(tn))return;const Gn=li.querySelector(".ion-overlay-wrapper");if(!Gn)return;if(Gn.contains(tn)||tn===li.querySelector("ion-backdrop"))It.lastFocus=tn;else{const ki=It.lastFocus;bt(Gn,It),ki===Ft.activeElement&&me(Gn,It),It.lastFocus=Ft.activeElement}}})())})(Ft,Xt)},!0),Xt.addEventListener("ionBackButton",Ft=>{const It=dt(Xt);null!=It&&It.backdropDismiss&&Ft.detail.register(ft.OVERLAY_BACK_BUTTON_PRIORITY,()=>It.dismiss(void 0,Mn))}),Xt.addEventListener("keydown",Ft=>{if("Escape"===Ft.key){const It=dt(Xt);null!=It&&It.backdropDismiss&&It.dismiss(void 0,Mn)}}))},Ce=(Xt,Ft,It,tn,Ut)=>{const ti=dt(Xt,tn,Ut);return ti?ti.dismiss(Ft,It):Promise.reject("overlay does not exist")},lt=(Xt,Ft)=>((Xt,Ft)=>(void 0===Ft&&(Ft="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(Xt.querySelectorAll(Ft)).filter(It=>It.overlayIndex>0)))(Xt,Ft).filter(It=>!(Xt=>Xt.classList.contains("overlay-hidden"))(It)),dt=(Xt,Ft,It)=>{const tn=lt(Xt,Ft);return void 0===It?tn[tn.length-1]:tn.find(Ut=>Ut.id===It)},ln=(Xt=!1)=>{const It=Oe(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");It&&(Xt?It.setAttribute("aria-hidden","true"):It.removeAttribute("aria-hidden"))},$n=function(){var Xt=(0,p.Z)(function*(Ft,It,tn,Ut,ti){var li,Gn;if(Ft.presented)return;ln(!0),Ft.presented=!0,Ft.willPresent.emit(),null===(li=Ft.willPresentShorthand)||void 0===li||li.emit();const ki=(0,Ye.b)(Ft),Ci=Ft.enterAnimation?Ft.enterAnimation:Ye.c.get(It,"ios"===ki?tn:Ut);(yield ye(Ft,Ci,Ft.el,ti))&&(Ft.didPresent.emit(),null===(Gn=Ft.didPresentShorthand)||void 0===Gn||Gn.emit()),"ION-TOAST"!==Ft.el.tagName&&Mi(Ft.el),Ft.keyboardClose&&(null===document.activeElement||!Ft.el.contains(document.activeElement))&&Ft.el.focus()});return function(It,tn,Ut,ti,li){return Xt.apply(this,arguments)}}(),Mi=function(){var Xt=(0,p.Z)(function*(Ft){let It=document.activeElement;if(!It)return;const tn=null==It?void 0:It.shadowRoot;tn&&(It=tn.querySelector(ot)||It),yield Ft.onDidDismiss(),It.focus()});return function(It){return Xt.apply(this,arguments)}}(),Lt=function(){var Xt=(0,p.Z)(function*(Ft,It,tn,Ut,ti,li,Gn){var ki,Ci;if(!Ft.presented)return!1;void 0!==se.d&&1===lt(se.d).length&&ln(!1),Ft.presented=!1;try{Ft.el.style.setProperty("pointer-events","none"),Ft.willDismiss.emit({data:It,role:tn}),null===(ki=Ft.willDismissShorthand)||void 0===ki||ki.emit({data:It,role:tn});const ar=(0,Ye.b)(Ft),Rn=Ft.leaveAnimation?Ft.leaveAnimation:Ye.c.get(Ut,"ios"===ar?ti:li);tn!==yn&&(yield ye(Ft,Rn,Ft.el,Gn)),Ft.didDismiss.emit({data:It,role:tn}),null===(Ci=Ft.didDismissShorthand)||void 0===Ci||Ci.emit({data:It,role:tn}),yt.delete(Ft),Ft.el.classList.add("overlay-hidden"),Ft.el.style.removeProperty("pointer-events"),void 0!==Ft.el.lastFocus&&(Ft.el.lastFocus=void 0)}catch(ar){console.error(ar)}return Ft.el.remove(),!0});return function(It,tn,Ut,ti,li,Gn,ki){return Xt.apply(this,arguments)}}(),Oe=Xt=>Xt.querySelector("ion-app")||Xt.body,ye=function(){var Xt=(0,p.Z)(function*(Ft,It,tn,Ut){tn.classList.remove("overlay-hidden");const li=It(Ft.el,Ut);(!Ft.animated||!Ye.c.getBoolean("animated",!0))&&li.duration(0),Ft.keyboardClose&&li.beforeAddWrite(()=>{const ki=tn.ownerDocument.activeElement;null!=ki&&ki.matches("input,ion-input, ion-textarea")&&ki.blur()});const Gn=yt.get(Ft)||[];return yt.set(Ft,[...Gn,li]),yield li.play(),!0});return function(It,tn,Ut,ti){return Xt.apply(this,arguments)}}(),Ie=(Xt,Ft)=>{let It;const tn=new Promise(Ut=>It=Ut);return xe(Xt,Ft,Ut=>{It(Ut.detail)}),tn},xe=(Xt,Ft,It)=>{const tn=Ut=>{(0,Fe.b)(Xt,Ft,tn),It(Ut)};(0,Fe.a)(Xt,Ft,tn)},wt=Xt=>"cancel"===Xt||Xt===Mn,ut=Xt=>Xt(),un=(Xt,Ft)=>{if("function"==typeof Xt)return Ye.c.get("_zoneGate",ut)(()=>{try{return Xt(Ft)}catch(tn){throw tn}})},Mn="backdrop",yn="gesture",Ln=39,ai=Xt=>{let It,Ft=!1;const tn=(0,Pe.C)(),Ut=(Gn=!1)=>{if(It&&!Gn)return{delegate:It,inline:Ft};const{el:ki,hasController:Ci,delegate:ar}=Xt;return Ft=null!==ki.parentNode&&!Ci,It=Ft?ar||tn:ar,{inline:Ft,delegate:It}};return{attachViewToDom:function(){var Gn=(0,p.Z)(function*(ki){const{delegate:Ci}=Ut(!0);if(Ci)return yield Ci.attachViewToDom(Xt.el,ki);const{hasController:ar}=Xt;if(ar&&void 0!==ki)throw new Error("framework delegate is missing");return null});return function(Ci){return Gn.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:Gn}=Ut();Gn&&void 0!==Xt.el&&Gn.removeViewFromDom(Xt.el.parentElement,Xt.el)}}},Si=()=>{let Xt;const Ft=()=>{Xt&&(Xt(),Xt=void 0)};return{addClickListener:(tn,Ut)=>{Ft();const ti=void 0!==Ut?document.getElementById(Ut):null;ti?Xt=((Gn,ki)=>{const Ci=()=>{ki.present()};return Gn.addEventListener("click",Ci),()=>{Gn.removeEventListener("click",Ci)}})(ti,tn):(0,Be.p)(`A trigger element with the ID "${Ut}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,tn)},removeClickListener:Ft}}},4926:(Qn,Vt,re)=>{"use strict";var p=re(6593),se=re(9212),Ye=re(899),Pe=re(7346),ft=re(1929),Fe=re(5861);const je=1,Rt=2,Ze=3,Ut=0,ti=1,li=2,Gn=0,ki=1,Ci=2,ar=3,Rn=4,mi=5,Sr=301,Fr=302,fr=306,jr=1e3,Ei=1001,Jn=1003,lr=1006,Br=1008,kr=1009,_t=1014,ke=1015,gt=1016,ni=1020,Ui=1023,qn=1026,Ws=1027,Zt=2300,En=2301,On=2400,$i=2401,Nr=3001,Gi="srgb",Dr="srgb-linear",Li="display-p3",Pu="300 es",ea=2e3;class mr{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const a=s.indexOf(t);-1!==a&&s.splice(a,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const s=i.slice(0);for(let a=0,c=s.length;a<c;a++)s[a].call(this,e);e.target=null}}}const dn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const rr=Math.PI/180,ls=180/Math.PI;function Ir(){const d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(dn[255&d]+dn[d>>8&255]+dn[d>>16&255]+dn[d>>24&255]+"-"+dn[255&e]+dn[e>>8&255]+"-"+dn[e>>16&15|64]+dn[e>>24&255]+"-"+dn[63&t|128]+dn[t>>8&255]+"-"+dn[t>>16&255]+dn[t>>24&255]+dn[255&i]+dn[i>>8&255]+dn[i>>16&255]+dn[i>>24&255]).toLowerCase()}function xr(d,e,t){return Math.max(e,Math.min(t,d))}function Oo(d,e){return(d%e+e)%e}function $(d,e,t){return(1-t)*d+t*e}function _o(d){return 0==(d&d-1)&&0!==d}function Aa(d){return Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function Fo(d){return Math.pow(2,Math.floor(Math.log(d)/Math.LN2))}function oo(d,e){switch(e.constructor){case Float32Array:return d;case Uint32Array:return d/4294967295;case Uint16Array:return d/65535;case Uint8Array:return d/255;case Int32Array:return Math.max(d/2147483647,-1);case Int16Array:return Math.max(d/32767,-1);case Int8Array:return Math.max(d/127,-1);default:throw new Error("Invalid component type.")}}function Ni(d,e){switch(e.constructor){case Float32Array:return d;case Uint32Array:return Math.round(4294967295*d);case Uint16Array:return Math.round(65535*d);case Uint8Array:return Math.round(255*d);case Int32Array:return Math.round(2147483647*d);case Int16Array:return Math.round(32767*d);case Int8Array:return Math.round(127*d);default:throw new Error("Invalid component type.")}}const Bo_DEG2RAD=rr,Bo_radToDeg=function No(d){return d*ls};class Jt{constructor(e=0,t=0){Jt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),a=this.x-e.x,c=this.y-e.y;return this.x=a*i-c*s+e.x,this.y=a*s+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Fi{constructor(e,t,i,s,a,c,u,f,m){Fi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,s,a,c,u,f,m)}set(e,t,i,s,a,c,u,f,m){const v=this.elements;return v[0]=e,v[1]=s,v[2]=u,v[3]=t,v[4]=a,v[5]=f,v[6]=i,v[7]=c,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,a=this.elements,c=i[0],u=i[3],f=i[6],m=i[1],v=i[4],y=i[7],_=i[2],x=i[5],M=i[8],P=s[0],C=s[3],A=s[6],F=s[1],N=s[4],W=s[7],Z=s[2],te=s[5],ee=s[8];return a[0]=c*P+u*F+f*Z,a[3]=c*C+u*N+f*te,a[6]=c*A+u*W+f*ee,a[1]=m*P+v*F+y*Z,a[4]=m*C+v*N+y*te,a[7]=m*A+v*W+y*ee,a[2]=_*P+x*F+M*Z,a[5]=_*C+x*N+M*te,a[8]=_*A+x*W+M*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],c=e[4],u=e[5],f=e[6],m=e[7],v=e[8];return t*c*v-t*u*m-i*a*v+i*u*f+s*a*m-s*c*f}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],c=e[4],u=e[5],f=e[6],m=e[7],v=e[8],y=v*c-u*m,_=u*f-v*a,x=m*a-c*f,M=t*y+i*_+s*x;if(0===M)return this.set(0,0,0,0,0,0,0,0,0);const P=1/M;return e[0]=y*P,e[1]=(s*m-v*i)*P,e[2]=(u*i-s*c)*P,e[3]=_*P,e[4]=(v*t-s*f)*P,e[5]=(s*a-u*t)*P,e[6]=x*P,e[7]=(i*f-m*t)*P,e[8]=(c*t-i*a)*P,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,a,c,u){const f=Math.cos(a),m=Math.sin(a);return this.set(i*f,i*m,-i*(f*c+m*u)+c+e,-s*m,s*f,-s*(-m*c+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(is.makeScale(e,t)),this}rotate(e){return this.premultiply(is.makeRotation(-e)),this}translate(e,t){return this.premultiply(is.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const is=new Fi;function ha(d){for(let e=d.length-1;e>=0;--e)if(d[e]>=65535)return!0;return!1}function wl(d){return document.createElementNS("http://www.w3.org/1999/xhtml",d)}function ll(){const d=wl("canvas");return d.style.display="block",d}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const ql={};function bo(d){d in ql||(ql[d]=!0,console.warn(d))}function fa(d){return d<.04045?.0773993808*d:Math.pow(.9478672986*d+.0521327014,2.4)}function Dc(d){return d<.0031308?12.92*d:1.055*Math.pow(d,.41666)-.055}const Lu=(new Fi).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Ic=(new Fi).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Ou={[Dr]:d=>d,[Gi]:d=>d.convertSRGBToLinear(),[Li]:function Rc(d){return d.convertSRGBToLinear().applyMatrix3(Ic)}},Pm={[Dr]:d=>d,[Gi]:d=>d.convertLinearToSRGB(),[Li]:function If(d){return d.applyMatrix3(Lu).convertLinearToSRGB()}},Vo={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(d){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!d},get workingColorSpace(){return Dr},set workingColorSpace(d){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(d,e,t){if(!1===this.enabled||e===t||!e||!t)return d;const i=Ou[e],s=Pm[t];if(void 0===i||void 0===s)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return s(i(d))},fromWorkingColorSpace:function(d,e){return this.convert(d,this.workingColorSpace,e)},toWorkingColorSpace:function(d,e){return this.convert(d,e,this.workingColorSpace)}};let $a;class Rf{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===$a&&($a=wl("canvas")),$a.width=e.width,$a.height=e.height;const i=$a.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=$a}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=wl("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),a=s.data;for(let c=0;c<a.length;c++)a[c]=255*fa(a[c]/255);return i.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*fa(t[i]/255)):fa(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Lm=0;class Xl{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Lm++}),this.uuid=Ir(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(null!==s){let a;if(Array.isArray(s)){a=[];for(let c=0,u=s.length;c<u;c++)a.push(oh(s[c].isDataTexture?s[c].image:s[c]))}else a=oh(s);i.url=a}return t||(e.images[this.uuid]=i),i}}function oh(d){return typeof HTMLImageElement<"u"&&d instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&d instanceof ImageBitmap?Rf.getDataURL(d):d.data?{data:Array.from(d.data),width:d.width,height:d.height,type:d.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Om=0,To=(()=>{class d extends mr{constructor(t=d.DEFAULT_IMAGE,i=d.DEFAULT_MAPPING,s=Ei,a=Ei,c=lr,u=Br,f=Ui,m=kr,v=d.DEFAULT_ANISOTROPY,y=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Om++}),this.uuid=Ir(),this.name="",this.source=new Xl(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=a,this.magFilter=c,this.minFilter=u,this.anisotropy=v,this.format=f,this.internalFormat=null,this.type=m,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Fi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof y?this.colorSpace=y:(bo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=y===Nr?Gi:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case jr:t.x=t.x-Math.floor(t.x);break;case Ei:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case jr:t.y=t.y-Math.floor(t.y);break;case Ei:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return bo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Gi?Nr:3e3}set encoding(t){bo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Nr?Gi:""}}return d.DEFAULT_IMAGE=null,d.DEFAULT_MAPPING=300,d.DEFAULT_ANISOTROPY=1,d})();class zr{constructor(e=0,t=0,i=0,s=1){zr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,a=this.w,c=e.elements;return this.x=c[0]*t+c[4]*i+c[8]*s+c[12]*a,this.y=c[1]*t+c[5]*i+c[9]*s+c[13]*a,this.z=c[2]*t+c[6]*i+c[10]*s+c[14]*a,this.w=c[3]*t+c[7]*i+c[11]*s+c[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,a;const f=e.elements,m=f[0],v=f[4],y=f[8],_=f[1],x=f[5],M=f[9],P=f[2],C=f[6],A=f[10];if(Math.abs(v-_)<.01&&Math.abs(y-P)<.01&&Math.abs(M-C)<.01){if(Math.abs(v+_)<.1&&Math.abs(y+P)<.1&&Math.abs(M+C)<.1&&Math.abs(m+x+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(m+1)/2,W=(x+1)/2,Z=(A+1)/2,te=(v+_)/4,ee=(y+P)/4,le=(M+C)/4;return N>W&&N>Z?N<.01?(i=0,s=.707106781,a=.707106781):(i=Math.sqrt(N),s=te/i,a=ee/i):W>Z?W<.01?(i=.707106781,s=0,a=.707106781):(s=Math.sqrt(W),i=te/s,a=le/s):Z<.01?(i=.707106781,s=.707106781,a=0):(a=Math.sqrt(Z),i=ee/a,s=le/a),this.set(i,s,a,t),this}let F=Math.sqrt((C-M)*(C-M)+(y-P)*(y-P)+(_-v)*(_-v));return Math.abs(F)<.001&&(F=1),this.x=(C-M)/F,this.y=(y-P)/F,this.z=(_-v)/F,this.w=Math.acos((m+x+A-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class R extends mr{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new zr(0,0,e,t),this.scissorTest=!1,this.viewport=new zr(0,0,e,t);const s={width:e,height:t,depth:1};void 0!==i.encoding&&(bo("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Nr?Gi:""),this.texture=new To(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:lr,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Xl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class H extends R{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Ee extends To{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ue extends To{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class on{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,a,c,u){let f=i[s+0],m=i[s+1],v=i[s+2],y=i[s+3];const _=a[c+0],x=a[c+1],M=a[c+2],P=a[c+3];if(0===u)return e[t+0]=f,e[t+1]=m,e[t+2]=v,void(e[t+3]=y);if(1===u)return e[t+0]=_,e[t+1]=x,e[t+2]=M,void(e[t+3]=P);if(y!==P||f!==_||m!==x||v!==M){let C=1-u;const A=f*_+m*x+v*M+y*P,F=A>=0?1:-1,N=1-A*A;if(N>Number.EPSILON){const Z=Math.sqrt(N),te=Math.atan2(Z,A*F);C=Math.sin(C*te)/Z,u=Math.sin(u*te)/Z}const W=u*F;if(f=f*C+_*W,m=m*C+x*W,v=v*C+M*W,y=y*C+P*W,C===1-u){const Z=1/Math.sqrt(f*f+m*m+v*v+y*y);f*=Z,m*=Z,v*=Z,y*=Z}}e[t]=f,e[t+1]=m,e[t+2]=v,e[t+3]=y}static multiplyQuaternionsFlat(e,t,i,s,a,c){const u=i[s],f=i[s+1],m=i[s+2],v=i[s+3],y=a[c],_=a[c+1],x=a[c+2],M=a[c+3];return e[t]=u*M+v*y+f*x-m*_,e[t+1]=f*M+v*_+m*y-u*x,e[t+2]=m*M+v*x+u*_-f*y,e[t+3]=v*M-u*y-f*_-m*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,s=e._y,a=e._z,c=e._order,u=Math.cos,f=Math.sin,m=u(i/2),v=u(s/2),y=u(a/2),_=f(i/2),x=f(s/2),M=f(a/2);switch(c){case"XYZ":this._x=_*v*y+m*x*M,this._y=m*x*y-_*v*M,this._z=m*v*M+_*x*y,this._w=m*v*y-_*x*M;break;case"YXZ":this._x=_*v*y+m*x*M,this._y=m*x*y-_*v*M,this._z=m*v*M-_*x*y,this._w=m*v*y+_*x*M;break;case"ZXY":this._x=_*v*y-m*x*M,this._y=m*x*y+_*v*M,this._z=m*v*M+_*x*y,this._w=m*v*y-_*x*M;break;case"ZYX":this._x=_*v*y-m*x*M,this._y=m*x*y+_*v*M,this._z=m*v*M-_*x*y,this._w=m*v*y+_*x*M;break;case"YZX":this._x=_*v*y+m*x*M,this._y=m*x*y+_*v*M,this._z=m*v*M-_*x*y,this._w=m*v*y-_*x*M;break;case"XZY":this._x=_*v*y-m*x*M,this._y=m*x*y-_*v*M,this._z=m*v*M+_*x*y,this._w=m*v*y+_*x*M;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],a=t[8],c=t[1],u=t[5],f=t[9],m=t[2],v=t[6],y=t[10],_=i+u+y;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(v-f)*x,this._y=(a-m)*x,this._z=(c-s)*x}else if(i>u&&i>y){const x=2*Math.sqrt(1+i-u-y);this._w=(v-f)/x,this._x=.25*x,this._y=(s+c)/x,this._z=(a+m)/x}else if(u>y){const x=2*Math.sqrt(1+u-i-y);this._w=(a-m)/x,this._x=(s+c)/x,this._y=.25*x,this._z=(f+v)/x}else{const x=2*Math.sqrt(1+y-i-u);this._w=(c-s)/x,this._x=(a+m)/x,this._y=(f+v)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,a=e._z,c=e._w,u=t._x,f=t._y,m=t._z,v=t._w;return this._x=i*v+c*u+s*m-a*f,this._y=s*v+c*f+a*u-i*m,this._z=a*v+c*m+i*f-s*u,this._w=c*v-i*u-s*f-a*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,s=this._y,a=this._z,c=this._w;let u=c*e._w+i*e._x+s*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=c,this._x=i,this._y=s,this._z=a,this;const f=1-u*u;if(f<=Number.EPSILON){const x=1-t;return this._w=x*c+t*this._w,this._x=x*i+t*this._x,this._y=x*s+t*this._y,this._z=x*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(f),v=Math.atan2(m,u),y=Math.sin((1-t)*v)/m,_=Math.sin(t*v)/m;return this._w=c*y+this._w*_,this._x=i*y+this._x*_,this._y=s*y+this._y*_,this._z=a*y+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),s=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(s),i*Math.sin(a),i*Math.cos(a),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class he{constructor(e=0,t=0,i=0){he.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ur.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ur.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[3]*i+a[6]*s,this.y=a[1]*t+a[4]*i+a[7]*s,this.z=a[2]*t+a[5]*i+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,a=e.elements,c=1/(a[3]*t+a[7]*i+a[11]*s+a[15]);return this.x=(a[0]*t+a[4]*i+a[8]*s+a[12])*c,this.y=(a[1]*t+a[5]*i+a[9]*s+a[13])*c,this.z=(a[2]*t+a[6]*i+a[10]*s+a[14])*c,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,a=e.x,c=e.y,u=e.z,f=e.w,m=f*t+c*s-u*i,v=f*i+u*t-a*s,y=f*s+a*i-c*t,_=-a*t-c*i-u*s;return this.x=m*f+_*-a+v*-u-y*-c,this.y=v*f+_*-c+y*-a-m*-u,this.z=y*f+_*-u+m*-c-v*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*s,this.y=a[1]*t+a[5]*i+a[9]*s,this.z=a[2]*t+a[6]*i+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,a=e.z,c=t.x,u=t.y,f=t.z;return this.x=s*f-a*u,this.y=a*c-i*f,this.z=i*u-s*c,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return er.copy(this).projectOnVector(e),this.sub(er)}reflect(e){return this.sub(er.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const er=new he,ur=new on;class bi{constructor(e=new he(1/0,1/0,1/0),t=new he(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(tr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(tr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=tr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Pr.copy(e.boundingBox),Pr.applyMatrix4(e.matrixWorld),this.union(Pr);else{const s=e.geometry;if(void 0!==s)if(t&&void 0!==s.attributes&&void 0!==s.attributes.position){const a=s.attributes.position;for(let c=0,u=a.count;c<u;c++)tr.fromBufferAttribute(a,c).applyMatrix4(e.matrixWorld),this.expandByPoint(tr)}else null===s.boundingBox&&s.computeBoundingBox(),Pr.copy(s.boundingBox),Pr.applyMatrix4(e.matrixWorld),this.union(Pr)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,tr),tr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(zo),Ta.subVectors(this.max,zo),Ms.subVectors(e.a,zo),ks.subVectors(e.b,zo),Do.subVectors(e.c,zo),ao.subVectors(ks,Ms),qr.subVectors(Do,ks),Us.subVectors(Ms,Do);let t=[0,-ao.z,ao.y,0,-qr.z,qr.y,0,-Us.z,Us.y,ao.z,0,-ao.x,qr.z,0,-qr.x,Us.z,0,-Us.x,-ao.y,ao.x,0,-qr.y,qr.x,0,-Us.y,Us.x,0];return!(!Hr(t,Ms,ks,Do,Ta)||(t=[1,0,0,0,1,0,0,0,1],!Hr(t,Ms,ks,Do,Ta)))&&(Pc.crossVectors(ao,qr),t=[Pc.x,Pc.y,Pc.z],Hr(t,Ms,ks,Do,Ta))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,tr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(tr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(dr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),dr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),dr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),dr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),dr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),dr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),dr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),dr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(dr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dr=[new he,new he,new he,new he,new he,new he,new he,new he],tr=new he,Pr=new bi,Ms=new he,ks=new he,Do=new he,ao=new he,qr=new he,Us=new he,zo=new he,Ta=new he,Pc=new he,Kl=new he;function Hr(d,e,t,i,s){for(let a=0,c=d.length-3;a<=c;a+=3){Kl.fromArray(d,a);const u=s.x*Math.abs(Kl.x)+s.y*Math.abs(Kl.y)+s.z*Math.abs(Kl.z),f=e.dot(Kl),m=t.dot(Kl),v=i.dot(Kl);if(Math.max(-Math.max(f,m,v),Math.min(f,m,v))>u)return!1}return!0}const Zl=new bi,Ga=new he,qs=new he;class pa{constructor(e=new he,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Zl.setFromPoints(e).getCenter(i);let s=0;for(let a=0,c=e.length;a<c;a++)s=Math.max(s,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ga.subVectors(e,this.center);const t=Ga.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=.5*(i-this.radius);this.center.addScaledVector(Ga,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(qs.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ga.copy(e.center).add(qs)),this.expandByPoint(Ga.copy(e.center).sub(qs))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ho=new he,Wa=new he,xo=new he,ta=new he,Jl=new he,Nu=new he,na=new he;class Ml{constructor(e=new he,t=new he(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ho)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ho.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ho.copy(this.origin).addScaledVector(this.direction,t),Ho.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Wa.copy(e).add(t).multiplyScalar(.5),xo.copy(t).sub(e).normalize(),ta.copy(this.origin).sub(Wa);const a=.5*e.distanceTo(t),c=-this.direction.dot(xo),u=ta.dot(this.direction),f=-ta.dot(xo),m=ta.lengthSq(),v=Math.abs(1-c*c);let y,_,x,M;if(v>0)if(y=c*f-u,_=c*u-f,M=a*v,y>=0)if(_>=-M)if(_<=M){const P=1/v;y*=P,_*=P,x=y*(y+c*_+2*u)+_*(c*y+_+2*f)+m}else _=a,y=Math.max(0,-(c*_+u)),x=-y*y+_*(_+2*f)+m;else _=-a,y=Math.max(0,-(c*_+u)),x=-y*y+_*(_+2*f)+m;else _<=-M?(y=Math.max(0,-(-c*a+u)),_=y>0?-a:Math.min(Math.max(-a,-f),a),x=-y*y+_*(_+2*f)+m):_<=M?(y=0,_=Math.min(Math.max(-a,-f),a),x=_*(_+2*f)+m):(y=Math.max(0,-(c*a+u)),_=y>0?a:Math.min(Math.max(-a,-f),a),x=-y*y+_*(_+2*f)+m);else _=c>0?-a:a,y=Math.max(0,-(c*_+u)),x=-y*y+_*(_+2*f)+m;return i&&i.copy(this.origin).addScaledVector(this.direction,y),s&&s.copy(Wa).addScaledVector(xo,_),x}intersectSphere(e,t){Ho.subVectors(e.center,this.origin);const i=Ho.dot(this.direction),s=Ho.dot(Ho)-i*i,a=e.radius*e.radius;if(s>a)return null;const c=Math.sqrt(a-s),u=i-c,f=i+c;return f<0?null:this.at(u<0?f:u,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,a,c,u,f;const m=1/this.direction.x,v=1/this.direction.y,y=1/this.direction.z,_=this.origin;return m>=0?(i=(e.min.x-_.x)*m,s=(e.max.x-_.x)*m):(i=(e.max.x-_.x)*m,s=(e.min.x-_.x)*m),v>=0?(a=(e.min.y-_.y)*v,c=(e.max.y-_.y)*v):(a=(e.max.y-_.y)*v,c=(e.min.y-_.y)*v),i>c||a>s||((a>i||isNaN(i))&&(i=a),(c<s||isNaN(s))&&(s=c),y>=0?(u=(e.min.z-_.z)*y,f=(e.max.z-_.z)*y):(u=(e.max.z-_.z)*y,f=(e.min.z-_.z)*y),i>f||u>s)||((u>i||i!=i)&&(i=u),(f<s||s!=s)&&(s=f),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Ho)}intersectTriangle(e,t,i,s,a){Jl.subVectors(t,e),Nu.subVectors(i,e),na.crossVectors(Jl,Nu);let u,c=this.direction.dot(na);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}ta.subVectors(this.origin,e);const f=u*this.direction.dot(Nu.crossVectors(ta,Nu));if(f<0)return null;const m=u*this.direction.dot(Jl.cross(ta));if(m<0||f+m>c)return null;const v=-u*ta.dot(na);return v<0?null:this.at(v/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class _i{constructor(e,t,i,s,a,c,u,f,m,v,y,_,x,M,P,C){_i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,s,a,c,u,f,m,v,y,_,x,M,P,C)}set(e,t,i,s,a,c,u,f,m,v,y,_,x,M,P,C){const A=this.elements;return A[0]=e,A[4]=t,A[8]=i,A[12]=s,A[1]=a,A[5]=c,A[9]=u,A[13]=f,A[2]=m,A[6]=v,A[10]=y,A[14]=_,A[3]=x,A[7]=M,A[11]=P,A[15]=C,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new _i).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,s=1/Sl.setFromMatrixColumn(e,0).length(),a=1/Sl.setFromMatrixColumn(e,1).length(),c=1/Sl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*a,t[5]=i[5]*a,t[6]=i[6]*a,t[7]=0,t[8]=i[8]*c,t[9]=i[9]*c,t[10]=i[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,a=e.z,c=Math.cos(i),u=Math.sin(i),f=Math.cos(s),m=Math.sin(s),v=Math.cos(a),y=Math.sin(a);if("XYZ"===e.order){const _=c*v,x=c*y,M=u*v,P=u*y;t[0]=f*v,t[4]=-f*y,t[8]=m,t[1]=x+M*m,t[5]=_-P*m,t[9]=-u*f,t[2]=P-_*m,t[6]=M+x*m,t[10]=c*f}else if("YXZ"===e.order){const _=f*v,x=f*y,M=m*v,P=m*y;t[0]=_+P*u,t[4]=M*u-x,t[8]=c*m,t[1]=c*y,t[5]=c*v,t[9]=-u,t[2]=x*u-M,t[6]=P+_*u,t[10]=c*f}else if("ZXY"===e.order){const _=f*v,x=f*y,M=m*v,P=m*y;t[0]=_-P*u,t[4]=-c*y,t[8]=M+x*u,t[1]=x+M*u,t[5]=c*v,t[9]=P-_*u,t[2]=-c*m,t[6]=u,t[10]=c*f}else if("ZYX"===e.order){const _=c*v,x=c*y,M=u*v,P=u*y;t[0]=f*v,t[4]=M*m-x,t[8]=_*m+P,t[1]=f*y,t[5]=P*m+_,t[9]=x*m-M,t[2]=-m,t[6]=u*f,t[10]=c*f}else if("YZX"===e.order){const _=c*f,x=c*m,M=u*f,P=u*m;t[0]=f*v,t[4]=P-_*y,t[8]=M*y+x,t[1]=y,t[5]=c*v,t[9]=-u*v,t[2]=-m*v,t[6]=x*y+M,t[10]=_-P*y}else if("XZY"===e.order){const _=c*f,x=c*m,M=u*f,P=u*m;t[0]=f*v,t[4]=-y,t[8]=m*v,t[1]=_*y+P,t[5]=c*v,t[9]=x*y-M,t[2]=M*y-x,t[6]=u*v,t[10]=P*y+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ql,e,Lc)}lookAt(e,t,i){const s=this.elements;return fi.subVectors(e,t),0===fi.lengthSq()&&(fi.z=1),fi.normalize(),ma.crossVectors(i,fi),0===ma.lengthSq()&&(1===Math.abs(i.z)?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),ma.crossVectors(i,fi)),ma.normalize(),Cl.crossVectors(fi,ma),s[0]=ma.x,s[4]=Cl.x,s[8]=fi.x,s[1]=ma.y,s[5]=Cl.y,s[9]=fi.y,s[2]=ma.z,s[6]=Cl.z,s[10]=fi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,a=this.elements,c=i[0],u=i[4],f=i[8],m=i[12],v=i[1],y=i[5],_=i[9],x=i[13],M=i[2],P=i[6],C=i[10],A=i[14],F=i[3],N=i[7],W=i[11],Z=i[15],te=s[0],ee=s[4],le=s[8],j=s[12],ne=s[1],Ge=s[5],rt=s[9],Me=s[13],Ae=s[2],Re=s[6],He=s[10],xt=s[14],St=s[3],Mt=s[7],Bt=s[11],pt=s[15];return a[0]=c*te+u*ne+f*Ae+m*St,a[4]=c*ee+u*Ge+f*Re+m*Mt,a[8]=c*le+u*rt+f*He+m*Bt,a[12]=c*j+u*Me+f*xt+m*pt,a[1]=v*te+y*ne+_*Ae+x*St,a[5]=v*ee+y*Ge+_*Re+x*Mt,a[9]=v*le+y*rt+_*He+x*Bt,a[13]=v*j+y*Me+_*xt+x*pt,a[2]=M*te+P*ne+C*Ae+A*St,a[6]=M*ee+P*Ge+C*Re+A*Mt,a[10]=M*le+P*rt+C*He+A*Bt,a[14]=M*j+P*Me+C*xt+A*pt,a[3]=F*te+N*ne+W*Ae+Z*St,a[7]=F*ee+N*Ge+W*Re+Z*Mt,a[11]=F*le+N*rt+W*He+Z*Bt,a[15]=F*j+N*Me+W*xt+Z*pt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],a=e[12],c=e[1],u=e[5],f=e[9],m=e[13],v=e[2],y=e[6],_=e[10],x=e[14];return e[3]*(+a*f*y-s*m*y-a*u*_+i*m*_+s*u*x-i*f*x)+e[7]*(+t*f*x-t*m*_+a*c*_-s*c*x+s*m*v-a*f*v)+e[11]*(+t*m*y-t*u*x-a*c*y+i*c*x+a*u*v-i*m*v)+e[15]*(-s*u*v-t*f*y+t*u*_+s*c*y-i*c*_+i*f*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],c=e[4],u=e[5],f=e[6],m=e[7],v=e[8],y=e[9],_=e[10],x=e[11],M=e[12],P=e[13],C=e[14],A=e[15],F=y*C*m-P*_*m+P*f*x-u*C*x-y*f*A+u*_*A,N=M*_*m-v*C*m-M*f*x+c*C*x+v*f*A-c*_*A,W=v*P*m-M*y*m+M*u*x-c*P*x-v*u*A+c*y*A,Z=M*y*f-v*P*f-M*u*_+c*P*_+v*u*C-c*y*C,te=t*F+i*N+s*W+a*Z;if(0===te)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ee=1/te;return e[0]=F*ee,e[1]=(P*_*a-y*C*a-P*s*x+i*C*x+y*s*A-i*_*A)*ee,e[2]=(u*C*a-P*f*a+P*s*m-i*C*m-u*s*A+i*f*A)*ee,e[3]=(y*f*a-u*_*a-y*s*m+i*_*m+u*s*x-i*f*x)*ee,e[4]=N*ee,e[5]=(v*C*a-M*_*a+M*s*x-t*C*x-v*s*A+t*_*A)*ee,e[6]=(M*f*a-c*C*a-M*s*m+t*C*m+c*s*A-t*f*A)*ee,e[7]=(c*_*a-v*f*a+v*s*m-t*_*m-c*s*x+t*f*x)*ee,e[8]=W*ee,e[9]=(M*y*a-v*P*a-M*i*x+t*P*x+v*i*A-t*y*A)*ee,e[10]=(c*P*a-M*u*a+M*i*m-t*P*m-c*i*A+t*u*A)*ee,e[11]=(v*u*a-c*y*a-v*i*m+t*y*m+c*i*x-t*u*x)*ee,e[12]=Z*ee,e[13]=(v*P*s-M*y*s+M*i*_-t*P*_-v*i*C+t*y*C)*ee,e[14]=(M*u*s-c*P*s-M*i*f+t*P*f+c*i*C-t*u*C)*ee,e[15]=(c*y*s-v*u*s+v*i*f-t*y*f-c*i*_+t*u*_)*ee,this}scale(e){const t=this.elements,i=e.x,s=e.y,a=e.z;return t[0]*=i,t[4]*=s,t[8]*=a,t[1]*=i,t[5]*=s,t[9]*=a,t[2]*=i,t[6]*=s,t[10]*=a,t[3]*=i,t[7]*=s,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),a=1-i,c=e.x,u=e.y,f=e.z,m=a*c,v=a*u;return this.set(m*c+i,m*u-s*f,m*f+s*u,0,m*u+s*f,v*u+i,v*f-s*c,0,m*f-s*u,v*f+s*c,a*f*f+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,a,c){return this.set(1,i,a,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,a=t._x,c=t._y,u=t._z,f=t._w,m=a+a,v=c+c,y=u+u,_=a*m,x=a*v,M=a*y,P=c*v,C=c*y,A=u*y,F=f*m,N=f*v,W=f*y,Z=i.x,te=i.y,ee=i.z;return s[0]=(1-(P+A))*Z,s[1]=(x+W)*Z,s[2]=(M-N)*Z,s[3]=0,s[4]=(x-W)*te,s[5]=(1-(_+A))*te,s[6]=(C+F)*te,s[7]=0,s[8]=(M+N)*ee,s[9]=(C-F)*ee,s[10]=(1-(_+P))*ee,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;let a=Sl.set(s[0],s[1],s[2]).length();const c=Sl.set(s[4],s[5],s[6]).length(),u=Sl.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],ia.copy(this);const m=1/a,v=1/c,y=1/u;return ia.elements[0]*=m,ia.elements[1]*=m,ia.elements[2]*=m,ia.elements[4]*=v,ia.elements[5]*=v,ia.elements[6]*=v,ia.elements[8]*=y,ia.elements[9]*=y,ia.elements[10]*=y,t.setFromRotationMatrix(ia),i.x=a,i.y=c,i.z=u,this}makePerspective(e,t,i,s,a,c,u=ea){const f=this.elements,m=2*a/(t-e),v=2*a/(i-s),y=(t+e)/(t-e),_=(i+s)/(i-s);let x,M;if(u===ea)x=-(c+a)/(c-a),M=-2*c*a/(c-a);else{if(2001!==u)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);x=-c/(c-a),M=-c*a/(c-a)}return f[0]=m,f[4]=0,f[8]=y,f[12]=0,f[1]=0,f[5]=v,f[9]=_,f[13]=0,f[2]=0,f[6]=0,f[10]=x,f[14]=M,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,t,i,s,a,c,u=ea){const f=this.elements,m=1/(t-e),v=1/(i-s),y=1/(c-a),_=(t+e)*m,x=(i+s)*v;let M,P;if(u===ea)M=(c+a)*y,P=-2*y;else{if(2001!==u)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);M=a*y,P=-1*y}return f[0]=2*m,f[4]=0,f[8]=0,f[12]=-_,f[1]=0,f[5]=2*v,f[9]=0,f[13]=-x,f[2]=0,f[6]=0,f[10]=P,f[14]=-M,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Sl=new he,ia=new _i,Ql=new he(0,0,0),Lc=new he(1,1,1),ma=new he,Cl=new he,fi=new he,Pf=new _i,Nm=new on;let ah=(()=>{class d{constructor(t=0,i=0,s=0,a=d.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,a=this._order){return this._x=t,this._y=i,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){const a=t.elements,c=a[0],u=a[4],f=a[8],m=a[1],v=a[5],y=a[9],_=a[2],x=a[6],M=a[10];switch(i){case"XYZ":this._y=Math.asin(xr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-y,M),this._z=Math.atan2(-u,c)):(this._x=Math.atan2(x,v),this._z=0);break;case"YXZ":this._x=Math.asin(-xr(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(f,M),this._z=Math.atan2(m,v)):(this._y=Math.atan2(-_,c),this._z=0);break;case"ZXY":this._x=Math.asin(xr(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-_,M),this._z=Math.atan2(-u,v)):(this._y=0,this._z=Math.atan2(m,c));break;case"ZYX":this._y=Math.asin(-xr(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(x,M),this._z=Math.atan2(m,c)):(this._x=0,this._z=Math.atan2(-u,v));break;case"YZX":this._z=Math.asin(xr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-y,v),this._y=Math.atan2(-_,c)):(this._x=0,this._y=Math.atan2(f,M));break;case"XZY":this._z=Math.asin(-xr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(x,v),this._y=Math.atan2(f,c)):(this._x=Math.atan2(-y,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return Pf.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Pf,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Nm.setFromEuler(this),this.setFromQuaternion(Nm,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return d.DEFAULT_ORDER="XYZ",d})();class Fu{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let xy=0;const Bu=new he,Ps=new on,ja=new _i,lh=new he,ku=new he,Ey=new he,Lf=new on,qt=new he(1,0,0),sr=new he(0,1,0),Of=new he(0,0,1),Fm={type:"added"},Gr={type:"removed"};let Ls=(()=>{class d extends mr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xy++}),this.uuid=Ir(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=d.DEFAULT_UP.clone();const t=new he,i=new ah,s=new on,a=new he(1,1,1);i._onChange(function c(){s.setFromEuler(i,!1)}),s._onChange(function u(){i.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new _i},normalMatrix:{value:new Fi}}),this.matrix=new _i,this.matrixWorld=new _i,this.matrixAutoUpdate=d.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=d.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Fu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Ps.setFromAxisAngle(t,i),this.quaternion.multiply(Ps),this}rotateOnWorldAxis(t,i){return Ps.setFromAxisAngle(t,i),this.quaternion.premultiply(Ps),this}rotateX(t){return this.rotateOnAxis(qt,t)}rotateY(t){return this.rotateOnAxis(sr,t)}rotateZ(t){return this.rotateOnAxis(Of,t)}translateOnAxis(t,i){return Bu.copy(t).applyQuaternion(this.quaternion),this.position.add(Bu.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(qt,t)}translateY(t){return this.translateOnAxis(sr,t)}translateZ(t){return this.translateOnAxis(Of,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(ja.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?lh.copy(t):lh.set(t,i,s);const a=this.parent;this.updateWorldMatrix(!0,!1),ku.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ja.lookAt(ku,lh,this.up):ja.lookAt(lh,ku,this.up),this.quaternion.setFromRotationMatrix(ja),a&&(ja.extractRotation(a.matrixWorld),Ps.setFromRotationMatrix(ja),this.quaternion.premultiply(Ps.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Fm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Gr)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),ja.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ja.multiply(t.parent.matrixWorld)),t.applyMatrix4(ja),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,a=this.children.length;s<a;s++){const u=this.children[s].getObjectByProperty(t,i);if(void 0!==u)return u}}getObjectsByProperty(t,i){let s=[];this[t]===i&&s.push(this);for(let a=0,c=this.children.length;a<c;a++){const u=this.children[a].getObjectsByProperty(t,i);u.length>0&&(s=s.concat(u))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ku,t,Ey),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ku,Lf,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let s=0,a=i.length;s<a;s++){const c=i[s];(!0===c.matrixWorldAutoUpdate||!0===t)&&c.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const s=this.parent;if(!0===t&&null!==s&&!0===s.matrixWorldAutoUpdate&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const a=this.children;for(let c=0,u=a.length;c<u;c++){const f=a[c];!0===f.matrixWorldAutoUpdate&&f.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};function c(f,m){return void 0===f[m.uuid]&&(f[m.uuid]=m.toJSON(t)),m.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(t.geometries,this.geometry);const f=this.geometry.parameters;if(void 0!==f&&void 0!==f.shapes){const m=f.shapes;if(Array.isArray(m))for(let v=0,y=m.length;v<y;v++)c(t.shapes,m[v]);else c(t.shapes,m)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(c(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const f=[];for(let m=0,v=this.material.length;m<v;m++)f.push(c(t.materials,this.material[m]));a.material=f}else a.material=c(t.materials,this.material);if(this.children.length>0){a.children=[];for(let f=0;f<this.children.length;f++)a.children.push(this.children[f].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let f=0;f<this.animations.length;f++)a.animations.push(c(t.animations,this.animations[f]))}if(i){const f=u(t.geometries),m=u(t.materials),v=u(t.textures),y=u(t.images),_=u(t.shapes),x=u(t.skeletons),M=u(t.animations),P=u(t.nodes);f.length>0&&(s.geometries=f),m.length>0&&(s.materials=m),v.length>0&&(s.textures=v),y.length>0&&(s.images=y),_.length>0&&(s.shapes=_),x.length>0&&(s.skeletons=x),M.length>0&&(s.animations=M),P.length>0&&(s.nodes=P)}return s.object=a,s;function u(f){const m=[];for(const v in f){const y=f[v];delete y.metadata,m.push(y)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return d.DEFAULT_UP=new he(0,1,0),d.DEFAULT_MATRIX_AUTO_UPDATE=!0,d.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,d})();const Io=new he,lo=new he,Uu=new he,Da=new he,ec=new he,Oc=new he,Nf=new he,Xs=new he,ga=new he,Vu=new he;let $o=!1;class Ss{constructor(e=new he,t=new he,i=new he){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),Io.subVectors(e,t),s.cross(Io);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,t,i,s,a){Io.subVectors(s,t),lo.subVectors(i,t),Uu.subVectors(e,t);const c=Io.dot(Io),u=Io.dot(lo),f=Io.dot(Uu),m=lo.dot(lo),v=lo.dot(Uu),y=c*m-u*u;if(0===y)return a.set(-2,-1,-1);const _=1/y,x=(m*f-u*v)*_,M=(c*v-u*f)*_;return a.set(1-x-M,M,x)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,Da),Da.x>=0&&Da.y>=0&&Da.x+Da.y<=1}static getUV(e,t,i,s,a,c,u,f){return!1===$o&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$o=!0),this.getInterpolation(e,t,i,s,a,c,u,f)}static getInterpolation(e,t,i,s,a,c,u,f){return this.getBarycoord(e,t,i,s,Da),f.setScalar(0),f.addScaledVector(a,Da.x),f.addScaledVector(c,Da.y),f.addScaledVector(u,Da.z),f}static isFrontFacing(e,t,i,s){return Io.subVectors(i,t),lo.subVectors(e,t),Io.cross(lo).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Io.subVectors(this.c,this.b),lo.subVectors(this.a,this.b),.5*Io.cross(lo).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ss.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ss.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,s,a){return!1===$o&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$o=!0),Ss.getInterpolation(e,this.a,this.b,this.c,t,i,s,a)}getInterpolation(e,t,i,s,a){return Ss.getInterpolation(e,this.a,this.b,this.c,t,i,s,a)}containsPoint(e){return Ss.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ss.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,a=this.c;let c,u;ec.subVectors(s,i),Oc.subVectors(a,i),Xs.subVectors(e,i);const f=ec.dot(Xs),m=Oc.dot(Xs);if(f<=0&&m<=0)return t.copy(i);ga.subVectors(e,s);const v=ec.dot(ga),y=Oc.dot(ga);if(v>=0&&y<=v)return t.copy(s);const _=f*y-v*m;if(_<=0&&f>=0&&v<=0)return c=f/(f-v),t.copy(i).addScaledVector(ec,c);Vu.subVectors(e,a);const x=ec.dot(Vu),M=Oc.dot(Vu);if(M>=0&&x<=M)return t.copy(a);const P=x*m-f*M;if(P<=0&&m>=0&&M<=0)return u=m/(m-M),t.copy(i).addScaledVector(Oc,u);const C=v*M-x*y;if(C<=0&&y-v>=0&&x-M>=0)return Nf.subVectors(a,s),u=(y-v)/(y-v+(x-M)),t.copy(s).addScaledVector(Nf,u);const A=1/(C+P+_);return c=P*A,u=_*A,t.copy(i).addScaledVector(ec,c).addScaledVector(Oc,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Bm=0;class Go extends mr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Bm++}),this.uuid=Ir(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function s(a){const c=[];for(const u in a){const f=a[u];delete f.metadata,c.push(f)}return c}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const a=s(e.textures),c=s(e.images);a.length>0&&(i.textures=a),c.length>0&&(i.images=c)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const s=t.length;i=new Array(s);for(let a=0;a!==s;++a)i[a]=t[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Ff={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ra={h:0,s:0,l:0},tc={h:0,s:0,l:0};function zu(d,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?d+6*(e-d)*t:t<.5?e:t<2/3?d+6*(e-d)*(2/3-t):d}class Yn{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Gi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Vo.toWorkingColorSpace(this,t),this}setRGB(e,t,i,s=Vo.workingColorSpace){return this.r=e,this.g=t,this.b=i,Vo.toWorkingColorSpace(this,s),this}setHSL(e,t,i,s=Vo.workingColorSpace){if(e=Oo(e,1),t=xr(t,0,1),i=xr(i,0,1),0===t)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+t):i+t-i*t,c=2*i-a;this.r=zu(c,a,e+1/3),this.g=zu(c,a,e),this.b=zu(c,a,e-1/3)}return Vo.toWorkingColorSpace(this,s),this}setStyle(e,t=Gi){function i(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=s[2];switch(s[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],c=a.length;if(3===c)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===c)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Gi){const i=Ff[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=fa(e.r),this.g=fa(e.g),this.b=fa(e.b),this}copyLinearToSRGB(e){return this.r=Dc(e.r),this.g=Dc(e.g),this.b=Dc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Gi){return Vo.fromWorkingColorSpace(co.copy(this),e),65536*Math.round(xr(255*co.r,0,255))+256*Math.round(xr(255*co.g,0,255))+Math.round(xr(255*co.b,0,255))}getHexString(e=Gi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Vo.workingColorSpace){Vo.fromWorkingColorSpace(co.copy(this),t);const i=co.r,s=co.g,a=co.b,c=Math.max(i,s,a),u=Math.min(i,s,a);let f,m;const v=(u+c)/2;if(u===c)f=0,m=0;else{const y=c-u;switch(m=v<=.5?y/(c+u):y/(2-c-u),c){case i:f=(s-a)/y+(s<a?6:0);break;case s:f=(a-i)/y+2;break;case a:f=(i-s)/y+4}f/=6}return e.h=f,e.s=m,e.l=v,e}getRGB(e,t=Vo.workingColorSpace){return Vo.fromWorkingColorSpace(co.copy(this),t),e.r=co.r,e.g=co.g,e.b=co.b,e}getStyle(e=Gi){Vo.fromWorkingColorSpace(co.copy(this),e);const t=co.r,i=co.g,s=co.b;return e!==Gi?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*s)})`}offsetHSL(e,t,i){return this.getHSL(ra),ra.h+=e,ra.s+=t,ra.l+=i,this.setHSL(ra.h,ra.s,ra.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ra),e.getHSL(tc);const i=$(ra.h,tc.h,t),s=$(ra.s,tc.s,t),a=$(ra.l,tc.l,t);return this.setHSL(i,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,a=e.elements;return this.r=a[0]*t+a[3]*i+a[6]*s,this.g=a[1]*t+a[4]*i+a[7]*s,this.b=a[2]*t+a[5]*i+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const co=new Yn;Yn.NAMES=Ff;class sa extends Go{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Yn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const S=new he,B=new Jt;class J{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=ke,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)B.fromBufferAttribute(this,t),B.applyMatrix3(e),this.setXY(t,B.x,B.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)S.fromBufferAttribute(this,t),S.applyMatrix3(e),this.setXYZ(t,S.x,S.y,S.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)S.fromBufferAttribute(this,t),S.applyMatrix4(e),this.setXYZ(t,S.x,S.y,S.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)S.fromBufferAttribute(this,t),S.applyNormalMatrix(e),this.setXYZ(t,S.x,S.y,S.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)S.fromBufferAttribute(this,t),S.transformDirection(e),this.setXYZ(t,S.x,S.y,S.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=oo(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ni(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=oo(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=oo(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=oo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=oo(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array),s=Ni(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,a){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array),s=Ni(s,this.array),a=Ni(a,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Nn extends J{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Jr extends J{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class kn extends J{constructor(e,t,i){super(new Float32Array(e),t,i)}}let oa=0;const Eo=new _i,Ia=new Ls,Wo=new he,wo=new bi,va=new bi,uo=new he;class Zi extends mr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:oa++}),this.uuid=Ir(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ha(e)?Jr:Nn)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const a=(new Fi).getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Eo.makeRotationFromQuaternion(e),this.applyMatrix4(Eo),this}rotateX(e){return Eo.makeRotationX(e),this.applyMatrix4(Eo),this}rotateY(e){return Eo.makeRotationY(e),this.applyMatrix4(Eo),this}rotateZ(e){return Eo.makeRotationZ(e),this.applyMatrix4(Eo),this}translate(e,t,i){return Eo.makeTranslation(e,t,i),this.applyMatrix4(Eo),this}scale(e,t,i){return Eo.makeScale(e,t,i),this.applyMatrix4(Eo),this}lookAt(e){return Ia.lookAt(e),Ia.updateMatrix(),this.applyMatrix4(Ia.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wo).negate(),this.translate(Wo.x,Wo.y,Wo.z),this}setFromPoints(e){const t=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new kn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new he(-1/0,-1/0,-1/0),new he(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++)wo.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(uo.addVectors(this.boundingBox.min,wo.min),this.boundingBox.expandByPoint(uo),uo.addVectors(this.boundingBox.max,wo.max),this.boundingBox.expandByPoint(uo)):(this.boundingBox.expandByPoint(wo.min),this.boundingBox.expandByPoint(wo.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new pa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new he,1/0);if(e){const i=this.boundingSphere.center;if(wo.setFromBufferAttribute(e),t)for(let a=0,c=t.length;a<c;a++)va.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(uo.addVectors(wo.min,va.min),wo.expandByPoint(uo),uo.addVectors(wo.max,va.max),wo.expandByPoint(uo)):(wo.expandByPoint(va.min),wo.expandByPoint(va.max));wo.getCenter(i);let s=0;for(let a=0,c=e.count;a<c;a++)uo.fromBufferAttribute(e,a),s=Math.max(s,i.distanceToSquared(uo));if(t)for(let a=0,c=t.length;a<c;a++){const u=t[a],f=this.morphTargetsRelative;for(let m=0,v=u.count;m<v;m++)uo.fromBufferAttribute(u,m),f&&(Wo.fromBufferAttribute(e,m),uo.add(Wo)),s=Math.max(s,i.distanceToSquared(uo))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,s=t.position.array,a=t.normal.array,c=t.uv.array,u=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new J(new Float32Array(4*u),4));const f=this.getAttribute("tangent").array,m=[],v=[];for(let ne=0;ne<u;ne++)m[ne]=new he,v[ne]=new he;const y=new he,_=new he,x=new he,M=new Jt,P=new Jt,C=new Jt,A=new he,F=new he;function N(ne,Ge,rt){y.fromArray(s,3*ne),_.fromArray(s,3*Ge),x.fromArray(s,3*rt),M.fromArray(c,2*ne),P.fromArray(c,2*Ge),C.fromArray(c,2*rt),_.sub(y),x.sub(y),P.sub(M),C.sub(M);const Me=1/(P.x*C.y-C.x*P.y);isFinite(Me)&&(A.copy(_).multiplyScalar(C.y).addScaledVector(x,-P.y).multiplyScalar(Me),F.copy(x).multiplyScalar(P.x).addScaledVector(_,-C.x).multiplyScalar(Me),m[ne].add(A),m[Ge].add(A),m[rt].add(A),v[ne].add(F),v[Ge].add(F),v[rt].add(F))}let W=this.groups;0===W.length&&(W=[{start:0,count:i.length}]);for(let ne=0,Ge=W.length;ne<Ge;++ne){const rt=W[ne],Me=rt.start;for(let Re=Me,He=Me+rt.count;Re<He;Re+=3)N(i[Re+0],i[Re+1],i[Re+2])}const Z=new he,te=new he,ee=new he,le=new he;function j(ne){ee.fromArray(a,3*ne),le.copy(ee);const Ge=m[ne];Z.copy(Ge),Z.sub(ee.multiplyScalar(ee.dot(Ge))).normalize(),te.crossVectors(le,Ge);const Me=te.dot(v[ne])<0?-1:1;f[4*ne]=Z.x,f[4*ne+1]=Z.y,f[4*ne+2]=Z.z,f[4*ne+3]=Me}for(let ne=0,Ge=W.length;ne<Ge;++ne){const rt=W[ne],Me=rt.start;for(let Re=Me,He=Me+rt.count;Re<He;Re+=3)j(i[Re+0]),j(i[Re+1]),j(i[Re+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new J(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let _=0,x=i.count;_<x;_++)i.setXYZ(_,0,0,0);const s=new he,a=new he,c=new he,u=new he,f=new he,m=new he,v=new he,y=new he;if(e)for(let _=0,x=e.count;_<x;_+=3){const M=e.getX(_+0),P=e.getX(_+1),C=e.getX(_+2);s.fromBufferAttribute(t,M),a.fromBufferAttribute(t,P),c.fromBufferAttribute(t,C),v.subVectors(c,a),y.subVectors(s,a),v.cross(y),u.fromBufferAttribute(i,M),f.fromBufferAttribute(i,P),m.fromBufferAttribute(i,C),u.add(v),f.add(v),m.add(v),i.setXYZ(M,u.x,u.y,u.z),i.setXYZ(P,f.x,f.y,f.z),i.setXYZ(C,m.x,m.y,m.z)}else for(let _=0,x=t.count;_<x;_+=3)s.fromBufferAttribute(t,_+0),a.fromBufferAttribute(t,_+1),c.fromBufferAttribute(t,_+2),v.subVectors(c,a),y.subVectors(s,a),v.cross(y),i.setXYZ(_+0,v.x,v.y,v.z),i.setXYZ(_+1,v.x,v.y,v.z),i.setXYZ(_+2,v.x,v.y,v.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)uo.fromBufferAttribute(e,t),uo.normalize(),e.setXYZ(t,uo.x,uo.y,uo.z)}toNonIndexed(){function e(u,f){const m=u.array,v=u.itemSize,y=u.normalized,_=new m.constructor(f.length*v);let x=0,M=0;for(let P=0,C=f.length;P<C;P++){x=u.isInterleavedBufferAttribute?f[P]*u.data.stride+u.offset:f[P]*v;for(let A=0;A<v;A++)_[M++]=m[x++]}return new J(_,v,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Zi,i=this.index.array,s=this.attributes;for(const u in s){const m=e(s[u],i);t.setAttribute(u,m)}const a=this.morphAttributes;for(const u in a){const f=[],m=a[u];for(let v=0,y=m.length;v<y;v++){const x=e(m[v],i);f.push(x)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,f=c.length;u<f;u++){const m=c[u];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const f=this.parameters;for(const m in f)void 0!==f[m]&&(e[m]=f[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const f in i)e.data.attributes[f]=i[f].toJSON(e.data);const s={};let a=!1;for(const f in this.morphAttributes){const m=this.morphAttributes[f],v=[];for(let y=0,_=m.length;y<_;y++)v.push(m[y].toJSON(e.data));v.length>0&&(s[f]=v,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const s=e.attributes;for(const m in s)this.setAttribute(m,s[m].clone(t));const a=e.morphAttributes;for(const m in a){const v=[],y=a[m];for(let _=0,x=y.length;_<x;_++)v.push(y[_].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let m=0,v=c.length;m<v;m++){const y=c[m];this.addGroup(y.start,y.count,y.materialIndex)}const u=e.boundingBox;null!==u&&(this.boundingBox=u.clone());const f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wy=new _i,Ra=new Ml,nc=new pa,My=new he,ic=new he,Hu=new he,$u=new he,km=new he,Um=new he,Vm=new Jt,Gu=new Jt,rc=new Jt,Sy=new he,Wu=new he,kf=new he,Nc=new he,zm=new he;class Xr extends Ls{constructor(e=new Zi,t=new sa){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,t){const i=this.geometry,a=i.morphAttributes.position,c=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const u=this.morphTargetInfluences;if(a&&u){Um.set(0,0,0);for(let f=0,m=a.length;f<m;f++){const v=u[f];0!==v&&(km.fromBufferAttribute(a[f],e),Um.addScaledVector(c?km:km.sub(t),v))}t.add(Um)}return t}raycast(e,t){const i=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),nc.copy(i.boundingSphere),nc.applyMatrix4(a),Ra.copy(e.ray).recast(e.near),(!1!==nc.containsPoint(Ra.origin)||!(null===Ra.intersectSphere(nc,My)||Ra.origin.distanceToSquared(My)>(e.far-e.near)**2))&&(wy.copy(a).invert(),Ra.copy(e.ray).applyMatrix4(wy),(null===i.boundingBox||!1!==Ra.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Ra)))}_computeIntersections(e,t,i){let s;const a=this.geometry,c=this.material,u=a.index,f=a.attributes.position,m=a.attributes.uv,v=a.attributes.uv1,y=a.attributes.normal,_=a.groups,x=a.drawRange;if(null!==u)if(Array.isArray(c))for(let M=0,P=_.length;M<P;M++){const C=_[M],A=c[C.materialIndex];for(let W=Math.max(C.start,x.start),Z=Math.min(u.count,Math.min(C.start+C.count,x.start+x.count));W<Z;W+=3)s=Uf(this,A,e,i,m,v,y,u.getX(W),u.getX(W+1),u.getX(W+2)),s&&(s.faceIndex=Math.floor(W/3),s.face.materialIndex=C.materialIndex,t.push(s))}else for(let C=Math.max(0,x.start),A=Math.min(u.count,x.start+x.count);C<A;C+=3)s=Uf(this,c,e,i,m,v,y,u.getX(C),u.getX(C+1),u.getX(C+2)),s&&(s.faceIndex=Math.floor(C/3),t.push(s));else if(void 0!==f)if(Array.isArray(c))for(let M=0,P=_.length;M<P;M++){const C=_[M],A=c[C.materialIndex];for(let W=Math.max(C.start,x.start),Z=Math.min(f.count,Math.min(C.start+C.count,x.start+x.count));W<Z;W+=3)s=Uf(this,A,e,i,m,v,y,W,W+1,W+2),s&&(s.faceIndex=Math.floor(W/3),s.face.materialIndex=C.materialIndex,t.push(s))}else for(let C=Math.max(0,x.start),A=Math.min(f.count,x.start+x.count);C<A;C+=3)s=Uf(this,c,e,i,m,v,y,C,C+1,C+2),s&&(s.faceIndex=Math.floor(C/3),t.push(s))}}function Uf(d,e,t,i,s,a,c,u,f,m){d.getVertexPosition(u,ic),d.getVertexPosition(f,Hu),d.getVertexPosition(m,$u);const v=function Cy(d,e,t,i,s,a,c,u){let f;if(f=1===e.side?i.intersectTriangle(c,a,s,!0,u):i.intersectTriangle(s,a,c,0===e.side,u),null===f)return null;zm.copy(u),zm.applyMatrix4(d.matrixWorld);const m=t.ray.origin.distanceTo(zm);return m<t.near||m>t.far?null:{distance:m,point:zm.clone(),object:d}}(d,e,t,i,ic,Hu,$u,Nc);if(v){s&&(Vm.fromBufferAttribute(s,u),Gu.fromBufferAttribute(s,f),rc.fromBufferAttribute(s,m),v.uv=Ss.getInterpolation(Nc,ic,Hu,$u,Vm,Gu,rc,new Jt)),a&&(Vm.fromBufferAttribute(a,u),Gu.fromBufferAttribute(a,f),rc.fromBufferAttribute(a,m),v.uv1=Ss.getInterpolation(Nc,ic,Hu,$u,Vm,Gu,rc,new Jt),v.uv2=v.uv1),c&&(Sy.fromBufferAttribute(c,u),Wu.fromBufferAttribute(c,f),kf.fromBufferAttribute(c,m),v.normal=Ss.getInterpolation(Nc,ic,Hu,$u,Sy,Wu,kf,new he),v.normal.dot(i.direction)>0&&v.normal.multiplyScalar(-1));const y={a:u,b:f,c:m,normal:new he,materialIndex:0};Ss.getNormal(ic,Hu,$u,y.normal),v.face=y}return v}class Mo extends Zi{constructor(e=1,t=1,i=1,s=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:a,depthSegments:c};const u=this;s=Math.floor(s),a=Math.floor(a),c=Math.floor(c);const f=[],m=[],v=[],y=[];let _=0,x=0;function M(P,C,A,F,N,W,Z,te,ee,le,j){const ne=W/ee,Ge=Z/le,rt=W/2,Me=Z/2,Ae=te/2,Re=ee+1,He=le+1;let xt=0,St=0;const Mt=new he;for(let Bt=0;Bt<He;Bt++){const pt=Bt*Ge-Me;for(let ht=0;ht<Re;ht++)Mt[P]=(ht*ne-rt)*F,Mt[C]=pt*N,Mt[A]=Ae,m.push(Mt.x,Mt.y,Mt.z),Mt[P]=0,Mt[C]=0,Mt[A]=te>0?1:-1,v.push(Mt.x,Mt.y,Mt.z),y.push(ht/ee),y.push(1-Bt/le),xt+=1}for(let Bt=0;Bt<le;Bt++)for(let pt=0;pt<ee;pt++){const pn=_+pt+Re*(Bt+1),bn=_+(pt+1)+Re*(Bt+1),Dn=_+(pt+1)+Re*Bt;f.push(_+pt+Re*Bt,pn,Dn),f.push(pn,bn,Dn),St+=6}u.addGroup(x,St,j),x+=St,_+=xt}M("z","y","x",-1,-1,i,t,e,c,a,0),M("z","y","x",1,-1,i,t,-e,c,a,1),M("x","z","y",1,1,e,i,t,s,c,2),M("x","z","y",1,-1,e,i,-t,s,c,3),M("x","y","z",1,-1,e,t,i,s,a,4),M("x","y","z",-1,-1,e,t,-i,s,a,5),this.setIndex(f),this.setAttribute("position",new kn(m,3)),this.setAttribute("normal",new kn(v,3)),this.setAttribute("uv",new kn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ju(d){const e={};for(const t in d){e[t]={};for(const i in d[t]){const s=d[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():e[t][i]=Array.isArray(s)?s.slice():s}}return e}function So(d){const e={};for(let t=0;t<d.length;t++){const i=ju(d[t]);for(const s in i)e[s]=i[s]}return e}function $m(d){return null===d.getRenderTarget()?d.outputColorSpace:Dr}const Vf={clone:ju,merge:So};class Al extends Go{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ju(e.uniforms),this.uniformsGroups=function Hm(d){const e=[];for(let t=0;t<d.length;t++)e.push(d[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const c=this.uniforms[s].value;t.uniforms[s]=c&&c.isTexture?{type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?{type:"c",value:c.getHex()}:c&&c.isVector2?{type:"v2",value:c.toArray()}:c&&c.isVector3?{type:"v3",value:c.toArray()}:c&&c.isVector4?{type:"v4",value:c.toArray()}:c&&c.isMatrix3?{type:"m3",value:c.toArray()}:c&&c.isMatrix4?{type:"m4",value:c.toArray()}:{value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const s in this.extensions)!0===this.extensions[s]&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class zf extends Ls{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _i,this.projectionMatrix=new _i,this.projectionMatrixInverse=new _i,this.coordinateSystem=ea}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ho extends zf{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ls*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*rr*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ls*Math.atan(Math.tan(.5*rr*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,s,a,c){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*rr*this.fov)/this.zoom,i=2*t,s=this.aspect*i,a=-.5*s;const c=this.view;if(null!==this.view&&this.view.enabled){const f=c.fullWidth,m=c.fullHeight;a+=c.offsetX*s/f,t-=c.offsetY*i/m,s*=c.width/f,i*=c.height/m}const u=this.filmOffset;0!==u&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Hf extends Ls{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const s=new ho(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new ho(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new ho(-90,1,e,t);c.layers=this.layers,this.add(c);const u=new ho(-90,1,e,t);u.layers=this.layers,this.add(u);const f=new ho(-90,1,e,t);f.layers=this.layers,this.add(f);const m=new ho(-90,1,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,s,a,c,u,f]=t;for(const m of t)this.remove(m);if(e===ea)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1)}for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,c,u,f,m]=this.children,v=e.getRenderTarget(),y=e.xr.enabled;e.xr.enabled=!1;const _=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,s),e.setRenderTarget(i,1),e.render(t,a),e.setRenderTarget(i,2),e.render(t,c),e.setRenderTarget(i,3),e.render(t,u),e.setRenderTarget(i,4),e.render(t,f),i.texture.generateMipmaps=_,e.setRenderTarget(i,5),e.render(t,m),e.setRenderTarget(v),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class cl extends To{constructor(e,t,i,s,a,c,u,f,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:Sr,i,s,a,c,u,f,m,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ix extends H{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];void 0!==t.encoding&&(bo("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Nr?Gi:""),this.texture=new cl(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:lr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Mo(5,5,5),a=new Al({name:"CubemapFromEquirect",uniforms:ju(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});a.uniforms.tEquirect.value=t;const c=new Xr(s,a),u=t.minFilter;return t.minFilter===Br&&(t.minFilter=lr),new Hf(1,10,this).update(e,c),t.minFilter=u,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,i,s){const a=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,i,s);e.setRenderTarget(a)}}const $f=new he,Ay=new he,qu=new Fi;class ya{constructor(e=new he(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=$f.subVectors(i,t).cross(Ay.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta($f),s=this.normal.dot(i);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:t.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||qu.getNormalMatrix(e),s=this.coplanarPoint($f).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const cs=new pa,Gf=new he;class Wf{constructor(e=new ya,t=new ya,i=new ya,s=new ya,a=new ya,c=new ya){this.planes=[e,t,i,s,a,c]}set(e,t,i,s,a,c){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(i),u[3].copy(s),u[4].copy(a),u[5].copy(c),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ea){const i=this.planes,s=e.elements,a=s[0],c=s[1],u=s[2],f=s[3],m=s[4],v=s[5],y=s[6],_=s[7],x=s[8],M=s[9],P=s[10],C=s[11],A=s[12],F=s[13],N=s[14],W=s[15];if(i[0].setComponents(f-a,_-m,C-x,W-A).normalize(),i[1].setComponents(f+a,_+m,C+x,W+A).normalize(),i[2].setComponents(f+c,_+v,C+M,W+F).normalize(),i[3].setComponents(f-c,_-v,C-M,W-F).normalize(),i[4].setComponents(f-u,_-y,C-P,W-N).normalize(),t===ea)i[5].setComponents(f+u,_+y,C+P,W+N).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(u,y,P,N).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),cs.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),cs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(cs)}intersectsSprite(e){return cs.center.set(0,0,0),cs.radius=.7071067811865476,cs.applyMatrix4(e.matrixWorld),this.intersectsSphere(cs)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(Gf.x=s.normal.x>0?e.max.x:e.min.x,Gf.y=s.normal.y>0?e.max.y:e.min.y,Gf.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Gf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function jf(){let d=null,e=!1,t=null,i=null;function s(a,c){t(a,c),i=d.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(i=d.requestAnimationFrame(s),e=!0)},stop:function(){d.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){d=a}}}function Rx(d,e){const t=e.isWebGL2,i=new WeakMap;return{get:function c(m){return m.isInterleavedBufferAttribute&&(m=m.data),i.get(m)},remove:function u(m){m.isInterleavedBufferAttribute&&(m=m.data);const v=i.get(m);v&&(d.deleteBuffer(v.buffer),i.delete(m))},update:function f(m,v){if(m.isGLBufferAttribute){const _=i.get(m);return void((!_||_.version<m.version)&&i.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const y=i.get(m);void 0===y?i.set(m,function s(m,v){const y=m.array,_=m.usage,x=d.createBuffer();let M;if(d.bindBuffer(v,x),d.bufferData(v,y,_),m.onUploadCallback(),y instanceof Float32Array)M=d.FLOAT;else if(y instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");M=d.HALF_FLOAT}else M=d.UNSIGNED_SHORT;else if(y instanceof Int16Array)M=d.SHORT;else if(y instanceof Uint32Array)M=d.UNSIGNED_INT;else if(y instanceof Int32Array)M=d.INT;else if(y instanceof Int8Array)M=d.BYTE;else if(y instanceof Uint8Array)M=d.UNSIGNED_BYTE;else{if(!(y instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+y);M=d.UNSIGNED_BYTE}return{buffer:x,type:M,bytesPerElement:y.BYTES_PER_ELEMENT,version:m.version}}(m,v)):y.version<m.version&&(function a(m,v,y){const _=v.array,x=v.updateRange;d.bindBuffer(y,m),-1===x.count?d.bufferSubData(y,0,_):(t?d.bufferSubData(y,x.offset*_.BYTES_PER_ELEMENT,_,x.offset,x.count):d.bufferSubData(y,x.offset*_.BYTES_PER_ELEMENT,_.subarray(x.offset,x.offset+x.count)),x.count=-1),v.onUploadCallback()}(y.buffer,m,v),y.version=m.version)}}}class Bc extends Zi{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};const a=e/2,c=t/2,u=Math.floor(i),f=Math.floor(s),m=u+1,v=f+1,y=e/u,_=t/f,x=[],M=[],P=[],C=[];for(let A=0;A<v;A++){const F=A*_-c;for(let N=0;N<m;N++)M.push(N*y-a,-F,0),P.push(0,0,1),C.push(N/u),C.push(1-A/f)}for(let A=0;A<f;A++)for(let F=0;F<u;F++){const W=F+m*(A+1),Z=F+1+m*(A+1),te=F+1+m*A;x.push(F+m*A,W,te),x.push(W,Z,te)}this.setIndex(x),this.setAttribute("position",new kn(M,3)),this.setAttribute("normal",new kn(P,3)),this.setAttribute("uv",new kn(C,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bc(e.width,e.height,e.widthSegments,e.heightSegments)}}const Vi={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Vn={common:{diffuse:{value:new Yn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Fi},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Fi}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Fi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Fi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Fi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Fi},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Fi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Fi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Fi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Fi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Yn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Yn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0},uvTransform:{value:new Fi}},sprite:{diffuse:{value:new Yn(16777215)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Fi},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0}}},Tl={basic:{uniforms:So([Vn.common,Vn.specularmap,Vn.envmap,Vn.aomap,Vn.lightmap,Vn.fog]),vertexShader:Vi.meshbasic_vert,fragmentShader:Vi.meshbasic_frag},lambert:{uniforms:So([Vn.common,Vn.specularmap,Vn.envmap,Vn.aomap,Vn.lightmap,Vn.emissivemap,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,Vn.fog,Vn.lights,{emissive:{value:new Yn(0)}}]),vertexShader:Vi.meshlambert_vert,fragmentShader:Vi.meshlambert_frag},phong:{uniforms:So([Vn.common,Vn.specularmap,Vn.envmap,Vn.aomap,Vn.lightmap,Vn.emissivemap,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,Vn.fog,Vn.lights,{emissive:{value:new Yn(0)},specular:{value:new Yn(1118481)},shininess:{value:30}}]),vertexShader:Vi.meshphong_vert,fragmentShader:Vi.meshphong_frag},standard:{uniforms:So([Vn.common,Vn.envmap,Vn.aomap,Vn.lightmap,Vn.emissivemap,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,Vn.roughnessmap,Vn.metalnessmap,Vn.fog,Vn.lights,{emissive:{value:new Yn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag},toon:{uniforms:So([Vn.common,Vn.aomap,Vn.lightmap,Vn.emissivemap,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,Vn.gradientmap,Vn.fog,Vn.lights,{emissive:{value:new Yn(0)}}]),vertexShader:Vi.meshtoon_vert,fragmentShader:Vi.meshtoon_frag},matcap:{uniforms:So([Vn.common,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,Vn.fog,{matcap:{value:null}}]),vertexShader:Vi.meshmatcap_vert,fragmentShader:Vi.meshmatcap_frag},points:{uniforms:So([Vn.points,Vn.fog]),vertexShader:Vi.points_vert,fragmentShader:Vi.points_frag},dashed:{uniforms:So([Vn.common,Vn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vi.linedashed_vert,fragmentShader:Vi.linedashed_frag},depth:{uniforms:So([Vn.common,Vn.displacementmap]),vertexShader:Vi.depth_vert,fragmentShader:Vi.depth_frag},normal:{uniforms:So([Vn.common,Vn.bumpmap,Vn.normalmap,Vn.displacementmap,{opacity:{value:1}}]),vertexShader:Vi.meshnormal_vert,fragmentShader:Vi.meshnormal_frag},sprite:{uniforms:So([Vn.sprite,Vn.fog]),vertexShader:Vi.sprite_vert,fragmentShader:Vi.sprite_frag},background:{uniforms:{uvTransform:{value:new Fi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Vi.background_vert,fragmentShader:Vi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Vi.backgroundCube_vert,fragmentShader:Vi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Vi.cube_vert,fragmentShader:Vi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vi.equirect_vert,fragmentShader:Vi.equirect_frag},distanceRGBA:{uniforms:So([Vn.common,Vn.displacementmap,{referencePosition:{value:new he},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vi.distanceRGBA_vert,fragmentShader:Vi.distanceRGBA_frag},shadow:{uniforms:So([Vn.lights,Vn.fog,{color:{value:new Yn(0)},opacity:{value:1}}]),vertexShader:Vi.shadow_vert,fragmentShader:Vi.shadow_frag}};Tl.physical={uniforms:So([Tl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Fi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Fi},clearcoatNormalScale:{value:new Jt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Fi},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Fi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Fi},sheen:{value:0},sheenColor:{value:new Yn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Fi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Fi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Fi},transmissionSamplerSize:{value:new Jt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Fi},attenuationDistance:{value:0},attenuationColor:{value:new Yn(0)},specularColor:{value:new Yn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Fi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Fi},anisotropyVector:{value:new Jt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Fi}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag};const $c={r:0,b:0,g:0};function qy(d,e,t,i,s,a,c){const u=new Yn(0);let m,v,f=!0===a?0:1,y=null,_=0,x=null;function P(C,A){C.getRGB($c,$m(d)),i.buffers.color.setClear($c.r,$c.g,$c.b,A,c)}return{getClearColor:function(){return u},setClearColor:function(C,A=1){u.set(C),f=A,P(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(C){f=C,P(u,f)},render:function M(C,A){let F=!1,N=!0===A.isScene?A.background:null;N&&N.isTexture&&(N=(A.backgroundBlurriness>0?t:e).get(N)),null===N?P(u,f):N&&N.isColor&&(P(N,1),F=!0);const W=d.xr.getEnvironmentBlendMode();"additive"===W?i.buffers.color.setClear(0,0,0,1,c):"alpha-blend"===W&&i.buffers.color.setClear(0,0,0,0,c),(d.autoClear||F)&&d.clear(d.autoClearColor,d.autoClearDepth,d.autoClearStencil),N&&(N.isCubeTexture||N.mapping===fr)?(void 0===v&&(v=new Xr(new Mo(1,1,1),new Al({name:"BackgroundCubeMaterial",uniforms:ju(Tl.backgroundCube.uniforms),vertexShader:Tl.backgroundCube.vertexShader,fragmentShader:Tl.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(Z,te,ee){this.matrixWorld.copyPosition(ee.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(v)),v.material.uniforms.envMap.value=N,v.material.uniforms.flipEnvMap.value=N.isCubeTexture&&!1===N.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=A.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,v.material.toneMapped=N.colorSpace!==Gi,(y!==N||_!==N.version||x!==d.toneMapping)&&(v.material.needsUpdate=!0,y=N,_=N.version,x=d.toneMapping),v.layers.enableAll(),C.unshift(v,v.geometry,v.material,0,0,null)):N&&N.isTexture&&(void 0===m&&(m=new Xr(new Bc(2,2),new Al({name:"BackgroundMaterial",uniforms:ju(Tl.background.uniforms),vertexShader:Tl.background.vertexShader,fragmentShader:Tl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(m)),m.material.uniforms.t2D.value=N,m.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,m.material.toneMapped=N.colorSpace!==Gi,!0===N.matrixAutoUpdate&&N.updateMatrix(),m.material.uniforms.uvTransform.value.copy(N.matrix),(y!==N||_!==N.version||x!==d.toneMapping)&&(m.material.needsUpdate=!0,y=N,_=N.version,x=d.toneMapping),m.layers.enableAll(),C.unshift(m,m.geometry,m.material,0,0,null))}}}function bE(d,e,t,i){const s=d.getParameter(d.MAX_VERTEX_ATTRIBS),a=i.isWebGL2?null:e.get("OES_vertex_array_object"),c=i.isWebGL2||null!==a,u={},f=C(null);let m=f,v=!1;function x(Ae){return i.isWebGL2?d.bindVertexArray(Ae):a.bindVertexArrayOES(Ae)}function M(Ae){return i.isWebGL2?d.deleteVertexArray(Ae):a.deleteVertexArrayOES(Ae)}function C(Ae){const Re=[],He=[],xt=[];for(let St=0;St<s;St++)Re[St]=0,He[St]=0,xt[St]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Re,enabledAttributes:He,attributeDivisors:xt,object:Ae,attributes:{},index:null}}function N(){const Ae=m.newAttributes;for(let Re=0,He=Ae.length;Re<He;Re++)Ae[Re]=0}function W(Ae){Z(Ae,0)}function Z(Ae,Re){const xt=m.enabledAttributes,St=m.attributeDivisors;m.newAttributes[Ae]=1,0===xt[Ae]&&(d.enableVertexAttribArray(Ae),xt[Ae]=1),St[Ae]!==Re&&((i.isWebGL2?d:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ae,Re),St[Ae]=Re)}function te(){const Ae=m.newAttributes,Re=m.enabledAttributes;for(let He=0,xt=Re.length;He<xt;He++)Re[He]!==Ae[He]&&(d.disableVertexAttribArray(He),Re[He]=0)}function ee(Ae,Re,He,xt,St,Mt,Bt){!0===Bt?d.vertexAttribIPointer(Ae,Re,He,St,Mt):d.vertexAttribPointer(Ae,Re,He,xt,St,Mt)}function rt(){Me(),v=!0,m!==f&&(m=f,x(m.object))}function Me(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:function y(Ae,Re,He,xt,St){let Mt=!1;if(c){const Bt=function P(Ae,Re,He){const xt=!0===He.wireframe;let St=u[Ae.id];void 0===St&&(St={},u[Ae.id]=St);let Mt=St[Re.id];void 0===Mt&&(Mt={},St[Re.id]=Mt);let Bt=Mt[xt];return void 0===Bt&&(Bt=C(function _(){return i.isWebGL2?d.createVertexArray():a.createVertexArrayOES()}()),Mt[xt]=Bt),Bt}(xt,He,Re);m!==Bt&&(m=Bt,x(m.object)),Mt=function A(Ae,Re,He,xt){const St=m.attributes,Mt=Re.attributes;let Bt=0;const pt=He.getAttributes();for(const ht in pt)if(pt[ht].location>=0){const bn=St[ht];let Dn=Mt[ht];if(void 0===Dn&&("instanceMatrix"===ht&&Ae.instanceMatrix&&(Dn=Ae.instanceMatrix),"instanceColor"===ht&&Ae.instanceColor&&(Dn=Ae.instanceColor)),void 0===bn||bn.attribute!==Dn||Dn&&bn.data!==Dn.data)return!0;Bt++}return m.attributesNum!==Bt||m.index!==xt}(Ae,xt,He,St),Mt&&function F(Ae,Re,He,xt){const St={},Mt=Re.attributes;let Bt=0;const pt=He.getAttributes();for(const ht in pt)if(pt[ht].location>=0){let bn=Mt[ht];void 0===bn&&("instanceMatrix"===ht&&Ae.instanceMatrix&&(bn=Ae.instanceMatrix),"instanceColor"===ht&&Ae.instanceColor&&(bn=Ae.instanceColor));const Dn={};Dn.attribute=bn,bn&&bn.data&&(Dn.data=bn.data),St[ht]=Dn,Bt++}m.attributes=St,m.attributesNum=Bt,m.index=xt}(Ae,xt,He,St)}else{const Bt=!0===Re.wireframe;(m.geometry!==xt.id||m.program!==He.id||m.wireframe!==Bt)&&(m.geometry=xt.id,m.program=He.id,m.wireframe=Bt,Mt=!0)}null!==St&&t.update(St,d.ELEMENT_ARRAY_BUFFER),(Mt||v)&&(v=!1,function le(Ae,Re,He,xt){if(!1===i.isWebGL2&&(Ae.isInstancedMesh||xt.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;N();const St=xt.attributes,Mt=He.getAttributes(),Bt=Re.defaultAttributeValues;for(const pt in Mt){const ht=Mt[pt];if(ht.location>=0){let pn=St[pt];if(void 0===pn&&("instanceMatrix"===pt&&Ae.instanceMatrix&&(pn=Ae.instanceMatrix),"instanceColor"===pt&&Ae.instanceColor&&(pn=Ae.instanceColor)),void 0!==pn){const bn=pn.normalized,Dn=pn.itemSize,Bn=t.get(pn);if(void 0===Bn)continue;const jn=Bn.buffer,ei=Bn.type,zi=Bn.bytesPerElement,Ki=!0===i.isWebGL2&&(ei===d.INT||ei===d.UNSIGNED_INT||1013===pn.gpuType);if(pn.isInterleavedBufferAttribute){const di=pn.data,Ve=di.stride,Cn=pn.offset;if(di.isInstancedInterleavedBuffer){for(let nn=0;nn<ht.locationSize;nn++)Z(ht.location+nn,di.meshPerAttribute);!0!==Ae.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=di.meshPerAttribute*di.count)}else for(let nn=0;nn<ht.locationSize;nn++)W(ht.location+nn);d.bindBuffer(d.ARRAY_BUFFER,jn);for(let nn=0;nn<ht.locationSize;nn++)ee(ht.location+nn,Dn/ht.locationSize,ei,bn,Ve*zi,(Cn+Dn/ht.locationSize*nn)*zi,Ki)}else{if(pn.isInstancedBufferAttribute){for(let di=0;di<ht.locationSize;di++)Z(ht.location+di,pn.meshPerAttribute);!0!==Ae.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=pn.meshPerAttribute*pn.count)}else for(let di=0;di<ht.locationSize;di++)W(ht.location+di);d.bindBuffer(d.ARRAY_BUFFER,jn);for(let di=0;di<ht.locationSize;di++)ee(ht.location+di,Dn/ht.locationSize,ei,bn,Dn*zi,Dn/ht.locationSize*di*zi,Ki)}}else if(void 0!==Bt){const bn=Bt[pt];if(void 0!==bn)switch(bn.length){case 2:d.vertexAttrib2fv(ht.location,bn);break;case 3:d.vertexAttrib3fv(ht.location,bn);break;case 4:d.vertexAttrib4fv(ht.location,bn);break;default:d.vertexAttrib1fv(ht.location,bn)}}}}te()}(Ae,Re,He,xt),null!==St&&d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,t.get(St).buffer))},reset:rt,resetDefaultState:Me,dispose:function j(){rt();for(const Ae in u){const Re=u[Ae];for(const He in Re){const xt=Re[He];for(const St in xt)M(xt[St].object),delete xt[St];delete Re[He]}delete u[Ae]}},releaseStatesOfGeometry:function ne(Ae){if(void 0===u[Ae.id])return;const Re=u[Ae.id];for(const He in Re){const xt=Re[He];for(const St in xt)M(xt[St].object),delete xt[St];delete Re[He]}delete u[Ae.id]},releaseStatesOfProgram:function Ge(Ae){for(const Re in u){const He=u[Re];if(void 0===He[Ae.id])continue;const xt=He[Ae.id];for(const St in xt)M(xt[St].object),delete xt[St];delete He[Ae.id]}},initAttributes:N,enableAttribute:W,disableUnusedAttributes:te}}function Xy(d,e,t,i){const s=i.isWebGL2;let a;this.setMode=function c(m){a=m},this.render=function u(m,v){d.drawArrays(a,m,v),t.update(v,a,1)},this.renderInstances=function f(m,v,y){if(0===y)return;let _,x;if(s)_=d,x="drawArraysInstanced";else if(_=e.get("ANGLE_instanced_arrays"),x="drawArraysInstancedANGLE",null===_)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[x](a,m,v,y),t.update(v,a,y)}}function yA(d,e,t){let i;function a(ee){if("highp"===ee){if(d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_FLOAT).precision>0&&d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT).precision>0)return"highp";ee="mediump"}return"mediump"===ee&&d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_FLOAT).precision>0&&d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const c=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===d.constructor.name;let u=void 0!==t.precision?t.precision:"highp";const f=a(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const m=c||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,y=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS),_=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=d.getParameter(d.MAX_TEXTURE_SIZE),M=d.getParameter(d.MAX_CUBE_MAP_TEXTURE_SIZE),P=d.getParameter(d.MAX_VERTEX_ATTRIBS),C=d.getParameter(d.MAX_VERTEX_UNIFORM_VECTORS),A=d.getParameter(d.MAX_VARYING_VECTORS),F=d.getParameter(d.MAX_FRAGMENT_UNIFORM_VECTORS),N=_>0,W=c||e.has("OES_texture_float");return{isWebGL2:c,drawBuffers:m,getMaxAnisotropy:function s(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const ee=e.get("EXT_texture_filter_anisotropic");i=d.getParameter(ee.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,precision:u,logarithmicDepthBuffer:v,maxTextures:y,maxVertexTextures:_,maxTextureSize:x,maxCubemapSize:M,maxAttributes:P,maxVertexUniforms:C,maxVaryings:A,maxFragmentUniforms:F,vertexTextures:N,floatFragmentTextures:W,floatVertexTextures:N&&W,maxSamples:c?d.getParameter(d.MAX_SAMPLES):0}}function Ky(d){const e=this;let t=null,i=0,s=!1,a=!1;const c=new ya,u=new Fi,f={value:null,needsUpdate:!1};function v(y,_,x,M){const P=null!==y?y.length:0;let C=null;if(0!==P){if(C=f.value,!0!==M||null===C){const A=x+4*P,F=_.matrixWorldInverse;u.getNormalMatrix(F),(null===C||C.length<A)&&(C=new Float32Array(A));for(let N=0,W=x;N!==P;++N,W+=4)c.copy(y[N]).applyMatrix4(F,u),c.normal.toArray(C,W),C[W+3]=c.constant}f.value=C,f.needsUpdate=!0}return e.numPlanes=P,e.numIntersection=0,C}this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(y,_){const x=0!==y.length||_||0!==i||s;return s=_,i=y.length,x},this.beginShadows=function(){a=!0,v(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(y,_){t=v(y,_,0)},this.setState=function(y,_,x){const M=y.clippingPlanes,P=y.clipIntersection,C=y.clipShadows,A=d.get(y);if(!s||null===M||0===M.length||a&&!C)a?v(null):function m(){f.value!==t&&(f.value=t,f.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const F=a?0:i,N=4*F;let W=A.clippingState||null;f.value=W,W=v(M,_,N,x);for(let Z=0;Z!==N;++Z)W[Z]=t[Z];A.clippingState=W,this.numIntersection=P?this.numPlanes:0,this.numPlanes+=F}}}function _A(d){let e=new WeakMap;function t(c,u){return 303===u?c.mapping=Sr:304===u&&(c.mapping=Fr),c}function s(c){const u=c.target;u.removeEventListener("dispose",s);const f=e.get(u);void 0!==f&&(e.delete(u),f.dispose())}return{get:function i(c){if(c&&c.isTexture&&!1===c.isRenderTargetTexture){const u=c.mapping;if(303===u||304===u){if(e.has(c))return t(e.get(c).texture,c.mapping);{const f=c.image;if(f&&f.height>0){const m=new Ix(f.height/2);return m.fromEquirectangularTexture(d,c),e.set(c,m),c.addEventListener("dispose",s),t(m.texture,c.mapping)}return null}}}return c},dispose:function a(){e=new WeakMap}}}class ip extends zf{constructor(e=-1,t=1,i=1,s=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,a,c){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=i-e,c=i+e,u=s+t,f=s-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=m*this.view.offsetX,c=a+m*this.view.width,u-=v*this.view.offsetY,f=u-v*this.view.height}this.projectionMatrix.makeOrthographic(a,c,u,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const rp=[.125,.215,.35,.446,.526,.582],Zy=new ip,sp=new Yn;let Jy=null;const ad=(1+Math.sqrt(5))/2,fh=1/ad,xE=[new he(1,1,1),new he(-1,1,1),new he(1,1,-1),new he(-1,1,-1),new he(0,ad,fh),new he(0,ad,-fh),new he(fh,0,ad),new he(-fh,0,ad),new he(ad,fh,0),new he(-ad,fh,0)];class EE{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100){Jy=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,i,s,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=lg(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=ag(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Jy),e.scissorTest=!1,Gc(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Sr||e.mapping===Fr?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Jy=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:lr,minFilter:lr,generateMipmaps:!1,type:gt,format:Ui,colorSpace:Dr,depthBuffer:!1},s=ph(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ph(e,t,i);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function wE(d){const e=[],t=[],i=[];let s=d;const a=d-4+1+rp.length;for(let c=0;c<a;c++){const u=Math.pow(2,s);t.push(u);let f=1/u;c>d-4?f=rp[c-d+4-1]:0===c&&(f=0),i.push(f);const m=1/(u-2),v=-m,y=1+m,_=[v,v,y,v,y,y,v,v,y,y,v,y],x=6,M=6,P=3,C=2,A=1,F=new Float32Array(P*M*x),N=new Float32Array(C*M*x),W=new Float32Array(A*M*x);for(let te=0;te<x;te++){const ee=te%3*2/3-1,le=te>2?0:-1;F.set([ee,le,0,ee+2/3,le,0,ee+2/3,le+1,0,ee,le,0,ee+2/3,le+1,0,ee,le+1,0],P*M*te),N.set(_,C*M*te),W.set([te,te,te,te,te,te],A*M*te)}const Z=new Zi;Z.setAttribute("position",new J(F,P)),Z.setAttribute("uv",new J(N,C)),Z.setAttribute("faceIndex",new J(W,A)),e.push(Z),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(a)),this._blurMaterial=function og(d,e,t){const i=new Float32Array(20),s=new he(0,1,0);return new Al({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${d}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return s}_compileMaterial(e){const t=new Xr(this._lodPlanes[0],e);this._renderer.compile(t,Zy)}_sceneToCubeUV(e,t,i,s){const u=new ho(90,1,t,i),f=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,_=v.toneMapping;v.getClearColor(sp),v.toneMapping=Gn,v.autoClear=!1;const x=new sa({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),M=new Xr(new Mo,x);let P=!1;const C=e.background;C?C.isColor&&(x.color.copy(C),e.background=null,P=!0):(x.color.copy(sp),P=!0);for(let A=0;A<6;A++){const F=A%3;0===F?(u.up.set(0,f[A],0),u.lookAt(m[A],0,0)):1===F?(u.up.set(0,0,f[A]),u.lookAt(0,m[A],0)):(u.up.set(0,f[A],0),u.lookAt(0,0,m[A]));const N=this._cubeSize;Gc(s,F*N,A>2?N:0,N,N),v.setRenderTarget(s),P&&v.render(M,u),v.render(e,u)}M.geometry.dispose(),M.material.dispose(),v.toneMapping=_,v.autoClear=y,e.background=C}_textureToCubeUV(e,t){const i=this._renderer,s=e.mapping===Sr||e.mapping===Fr;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=lg()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ag());const a=s?this._cubemapMaterial:this._equirectMaterial,c=new Xr(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const f=this._cubeSize;Gc(t,0,0,3*f,2*f),i.setRenderTarget(t),i.render(c,Zy)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,a,xE[(s-1)%xE.length])}t.autoClear=i}_blur(e,t,i,s,a){const c=this._pingPongRenderTarget;this._halfBlur(e,c,t,i,s,"latitudinal",a),this._halfBlur(c,e,i,i,s,"longitudinal",a)}_halfBlur(e,t,i,s,a,c,u){const f=this._renderer,m=this._blurMaterial;"latitudinal"!==c&&"longitudinal"!==c&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new Xr(this._lodPlanes[s],m),_=m.uniforms,x=this._sizeLods[i]-1,M=isFinite(a)?Math.PI/(2*x):2*Math.PI/39,P=a/M,C=isFinite(a)?1+Math.floor(3*P):20;C>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${C} samples when the maximum is set to 20`);const A=[];let F=0;for(let ee=0;ee<20;++ee){const le=ee/P,j=Math.exp(-le*le/2);A.push(j),0===ee?F+=j:ee<C&&(F+=2*j)}for(let ee=0;ee<A.length;ee++)A[ee]=A[ee]/F;_.envMap.value=e.texture,_.samples.value=C,_.weights.value=A,_.latitudinal.value="latitudinal"===c,u&&(_.poleAxis.value=u);const{_lodMax:N}=this;_.dTheta.value=M,_.mipInt.value=N-i;const W=this._sizeLods[s];Gc(t,3*W*(s>N-4?s-N+4:0),4*(this._cubeSize-W),3*W,2*W),f.setRenderTarget(t),f.render(y,Zy)}}function ph(d,e,t){const i=new H(d,e,t);return i.texture.mapping=fr,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Gc(d,e,t,i,s){d.viewport.set(e,t,i,s),d.scissor.set(e,t,i,s)}function ag(){return new Al({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function lg(){return new Al({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ME(d){let e=new WeakMap,t=null;function a(u){const f=u.target;f.removeEventListener("dispose",a);const m=e.get(f);void 0!==m&&(e.delete(f),m.dispose())}return{get:function i(u){if(u&&u.isTexture){const f=u.mapping,m=303===f||304===f,v=f===Sr||f===Fr;if(m||v){if(u.isRenderTargetTexture&&!0===u.needsPMREMUpdate){u.needsPMREMUpdate=!1;let y=e.get(u);return null===t&&(t=new EE(d)),y=m?t.fromEquirectangular(u,y):t.fromCubemap(u,y),e.set(u,y),y.texture}if(e.has(u))return e.get(u).texture;{const y=u.image;if(m&&y&&y.height>0||v&&y&&function s(u){let f=0;for(let v=0;v<6;v++)void 0!==u[v]&&f++;return 6===f}(y)){null===t&&(t=new EE(d));const _=m?t.fromEquirectangular(u):t.fromCubemap(u);return e.set(u,_),u.addEventListener("dispose",a),_.texture}return null}}}return u},dispose:function c(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Qy(d){const e={};function t(i){if(void 0!==e[i])return e[i];let s;switch(i){case"WEBGL_depth_texture":s=d.getExtension("WEBGL_depth_texture")||d.getExtension("MOZ_WEBGL_depth_texture")||d.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=d.getExtension("WEBGL_compressed_texture_s3tc")||d.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=d.getExtension("WEBGL_compressed_texture_pvrtc")||d.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=d.getExtension(i)}return e[i]=s,s}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const s=t(i);return null===s&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function e0(d,e,t,i){const s={},a=new WeakMap;function c(y){const _=y.target;null!==_.index&&e.remove(_.index);for(const M in _.attributes)e.remove(_.attributes[M]);for(const M in _.morphAttributes){const P=_.morphAttributes[M];for(let C=0,A=P.length;C<A;C++)e.remove(P[C])}_.removeEventListener("dispose",c),delete s[_.id];const x=a.get(_);x&&(e.remove(x),a.delete(_)),i.releaseStatesOfGeometry(_),!0===_.isInstancedBufferGeometry&&delete _._maxInstanceCount,t.memory.geometries--}function m(y){const _=[],x=y.index,M=y.attributes.position;let P=0;if(null!==x){const F=x.array;P=x.version;for(let N=0,W=F.length;N<W;N+=3){const Z=F[N+0],te=F[N+1],ee=F[N+2];_.push(Z,te,te,ee,ee,Z)}}else{if(void 0===M)return;P=M.version;for(let N=0,W=M.array.length/3-1;N<W;N+=3){const Z=N+0,te=N+1,ee=N+2;_.push(Z,te,te,ee,ee,Z)}}const C=new(ha(_)?Jr:Nn)(_,1);C.version=P;const A=a.get(y);A&&e.remove(A),a.set(y,C)}return{get:function u(y,_){return!0===s[_.id]||(_.addEventListener("dispose",c),s[_.id]=!0,t.memory.geometries++),_},update:function f(y){const _=y.attributes;for(const M in _)e.update(_[M],d.ARRAY_BUFFER);const x=y.morphAttributes;for(const M in x){const P=x[M];for(let C=0,A=P.length;C<A;C++)e.update(P[C],d.ARRAY_BUFFER)}},getWireframeAttribute:function v(y){const _=a.get(y);if(_){const x=y.index;null!==x&&_.version<x.version&&m(y)}else m(y);return a.get(y)}}}function op(d,e,t,i){const s=i.isWebGL2;let a,u,f;this.setMode=function c(_){a=_},this.setIndex=function m(_){u=_.type,f=_.bytesPerElement},this.render=function v(_,x){d.drawElements(a,x,u,_*f),t.update(x,a,1)},this.renderInstances=function y(_,x,M){if(0===M)return;let P,C;if(s)P=d,C="drawElementsInstanced";else if(P=e.get("ANGLE_instanced_arrays"),C="drawElementsInstancedANGLE",null===P)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");P[C](a,x,u,_*f,M),t.update(x,a,M)}}function ap(d){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(a,c,u){switch(t.calls++,c){case d.TRIANGLES:t.triangles+=u*(a/3);break;case d.LINES:t.lines+=u*(a/2);break;case d.LINE_STRIP:t.lines+=u*(a-1);break;case d.LINE_LOOP:t.lines+=u*a;break;case d.POINTS:t.points+=u*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c)}}}}function lp(d,e){return d[0]-e[0]}function SE(d,e){return Math.abs(e[1])-Math.abs(d[1])}function CE(d,e,t){const i={},s=new Float32Array(8),a=new WeakMap,c=new zr,u=[];for(let m=0;m<8;m++)u[m]=[m,0];return{update:function f(m,v,y){const _=m.morphTargetInfluences;if(!0===e.isWebGL2){const x=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,M=void 0!==x?x.length:0;let P=a.get(v);if(void 0===P||P.count!==M){let Ae=function(){rt.dispose(),a.delete(v),v.removeEventListener("dispose",Ae)};void 0!==P&&P.texture.dispose();const F=void 0!==v.morphAttributes.position,N=void 0!==v.morphAttributes.normal,W=void 0!==v.morphAttributes.color,Z=v.morphAttributes.position||[],te=v.morphAttributes.normal||[],ee=v.morphAttributes.color||[];let le=0;!0===F&&(le=1),!0===N&&(le=2),!0===W&&(le=3);let j=v.attributes.position.count*le,ne=1;j>e.maxTextureSize&&(ne=Math.ceil(j/e.maxTextureSize),j=e.maxTextureSize);const Ge=new Float32Array(j*ne*4*M),rt=new Ee(Ge,j,ne,M);rt.type=ke,rt.needsUpdate=!0;const Me=4*le;for(let Re=0;Re<M;Re++){const He=Z[Re],xt=te[Re],St=ee[Re],Mt=j*ne*4*Re;for(let Bt=0;Bt<He.count;Bt++){const pt=Bt*Me;!0===F&&(c.fromBufferAttribute(He,Bt),Ge[Mt+pt+0]=c.x,Ge[Mt+pt+1]=c.y,Ge[Mt+pt+2]=c.z,Ge[Mt+pt+3]=0),!0===N&&(c.fromBufferAttribute(xt,Bt),Ge[Mt+pt+4]=c.x,Ge[Mt+pt+5]=c.y,Ge[Mt+pt+6]=c.z,Ge[Mt+pt+7]=0),!0===W&&(c.fromBufferAttribute(St,Bt),Ge[Mt+pt+8]=c.x,Ge[Mt+pt+9]=c.y,Ge[Mt+pt+10]=c.z,Ge[Mt+pt+11]=4===St.itemSize?c.w:1)}}P={count:M,texture:rt,size:new Jt(j,ne)},a.set(v,P),v.addEventListener("dispose",Ae)}let C=0;for(let F=0;F<_.length;F++)C+=_[F];const A=v.morphTargetsRelative?1:1-C;y.getUniforms().setValue(d,"morphTargetBaseInfluence",A),y.getUniforms().setValue(d,"morphTargetInfluences",_),y.getUniforms().setValue(d,"morphTargetsTexture",P.texture,t),y.getUniforms().setValue(d,"morphTargetsTextureSize",P.size)}else{const x=void 0===_?0:_.length;let M=i[v.id];if(void 0===M||M.length!==x){M=[];for(let N=0;N<x;N++)M[N]=[N,0];i[v.id]=M}for(let N=0;N<x;N++){const W=M[N];W[0]=N,W[1]=_[N]}M.sort(SE);for(let N=0;N<8;N++)N<x&&M[N][1]?(u[N][0]=M[N][0],u[N][1]=M[N][1]):(u[N][0]=Number.MAX_SAFE_INTEGER,u[N][1]=0);u.sort(lp);const P=v.morphAttributes.position,C=v.morphAttributes.normal;let A=0;for(let N=0;N<8;N++){const W=u[N],Z=W[0],te=W[1];Z!==Number.MAX_SAFE_INTEGER&&te?(P&&v.getAttribute("morphTarget"+N)!==P[Z]&&v.setAttribute("morphTarget"+N,P[Z]),C&&v.getAttribute("morphNormal"+N)!==C[Z]&&v.setAttribute("morphNormal"+N,C[Z]),s[N]=te,A+=te):(P&&!0===v.hasAttribute("morphTarget"+N)&&v.deleteAttribute("morphTarget"+N),C&&!0===v.hasAttribute("morphNormal"+N)&&v.deleteAttribute("morphNormal"+N),s[N]=0)}const F=v.morphTargetsRelative?1:1-A;y.getUniforms().setValue(d,"morphTargetBaseInfluence",F),y.getUniforms().setValue(d,"morphTargetInfluences",s)}}}}function AE(d,e,t,i){let s=new WeakMap;function u(f){const m=f.target;m.removeEventListener("dispose",u),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function a(f){const m=i.render.frame,y=e.get(f,f.geometry);if(s.get(y)!==m&&(e.update(y),s.set(y,m)),f.isInstancedMesh&&(!1===f.hasEventListener("dispose",u)&&f.addEventListener("dispose",u),s.get(f)!==m&&(t.update(f.instanceMatrix,d.ARRAY_BUFFER),null!==f.instanceColor&&t.update(f.instanceColor,d.ARRAY_BUFFER),s.set(f,m))),f.isSkinnedMesh){const _=f.skeleton;s.get(_)!==m&&(_.update(),s.set(_,m))}return y},dispose:function c(){s=new WeakMap}}}const cg=new To,cp=new Ee,t0=new ue,n0=new cl,r0=[],ug=[],s0=new Float32Array(16),o0=new Float32Array(9),jo=new Float32Array(4);function sc(d,e,t){const i=d[0];if(i<=0||i>0)return d;const s=e*t;let a=r0[s];if(void 0===a&&(a=new Float32Array(s),r0[s]=a),0!==e){i.toArray(a,0);for(let c=1,u=0;c!==e;++c)u+=t,d[c].toArray(a,u)}return a}function Ks(d,e){if(d.length!==e.length)return!1;for(let t=0,i=d.length;t<i;t++)if(d[t]!==e[t])return!1;return!0}function Vs(d,e){for(let t=0,i=e.length;t<i;t++)d[t]=e[t]}function po(d,e){let t=ug[e];void 0===t&&(t=new Int32Array(e),ug[e]=t);for(let i=0;i!==e;++i)t[i]=d.allocateTextureUnit();return t}function mh(d,e){const t=this.cache;t[0]!==e&&(d.uniform1f(this.addr,e),t[0]=e)}function a0(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(d.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ks(t,e))return;d.uniform2fv(this.addr,e),Vs(t,e)}}function l0(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(d.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(d.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ks(t,e))return;d.uniform3fv(this.addr,e),Vs(t,e)}}function TE(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(d.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ks(t,e))return;d.uniform4fv(this.addr,e),Vs(t,e)}}function c0(d,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ks(t,e))return;d.uniformMatrix2fv(this.addr,!1,e),Vs(t,e)}else{if(Ks(t,i))return;jo.set(i),d.uniformMatrix2fv(this.addr,!1,jo),Vs(t,i)}}function DE(d,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ks(t,e))return;d.uniformMatrix3fv(this.addr,!1,e),Vs(t,e)}else{if(Ks(t,i))return;o0.set(i),d.uniformMatrix3fv(this.addr,!1,o0),Vs(t,i)}}function u0(d,e){const t=this.cache,i=e.elements;if(void 0===i){if(Ks(t,e))return;d.uniformMatrix4fv(this.addr,!1,e),Vs(t,e)}else{if(Ks(t,i))return;s0.set(i),d.uniformMatrix4fv(this.addr,!1,s0),Vs(t,i)}}function IE(d,e){const t=this.cache;t[0]!==e&&(d.uniform1i(this.addr,e),t[0]=e)}function d0(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(d.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ks(t,e))return;d.uniform2iv(this.addr,e),Vs(t,e)}}function RE(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(d.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ks(t,e))return;d.uniform3iv(this.addr,e),Vs(t,e)}}function PE(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(d.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ks(t,e))return;d.uniform4iv(this.addr,e),Vs(t,e)}}function dg(d,e){const t=this.cache;t[0]!==e&&(d.uniform1ui(this.addr,e),t[0]=e)}function hg(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(d.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ks(t,e))return;d.uniform2uiv(this.addr,e),Vs(t,e)}}function LE(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(d.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ks(t,e))return;d.uniform3uiv(this.addr,e),Vs(t,e)}}function gh(d,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(d.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ks(t,e))return;d.uniform4uiv(this.addr,e),Vs(t,e)}}function OE(d,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(d.uniform1i(this.addr,s),i[0]=s),t.setTexture2D(e||cg,s)}function NE(d,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(d.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||t0,s)}function h0(d,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(d.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||n0,s)}function f0(d,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(d.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||cp,s)}function ld(d,e){d.uniform1fv(this.addr,e)}function up(d,e){const t=sc(e,this.size,2);d.uniform2fv(this.addr,t)}function m0(d,e){const t=sc(e,this.size,3);d.uniform3fv(this.addr,t)}function fg(d,e){const t=sc(e,this.size,4);d.uniform4fv(this.addr,t)}function dp(d,e){const t=sc(e,this.size,4);d.uniformMatrix2fv(this.addr,!1,t)}function FE(d,e){const t=sc(e,this.size,9);d.uniformMatrix3fv(this.addr,!1,t)}function BE(d,e){const t=sc(e,this.size,16);d.uniformMatrix4fv(this.addr,!1,t)}function kE(d,e){d.uniform1iv(this.addr,e)}function UE(d,e){d.uniform2iv(this.addr,e)}function VE(d,e){d.uniform3iv(this.addr,e)}function zE(d,e){d.uniform4iv(this.addr,e)}function g0(d,e){d.uniform1uiv(this.addr,e)}function vh(d,e){d.uniform2uiv(this.addr,e)}function hp(d,e){d.uniform3uiv(this.addr,e)}function pg(d,e){d.uniform4uiv(this.addr,e)}function HE(d,e,t){const i=this.cache,s=e.length,a=po(t,s);Ks(i,a)||(d.uniform1iv(this.addr,a),Vs(i,a));for(let c=0;c!==s;++c)t.setTexture2D(e[c]||cg,a[c])}function $E(d,e,t){const i=this.cache,s=e.length,a=po(t,s);Ks(i,a)||(d.uniform1iv(this.addr,a),Vs(i,a));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||t0,a[c])}function mg(d,e,t){const i=this.cache,s=e.length,a=po(t,s);Ks(i,a)||(d.uniform1iv(this.addr,a),Vs(i,a));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||n0,a[c])}function v0(d,e,t){const i=this.cache,s=e.length,a=po(t,s);Ks(i,a)||(d.uniform1iv(this.addr,a),Vs(i,a));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||cp,a[c])}class y0{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function p0(d){switch(d){case 5126:return mh;case 35664:return a0;case 35665:return l0;case 35666:return TE;case 35674:return c0;case 35675:return DE;case 35676:return u0;case 5124:case 35670:return IE;case 35667:case 35671:return d0;case 35668:case 35672:return RE;case 35669:case 35673:return PE;case 5125:return dg;case 36294:return hg;case 36295:return LE;case 36296:return gh;case 35678:case 36198:case 36298:case 36306:case 35682:return OE;case 35679:case 36299:case 36307:return NE;case 35680:case 36300:case 36308:case 36293:return h0;case 36289:case 36303:case 36311:case 36292:return f0}}(t.type)}}class _0{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function jc(d){switch(d){case 5126:return ld;case 35664:return up;case 35665:return m0;case 35666:return fg;case 35674:return dp;case 35675:return FE;case 35676:return BE;case 5124:case 35670:return kE;case 35667:case 35671:return UE;case 35668:case 35672:return VE;case 35669:case 35673:return zE;case 5125:return g0;case 36294:return vh;case 36295:return hp;case 36296:return pg;case 35678:case 36198:case 36298:case 36306:case 35682:return HE;case 35679:case 36299:case 36307:return $E;case 35680:case 36300:case 36308:case 36293:return mg;case 36289:case 36303:case 36311:case 36292:return v0}}(t.type)}}class GE{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const s=this.seq;for(let a=0,c=s.length;a!==c;++a){const u=s[a];u.setValue(e,t[u.id],i)}}}const b0=/(\w+)(\])?(\[|\.)?/g;function yh(d,e){d.seq.push(e),d.map[e.id]=e}function WE(d,e,t){const i=d.name,s=i.length;for(b0.lastIndex=0;;){const a=b0.exec(i);let u=a[1];const m=a[3];if("]"===a[2]&&(u|=0),void 0===m||"["===m&&b0.lastIndex+2===s){yh(t,void 0===m?new y0(u,d,e):new _0(u,d,e));break}{let y=t.map[u];void 0===y&&(y=new GE(u),yh(t,y)),t=y}}}class _h{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const a=e.getActiveUniform(t,s);WE(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,i,s){const a=this.map[t];void 0!==a&&a.setValue(e,i,s)}setOptional(e,t,i){const s=t[i];void 0!==s&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let a=0,c=t.length;a!==c;++a){const u=t[a],f=i[u.id];!1!==f.needsUpdate&&u.setValue(e,f.value,s)}}static seqWithValue(e,t){const i=[];for(let s=0,a=e.length;s!==a;++s){const c=e[s];c.id in t&&i.push(c)}return i}}function gg(d,e,t){const i=d.createShader(e);return d.shaderSource(i,t),d.compileShader(i),i}let x0=0;function bh(d,e,t){const i=d.getShaderParameter(e,d.COMPILE_STATUS),s=d.getShaderInfoLog(e).trim();if(i&&""===s)return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const c=parseInt(a[1]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function vg(d,e){const t=d.split("\n"),i=[],s=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let c=s;c<a;c++){const u=c+1;i.push(`${u===e?">":" "} ${u}: ${t[c]}`)}return i.join("\n")}(d.getShaderSource(e),c)}return s}function xh(d,e){const t=function E0(d){switch(d){case Dr:return["Linear","( value )"];case Gi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",d),["Linear","( value )"]}}(e);return"vec4 "+d+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function w0(d,e){let t;switch(e){case ki:t="Linear";break;case Ci:t="Reinhard";break;case ar:t="OptimizedCineon";break;case Rn:t="ACESFilmic";break;case mi:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+d+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Yc(d){return""!==d}function cd(d,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return d.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function S0(d,e){return d.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const C0=/^[ \t]*#include +<([\w\d./]+)>/gm;function _g(d){return d.replace(C0,YE)}const jE=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function YE(d,e){let t=Vi[e];if(void 0===t){const i=jE.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Vi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return _g(t)}const A0=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bg(d){return d.replace(A0,pp)}function pp(d,e,t,i){let s="";for(let a=parseInt(e);a<parseInt(t);a++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function mp(d){let e="precision "+d.precision+" float;\nprecision "+d.precision+" int;";return"highp"===d.precision?e+="\n#define HIGH_PRECISION":"mediump"===d.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===d.precision&&(e+="\n#define LOW_PRECISION"),e}function gp(d,e,t,i){const s=d.getContext(),a=t.defines;let c=t.vertexShader,u=t.fragmentShader;const f=function ud(d){let e="SHADOWMAP_TYPE_BASIC";return d.shadowMapType===je?e="SHADOWMAP_TYPE_PCF":d.shadowMapType===Rt?e="SHADOWMAP_TYPE_PCF_SOFT":d.shadowMapType===Ze&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function qE(d){let e="ENVMAP_TYPE_CUBE";if(d.envMap)switch(d.envMapMode){case Sr:case Fr:e="ENVMAP_TYPE_CUBE";break;case fr:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function XE(d){let e="ENVMAP_MODE_REFLECTION";return d.envMap&&d.envMapMode===Fr&&(e="ENVMAP_MODE_REFRACTION"),e}(t),y=function bA(d){let e="ENVMAP_BLENDING_NONE";if(d.envMap)switch(d.combine){case Ut:e="ENVMAP_BLENDING_MULTIPLY";break;case ti:e="ENVMAP_BLENDING_MIX";break;case li:e="ENVMAP_BLENDING_ADD"}return e}(t),_=function KE(d){const e=d.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),x=t.isWebGL2?"":function yg(d){return[d.extensionDerivatives||d.envMapCubeUVHeight||d.bumpMap||d.normalMapTangentSpace||d.clearcoatNormalMap||d.flatShading||"physical"===d.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(d.extensionFragDepth||d.logarithmicDepthBuffer)&&d.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",d.extensionDrawBuffers&&d.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(d.extensionShaderTextureLOD||d.envMap||d.transmission)&&d.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Yc).join("\n")}(t),M=function fp(d){const e=[];for(const t in d){const i=d[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(a),P=s.createProgram();let C,A,F=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(C=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Yc).join("\n"),C.length>0&&(C+="\n"),A=[x,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Yc).join("\n"),A.length>0&&(A+="\n")):(C=[mp(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Yc).join("\n"),A=[x,mp(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+y:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Gn?"#define TONE_MAPPING":"",t.toneMapping!==Gn?Vi.tonemapping_pars_fragment:"",t.toneMapping!==Gn?w0("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Vi.colorspace_pars_fragment,xh("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Yc).join("\n")),c=_g(c),c=cd(c,t),c=S0(c,t),u=_g(u),u=cd(u,t),u=S0(u,t),c=bg(c),u=bg(u),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(F="#version 300 es\n",C=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+C,A=["#define varying in",t.glslVersion===Pu?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Pu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+A);const W=F+A+u,Z=gg(s,s.VERTEX_SHADER,F+C+c),te=gg(s,s.FRAGMENT_SHADER,W);if(s.attachShader(P,Z),s.attachShader(P,te),void 0!==t.index0AttributeName?s.bindAttribLocation(P,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(P,0,"position"),s.linkProgram(P),d.debug.checkShaderErrors){const j=s.getProgramInfoLog(P).trim(),ne=s.getShaderInfoLog(Z).trim(),Ge=s.getShaderInfoLog(te).trim();let rt=!0,Me=!0;if(!1===s.getProgramParameter(P,s.LINK_STATUS))if(rt=!1,"function"==typeof d.debug.onShaderError)d.debug.onShaderError(s,P,Z,te);else{const Ae=bh(s,Z,"vertex"),Re=bh(s,te,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(P,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+j+"\n"+Ae+"\n"+Re)}else""!==j?console.warn("THREE.WebGLProgram: Program Info Log:",j):(""===ne||""===Ge)&&(Me=!1);Me&&(this.diagnostics={runnable:rt,programLog:j,vertexShader:{log:ne,prefix:C},fragmentShader:{log:Ge,prefix:A}})}let ee,le;return s.deleteShader(Z),s.deleteShader(te),this.getUniforms=function(){return void 0===ee&&(ee=new _h(s,P)),ee},this.getAttributes=function(){return void 0===le&&(le=function M0(d,e){const t={},i=d.getProgramParameter(e,d.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const a=d.getActiveAttrib(e,s),c=a.name;let u=1;a.type===d.FLOAT_MAT2&&(u=2),a.type===d.FLOAT_MAT3&&(u=3),a.type===d.FLOAT_MAT4&&(u=4),t[c]={type:a.type,location:d.getAttribLocation(e,c),locationSize:u}}return t}(s,P)),le},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(P),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=x0++,this.cacheKey=e,this.usedTimes=1,this.program=P,this.vertexShader=Z,this.fragmentShader=te,this}let xg=0;class T0{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,s=this._getShaderStage(e.vertexShader),a=this._getShaderStage(i),c=this._getShaderCacheForMaterial(e);return!1===c.has(s)&&(c.add(s),s.usedTimes++),!1===c.has(a)&&(c.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new D0(e),t.set(e,i)),i}}class D0{constructor(e){this.id=xg++,this.code=e,this.usedTimes=0}}function I0(d,e,t,i,s,a,c){const u=new Fu,f=new T0,m=[],v=s.isWebGL2,y=s.logarithmicDepthBuffer,_=s.vertexTextures;let x=s.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function P(j){return 0===j?"uv":`uv${j}`}return{getParameters:function C(j,ne,Ge,rt,Me){const Ae=rt.fog,Re=Me.geometry,xt=(j.isMeshStandardMaterial?t:e).get(j.envMap||(j.isMeshStandardMaterial?rt.environment:null)),St=xt&&xt.mapping===fr?xt.image.height:null,Mt=M[j.type];null!==j.precision&&(x=s.getMaxPrecision(j.precision),x!==j.precision&&console.warn("THREE.WebGLProgram.getParameters:",j.precision,"not supported, using",x,"instead."));const Bt=Re.morphAttributes.position||Re.morphAttributes.normal||Re.morphAttributes.color,pt=void 0!==Bt?Bt.length:0;let pn,bn,Dn,Bn,ht=0;if(void 0!==Re.morphAttributes.position&&(ht=1),void 0!==Re.morphAttributes.normal&&(ht=2),void 0!==Re.morphAttributes.color&&(ht=3),Mt){const hr=Tl[Mt];pn=hr.vertexShader,bn=hr.fragmentShader}else pn=j.vertexShader,bn=j.fragmentShader,f.update(j),Dn=f.getVertexShaderID(j),Bn=f.getFragmentShaderID(j);const jn=d.getRenderTarget(),ei=!0===Me.isInstancedMesh,zi=!!j.map,di=!!xt,Ve=!!j.aoMap,Cn=!!j.lightMap,nn=!!j.bumpMap,An=!!j.normalMap,fn=!!j.displacementMap,gi=!!j.emissiveMap,ri=!!j.metalnessMap,si=!!j.roughnessMap,Ti=j.anisotropy>0,br=j.clearcoat>0,ys=j.iridescence>0,Te=j.sheen>0,fe=j.transmission>0,Ot=Ti&&!!j.anisotropyMap,Tn=br&&!!j.clearcoatMap,mn=br&&!!j.clearcoatNormalMap,In=br&&!!j.clearcoatRoughnessMap,vi=ys&&!!j.iridescenceMap,Pn=ys&&!!j.iridescenceThicknessMap,zt=Te&&!!j.sheenColorMap,We=Te&&!!j.sheenRoughnessMap,hn=!!j.specularMap,Zn=!!j.specularColorMap,Un=!!j.specularIntensityMap,Xn=fe&&!!j.transmissionMap,ji=fe&&!!j.thicknessMap,nt=!!j.alphaMap,wn=!!j.extensions,zn=!!Re.attributes.uv1,gr=!!Re.attributes.uv2,Wr=!!Re.attributes.uv3;let rs=Gn;return j.toneMapped&&(null===jn||!0===jn.isXRRenderTarget)&&(rs=d.toneMapping),{isWebGL2:v,shaderID:Mt,shaderType:j.type,shaderName:j.name,vertexShader:pn,fragmentShader:bn,defines:j.defines,customVertexShaderID:Dn,customFragmentShaderID:Bn,isRawShaderMaterial:!0===j.isRawShaderMaterial,glslVersion:j.glslVersion,precision:x,instancing:ei,instancingColor:ei&&null!==Me.instanceColor,supportsVertexTextures:_,outputColorSpace:null===jn?d.outputColorSpace:!0===jn.isXRRenderTarget?jn.texture.colorSpace:Dr,map:zi,matcap:!!j.matcap,envMap:di,envMapMode:di&&xt.mapping,envMapCubeUVHeight:St,aoMap:Ve,lightMap:Cn,bumpMap:nn,normalMap:An,displacementMap:_&&fn,emissiveMap:gi,normalMapObjectSpace:An&&1===j.normalMapType,normalMapTangentSpace:An&&0===j.normalMapType,metalnessMap:ri,roughnessMap:si,anisotropy:Ti,anisotropyMap:Ot,clearcoat:br,clearcoatMap:Tn,clearcoatNormalMap:mn,clearcoatRoughnessMap:In,iridescence:ys,iridescenceMap:vi,iridescenceThicknessMap:Pn,sheen:Te,sheenColorMap:zt,sheenRoughnessMap:We,specularMap:hn,specularColorMap:Zn,specularIntensityMap:Un,transmission:fe,transmissionMap:Xn,thicknessMap:ji,gradientMap:!!j.gradientMap,opaque:!1===j.transparent&&1===j.blending,alphaMap:nt,alphaTest:j.alphaTest>0,alphaHash:!!j.alphaHash,combine:j.combine,mapUv:zi&&P(j.map.channel),aoMapUv:Ve&&P(j.aoMap.channel),lightMapUv:Cn&&P(j.lightMap.channel),bumpMapUv:nn&&P(j.bumpMap.channel),normalMapUv:An&&P(j.normalMap.channel),displacementMapUv:fn&&P(j.displacementMap.channel),emissiveMapUv:gi&&P(j.emissiveMap.channel),metalnessMapUv:ri&&P(j.metalnessMap.channel),roughnessMapUv:si&&P(j.roughnessMap.channel),anisotropyMapUv:Ot&&P(j.anisotropyMap.channel),clearcoatMapUv:Tn&&P(j.clearcoatMap.channel),clearcoatNormalMapUv:mn&&P(j.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:In&&P(j.clearcoatRoughnessMap.channel),iridescenceMapUv:vi&&P(j.iridescenceMap.channel),iridescenceThicknessMapUv:Pn&&P(j.iridescenceThicknessMap.channel),sheenColorMapUv:zt&&P(j.sheenColorMap.channel),sheenRoughnessMapUv:We&&P(j.sheenRoughnessMap.channel),specularMapUv:hn&&P(j.specularMap.channel),specularColorMapUv:Zn&&P(j.specularColorMap.channel),specularIntensityMapUv:Un&&P(j.specularIntensityMap.channel),transmissionMapUv:Xn&&P(j.transmissionMap.channel),thicknessMapUv:ji&&P(j.thicknessMap.channel),alphaMapUv:nt&&P(j.alphaMap.channel),vertexTangents:!!Re.attributes.tangent&&(An||Ti),vertexColors:j.vertexColors,vertexAlphas:!0===j.vertexColors&&!!Re.attributes.color&&4===Re.attributes.color.itemSize,vertexUv1s:zn,vertexUv2s:gr,vertexUv3s:Wr,pointsUvs:!0===Me.isPoints&&!!Re.attributes.uv&&(zi||nt),fog:!!Ae,useFog:!0===j.fog,fogExp2:Ae&&Ae.isFogExp2,flatShading:!0===j.flatShading,sizeAttenuation:!0===j.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===Me.isSkinnedMesh,morphTargets:void 0!==Re.morphAttributes.position,morphNormals:void 0!==Re.morphAttributes.normal,morphColors:void 0!==Re.morphAttributes.color,morphTargetsCount:pt,morphTextureStride:ht,numDirLights:ne.directional.length,numPointLights:ne.point.length,numSpotLights:ne.spot.length,numSpotLightMaps:ne.spotLightMap.length,numRectAreaLights:ne.rectArea.length,numHemiLights:ne.hemi.length,numDirLightShadows:ne.directionalShadowMap.length,numPointLightShadows:ne.pointShadowMap.length,numSpotLightShadows:ne.spotShadowMap.length,numSpotLightShadowsWithMaps:ne.numSpotLightShadowsWithMaps,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:j.dithering,shadowMapEnabled:d.shadowMap.enabled&&Ge.length>0,shadowMapType:d.shadowMap.type,toneMapping:rs,useLegacyLights:d._useLegacyLights,decodeVideoTexture:zi&&!0===j.map.isVideoTexture&&j.map.colorSpace===Gi,premultipliedAlpha:j.premultipliedAlpha,doubleSided:2===j.side,flipSided:1===j.side,useDepthPacking:j.depthPacking>=0,depthPacking:j.depthPacking||0,index0AttributeName:j.index0AttributeName,extensionDerivatives:wn&&!0===j.extensions.derivatives,extensionFragDepth:wn&&!0===j.extensions.fragDepth,extensionDrawBuffers:wn&&!0===j.extensions.drawBuffers,extensionShaderTextureLOD:wn&&!0===j.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||i.has("EXT_shader_texture_lod"),customProgramCacheKey:j.customProgramCacheKey()}},getProgramCacheKey:function A(j){const ne=[];if(j.shaderID?ne.push(j.shaderID):(ne.push(j.customVertexShaderID),ne.push(j.customFragmentShaderID)),void 0!==j.defines)for(const Ge in j.defines)ne.push(Ge),ne.push(j.defines[Ge]);return!1===j.isRawShaderMaterial&&(function F(j,ne){j.push(ne.precision),j.push(ne.outputColorSpace),j.push(ne.envMapMode),j.push(ne.envMapCubeUVHeight),j.push(ne.mapUv),j.push(ne.alphaMapUv),j.push(ne.lightMapUv),j.push(ne.aoMapUv),j.push(ne.bumpMapUv),j.push(ne.normalMapUv),j.push(ne.displacementMapUv),j.push(ne.emissiveMapUv),j.push(ne.metalnessMapUv),j.push(ne.roughnessMapUv),j.push(ne.anisotropyMapUv),j.push(ne.clearcoatMapUv),j.push(ne.clearcoatNormalMapUv),j.push(ne.clearcoatRoughnessMapUv),j.push(ne.iridescenceMapUv),j.push(ne.iridescenceThicknessMapUv),j.push(ne.sheenColorMapUv),j.push(ne.sheenRoughnessMapUv),j.push(ne.specularMapUv),j.push(ne.specularColorMapUv),j.push(ne.specularIntensityMapUv),j.push(ne.transmissionMapUv),j.push(ne.thicknessMapUv),j.push(ne.combine),j.push(ne.fogExp2),j.push(ne.sizeAttenuation),j.push(ne.morphTargetsCount),j.push(ne.morphAttributeCount),j.push(ne.numDirLights),j.push(ne.numPointLights),j.push(ne.numSpotLights),j.push(ne.numSpotLightMaps),j.push(ne.numHemiLights),j.push(ne.numRectAreaLights),j.push(ne.numDirLightShadows),j.push(ne.numPointLightShadows),j.push(ne.numSpotLightShadows),j.push(ne.numSpotLightShadowsWithMaps),j.push(ne.shadowMapType),j.push(ne.toneMapping),j.push(ne.numClippingPlanes),j.push(ne.numClipIntersection),j.push(ne.depthPacking)}(ne,j),function N(j,ne){u.disableAll(),ne.isWebGL2&&u.enable(0),ne.supportsVertexTextures&&u.enable(1),ne.instancing&&u.enable(2),ne.instancingColor&&u.enable(3),ne.matcap&&u.enable(4),ne.envMap&&u.enable(5),ne.normalMapObjectSpace&&u.enable(6),ne.normalMapTangentSpace&&u.enable(7),ne.clearcoat&&u.enable(8),ne.iridescence&&u.enable(9),ne.alphaTest&&u.enable(10),ne.vertexColors&&u.enable(11),ne.vertexAlphas&&u.enable(12),ne.vertexUv1s&&u.enable(13),ne.vertexUv2s&&u.enable(14),ne.vertexUv3s&&u.enable(15),ne.vertexTangents&&u.enable(16),ne.anisotropy&&u.enable(17),j.push(u.mask),u.disableAll(),ne.fog&&u.enable(0),ne.useFog&&u.enable(1),ne.flatShading&&u.enable(2),ne.logarithmicDepthBuffer&&u.enable(3),ne.skinning&&u.enable(4),ne.morphTargets&&u.enable(5),ne.morphNormals&&u.enable(6),ne.morphColors&&u.enable(7),ne.premultipliedAlpha&&u.enable(8),ne.shadowMapEnabled&&u.enable(9),ne.useLegacyLights&&u.enable(10),ne.doubleSided&&u.enable(11),ne.flipSided&&u.enable(12),ne.useDepthPacking&&u.enable(13),ne.dithering&&u.enable(14),ne.transmission&&u.enable(15),ne.sheen&&u.enable(16),ne.opaque&&u.enable(17),ne.pointsUvs&&u.enable(18),ne.decodeVideoTexture&&u.enable(19),j.push(u.mask)}(ne,j),ne.push(d.outputColorSpace)),ne.push(j.customProgramCacheKey),ne.join()},getUniforms:function W(j){const ne=M[j.type];let Ge;return Ge=ne?Vf.clone(Tl[ne].uniforms):j.uniforms,Ge},acquireProgram:function Z(j,ne){let Ge;for(let rt=0,Me=m.length;rt<Me;rt++){const Ae=m[rt];if(Ae.cacheKey===ne){Ge=Ae,++Ge.usedTimes;break}}return void 0===Ge&&(Ge=new gp(d,ne,j,a),m.push(Ge)),Ge},releaseProgram:function te(j){if(0==--j.usedTimes){const ne=m.indexOf(j);m[ne]=m[m.length-1],m.pop(),j.destroy()}},releaseShaderCache:function ee(j){f.remove(j)},programs:m,dispose:function le(){f.dispose()}}}function R0(){let d=new WeakMap;return{get:function e(a){let c=d.get(a);return void 0===c&&(c={},d.set(a,c)),c},remove:function t(a){d.delete(a)},update:function i(a,c,u){d.get(a)[c]=u},dispose:function s(){d=new WeakMap}}}function ZE(d,e){return d.groupOrder!==e.groupOrder?d.groupOrder-e.groupOrder:d.renderOrder!==e.renderOrder?d.renderOrder-e.renderOrder:d.material.id!==e.material.id?d.material.id-e.material.id:d.z!==e.z?d.z-e.z:d.id-e.id}function P0(d,e){return d.groupOrder!==e.groupOrder?d.groupOrder-e.groupOrder:d.renderOrder!==e.renderOrder?d.renderOrder-e.renderOrder:d.z!==e.z?e.z-d.z:d.id-e.id}function L0(){const d=[];let e=0;const t=[],i=[],s=[];function c(y,_,x,M,P,C){let A=d[e];return void 0===A?(A={id:y.id,object:y,geometry:_,material:x,groupOrder:M,renderOrder:y.renderOrder,z:P,group:C},d[e]=A):(A.id=y.id,A.object=y,A.geometry=_,A.material=x,A.groupOrder=M,A.renderOrder=y.renderOrder,A.z=P,A.group=C),e++,A}return{opaque:t,transmissive:i,transparent:s,init:function a(){e=0,t.length=0,i.length=0,s.length=0},push:function u(y,_,x,M,P,C){const A=c(y,_,x,M,P,C);x.transmission>0?i.push(A):!0===x.transparent?s.push(A):t.push(A)},unshift:function f(y,_,x,M,P,C){const A=c(y,_,x,M,P,C);x.transmission>0?i.unshift(A):!0===x.transparent?s.unshift(A):t.unshift(A)},finish:function v(){for(let y=e,_=d.length;y<_;y++){const x=d[y];if(null===x.id)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}},sort:function m(y,_){t.length>1&&t.sort(y||ZE),i.length>1&&i.sort(_||P0),s.length>1&&s.sort(_||P0)}}}function JE(){let d=new WeakMap;return{get:function e(i,s){const a=d.get(i);let c;return void 0===a?(c=new L0,d.set(i,[c])):s>=a.length?(c=new L0,a.push(c)):c=a[s],c},dispose:function t(){d=new WeakMap}}}function QE(){const d={};return{get:function(e){if(void 0!==d[e.id])return d[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new he,color:new Yn};break;case"SpotLight":t={position:new he,direction:new he,color:new Yn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new he,color:new Yn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new he,skyColor:new Yn,groundColor:new Yn};break;case"RectAreaLight":t={color:new Yn,position:new he,halfWidth:new he,halfHeight:new he}}return d[e.id]=t,t}}}let Eh=0;function ew(d,e){return(e.castShadow?2:0)-(d.castShadow?2:0)+(e.map?1:0)-(d.map?1:0)}function xA(d,e){const t=new QE,i=function oc(){const d={};return{get:function(e){if(void 0!==d[e.id])return d[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3}}return d[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)s.probe.push(new he);const a=new he,c=new _i,u=new _i;return{setup:function f(v,y){let _=0,x=0,M=0;for(let Ge=0;Ge<9;Ge++)s.probe[Ge].set(0,0,0);let P=0,C=0,A=0,F=0,N=0,W=0,Z=0,te=0,ee=0,le=0;v.sort(ew);const j=!0===y?Math.PI:1;for(let Ge=0,rt=v.length;Ge<rt;Ge++){const Me=v[Ge],Ae=Me.color,Re=Me.intensity,He=Me.distance,xt=Me.shadow&&Me.shadow.map?Me.shadow.map.texture:null;if(Me.isAmbientLight)_+=Ae.r*Re*j,x+=Ae.g*Re*j,M+=Ae.b*Re*j;else if(Me.isLightProbe)for(let St=0;St<9;St++)s.probe[St].addScaledVector(Me.sh.coefficients[St],Re);else if(Me.isDirectionalLight){const St=t.get(Me);if(St.color.copy(Me.color).multiplyScalar(Me.intensity*j),Me.castShadow){const Mt=Me.shadow,Bt=i.get(Me);Bt.shadowBias=Mt.bias,Bt.shadowNormalBias=Mt.normalBias,Bt.shadowRadius=Mt.radius,Bt.shadowMapSize=Mt.mapSize,s.directionalShadow[P]=Bt,s.directionalShadowMap[P]=xt,s.directionalShadowMatrix[P]=Me.shadow.matrix,W++}s.directional[P]=St,P++}else if(Me.isSpotLight){const St=t.get(Me);St.position.setFromMatrixPosition(Me.matrixWorld),St.color.copy(Ae).multiplyScalar(Re*j),St.distance=He,St.coneCos=Math.cos(Me.angle),St.penumbraCos=Math.cos(Me.angle*(1-Me.penumbra)),St.decay=Me.decay,s.spot[A]=St;const Mt=Me.shadow;if(Me.map&&(s.spotLightMap[ee]=Me.map,ee++,Mt.updateMatrices(Me),Me.castShadow&&le++),s.spotLightMatrix[A]=Mt.matrix,Me.castShadow){const Bt=i.get(Me);Bt.shadowBias=Mt.bias,Bt.shadowNormalBias=Mt.normalBias,Bt.shadowRadius=Mt.radius,Bt.shadowMapSize=Mt.mapSize,s.spotShadow[A]=Bt,s.spotShadowMap[A]=xt,te++}A++}else if(Me.isRectAreaLight){const St=t.get(Me);St.color.copy(Ae).multiplyScalar(Re),St.halfWidth.set(.5*Me.width,0,0),St.halfHeight.set(0,.5*Me.height,0),s.rectArea[F]=St,F++}else if(Me.isPointLight){const St=t.get(Me);if(St.color.copy(Me.color).multiplyScalar(Me.intensity*j),St.distance=Me.distance,St.decay=Me.decay,Me.castShadow){const Mt=Me.shadow,Bt=i.get(Me);Bt.shadowBias=Mt.bias,Bt.shadowNormalBias=Mt.normalBias,Bt.shadowRadius=Mt.radius,Bt.shadowMapSize=Mt.mapSize,Bt.shadowCameraNear=Mt.camera.near,Bt.shadowCameraFar=Mt.camera.far,s.pointShadow[C]=Bt,s.pointShadowMap[C]=xt,s.pointShadowMatrix[C]=Me.shadow.matrix,Z++}s.point[C]=St,C++}else if(Me.isHemisphereLight){const St=t.get(Me);St.skyColor.copy(Me.color).multiplyScalar(Re*j),St.groundColor.copy(Me.groundColor).multiplyScalar(Re*j),s.hemi[N]=St,N++}}F>0&&(e.isWebGL2||!0===d.has("OES_texture_float_linear")?(s.rectAreaLTC1=Vn.LTC_FLOAT_1,s.rectAreaLTC2=Vn.LTC_FLOAT_2):!0===d.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=Vn.LTC_HALF_1,s.rectAreaLTC2=Vn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=_,s.ambient[1]=x,s.ambient[2]=M;const ne=s.hash;(ne.directionalLength!==P||ne.pointLength!==C||ne.spotLength!==A||ne.rectAreaLength!==F||ne.hemiLength!==N||ne.numDirectionalShadows!==W||ne.numPointShadows!==Z||ne.numSpotShadows!==te||ne.numSpotMaps!==ee)&&(s.directional.length=P,s.spot.length=A,s.rectArea.length=F,s.point.length=C,s.hemi.length=N,s.directionalShadow.length=W,s.directionalShadowMap.length=W,s.pointShadow.length=Z,s.pointShadowMap.length=Z,s.spotShadow.length=te,s.spotShadowMap.length=te,s.directionalShadowMatrix.length=W,s.pointShadowMatrix.length=Z,s.spotLightMatrix.length=te+ee-le,s.spotLightMap.length=ee,s.numSpotLightShadowsWithMaps=le,ne.directionalLength=P,ne.pointLength=C,ne.spotLength=A,ne.rectAreaLength=F,ne.hemiLength=N,ne.numDirectionalShadows=W,ne.numPointShadows=Z,ne.numSpotShadows=te,ne.numSpotMaps=ee,s.version=Eh++)},setupView:function m(v,y){let _=0,x=0,M=0,P=0,C=0;const A=y.matrixWorldInverse;for(let F=0,N=v.length;F<N;F++){const W=v[F];if(W.isDirectionalLight){const Z=s.directional[_];Z.direction.setFromMatrixPosition(W.matrixWorld),a.setFromMatrixPosition(W.target.matrixWorld),Z.direction.sub(a),Z.direction.transformDirection(A),_++}else if(W.isSpotLight){const Z=s.spot[M];Z.position.setFromMatrixPosition(W.matrixWorld),Z.position.applyMatrix4(A),Z.direction.setFromMatrixPosition(W.matrixWorld),a.setFromMatrixPosition(W.target.matrixWorld),Z.direction.sub(a),Z.direction.transformDirection(A),M++}else if(W.isRectAreaLight){const Z=s.rectArea[P];Z.position.setFromMatrixPosition(W.matrixWorld),Z.position.applyMatrix4(A),u.identity(),c.copy(W.matrixWorld),c.premultiply(A),u.extractRotation(c),Z.halfWidth.set(.5*W.width,0,0),Z.halfHeight.set(0,.5*W.height,0),Z.halfWidth.applyMatrix4(u),Z.halfHeight.applyMatrix4(u),P++}else if(W.isPointLight){const Z=s.point[x];Z.position.setFromMatrixPosition(W.matrixWorld),Z.position.applyMatrix4(A),x++}else if(W.isHemisphereLight){const Z=s.hemi[C];Z.direction.setFromMatrixPosition(W.matrixWorld),Z.direction.transformDirection(A),C++}}},state:s}}function tw(d,e){const t=new xA(d,e),i=[],s=[];return{init:function a(){i.length=0,s.length=0},state:{lightsArray:i,shadowsArray:s,lights:t},setupLights:function f(y){t.setup(i,y)},setupLightsView:function m(y){t.setupView(i,y)},pushLight:function c(y){i.push(y)},pushShadow:function u(y){s.push(y)}}}function EA(d,e){let t=new WeakMap;return{get:function i(a,c=0){const u=t.get(a);let f;return void 0===u?(f=new tw(d,e),t.set(a,[f])):c>=u.length?(f=new tw(d,e),u.push(f)):f=u[c],f},dispose:function s(){t=new WeakMap}}}class nw extends Go{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class iw extends Go{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function sw(d,e,t){let i=new Wf;const s=new Jt,a=new Jt,c=new zr,u=new nw({depthPacking:3201}),f=new iw,m={},v=t.maxTextureSize,y={0:1,1:0,2:2},_=new Al({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const M=new Zi;M.setAttribute("position",new J(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const P=new Xr(M,_),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=je;let A=this.type;function F(Z,te){const ee=e.update(P);_.defines.VSM_SAMPLES!==Z.blurSamples&&(_.defines.VSM_SAMPLES=Z.blurSamples,x.defines.VSM_SAMPLES=Z.blurSamples,_.needsUpdate=!0,x.needsUpdate=!0),null===Z.mapPass&&(Z.mapPass=new H(s.x,s.y)),_.uniforms.shadow_pass.value=Z.map.texture,_.uniforms.resolution.value=Z.mapSize,_.uniforms.radius.value=Z.radius,d.setRenderTarget(Z.mapPass),d.clear(),d.renderBufferDirect(te,null,ee,_,P,null),x.uniforms.shadow_pass.value=Z.mapPass.texture,x.uniforms.resolution.value=Z.mapSize,x.uniforms.radius.value=Z.radius,d.setRenderTarget(Z.map),d.clear(),d.renderBufferDirect(te,null,ee,x,P,null)}function N(Z,te,ee,le){let j=null;const ne=!0===ee.isPointLight?Z.customDistanceMaterial:Z.customDepthMaterial;if(void 0!==ne)j=ne;else if(j=!0===ee.isPointLight?f:u,d.localClippingEnabled&&!0===te.clipShadows&&Array.isArray(te.clippingPlanes)&&0!==te.clippingPlanes.length||te.displacementMap&&0!==te.displacementScale||te.alphaMap&&te.alphaTest>0||te.map&&te.alphaTest>0){const Ge=j.uuid,rt=te.uuid;let Me=m[Ge];void 0===Me&&(Me={},m[Ge]=Me);let Ae=Me[rt];void 0===Ae&&(Ae=j.clone(),Me[rt]=Ae),j=Ae}return j.visible=te.visible,j.wireframe=te.wireframe,j.side=le===Ze?null!==te.shadowSide?te.shadowSide:te.side:null!==te.shadowSide?te.shadowSide:y[te.side],j.alphaMap=te.alphaMap,j.alphaTest=te.alphaTest,j.map=te.map,j.clipShadows=te.clipShadows,j.clippingPlanes=te.clippingPlanes,j.clipIntersection=te.clipIntersection,j.displacementMap=te.displacementMap,j.displacementScale=te.displacementScale,j.displacementBias=te.displacementBias,j.wireframeLinewidth=te.wireframeLinewidth,j.linewidth=te.linewidth,!0===ee.isPointLight&&!0===j.isMeshDistanceMaterial&&(d.properties.get(j).light=ee),j}function W(Z,te,ee,le,j){if(!1===Z.visible)return;if(Z.layers.test(te.layers)&&(Z.isMesh||Z.isLine||Z.isPoints)&&(Z.castShadow||Z.receiveShadow&&j===Ze)&&(!Z.frustumCulled||i.intersectsObject(Z))){Z.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,Z.matrixWorld);const rt=e.update(Z),Me=Z.material;if(Array.isArray(Me)){const Ae=rt.groups;for(let Re=0,He=Ae.length;Re<He;Re++){const xt=Ae[Re],St=Me[xt.materialIndex];if(St&&St.visible){const Mt=N(Z,St,le,j);d.renderBufferDirect(ee,null,rt,Mt,Z,xt)}}}else if(Me.visible){const Ae=N(Z,Me,le,j);d.renderBufferDirect(ee,null,rt,Ae,Z,null)}}const Ge=Z.children;for(let rt=0,Me=Ge.length;rt<Me;rt++)W(Ge[rt],te,ee,le,j)}this.render=function(Z,te,ee){if(!1===C.enabled||!1===C.autoUpdate&&!1===C.needsUpdate||0===Z.length)return;const le=d.getRenderTarget(),j=d.getActiveCubeFace(),ne=d.getActiveMipmapLevel(),Ge=d.state;Ge.setBlending(0),Ge.buffers.color.setClear(1,1,1,1),Ge.buffers.depth.setTest(!0),Ge.setScissorTest(!1);const rt=A!==Ze&&this.type===Ze,Me=A===Ze&&this.type!==Ze;for(let Ae=0,Re=Z.length;Ae<Re;Ae++){const He=Z[Ae],xt=He.shadow;if(void 0===xt){console.warn("THREE.WebGLShadowMap:",He,"has no shadow.");continue}if(!1===xt.autoUpdate&&!1===xt.needsUpdate)continue;s.copy(xt.mapSize);const St=xt.getFrameExtents();if(s.multiply(St),a.copy(xt.mapSize),(s.x>v||s.y>v)&&(s.x>v&&(a.x=Math.floor(v/St.x),s.x=a.x*St.x,xt.mapSize.x=a.x),s.y>v&&(a.y=Math.floor(v/St.y),s.y=a.y*St.y,xt.mapSize.y=a.y)),null===xt.map||!0===rt||!0===Me){const Bt=this.type!==Ze?{minFilter:Jn,magFilter:Jn}:{};null!==xt.map&&xt.map.dispose(),xt.map=new H(s.x,s.y,Bt),xt.map.texture.name=He.name+".shadowMap",xt.camera.updateProjectionMatrix()}d.setRenderTarget(xt.map),d.clear();const Mt=xt.getViewportCount();for(let Bt=0;Bt<Mt;Bt++){const pt=xt.getViewport(Bt);c.set(a.x*pt.x,a.y*pt.y,a.x*pt.z,a.y*pt.w),Ge.viewport(c),xt.updateMatrices(He,Bt),i=xt.getFrustum(),W(te,ee,xt.camera,He,this.type)}!0!==xt.isPointLightShadow&&this.type===Ze&&F(xt,ee),xt.needsUpdate=!1}A=this.type,C.needsUpdate=!1,d.setRenderTarget(le,j,ne)}}function ow(d,e,t){const i=t.isWebGL2,u=new function s(){let nt=!1;const Kn=new zr;let Ht=null;const wn=new zr(0,0,0,0);return{setMask:function(zn){Ht!==zn&&!nt&&(d.colorMask(zn,zn,zn,zn),Ht=zn)},setLocked:function(zn){nt=zn},setClear:function(zn,gr,Wr,rs,Ea){!0===Ea&&(zn*=rs,gr*=rs,Wr*=rs),Kn.set(zn,gr,Wr,rs),!1===wn.equals(Kn)&&(d.clearColor(zn,gr,Wr,rs),wn.copy(Kn))},reset:function(){nt=!1,Ht=null,wn.set(-1,0,0,0)}}},f=new function a(){let nt=!1,Kn=null,Ht=null,wn=null;return{setTest:function(zn){zn?jn(d.DEPTH_TEST):ei(d.DEPTH_TEST)},setMask:function(zn){Kn!==zn&&!nt&&(d.depthMask(zn),Kn=zn)},setFunc:function(zn){if(Ht!==zn){switch(zn){case 0:d.depthFunc(d.NEVER);break;case 1:d.depthFunc(d.ALWAYS);break;case 2:d.depthFunc(d.LESS);break;case 3:default:d.depthFunc(d.LEQUAL);break;case 4:d.depthFunc(d.EQUAL);break;case 5:d.depthFunc(d.GEQUAL);break;case 6:d.depthFunc(d.GREATER);break;case 7:d.depthFunc(d.NOTEQUAL)}Ht=zn}},setLocked:function(zn){nt=zn},setClear:function(zn){wn!==zn&&(d.clearDepth(zn),wn=zn)},reset:function(){nt=!1,Kn=null,Ht=null,wn=null}}},m=new function c(){let nt=!1,Kn=null,Ht=null,wn=null,zn=null,gr=null,Wr=null,rs=null,Ea=null;return{setTest:function(hr){nt||(hr?jn(d.STENCIL_TEST):ei(d.STENCIL_TEST))},setMask:function(hr){Kn!==hr&&!nt&&(d.stencilMask(hr),Kn=hr)},setFunc:function(hr,Ko,Zo){(Ht!==hr||wn!==Ko||zn!==Zo)&&(d.stencilFunc(hr,Ko,Zo),Ht=hr,wn=Ko,zn=Zo)},setOp:function(hr,Ko,Zo){(gr!==hr||Wr!==Ko||rs!==Zo)&&(d.stencilOp(hr,Ko,Zo),gr=hr,Wr=Ko,rs=Zo)},setLocked:function(hr){nt=hr},setClear:function(hr){Ea!==hr&&(d.clearStencil(hr),Ea=hr)},reset:function(){nt=!1,Kn=null,Ht=null,wn=null,zn=null,gr=null,Wr=null,rs=null,Ea=null}}},v=new WeakMap,y=new WeakMap;let _={},x={},M=new WeakMap,P=[],C=null,A=!1,F=null,N=null,W=null,Z=null,te=null,ee=null,le=null,j=!1,ne=null,Ge=null,rt=null,Me=null,Ae=null;const Re=d.getParameter(d.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let He=!1,xt=0;const St=d.getParameter(d.VERSION);-1!==St.indexOf("WebGL")?(xt=parseFloat(/^WebGL (\d)/.exec(St)[1]),He=xt>=1):-1!==St.indexOf("OpenGL ES")&&(xt=parseFloat(/^OpenGL ES (\d)/.exec(St)[1]),He=xt>=2);let Mt=null,Bt={};const pt=d.getParameter(d.SCISSOR_BOX),ht=d.getParameter(d.VIEWPORT),pn=(new zr).fromArray(pt),bn=(new zr).fromArray(ht);function Dn(nt,Kn,Ht,wn){const zn=new Uint8Array(4),gr=d.createTexture();d.bindTexture(nt,gr),d.texParameteri(nt,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(nt,d.TEXTURE_MAG_FILTER,d.NEAREST);for(let Wr=0;Wr<Ht;Wr++)!i||nt!==d.TEXTURE_3D&&nt!==d.TEXTURE_2D_ARRAY?d.texImage2D(Kn+Wr,0,d.RGBA,1,1,0,d.RGBA,d.UNSIGNED_BYTE,zn):d.texImage3D(Kn,0,d.RGBA,1,1,wn,0,d.RGBA,d.UNSIGNED_BYTE,zn);return gr}const Bn={};function jn(nt){!0!==_[nt]&&(d.enable(nt),_[nt]=!0)}function ei(nt){!1!==_[nt]&&(d.disable(nt),_[nt]=!1)}Bn[d.TEXTURE_2D]=Dn(d.TEXTURE_2D,d.TEXTURE_2D,1),Bn[d.TEXTURE_CUBE_MAP]=Dn(d.TEXTURE_CUBE_MAP,d.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Bn[d.TEXTURE_2D_ARRAY]=Dn(d.TEXTURE_2D_ARRAY,d.TEXTURE_2D_ARRAY,1,1),Bn[d.TEXTURE_3D]=Dn(d.TEXTURE_3D,d.TEXTURE_3D,1,1)),u.setClear(0,0,0,1),f.setClear(1),m.setClear(0),jn(d.DEPTH_TEST),f.setFunc(3),fn(!1),gi(1),jn(d.CULL_FACE),nn(0);const Ve={100:d.FUNC_ADD,101:d.FUNC_SUBTRACT,102:d.FUNC_REVERSE_SUBTRACT};if(i)Ve[103]=d.MIN,Ve[104]=d.MAX;else{const nt=e.get("EXT_blend_minmax");null!==nt&&(Ve[103]=nt.MIN_EXT,Ve[104]=nt.MAX_EXT)}const Cn={200:d.ZERO,201:d.ONE,202:d.SRC_COLOR,204:d.SRC_ALPHA,210:d.SRC_ALPHA_SATURATE,208:d.DST_COLOR,206:d.DST_ALPHA,203:d.ONE_MINUS_SRC_COLOR,205:d.ONE_MINUS_SRC_ALPHA,209:d.ONE_MINUS_DST_COLOR,207:d.ONE_MINUS_DST_ALPHA};function nn(nt,Kn,Ht,wn,zn,gr,Wr,rs){if(0!==nt){if(!1===A&&(jn(d.BLEND),A=!0),5===nt)zn=zn||Kn,gr=gr||Ht,Wr=Wr||wn,(Kn!==N||zn!==te)&&(d.blendEquationSeparate(Ve[Kn],Ve[zn]),N=Kn,te=zn),(Ht!==W||wn!==Z||gr!==ee||Wr!==le)&&(d.blendFuncSeparate(Cn[Ht],Cn[wn],Cn[gr],Cn[Wr]),W=Ht,Z=wn,ee=gr,le=Wr),F=nt,j=!1;else if(nt!==F||rs!==j){if((100!==N||100!==te)&&(d.blendEquation(d.FUNC_ADD),N=100,te=100),rs)switch(nt){case 1:d.blendFuncSeparate(d.ONE,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case 2:d.blendFunc(d.ONE,d.ONE);break;case 3:d.blendFuncSeparate(d.ZERO,d.ONE_MINUS_SRC_COLOR,d.ZERO,d.ONE);break;case 4:d.blendFuncSeparate(d.ZERO,d.SRC_COLOR,d.ZERO,d.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",nt)}else switch(nt){case 1:d.blendFuncSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case 2:d.blendFunc(d.SRC_ALPHA,d.ONE);break;case 3:d.blendFuncSeparate(d.ZERO,d.ONE_MINUS_SRC_COLOR,d.ZERO,d.ONE);break;case 4:d.blendFunc(d.ZERO,d.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",nt)}W=null,Z=null,ee=null,le=null,F=nt,j=rs}}else!0===A&&(ei(d.BLEND),A=!1)}function fn(nt){ne!==nt&&(d.frontFace(nt?d.CW:d.CCW),ne=nt)}function gi(nt){0!==nt?(jn(d.CULL_FACE),nt!==Ge&&d.cullFace(1===nt?d.BACK:2===nt?d.FRONT:d.FRONT_AND_BACK)):ei(d.CULL_FACE),Ge=nt}function si(nt,Kn,Ht){nt?(jn(d.POLYGON_OFFSET_FILL),(Me!==Kn||Ae!==Ht)&&(d.polygonOffset(Kn,Ht),Me=Kn,Ae=Ht)):ei(d.POLYGON_OFFSET_FILL)}return{buffers:{color:u,depth:f,stencil:m},enable:jn,disable:ei,bindFramebuffer:function zi(nt,Kn){return x[nt]!==Kn&&(d.bindFramebuffer(nt,Kn),x[nt]=Kn,i&&(nt===d.DRAW_FRAMEBUFFER&&(x[d.FRAMEBUFFER]=Kn),nt===d.FRAMEBUFFER&&(x[d.DRAW_FRAMEBUFFER]=Kn)),!0)},drawBuffers:function Ki(nt,Kn){let Ht=P,wn=!1;if(nt)if(Ht=M.get(Kn),void 0===Ht&&(Ht=[],M.set(Kn,Ht)),nt.isWebGLMultipleRenderTargets){const zn=nt.texture;if(Ht.length!==zn.length||Ht[0]!==d.COLOR_ATTACHMENT0){for(let gr=0,Wr=zn.length;gr<Wr;gr++)Ht[gr]=d.COLOR_ATTACHMENT0+gr;Ht.length=zn.length,wn=!0}}else Ht[0]!==d.COLOR_ATTACHMENT0&&(Ht[0]=d.COLOR_ATTACHMENT0,wn=!0);else Ht[0]!==d.BACK&&(Ht[0]=d.BACK,wn=!0);wn&&(t.isWebGL2?d.drawBuffers(Ht):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ht))},useProgram:function di(nt){return C!==nt&&(d.useProgram(nt),C=nt,!0)},setBlending:nn,setMaterial:function An(nt,Kn){2===nt.side?ei(d.CULL_FACE):jn(d.CULL_FACE);let Ht=1===nt.side;Kn&&(Ht=!Ht),fn(Ht),1===nt.blending&&!1===nt.transparent?nn(0):nn(nt.blending,nt.blendEquation,nt.blendSrc,nt.blendDst,nt.blendEquationAlpha,nt.blendSrcAlpha,nt.blendDstAlpha,nt.premultipliedAlpha),f.setFunc(nt.depthFunc),f.setTest(nt.depthTest),f.setMask(nt.depthWrite),u.setMask(nt.colorWrite);const wn=nt.stencilWrite;m.setTest(wn),wn&&(m.setMask(nt.stencilWriteMask),m.setFunc(nt.stencilFunc,nt.stencilRef,nt.stencilFuncMask),m.setOp(nt.stencilFail,nt.stencilZFail,nt.stencilZPass)),si(nt.polygonOffset,nt.polygonOffsetFactor,nt.polygonOffsetUnits),!0===nt.alphaToCoverage?jn(d.SAMPLE_ALPHA_TO_COVERAGE):ei(d.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:fn,setCullFace:gi,setLineWidth:function ri(nt){nt!==rt&&(He&&d.lineWidth(nt),rt=nt)},setPolygonOffset:si,setScissorTest:function Ti(nt){nt?jn(d.SCISSOR_TEST):ei(d.SCISSOR_TEST)},activeTexture:function br(nt){void 0===nt&&(nt=d.TEXTURE0+Re-1),Mt!==nt&&(d.activeTexture(nt),Mt=nt)},bindTexture:function ys(nt,Kn,Ht){void 0===Ht&&(Ht=null===Mt?d.TEXTURE0+Re-1:Mt);let wn=Bt[Ht];void 0===wn&&(wn={type:void 0,texture:void 0},Bt[Ht]=wn),(wn.type!==nt||wn.texture!==Kn)&&(Mt!==Ht&&(d.activeTexture(Ht),Mt=Ht),d.bindTexture(nt,Kn||Bn[nt]),wn.type=nt,wn.texture=Kn)},unbindTexture:function Te(){const nt=Bt[Mt];void 0!==nt&&void 0!==nt.type&&(d.bindTexture(nt.type,null),nt.type=void 0,nt.texture=void 0)},compressedTexImage2D:function fe(){try{d.compressedTexImage2D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexImage3D:function Ot(){try{d.compressedTexImage3D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texImage2D:function We(){try{d.texImage2D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texImage3D:function hn(){try{d.texImage3D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},updateUBOMapping:function Xn(nt,Kn){let Ht=y.get(Kn);void 0===Ht&&(Ht=new WeakMap,y.set(Kn,Ht));let wn=Ht.get(nt);void 0===wn&&(wn=d.getUniformBlockIndex(Kn,nt.name),Ht.set(nt,wn))},uniformBlockBinding:function ji(nt,Kn){const wn=y.get(Kn).get(nt);v.get(Kn)!==wn&&(d.uniformBlockBinding(Kn,wn,nt.__bindingPointIndex),v.set(Kn,wn))},texStorage2D:function Pn(){try{d.texStorage2D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texStorage3D:function zt(){try{d.texStorage3D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texSubImage2D:function Tn(){try{d.texSubImage2D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texSubImage3D:function mn(){try{d.texSubImage3D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexSubImage2D:function In(){try{d.compressedTexSubImage2D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexSubImage3D:function vi(){try{d.compressedTexSubImage3D.apply(d,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},scissor:function Zn(nt){!1===pn.equals(nt)&&(d.scissor(nt.x,nt.y,nt.z,nt.w),pn.copy(nt))},viewport:function Un(nt){!1===bn.equals(nt)&&(d.viewport(nt.x,nt.y,nt.z,nt.w),bn.copy(nt))},reset:function wr(){d.disable(d.BLEND),d.disable(d.CULL_FACE),d.disable(d.DEPTH_TEST),d.disable(d.POLYGON_OFFSET_FILL),d.disable(d.SCISSOR_TEST),d.disable(d.STENCIL_TEST),d.disable(d.SAMPLE_ALPHA_TO_COVERAGE),d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ZERO),d.blendFuncSeparate(d.ONE,d.ZERO,d.ONE,d.ZERO),d.colorMask(!0,!0,!0,!0),d.clearColor(0,0,0,0),d.depthMask(!0),d.depthFunc(d.LESS),d.clearDepth(1),d.stencilMask(4294967295),d.stencilFunc(d.ALWAYS,0,4294967295),d.stencilOp(d.KEEP,d.KEEP,d.KEEP),d.clearStencil(0),d.cullFace(d.BACK),d.frontFace(d.CCW),d.polygonOffset(0,0),d.activeTexture(d.TEXTURE0),d.bindFramebuffer(d.FRAMEBUFFER,null),!0===i&&(d.bindFramebuffer(d.DRAW_FRAMEBUFFER,null),d.bindFramebuffer(d.READ_FRAMEBUFFER,null)),d.useProgram(null),d.lineWidth(1),d.scissor(0,0,d.canvas.width,d.canvas.height),d.viewport(0,0,d.canvas.width,d.canvas.height),_={},Mt=null,Bt={},x={},M=new WeakMap,P=[],C=null,A=!1,F=null,N=null,W=null,Z=null,te=null,ee=null,le=null,j=!1,ne=null,Ge=null,rt=null,Me=null,Ae=null,pn.set(0,0,d.canvas.width,d.canvas.height),bn.set(0,0,d.canvas.width,d.canvas.height),u.reset(),f.reset(),m.reset()}}}function aw(d,e,t,i,s,a,c){const u=s.isWebGL2,f=s.maxTextures,m=s.maxCubemapSize,v=s.maxTextureSize,y=s.maxSamples,_=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,x=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),M=new WeakMap;let P;const C=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function F(Te,fe){return A?new OffscreenCanvas(Te,fe):wl("canvas")}function N(Te,fe,Ot,Tn){let mn=1;if((Te.width>Tn||Te.height>Tn)&&(mn=Tn/Math.max(Te.width,Te.height)),mn<1||!0===fe){if(typeof HTMLImageElement<"u"&&Te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Te instanceof ImageBitmap){const In=fe?Fo:Math.floor,vi=In(mn*Te.width),Pn=In(mn*Te.height);void 0===P&&(P=F(vi,Pn));const zt=Ot?F(vi,Pn):P;return zt.width=vi,zt.height=Pn,zt.getContext("2d").drawImage(Te,0,0,vi,Pn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Te.width+"x"+Te.height+") to ("+vi+"x"+Pn+")."),zt}return"data"in Te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Te.width+"x"+Te.height+")."),Te}return Te}function W(Te){return _o(Te.width)&&_o(Te.height)}function te(Te,fe){return Te.generateMipmaps&&fe&&Te.minFilter!==Jn&&Te.minFilter!==lr}function ee(Te){d.generateMipmap(Te)}function le(Te,fe,Ot,Tn,mn=!1){if(!1===u)return fe;if(null!==Te){if(void 0!==d[Te])return d[Te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Te+"'")}let In=fe;return fe===d.RED&&(Ot===d.FLOAT&&(In=d.R32F),Ot===d.HALF_FLOAT&&(In=d.R16F),Ot===d.UNSIGNED_BYTE&&(In=d.R8)),fe===d.RED_INTEGER&&(Ot===d.UNSIGNED_BYTE&&(In=d.R8UI),Ot===d.UNSIGNED_SHORT&&(In=d.R16UI),Ot===d.UNSIGNED_INT&&(In=d.R32UI),Ot===d.BYTE&&(In=d.R8I),Ot===d.SHORT&&(In=d.R16I),Ot===d.INT&&(In=d.R32I)),fe===d.RG&&(Ot===d.FLOAT&&(In=d.RG32F),Ot===d.HALF_FLOAT&&(In=d.RG16F),Ot===d.UNSIGNED_BYTE&&(In=d.RG8)),fe===d.RGBA&&(Ot===d.FLOAT&&(In=d.RGBA32F),Ot===d.HALF_FLOAT&&(In=d.RGBA16F),Ot===d.UNSIGNED_BYTE&&(In=Tn===Gi&&!1===mn?d.SRGB8_ALPHA8:d.RGBA8),Ot===d.UNSIGNED_SHORT_4_4_4_4&&(In=d.RGBA4),Ot===d.UNSIGNED_SHORT_5_5_5_1&&(In=d.RGB5_A1)),(In===d.R16F||In===d.R32F||In===d.RG16F||In===d.RG32F||In===d.RGBA16F||In===d.RGBA32F)&&e.get("EXT_color_buffer_float"),In}function j(Te,fe,Ot){return!0===te(Te,Ot)||Te.isFramebufferTexture&&Te.minFilter!==Jn&&Te.minFilter!==lr?Math.log2(Math.max(fe.width,fe.height))+1:void 0!==Te.mipmaps&&Te.mipmaps.length>0?Te.mipmaps.length:Te.isCompressedTexture&&Array.isArray(Te.image)?fe.mipmaps.length:1}function ne(Te){return Te===Jn||1004===Te||1005===Te?d.NEAREST:d.LINEAR}function Ge(Te){const fe=Te.target;fe.removeEventListener("dispose",Ge),function Me(Te){const fe=i.get(Te);if(void 0===fe.__webglInit)return;const Ot=Te.source,Tn=C.get(Ot);if(Tn){const mn=Tn[fe.__cacheKey];mn.usedTimes--,0===mn.usedTimes&&Ae(Te),0===Object.keys(Tn).length&&C.delete(Ot)}i.remove(Te)}(fe),fe.isVideoTexture&&M.delete(fe)}function rt(Te){const fe=Te.target;fe.removeEventListener("dispose",rt),function Re(Te){const fe=Te.texture,Ot=i.get(Te),Tn=i.get(fe);if(void 0!==Tn.__webglTexture&&(d.deleteTexture(Tn.__webglTexture),c.memory.textures--),Te.depthTexture&&Te.depthTexture.dispose(),Te.isWebGLCubeRenderTarget)for(let mn=0;mn<6;mn++){if(Array.isArray(Ot.__webglFramebuffer[mn]))for(let In=0;In<Ot.__webglFramebuffer[mn].length;In++)d.deleteFramebuffer(Ot.__webglFramebuffer[mn][In]);else d.deleteFramebuffer(Ot.__webglFramebuffer[mn]);Ot.__webglDepthbuffer&&d.deleteRenderbuffer(Ot.__webglDepthbuffer[mn])}else{if(Array.isArray(Ot.__webglFramebuffer))for(let mn=0;mn<Ot.__webglFramebuffer.length;mn++)d.deleteFramebuffer(Ot.__webglFramebuffer[mn]);else d.deleteFramebuffer(Ot.__webglFramebuffer);if(Ot.__webglDepthbuffer&&d.deleteRenderbuffer(Ot.__webglDepthbuffer),Ot.__webglMultisampledFramebuffer&&d.deleteFramebuffer(Ot.__webglMultisampledFramebuffer),Ot.__webglColorRenderbuffer)for(let mn=0;mn<Ot.__webglColorRenderbuffer.length;mn++)Ot.__webglColorRenderbuffer[mn]&&d.deleteRenderbuffer(Ot.__webglColorRenderbuffer[mn]);Ot.__webglDepthRenderbuffer&&d.deleteRenderbuffer(Ot.__webglDepthRenderbuffer)}if(Te.isWebGLMultipleRenderTargets)for(let mn=0,In=fe.length;mn<In;mn++){const vi=i.get(fe[mn]);vi.__webglTexture&&(d.deleteTexture(vi.__webglTexture),c.memory.textures--),i.remove(fe[mn])}i.remove(fe),i.remove(Te)}(fe)}function Ae(Te){const fe=i.get(Te);d.deleteTexture(fe.__webglTexture),delete C.get(Te.source)[fe.__cacheKey],c.memory.textures--}let He=0;function Bt(Te,fe){const Ot=i.get(Te);if(Te.isVideoTexture&&function br(Te){const fe=c.render.frame;M.get(Te)!==fe&&(M.set(Te,fe),Te.update())}(Te),!1===Te.isRenderTargetTexture&&Te.version>0&&Ot.__version!==Te.version){const Tn=Te.image;if(null===Tn)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Tn.complete)return void zi(Ot,Te,fe);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(d.TEXTURE_2D,Ot.__webglTexture,d.TEXTURE0+fe)}const bn={[jr]:d.REPEAT,[Ei]:d.CLAMP_TO_EDGE,1002:d.MIRRORED_REPEAT},Dn={[Jn]:d.NEAREST,1004:d.NEAREST_MIPMAP_NEAREST,1005:d.NEAREST_MIPMAP_LINEAR,[lr]:d.LINEAR,1007:d.LINEAR_MIPMAP_NEAREST,[Br]:d.LINEAR_MIPMAP_LINEAR},Bn={512:d.NEVER,519:d.ALWAYS,513:d.LESS,515:d.LEQUAL,514:d.EQUAL,518:d.GEQUAL,516:d.GREATER,517:d.NOTEQUAL};function jn(Te,fe,Ot){if(Ot?(d.texParameteri(Te,d.TEXTURE_WRAP_S,bn[fe.wrapS]),d.texParameteri(Te,d.TEXTURE_WRAP_T,bn[fe.wrapT]),(Te===d.TEXTURE_3D||Te===d.TEXTURE_2D_ARRAY)&&d.texParameteri(Te,d.TEXTURE_WRAP_R,bn[fe.wrapR]),d.texParameteri(Te,d.TEXTURE_MAG_FILTER,Dn[fe.magFilter]),d.texParameteri(Te,d.TEXTURE_MIN_FILTER,Dn[fe.minFilter])):(d.texParameteri(Te,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(Te,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),(Te===d.TEXTURE_3D||Te===d.TEXTURE_2D_ARRAY)&&d.texParameteri(Te,d.TEXTURE_WRAP_R,d.CLAMP_TO_EDGE),(fe.wrapS!==Ei||fe.wrapT!==Ei)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),d.texParameteri(Te,d.TEXTURE_MAG_FILTER,ne(fe.magFilter)),d.texParameteri(Te,d.TEXTURE_MIN_FILTER,ne(fe.minFilter)),fe.minFilter!==Jn&&fe.minFilter!==lr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),fe.compareFunction&&(d.texParameteri(Te,d.TEXTURE_COMPARE_MODE,d.COMPARE_REF_TO_TEXTURE),d.texParameteri(Te,d.TEXTURE_COMPARE_FUNC,Bn[fe.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Tn=e.get("EXT_texture_filter_anisotropic");if(fe.magFilter===Jn||1005!==fe.minFilter&&fe.minFilter!==Br||fe.type===ke&&!1===e.has("OES_texture_float_linear")||!1===u&&fe.type===gt&&!1===e.has("OES_texture_half_float_linear"))return;(fe.anisotropy>1||i.get(fe).__currentAnisotropy)&&(d.texParameterf(Te,Tn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(fe.anisotropy,s.getMaxAnisotropy())),i.get(fe).__currentAnisotropy=fe.anisotropy)}}function ei(Te,fe){let Ot=!1;void 0===Te.__webglInit&&(Te.__webglInit=!0,fe.addEventListener("dispose",Ge));const Tn=fe.source;let mn=C.get(Tn);void 0===mn&&(mn={},C.set(Tn,mn));const In=function Mt(Te){const fe=[];return fe.push(Te.wrapS),fe.push(Te.wrapT),fe.push(Te.wrapR||0),fe.push(Te.magFilter),fe.push(Te.minFilter),fe.push(Te.anisotropy),fe.push(Te.internalFormat),fe.push(Te.format),fe.push(Te.type),fe.push(Te.generateMipmaps),fe.push(Te.premultiplyAlpha),fe.push(Te.flipY),fe.push(Te.unpackAlignment),fe.push(Te.colorSpace),fe.join()}(fe);if(In!==Te.__cacheKey){void 0===mn[In]&&(mn[In]={texture:d.createTexture(),usedTimes:0},c.memory.textures++,Ot=!0),mn[In].usedTimes++;const vi=mn[Te.__cacheKey];void 0!==vi&&(mn[Te.__cacheKey].usedTimes--,0===vi.usedTimes&&Ae(fe)),Te.__cacheKey=In,Te.__webglTexture=mn[In].texture}return Ot}function zi(Te,fe,Ot){let Tn=d.TEXTURE_2D;(fe.isDataArrayTexture||fe.isCompressedArrayTexture)&&(Tn=d.TEXTURE_2D_ARRAY),fe.isData3DTexture&&(Tn=d.TEXTURE_3D);const mn=ei(Te,fe),In=fe.source;t.bindTexture(Tn,Te.__webglTexture,d.TEXTURE0+Ot);const vi=i.get(In);if(In.version!==vi.__version||!0===mn){t.activeTexture(d.TEXTURE0+Ot),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,fe.flipY),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,fe.premultiplyAlpha),d.pixelStorei(d.UNPACK_ALIGNMENT,fe.unpackAlignment),d.pixelStorei(d.UNPACK_COLORSPACE_CONVERSION_WEBGL,d.NONE);const Pn=function Z(Te){return!u&&(Te.wrapS!==Ei||Te.wrapT!==Ei||Te.minFilter!==Jn&&Te.minFilter!==lr)}(fe)&&!1===W(fe.image);let zt=N(fe.image,Pn,!1,v);zt=ys(fe,zt);const We=W(zt)||u,hn=a.convert(fe.format,fe.colorSpace);let Xn,Zn=a.convert(fe.type),Un=le(fe.internalFormat,hn,Zn,fe.colorSpace,fe.isVideoTexture);jn(Tn,fe,We);const ji=fe.mipmaps,wr=u&&!0!==fe.isVideoTexture,nt=void 0===vi.__version||!0===mn,Kn=j(fe,zt,We);if(fe.isDepthTexture)Un=d.DEPTH_COMPONENT,u?Un=fe.type===ke?d.DEPTH_COMPONENT32F:fe.type===_t?d.DEPTH_COMPONENT24:fe.type===ni?d.DEPTH24_STENCIL8:d.DEPTH_COMPONENT16:fe.type===ke&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),fe.format===qn&&Un===d.DEPTH_COMPONENT&&1012!==fe.type&&fe.type!==_t&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),fe.type=_t,Zn=a.convert(fe.type)),fe.format===Ws&&Un===d.DEPTH_COMPONENT&&(Un=d.DEPTH_STENCIL,fe.type!==ni&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),fe.type=ni,Zn=a.convert(fe.type))),nt&&(wr?t.texStorage2D(d.TEXTURE_2D,1,Un,zt.width,zt.height):t.texImage2D(d.TEXTURE_2D,0,Un,zt.width,zt.height,0,hn,Zn,null));else if(fe.isDataTexture)if(ji.length>0&&We){wr&&nt&&t.texStorage2D(d.TEXTURE_2D,Kn,Un,ji[0].width,ji[0].height);for(let Ht=0,wn=ji.length;Ht<wn;Ht++)Xn=ji[Ht],wr?t.texSubImage2D(d.TEXTURE_2D,Ht,0,0,Xn.width,Xn.height,hn,Zn,Xn.data):t.texImage2D(d.TEXTURE_2D,Ht,Un,Xn.width,Xn.height,0,hn,Zn,Xn.data);fe.generateMipmaps=!1}else wr?(nt&&t.texStorage2D(d.TEXTURE_2D,Kn,Un,zt.width,zt.height),t.texSubImage2D(d.TEXTURE_2D,0,0,0,zt.width,zt.height,hn,Zn,zt.data)):t.texImage2D(d.TEXTURE_2D,0,Un,zt.width,zt.height,0,hn,Zn,zt.data);else if(fe.isCompressedTexture)if(fe.isCompressedArrayTexture){wr&&nt&&t.texStorage3D(d.TEXTURE_2D_ARRAY,Kn,Un,ji[0].width,ji[0].height,zt.depth);for(let Ht=0,wn=ji.length;Ht<wn;Ht++)Xn=ji[Ht],fe.format!==Ui?null!==hn?wr?t.compressedTexSubImage3D(d.TEXTURE_2D_ARRAY,Ht,0,0,0,Xn.width,Xn.height,zt.depth,hn,Xn.data,0,0):t.compressedTexImage3D(d.TEXTURE_2D_ARRAY,Ht,Un,Xn.width,Xn.height,zt.depth,0,Xn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):wr?t.texSubImage3D(d.TEXTURE_2D_ARRAY,Ht,0,0,0,Xn.width,Xn.height,zt.depth,hn,Zn,Xn.data):t.texImage3D(d.TEXTURE_2D_ARRAY,Ht,Un,Xn.width,Xn.height,zt.depth,0,hn,Zn,Xn.data)}else{wr&&nt&&t.texStorage2D(d.TEXTURE_2D,Kn,Un,ji[0].width,ji[0].height);for(let Ht=0,wn=ji.length;Ht<wn;Ht++)Xn=ji[Ht],fe.format!==Ui?null!==hn?wr?t.compressedTexSubImage2D(d.TEXTURE_2D,Ht,0,0,Xn.width,Xn.height,hn,Xn.data):t.compressedTexImage2D(d.TEXTURE_2D,Ht,Un,Xn.width,Xn.height,0,Xn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):wr?t.texSubImage2D(d.TEXTURE_2D,Ht,0,0,Xn.width,Xn.height,hn,Zn,Xn.data):t.texImage2D(d.TEXTURE_2D,Ht,Un,Xn.width,Xn.height,0,hn,Zn,Xn.data)}else if(fe.isDataArrayTexture)wr?(nt&&t.texStorage3D(d.TEXTURE_2D_ARRAY,Kn,Un,zt.width,zt.height,zt.depth),t.texSubImage3D(d.TEXTURE_2D_ARRAY,0,0,0,0,zt.width,zt.height,zt.depth,hn,Zn,zt.data)):t.texImage3D(d.TEXTURE_2D_ARRAY,0,Un,zt.width,zt.height,zt.depth,0,hn,Zn,zt.data);else if(fe.isData3DTexture)wr?(nt&&t.texStorage3D(d.TEXTURE_3D,Kn,Un,zt.width,zt.height,zt.depth),t.texSubImage3D(d.TEXTURE_3D,0,0,0,0,zt.width,zt.height,zt.depth,hn,Zn,zt.data)):t.texImage3D(d.TEXTURE_3D,0,Un,zt.width,zt.height,zt.depth,0,hn,Zn,zt.data);else if(fe.isFramebufferTexture){if(nt)if(wr)t.texStorage2D(d.TEXTURE_2D,Kn,Un,zt.width,zt.height);else{let Ht=zt.width,wn=zt.height;for(let zn=0;zn<Kn;zn++)t.texImage2D(d.TEXTURE_2D,zn,Un,Ht,wn,0,hn,Zn,null),Ht>>=1,wn>>=1}}else if(ji.length>0&&We){wr&&nt&&t.texStorage2D(d.TEXTURE_2D,Kn,Un,ji[0].width,ji[0].height);for(let Ht=0,wn=ji.length;Ht<wn;Ht++)Xn=ji[Ht],wr?t.texSubImage2D(d.TEXTURE_2D,Ht,0,0,hn,Zn,Xn):t.texImage2D(d.TEXTURE_2D,Ht,Un,hn,Zn,Xn);fe.generateMipmaps=!1}else wr?(nt&&t.texStorage2D(d.TEXTURE_2D,Kn,Un,zt.width,zt.height),t.texSubImage2D(d.TEXTURE_2D,0,0,0,hn,Zn,zt)):t.texImage2D(d.TEXTURE_2D,0,Un,hn,Zn,zt);te(fe,We)&&ee(Tn),vi.__version=In.version,fe.onUpdate&&fe.onUpdate(fe)}Te.__version=fe.version}function di(Te,fe,Ot,Tn,mn,In){const vi=a.convert(Ot.format,Ot.colorSpace),Pn=a.convert(Ot.type),zt=le(Ot.internalFormat,vi,Pn,Ot.colorSpace);if(!i.get(fe).__hasExternalTextures){const hn=Math.max(1,fe.width>>In),Zn=Math.max(1,fe.height>>In);mn===d.TEXTURE_3D||mn===d.TEXTURE_2D_ARRAY?t.texImage3D(mn,In,zt,hn,Zn,fe.depth,0,vi,Pn,null):t.texImage2D(mn,In,zt,hn,Zn,0,vi,Pn,null)}t.bindFramebuffer(d.FRAMEBUFFER,Te),Ti(fe)?_.framebufferTexture2DMultisampleEXT(d.FRAMEBUFFER,Tn,mn,i.get(Ot).__webglTexture,0,si(fe)):(mn===d.TEXTURE_2D||mn>=d.TEXTURE_CUBE_MAP_POSITIVE_X&&mn<=d.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&d.framebufferTexture2D(d.FRAMEBUFFER,Tn,mn,i.get(Ot).__webglTexture,In),t.bindFramebuffer(d.FRAMEBUFFER,null)}function Ve(Te,fe,Ot){if(d.bindRenderbuffer(d.RENDERBUFFER,Te),fe.depthBuffer&&!fe.stencilBuffer){let Tn=d.DEPTH_COMPONENT16;if(Ot||Ti(fe)){const mn=fe.depthTexture;mn&&mn.isDepthTexture&&(mn.type===ke?Tn=d.DEPTH_COMPONENT32F:mn.type===_t&&(Tn=d.DEPTH_COMPONENT24));const In=si(fe);Ti(fe)?_.renderbufferStorageMultisampleEXT(d.RENDERBUFFER,In,Tn,fe.width,fe.height):d.renderbufferStorageMultisample(d.RENDERBUFFER,In,Tn,fe.width,fe.height)}else d.renderbufferStorage(d.RENDERBUFFER,Tn,fe.width,fe.height);d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,Te)}else if(fe.depthBuffer&&fe.stencilBuffer){const Tn=si(fe);Ot&&!1===Ti(fe)?d.renderbufferStorageMultisample(d.RENDERBUFFER,Tn,d.DEPTH24_STENCIL8,fe.width,fe.height):Ti(fe)?_.renderbufferStorageMultisampleEXT(d.RENDERBUFFER,Tn,d.DEPTH24_STENCIL8,fe.width,fe.height):d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,fe.width,fe.height),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,Te)}else{const Tn=!0===fe.isWebGLMultipleRenderTargets?fe.texture:[fe.texture];for(let mn=0;mn<Tn.length;mn++){const In=Tn[mn],vi=a.convert(In.format,In.colorSpace),Pn=a.convert(In.type),zt=le(In.internalFormat,vi,Pn,In.colorSpace),We=si(fe);Ot&&!1===Ti(fe)?d.renderbufferStorageMultisample(d.RENDERBUFFER,We,zt,fe.width,fe.height):Ti(fe)?_.renderbufferStorageMultisampleEXT(d.RENDERBUFFER,We,zt,fe.width,fe.height):d.renderbufferStorage(d.RENDERBUFFER,zt,fe.width,fe.height)}}d.bindRenderbuffer(d.RENDERBUFFER,null)}function nn(Te){const fe=i.get(Te),Ot=!0===Te.isWebGLCubeRenderTarget;if(Te.depthTexture&&!fe.__autoAllocateDepthBuffer){if(Ot)throw new Error("target.depthTexture not supported in Cube render targets");!function Cn(Te,fe){if(fe&&fe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(d.FRAMEBUFFER,Te),!fe.depthTexture||!fe.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(fe.depthTexture).__webglTexture||fe.depthTexture.image.width!==fe.width||fe.depthTexture.image.height!==fe.height)&&(fe.depthTexture.image.width=fe.width,fe.depthTexture.image.height=fe.height,fe.depthTexture.needsUpdate=!0),Bt(fe.depthTexture,0);const Tn=i.get(fe.depthTexture).__webglTexture,mn=si(fe);if(fe.depthTexture.format===qn)Ti(fe)?_.framebufferTexture2DMultisampleEXT(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.TEXTURE_2D,Tn,0,mn):d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.TEXTURE_2D,Tn,0);else{if(fe.depthTexture.format!==Ws)throw new Error("Unknown depthTexture format");Ti(fe)?_.framebufferTexture2DMultisampleEXT(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,Tn,0,mn):d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,Tn,0)}}(fe.__webglFramebuffer,Te)}else if(Ot){fe.__webglDepthbuffer=[];for(let Tn=0;Tn<6;Tn++)t.bindFramebuffer(d.FRAMEBUFFER,fe.__webglFramebuffer[Tn]),fe.__webglDepthbuffer[Tn]=d.createRenderbuffer(),Ve(fe.__webglDepthbuffer[Tn],Te,!1)}else t.bindFramebuffer(d.FRAMEBUFFER,fe.__webglFramebuffer),fe.__webglDepthbuffer=d.createRenderbuffer(),Ve(fe.__webglDepthbuffer,Te,!1);t.bindFramebuffer(d.FRAMEBUFFER,null)}function si(Te){return Math.min(y,Te.samples)}function Ti(Te){const fe=i.get(Te);return u&&Te.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==fe.__useRenderToTexture}function ys(Te,fe){const Ot=Te.colorSpace,Tn=Te.format,mn=Te.type;return!0===Te.isCompressedTexture||!0===Te.isVideoTexture||1035===Te.format||Ot!==Dr&&""!==Ot&&(Ot===Gi||Ot===Li?!1===u?!0===e.has("EXT_sRGB")&&Tn===Ui?(Te.format=1035,Te.minFilter=lr,Te.generateMipmaps=!1):fe=Rf.sRGBToLinear(fe):(Tn!==Ui||mn!==kr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ot)),fe}this.allocateTextureUnit=function St(){const Te=He;return Te>=f&&console.warn("THREE.WebGLTextures: Trying to use "+Te+" texture units while this GPU supports only "+f),He+=1,Te},this.resetTextureUnits=function xt(){He=0},this.setTexture2D=Bt,this.setTexture2DArray=function pt(Te,fe){const Ot=i.get(Te);Te.version>0&&Ot.__version!==Te.version?zi(Ot,Te,fe):t.bindTexture(d.TEXTURE_2D_ARRAY,Ot.__webglTexture,d.TEXTURE0+fe)},this.setTexture3D=function ht(Te,fe){const Ot=i.get(Te);Te.version>0&&Ot.__version!==Te.version?zi(Ot,Te,fe):t.bindTexture(d.TEXTURE_3D,Ot.__webglTexture,d.TEXTURE0+fe)},this.setTextureCube=function pn(Te,fe){const Ot=i.get(Te);Te.version>0&&Ot.__version!==Te.version?function Ki(Te,fe,Ot){if(6!==fe.image.length)return;const Tn=ei(Te,fe),mn=fe.source;t.bindTexture(d.TEXTURE_CUBE_MAP,Te.__webglTexture,d.TEXTURE0+Ot);const In=i.get(mn);if(mn.version!==In.__version||!0===Tn){t.activeTexture(d.TEXTURE0+Ot),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,fe.flipY),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,fe.premultiplyAlpha),d.pixelStorei(d.UNPACK_ALIGNMENT,fe.unpackAlignment),d.pixelStorei(d.UNPACK_COLORSPACE_CONVERSION_WEBGL,d.NONE);const vi=fe.isCompressedTexture||fe.image[0].isCompressedTexture,Pn=fe.image[0]&&fe.image[0].isDataTexture,zt=[];for(let Ht=0;Ht<6;Ht++)zt[Ht]=vi||Pn?Pn?fe.image[Ht].image:fe.image[Ht]:N(fe.image[Ht],!1,!0,m),zt[Ht]=ys(fe,zt[Ht]);const We=zt[0],hn=W(We)||u,Zn=a.convert(fe.format,fe.colorSpace),Un=a.convert(fe.type),Xn=le(fe.internalFormat,Zn,Un,fe.colorSpace),ji=u&&!0!==fe.isVideoTexture,wr=void 0===In.__version||!0===Tn;let Kn,nt=j(fe,We,hn);if(jn(d.TEXTURE_CUBE_MAP,fe,hn),vi){ji&&wr&&t.texStorage2D(d.TEXTURE_CUBE_MAP,nt,Xn,We.width,We.height);for(let Ht=0;Ht<6;Ht++){Kn=zt[Ht].mipmaps;for(let wn=0;wn<Kn.length;wn++){const zn=Kn[wn];fe.format!==Ui?null!==Zn?ji?t.compressedTexSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn,0,0,zn.width,zn.height,Zn,zn.data):t.compressedTexImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn,Xn,zn.width,zn.height,0,zn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ji?t.texSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn,0,0,zn.width,zn.height,Zn,Un,zn.data):t.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn,Xn,zn.width,zn.height,0,Zn,Un,zn.data)}}}else{Kn=fe.mipmaps,ji&&wr&&(Kn.length>0&&nt++,t.texStorage2D(d.TEXTURE_CUBE_MAP,nt,Xn,zt[0].width,zt[0].height));for(let Ht=0;Ht<6;Ht++)if(Pn){ji?t.texSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,zt[Ht].width,zt[Ht].height,Zn,Un,zt[Ht].data):t.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,Xn,zt[Ht].width,zt[Ht].height,0,Zn,Un,zt[Ht].data);for(let wn=0;wn<Kn.length;wn++){const gr=Kn[wn].image[Ht].image;ji?t.texSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn+1,0,0,gr.width,gr.height,Zn,Un,gr.data):t.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn+1,Xn,gr.width,gr.height,0,Zn,Un,gr.data)}}else{ji?t.texSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,Zn,Un,zt[Ht]):t.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,Xn,Zn,Un,zt[Ht]);for(let wn=0;wn<Kn.length;wn++){const zn=Kn[wn];ji?t.texSubImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn+1,0,0,Zn,Un,zn.image[Ht]):t.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,wn+1,Xn,Zn,Un,zn.image[Ht])}}}te(fe,hn)&&ee(d.TEXTURE_CUBE_MAP),In.__version=mn.version,fe.onUpdate&&fe.onUpdate(fe)}Te.__version=fe.version}(Ot,Te,fe):t.bindTexture(d.TEXTURE_CUBE_MAP,Ot.__webglTexture,d.TEXTURE0+fe)},this.rebindTextures=function An(Te,fe,Ot){const Tn=i.get(Te);void 0!==fe&&di(Tn.__webglFramebuffer,Te,Te.texture,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,0),void 0!==Ot&&nn(Te)},this.setupRenderTarget=function fn(Te){const fe=Te.texture,Ot=i.get(Te),Tn=i.get(fe);Te.addEventListener("dispose",rt),!0!==Te.isWebGLMultipleRenderTargets&&(void 0===Tn.__webglTexture&&(Tn.__webglTexture=d.createTexture()),Tn.__version=fe.version,c.memory.textures++);const mn=!0===Te.isWebGLCubeRenderTarget,In=!0===Te.isWebGLMultipleRenderTargets,vi=W(Te)||u;if(mn){Ot.__webglFramebuffer=[];for(let Pn=0;Pn<6;Pn++)if(u&&fe.mipmaps&&fe.mipmaps.length>0){Ot.__webglFramebuffer[Pn]=[];for(let zt=0;zt<fe.mipmaps.length;zt++)Ot.__webglFramebuffer[Pn][zt]=d.createFramebuffer()}else Ot.__webglFramebuffer[Pn]=d.createFramebuffer()}else{if(u&&fe.mipmaps&&fe.mipmaps.length>0){Ot.__webglFramebuffer=[];for(let Pn=0;Pn<fe.mipmaps.length;Pn++)Ot.__webglFramebuffer[Pn]=d.createFramebuffer()}else Ot.__webglFramebuffer=d.createFramebuffer();if(In)if(s.drawBuffers){const Pn=Te.texture;for(let zt=0,We=Pn.length;zt<We;zt++){const hn=i.get(Pn[zt]);void 0===hn.__webglTexture&&(hn.__webglTexture=d.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&Te.samples>0&&!1===Ti(Te)){const Pn=In?fe:[fe];Ot.__webglMultisampledFramebuffer=d.createFramebuffer(),Ot.__webglColorRenderbuffer=[],t.bindFramebuffer(d.FRAMEBUFFER,Ot.__webglMultisampledFramebuffer);for(let zt=0;zt<Pn.length;zt++){const We=Pn[zt];Ot.__webglColorRenderbuffer[zt]=d.createRenderbuffer(),d.bindRenderbuffer(d.RENDERBUFFER,Ot.__webglColorRenderbuffer[zt]);const hn=a.convert(We.format,We.colorSpace),Zn=a.convert(We.type),Un=le(We.internalFormat,hn,Zn,We.colorSpace,!0===Te.isXRRenderTarget),Xn=si(Te);d.renderbufferStorageMultisample(d.RENDERBUFFER,Xn,Un,Te.width,Te.height),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+zt,d.RENDERBUFFER,Ot.__webglColorRenderbuffer[zt])}d.bindRenderbuffer(d.RENDERBUFFER,null),Te.depthBuffer&&(Ot.__webglDepthRenderbuffer=d.createRenderbuffer(),Ve(Ot.__webglDepthRenderbuffer,Te,!0)),t.bindFramebuffer(d.FRAMEBUFFER,null)}}if(mn){t.bindTexture(d.TEXTURE_CUBE_MAP,Tn.__webglTexture),jn(d.TEXTURE_CUBE_MAP,fe,vi);for(let Pn=0;Pn<6;Pn++)if(u&&fe.mipmaps&&fe.mipmaps.length>0)for(let zt=0;zt<fe.mipmaps.length;zt++)di(Ot.__webglFramebuffer[Pn][zt],Te,fe,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,zt);else di(Ot.__webglFramebuffer[Pn],Te,fe,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,0);te(fe,vi)&&ee(d.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(In){const Pn=Te.texture;for(let zt=0,We=Pn.length;zt<We;zt++){const hn=Pn[zt],Zn=i.get(hn);t.bindTexture(d.TEXTURE_2D,Zn.__webglTexture),jn(d.TEXTURE_2D,hn,vi),di(Ot.__webglFramebuffer,Te,hn,d.COLOR_ATTACHMENT0+zt,d.TEXTURE_2D,0),te(hn,vi)&&ee(d.TEXTURE_2D)}t.unbindTexture()}else{let Pn=d.TEXTURE_2D;if((Te.isWebGL3DRenderTarget||Te.isWebGLArrayRenderTarget)&&(u?Pn=Te.isWebGL3DRenderTarget?d.TEXTURE_3D:d.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Pn,Tn.__webglTexture),jn(Pn,fe,vi),u&&fe.mipmaps&&fe.mipmaps.length>0)for(let zt=0;zt<fe.mipmaps.length;zt++)di(Ot.__webglFramebuffer[zt],Te,fe,d.COLOR_ATTACHMENT0,Pn,zt);else di(Ot.__webglFramebuffer,Te,fe,d.COLOR_ATTACHMENT0,Pn,0);te(fe,vi)&&ee(Pn),t.unbindTexture()}Te.depthBuffer&&nn(Te)},this.updateRenderTargetMipmap=function gi(Te){const fe=W(Te)||u,Ot=!0===Te.isWebGLMultipleRenderTargets?Te.texture:[Te.texture];for(let Tn=0,mn=Ot.length;Tn<mn;Tn++){const In=Ot[Tn];if(te(In,fe)){const vi=Te.isWebGLCubeRenderTarget?d.TEXTURE_CUBE_MAP:d.TEXTURE_2D,Pn=i.get(In).__webglTexture;t.bindTexture(vi,Pn),ee(vi),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ri(Te){if(u&&Te.samples>0&&!1===Ti(Te)){const fe=Te.isWebGLMultipleRenderTargets?Te.texture:[Te.texture],Ot=Te.width,Tn=Te.height;let mn=d.COLOR_BUFFER_BIT;const In=[],vi=Te.stencilBuffer?d.DEPTH_STENCIL_ATTACHMENT:d.DEPTH_ATTACHMENT,Pn=i.get(Te),zt=!0===Te.isWebGLMultipleRenderTargets;if(zt)for(let We=0;We<fe.length;We++)t.bindFramebuffer(d.FRAMEBUFFER,Pn.__webglMultisampledFramebuffer),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+We,d.RENDERBUFFER,null),t.bindFramebuffer(d.FRAMEBUFFER,Pn.__webglFramebuffer),d.framebufferTexture2D(d.DRAW_FRAMEBUFFER,d.COLOR_ATTACHMENT0+We,d.TEXTURE_2D,null,0);t.bindFramebuffer(d.READ_FRAMEBUFFER,Pn.__webglMultisampledFramebuffer),t.bindFramebuffer(d.DRAW_FRAMEBUFFER,Pn.__webglFramebuffer);for(let We=0;We<fe.length;We++){In.push(d.COLOR_ATTACHMENT0+We),Te.depthBuffer&&In.push(vi);const hn=void 0!==Pn.__ignoreDepthValues&&Pn.__ignoreDepthValues;if(!1===hn&&(Te.depthBuffer&&(mn|=d.DEPTH_BUFFER_BIT),Te.stencilBuffer&&(mn|=d.STENCIL_BUFFER_BIT)),zt&&d.framebufferRenderbuffer(d.READ_FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,Pn.__webglColorRenderbuffer[We]),!0===hn&&(d.invalidateFramebuffer(d.READ_FRAMEBUFFER,[vi]),d.invalidateFramebuffer(d.DRAW_FRAMEBUFFER,[vi])),zt){const Zn=i.get(fe[We]).__webglTexture;d.framebufferTexture2D(d.DRAW_FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,Zn,0)}d.blitFramebuffer(0,0,Ot,Tn,0,0,Ot,Tn,mn,d.NEAREST),x&&d.invalidateFramebuffer(d.READ_FRAMEBUFFER,In)}if(t.bindFramebuffer(d.READ_FRAMEBUFFER,null),t.bindFramebuffer(d.DRAW_FRAMEBUFFER,null),zt)for(let We=0;We<fe.length;We++){t.bindFramebuffer(d.FRAMEBUFFER,Pn.__webglMultisampledFramebuffer),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+We,d.RENDERBUFFER,Pn.__webglColorRenderbuffer[We]);const hn=i.get(fe[We]).__webglTexture;t.bindFramebuffer(d.FRAMEBUFFER,Pn.__webglFramebuffer),d.framebufferTexture2D(d.DRAW_FRAMEBUFFER,d.COLOR_ATTACHMENT0+We,d.TEXTURE_2D,hn,0)}t.bindFramebuffer(d.DRAW_FRAMEBUFFER,Pn.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=nn,this.setupFrameBufferTexture=di,this.useMultisampledRTT=Ti}function wh(d,e,t){const i=t.isWebGL2;return{convert:function s(a,c=""){let u;const f=c===Gi||c===Li?1:0;if(a===kr)return d.UNSIGNED_BYTE;if(1017===a)return d.UNSIGNED_SHORT_4_4_4_4;if(1018===a)return d.UNSIGNED_SHORT_5_5_5_1;if(1010===a)return d.BYTE;if(1011===a)return d.SHORT;if(1012===a)return d.UNSIGNED_SHORT;if(1013===a)return d.INT;if(a===_t)return d.UNSIGNED_INT;if(a===ke)return d.FLOAT;if(a===gt)return i?d.HALF_FLOAT:(u=e.get("OES_texture_half_float"),null!==u?u.HALF_FLOAT_OES:null);if(1021===a)return d.ALPHA;if(a===Ui)return d.RGBA;if(1024===a)return d.LUMINANCE;if(1025===a)return d.LUMINANCE_ALPHA;if(a===qn)return d.DEPTH_COMPONENT;if(a===Ws)return d.DEPTH_STENCIL;if(1035===a)return u=e.get("EXT_sRGB"),null!==u?u.SRGB_ALPHA_EXT:null;if(1028===a)return d.RED;if(1029===a)return d.RED_INTEGER;if(1030===a)return d.RG;if(1031===a)return d.RG_INTEGER;if(1033===a)return d.RGBA_INTEGER;if(33776===a||33777===a||33778===a||33779===a)if(1===f){if(u=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===u)return null;if(33776===a)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===a)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(u=e.get("WEBGL_compressed_texture_s3tc"),null===u)return null;if(33776===a)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a){if(u=e.get("WEBGL_compressed_texture_pvrtc"),null===u)return null;if(35840===a)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a)return u=e.get("WEBGL_compressed_texture_etc1"),null!==u?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===a||37496===a){if(u=e.get("WEBGL_compressed_texture_etc"),null===u)return null;if(37492===a)return 1===f?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(37496===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a){if(u=e.get("WEBGL_compressed_texture_astc"),null===u)return null;if(37808===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===a)return 1===f?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===a||36494===a||36495===a){if(u=e.get("EXT_texture_compression_bptc"),null===u)return null;if(36492===a)return 1===f?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===a)return u.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===a)return u.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===a||36284===a||36285===a||36286===a){if(u=e.get("EXT_texture_compression_rgtc"),null===u)return null;if(36492===a)return u.COMPRESSED_RED_RGTC1_EXT;if(36284===a)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===a)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===a)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===ni?i?d.UNSIGNED_INT_24_8:(u=e.get("WEBGL_depth_texture"),null!==u?u.UNSIGNED_INT_24_8_WEBGL:null):void 0!==d[a]?d[a]:null}}}class N0 extends ho{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Dl extends Ls{constructor(){super(),this.isGroup=!0,this.type="Group"}}const F0={type:"move"};class B0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Dl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Dl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new he,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new he),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Dl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new he,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new he),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let s=null,a=null,c=null;const u=this._targetRay,f=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){c=!0;for(const P of e.hand.values()){const C=t.getJointPose(P,i),A=this._getHandJoint(m,P);null!==C&&(A.matrix.fromArray(C.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=C.radius),A.visible=null!==C}const _=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),x=.02,M=.005;m.inputState.pinching&&_>x+M?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&_<=x-M&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==f&&e.gripSpace&&(a=t.getPose(e.gripSpace,i),null!==a&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));null!==u&&(s=t.getPose(e.targetRaySpace,i),null===s&&null!==a&&(s=a),null!==s&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(F0)))}return null!==u&&(u.visible=null!==s),null!==f&&(f.visible=null!==a),null!==m&&(m.visible=null!==c),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Dl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class wA extends To{constructor(e,t,i,s,a,c,u,f,m,v){if((v=void 0!==v?v:qn)!==qn&&v!==Ws)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&v===qn&&(i=_t),void 0===i&&v===Ws&&(i=ni),super(null,s,a,c,u,f,v,i,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==u?u:Jn,this.minFilter=void 0!==f?f:Jn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class MA extends mr{constructor(e,t){super();const i=this;let s=null,a=1,c=null,u="local-floor",f=1,m=null,v=null,y=null,_=null,x=null,M=null;const P=t.getContextAttributes();let C=null,A=null;const F=[],N=[],W=new ho;W.layers.enable(1),W.viewport=new zr;const Z=new ho;Z.layers.enable(2),Z.viewport=new zr;const te=[W,Z],ee=new N0;ee.layers.enable(1),ee.layers.enable(2);let le=null,j=null;function ne(pt){const ht=N.indexOf(pt.inputSource);if(-1===ht)return;const pn=F[ht];void 0!==pn&&(pn.update(pt.inputSource,pt.frame,m||c),pn.dispatchEvent({type:pt.type,data:pt.inputSource}))}function Ge(){s.removeEventListener("select",ne),s.removeEventListener("selectstart",ne),s.removeEventListener("selectend",ne),s.removeEventListener("squeeze",ne),s.removeEventListener("squeezestart",ne),s.removeEventListener("squeezeend",ne),s.removeEventListener("end",Ge),s.removeEventListener("inputsourceschange",rt);for(let pt=0;pt<F.length;pt++){const ht=N[pt];null!==ht&&(N[pt]=null,F[pt].disconnect(ht))}le=null,j=null,e.setRenderTarget(C),x=null,_=null,y=null,s=null,A=null,Bt.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function rt(pt){for(let ht=0;ht<pt.removed.length;ht++){const pn=pt.removed[ht],bn=N.indexOf(pn);bn>=0&&(N[bn]=null,F[bn].disconnect(pn))}for(let ht=0;ht<pt.added.length;ht++){const pn=pt.added[ht];let bn=N.indexOf(pn);if(-1===bn){for(let Bn=0;Bn<F.length;Bn++){if(Bn>=N.length){N.push(pn),bn=Bn;break}if(null===N[Bn]){N[Bn]=pn,bn=Bn;break}}if(-1===bn)break}const Dn=F[bn];Dn&&Dn.connect(pn)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(pt){let ht=F[pt];return void 0===ht&&(ht=new B0,F[pt]=ht),ht.getTargetRaySpace()},this.getControllerGrip=function(pt){let ht=F[pt];return void 0===ht&&(ht=new B0,F[pt]=ht),ht.getGripSpace()},this.getHand=function(pt){let ht=F[pt];return void 0===ht&&(ht=new B0,F[pt]=ht),ht.getHandSpace()},this.setFramebufferScaleFactor=function(pt){a=pt,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pt){u=pt,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||c},this.setReferenceSpace=function(pt){m=pt},this.getBaseLayer=function(){return null!==_?_:x},this.getBinding=function(){return y},this.getFrame=function(){return M},this.getSession=function(){return s},this.setSession=function(){var pt=(0,Fe.Z)(function*(ht){if(s=ht,null!==s){if(C=e.getRenderTarget(),s.addEventListener("select",ne),s.addEventListener("selectstart",ne),s.addEventListener("selectend",ne),s.addEventListener("squeeze",ne),s.addEventListener("squeezestart",ne),s.addEventListener("squeezeend",ne),s.addEventListener("end",Ge),s.addEventListener("inputsourceschange",rt),!0!==P.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)x=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||P.antialias,alpha:!0,depth:P.depth,stencil:P.stencil,framebufferScaleFactor:a}),s.updateRenderState({baseLayer:x}),A=new H(x.framebufferWidth,x.framebufferHeight,{format:Ui,type:kr,colorSpace:e.outputColorSpace,stencilBuffer:P.stencil});else{let pn=null,bn=null,Dn=null;P.depth&&(Dn=P.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,pn=P.stencil?Ws:qn,bn=P.stencil?ni:_t);const Bn={colorFormat:t.RGBA8,depthFormat:Dn,scaleFactor:a};y=new XRWebGLBinding(s,t),_=y.createProjectionLayer(Bn),s.updateRenderState({layers:[_]}),A=new H(_.textureWidth,_.textureHeight,{format:Ui,type:kr,depthTexture:new wA(_.textureWidth,_.textureHeight,bn,void 0,void 0,void 0,void 0,void 0,void 0,pn),stencilBuffer:P.stencil,colorSpace:e.outputColorSpace,samples:P.antialias?4:0}),e.properties.get(A).__ignoreDepthValues=_.ignoreDepthValues}A.isXRRenderTarget=!0,this.setFoveation(f),m=null,c=yield s.requestReferenceSpace(u),Bt.setContext(s),Bt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(ht){return pt.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};const Me=new he,Ae=new he;function He(pt,ht){null===ht?pt.matrixWorld.copy(pt.matrix):pt.matrixWorld.multiplyMatrices(ht.matrixWorld,pt.matrix),pt.matrixWorldInverse.copy(pt.matrixWorld).invert()}this.updateCamera=function(pt){if(null===s)return;ee.near=Z.near=W.near=pt.near,ee.far=Z.far=W.far=pt.far,(le!==ee.near||j!==ee.far)&&(s.updateRenderState({depthNear:ee.near,depthFar:ee.far}),le=ee.near,j=ee.far);const ht=pt.parent,pn=ee.cameras;He(ee,ht);for(let bn=0;bn<pn.length;bn++)He(pn[bn],ht);2===pn.length?function Re(pt,ht,pn){Me.setFromMatrixPosition(ht.matrixWorld),Ae.setFromMatrixPosition(pn.matrixWorld);const bn=Me.distanceTo(Ae),Dn=ht.projectionMatrix.elements,Bn=pn.projectionMatrix.elements,jn=Dn[14]/(Dn[10]-1),ei=Dn[14]/(Dn[10]+1),zi=(Dn[9]+1)/Dn[5],Ki=(Dn[9]-1)/Dn[5],di=(Dn[8]-1)/Dn[0],Ve=(Bn[8]+1)/Bn[0],Cn=jn*di,nn=jn*Ve,An=bn/(-di+Ve),fn=An*-di;ht.matrixWorld.decompose(pt.position,pt.quaternion,pt.scale),pt.translateX(fn),pt.translateZ(An),pt.matrixWorld.compose(pt.position,pt.quaternion,pt.scale),pt.matrixWorldInverse.copy(pt.matrixWorld).invert();const gi=jn+An,ri=ei+An;pt.projectionMatrix.makePerspective(Cn-fn,nn+(bn-fn),zi*ei/ri*gi,Ki*ei/ri*gi,gi,ri),pt.projectionMatrixInverse.copy(pt.projectionMatrix).invert()}(ee,W,Z):ee.projectionMatrix.copy(W.projectionMatrix),function xt(pt,ht,pn){null===pn?pt.matrix.copy(ht.matrixWorld):(pt.matrix.copy(pn.matrixWorld),pt.matrix.invert(),pt.matrix.multiply(ht.matrixWorld)),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt.updateMatrixWorld(!0),pt.projectionMatrix.copy(ht.projectionMatrix),pt.projectionMatrixInverse.copy(ht.projectionMatrixInverse),pt.isPerspectiveCamera&&(pt.fov=2*ls*Math.atan(1/pt.projectionMatrix.elements[5]),pt.zoom=1)}(pt,ee,ht)},this.getCamera=function(){return ee},this.getFoveation=function(){if(null!==_||null!==x)return f},this.setFoveation=function(pt){f=pt,null!==_&&(_.fixedFoveation=pt),null!==x&&void 0!==x.fixedFoveation&&(x.fixedFoveation=pt)};let St=null;const Bt=new jf;Bt.setAnimationLoop(function Mt(pt,ht){if(v=ht.getViewerPose(m||c),M=ht,null!==v){const pn=v.views;null!==x&&(e.setRenderTargetFramebuffer(A,x.framebuffer),e.setRenderTarget(A));let bn=!1;pn.length!==ee.cameras.length&&(ee.cameras.length=0,bn=!0);for(let Dn=0;Dn<pn.length;Dn++){const Bn=pn[Dn];let jn=null;if(null!==x)jn=x.getViewport(Bn);else{const zi=y.getViewSubImage(_,Bn);jn=zi.viewport,0===Dn&&(e.setRenderTargetTextures(A,zi.colorTexture,_.ignoreDepthValues?void 0:zi.depthStencilTexture),e.setRenderTarget(A))}let ei=te[Dn];void 0===ei&&(ei=new ho,ei.layers.enable(Dn),ei.viewport=new zr,te[Dn]=ei),ei.matrix.fromArray(Bn.transform.matrix),ei.matrix.decompose(ei.position,ei.quaternion,ei.scale),ei.projectionMatrix.fromArray(Bn.projectionMatrix),ei.projectionMatrixInverse.copy(ei.projectionMatrix).invert(),ei.viewport.set(jn.x,jn.y,jn.width,jn.height),0===Dn&&(ee.matrix.copy(ei.matrix),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale)),!0===bn&&ee.cameras.push(ei)}}for(let pn=0;pn<F.length;pn++){const bn=N[pn],Dn=F[pn];null!==bn&&void 0!==Dn&&Dn.update(bn,ht,m||c)}St&&St(pt,ht),ht.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ht}),M=null}),this.setAnimationLoop=function(pt){St=pt},this.dispose=function(){}}}function wg(d,e){function t(C,A){!0===C.matrixAutoUpdate&&C.updateMatrix(),A.value.copy(C.matrix)}function a(C,A){C.opacity.value=A.opacity,A.color&&C.diffuse.value.copy(A.color),A.emissive&&C.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(C.map.value=A.map,t(A.map,C.mapTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.bumpMap&&(C.bumpMap.value=A.bumpMap,t(A.bumpMap,C.bumpMapTransform),C.bumpScale.value=A.bumpScale,1===A.side&&(C.bumpScale.value*=-1)),A.normalMap&&(C.normalMap.value=A.normalMap,t(A.normalMap,C.normalMapTransform),C.normalScale.value.copy(A.normalScale),1===A.side&&C.normalScale.value.negate()),A.displacementMap&&(C.displacementMap.value=A.displacementMap,t(A.displacementMap,C.displacementMapTransform),C.displacementScale.value=A.displacementScale,C.displacementBias.value=A.displacementBias),A.emissiveMap&&(C.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,C.emissiveMapTransform)),A.specularMap&&(C.specularMap.value=A.specularMap,t(A.specularMap,C.specularMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest);const F=e.get(A).envMap;if(F&&(C.envMap.value=F,C.flipEnvMap.value=F.isCubeTexture&&!1===F.isRenderTargetTexture?-1:1,C.reflectivity.value=A.reflectivity,C.ior.value=A.ior,C.refractionRatio.value=A.refractionRatio),A.lightMap){C.lightMap.value=A.lightMap;const N=!0===d._useLegacyLights?Math.PI:1;C.lightMapIntensity.value=A.lightMapIntensity*N,t(A.lightMap,C.lightMapTransform)}A.aoMap&&(C.aoMap.value=A.aoMap,C.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,C.aoMapTransform))}return{refreshFogUniforms:function i(C,A){A.color.getRGB(C.fogColor.value,$m(d)),A.isFog?(C.fogNear.value=A.near,C.fogFar.value=A.far):A.isFogExp2&&(C.fogDensity.value=A.density)},refreshMaterialUniforms:function s(C,A,F,N,W){A.isMeshBasicMaterial||A.isMeshLambertMaterial?a(C,A):A.isMeshToonMaterial?(a(C,A),function y(C,A){A.gradientMap&&(C.gradientMap.value=A.gradientMap)}(C,A)):A.isMeshPhongMaterial?(a(C,A),function v(C,A){C.specular.value.copy(A.specular),C.shininess.value=Math.max(A.shininess,1e-4)}(C,A)):A.isMeshStandardMaterial?(a(C,A),function _(C,A){C.metalness.value=A.metalness,A.metalnessMap&&(C.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,C.metalnessMapTransform)),C.roughness.value=A.roughness,A.roughnessMap&&(C.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,C.roughnessMapTransform)),e.get(A).envMap&&(C.envMapIntensity.value=A.envMapIntensity)}(C,A),A.isMeshPhysicalMaterial&&function x(C,A,F){C.ior.value=A.ior,A.sheen>0&&(C.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),C.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(C.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,C.sheenColorMapTransform)),A.sheenRoughnessMap&&(C.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,C.sheenRoughnessMapTransform))),A.clearcoat>0&&(C.clearcoat.value=A.clearcoat,C.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(C.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,C.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(C.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,C.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(C.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,C.clearcoatNormalMapTransform),C.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),1===A.side&&C.clearcoatNormalScale.value.negate())),A.iridescence>0&&(C.iridescence.value=A.iridescence,C.iridescenceIOR.value=A.iridescenceIOR,C.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],C.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(C.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,C.iridescenceMapTransform)),A.iridescenceThicknessMap&&(C.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,C.iridescenceThicknessMapTransform))),A.transmission>0&&(C.transmission.value=A.transmission,C.transmissionSamplerMap.value=F.texture,C.transmissionSamplerSize.value.set(F.width,F.height),A.transmissionMap&&(C.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,C.transmissionMapTransform)),C.thickness.value=A.thickness,A.thicknessMap&&(C.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,C.thicknessMapTransform)),C.attenuationDistance.value=A.attenuationDistance,C.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(C.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(C.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,C.anisotropyMapTransform))),C.specularIntensity.value=A.specularIntensity,C.specularColor.value.copy(A.specularColor),A.specularColorMap&&(C.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,C.specularColorMapTransform)),A.specularIntensityMap&&(C.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,C.specularIntensityMapTransform))}(C,A,W)):A.isMeshMatcapMaterial?(a(C,A),function M(C,A){A.matcap&&(C.matcap.value=A.matcap)}(C,A)):A.isMeshDepthMaterial?a(C,A):A.isMeshDistanceMaterial?(a(C,A),function P(C,A){const F=e.get(A).light;C.referencePosition.value.setFromMatrixPosition(F.matrixWorld),C.nearDistance.value=F.shadow.camera.near,C.farDistance.value=F.shadow.camera.far}(C,A)):A.isMeshNormalMaterial?a(C,A):A.isLineBasicMaterial?(function c(C,A){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,A.map&&(C.map.value=A.map,t(A.map,C.mapTransform))}(C,A),A.isLineDashedMaterial&&function u(C,A){C.dashSize.value=A.dashSize,C.totalSize.value=A.dashSize+A.gapSize,C.scale.value=A.scale}(C,A)):A.isPointsMaterial?function f(C,A,F,N){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,C.size.value=A.size*F,C.scale.value=.5*N,A.map&&(C.map.value=A.map,t(A.map,C.uvTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest)}(C,A,F,N):A.isSpriteMaterial?function m(C,A){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,C.rotation.value=A.rotation,A.map&&(C.map.value=A.map,t(A.map,C.mapTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest)}(C,A):A.isShadowMaterial?(C.color.value.copy(A.color),C.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}}}function Mg(d,e,t,i){let s={},a={},c=[];const u=t.isWebGL2?d.getParameter(d.MAX_UNIFORM_BUFFER_BINDINGS):0;function x(F,N,W){const Z=F.value;if(void 0===W[N]){if("number"==typeof Z)W[N]=Z;else{const te=Array.isArray(Z)?Z:[Z],ee=[];for(let le=0;le<te.length;le++)ee.push(te[le].clone());W[N]=ee}return!0}if("number"==typeof Z){if(W[N]!==Z)return W[N]=Z,!0}else{const te=Array.isArray(W[N])?W[N]:[W[N]],ee=Array.isArray(Z)?Z:[Z];for(let le=0;le<te.length;le++){const j=te[le];if(!1===j.equals(ee[le]))return j.copy(ee[le]),!0}}return!1}function P(F){const N={boundary:0,storage:0};return"number"==typeof F?(N.boundary=4,N.storage=4):F.isVector2?(N.boundary=8,N.storage=8):F.isVector3||F.isColor?(N.boundary=16,N.storage=12):F.isVector4?(N.boundary=16,N.storage=16):F.isMatrix3?(N.boundary=48,N.storage=48):F.isMatrix4?(N.boundary=64,N.storage=64):F.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",F),N}function C(F){const N=F.target;N.removeEventListener("dispose",C);const W=c.indexOf(N.__bindingPointIndex);c.splice(W,1),d.deleteBuffer(s[N.id]),delete s[N.id],delete a[N.id]}return{bind:function f(F,N){i.uniformBlockBinding(F,N.program)},update:function m(F,N){let W=s[F.id];void 0===W&&(function M(F){const N=F.uniforms;let W=0;let te=0;for(let ee=0,le=N.length;ee<le;ee++){const j=N[ee],ne={boundary:0,storage:0},Ge=Array.isArray(j.value)?j.value:[j.value];for(let rt=0,Me=Ge.length;rt<Me;rt++){const Re=P(Ge[rt]);ne.boundary+=Re.boundary,ne.storage+=Re.storage}j.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=W,ee>0&&(te=W%16,0!==te&&16-te-ne.boundary<0&&(W+=16-te,j.__offset=W)),W+=ne.storage}te=W%16,te>0&&(W+=16-te),F.__size=W,F.__cache={}}(F),W=function v(F){const N=function y(){for(let F=0;F<u;F++)if(-1===c.indexOf(F))return c.push(F),F;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();F.__bindingPointIndex=N;const W=d.createBuffer(),Z=F.__size,te=F.usage;return d.bindBuffer(d.UNIFORM_BUFFER,W),d.bufferData(d.UNIFORM_BUFFER,Z,te),d.bindBuffer(d.UNIFORM_BUFFER,null),d.bindBufferBase(d.UNIFORM_BUFFER,N,W),W}(F),s[F.id]=W,F.addEventListener("dispose",C)),i.updateUBOMapping(F,N.program);const te=e.render.frame;a[F.id]!==te&&(function _(F){const W=F.uniforms,Z=F.__cache;d.bindBuffer(d.UNIFORM_BUFFER,s[F.id]);for(let te=0,ee=W.length;te<ee;te++){const le=W[te];if(!0===x(le,te,Z)){const j=le.__offset,ne=Array.isArray(le.value)?le.value:[le.value];let Ge=0;for(let rt=0;rt<ne.length;rt++){const Me=ne[rt],Ae=P(Me);"number"==typeof Me?(le.__data[0]=Me,d.bufferSubData(d.UNIFORM_BUFFER,j+Ge,le.__data)):Me.isMatrix3?(le.__data[0]=Me.elements[0],le.__data[1]=Me.elements[1],le.__data[2]=Me.elements[2],le.__data[3]=Me.elements[0],le.__data[4]=Me.elements[3],le.__data[5]=Me.elements[4],le.__data[6]=Me.elements[5],le.__data[7]=Me.elements[0],le.__data[8]=Me.elements[6],le.__data[9]=Me.elements[7],le.__data[10]=Me.elements[8],le.__data[11]=Me.elements[0]):(Me.toArray(le.__data,Ge),Ge+=Ae.storage/Float32Array.BYTES_PER_ELEMENT)}d.bufferSubData(d.UNIFORM_BUFFER,j,le.__data)}}d.bindBuffer(d.UNIFORM_BUFFER,null)}(F),a[F.id]=te)},dispose:function A(){for(const F in s)d.deleteBuffer(s[F]);c=[],s={},a={}}}}class lw{constructor(e={}){const{canvas:t=ll(),context:i=null,depth:s=!0,stencil:a=!0,alpha:c=!1,antialias:u=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:m=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:y=!1}=e;let _;this.isWebGLRenderer=!0,_=null!==i?i.getContextAttributes().alpha:c;const x=new Uint32Array(4),M=new Int32Array(4);let P=null,C=null;const A=[],F=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Gi,this._useLegacyLights=!1,this.toneMapping=Gn,this.toneMappingExposure=1;const N=this;let W=!1,Z=0,te=0,ee=null,le=-1,j=null;const ne=new zr,Ge=new zr;let rt=null;const Me=new Yn(0);let Ae=0,Re=t.width,He=t.height,xt=1,St=null,Mt=null;const Bt=new zr(0,0,Re,He),pt=new zr(0,0,Re,He);let ht=!1;const pn=new Wf;let bn=!1,Dn=!1,Bn=null;const jn=new _i,ei=new Jt,zi=new he,Ki={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function di(){return null===ee?xt:1}let nn,An,fn,gi,ri,si,Ti,br,ys,Te,fe,Ot,Tn,mn,In,vi,Pn,zt,We,hn,Zn,Un,Xn,ji,Ve=i;function Cn(Se,Tt){for(let Qt=0;Qt<Se.length;Qt++){const Kt=t.getContext(Se[Qt],Tt);if(null!==Kt)return Kt}return null}try{const Se={alpha:!0,depth:s,stencil:a,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:m,powerPreference:v,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r156"),t.addEventListener("webglcontextlost",Kn,!1),t.addEventListener("webglcontextrestored",Ht,!1),t.addEventListener("webglcontextcreationerror",wn,!1),null===Ve){const Tt=["webgl2","webgl","experimental-webgl"];if(!0===N.isWebGL1Renderer&&Tt.shift(),Ve=Cn(Tt,Se),null===Ve)throw Cn(Tt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ve instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Ve.getShaderPrecisionFormat&&(Ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Se){throw console.error("THREE.WebGLRenderer: "+Se.message),Se}function wr(){nn=new Qy(Ve),An=new yA(Ve,nn,e),nn.init(An),Un=new wh(Ve,nn,An),fn=new ow(Ve,nn,An),gi=new ap(Ve),ri=new R0,si=new aw(Ve,nn,fn,ri,An,Un,gi),Ti=new _A(N),br=new ME(N),ys=new Rx(Ve,An),Xn=new bE(Ve,nn,ys,An),Te=new e0(Ve,ys,gi,Xn),fe=new AE(Ve,Te,ys,gi),We=new CE(Ve,An,si),vi=new Ky(ri),Ot=new I0(N,Ti,br,nn,An,Xn,vi),Tn=new wg(N,ri),mn=new JE,In=new EA(nn,An),zt=new qy(N,Ti,br,fn,fe,_,f),Pn=new sw(N,fe,An),ji=new Mg(Ve,gi,An,fn),hn=new Xy(Ve,nn,gi,An),Zn=new op(Ve,nn,gi,An),gi.programs=Ot.programs,N.capabilities=An,N.extensions=nn,N.properties=ri,N.renderLists=mn,N.shadowMap=Pn,N.state=fn,N.info=gi}wr();const nt=new MA(N,Ve);function Kn(Se){Se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),W=!0}function Ht(){console.log("THREE.WebGLRenderer: Context Restored."),W=!1;const Se=gi.autoReset,Tt=Pn.enabled,Qt=Pn.autoUpdate,Nt=Pn.needsUpdate,Kt=Pn.type;wr(),gi.autoReset=Se,Pn.enabled=Tt,Pn.autoUpdate=Qt,Pn.needsUpdate=Nt,Pn.type=Kt}function wn(Se){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Se.statusMessage)}function zn(Se){const Tt=Se.target;Tt.removeEventListener("dispose",zn),function gr(Se){(function Wr(Se){const Tt=ri.get(Se).programs;void 0!==Tt&&(Tt.forEach(function(Qt){Ot.releaseProgram(Qt)}),Se.isShaderMaterial&&Ot.releaseShaderCache(Se))})(Se),ri.remove(Se)}(Tt)}this.xr=nt,this.getContext=function(){return Ve},this.getContextAttributes=function(){return Ve.getContextAttributes()},this.forceContextLoss=function(){const Se=nn.get("WEBGL_lose_context");Se&&Se.loseContext()},this.forceContextRestore=function(){const Se=nn.get("WEBGL_lose_context");Se&&Se.restoreContext()},this.getPixelRatio=function(){return xt},this.setPixelRatio=function(Se){void 0!==Se&&(xt=Se,this.setSize(Re,He,!1))},this.getSize=function(Se){return Se.set(Re,He)},this.setSize=function(Se,Tt,Qt=!0){nt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Re=Se,He=Tt,t.width=Math.floor(Se*xt),t.height=Math.floor(Tt*xt),!0===Qt&&(t.style.width=Se+"px",t.style.height=Tt+"px"),this.setViewport(0,0,Se,Tt))},this.getDrawingBufferSize=function(Se){return Se.set(Re*xt,He*xt).floor()},this.setDrawingBufferSize=function(Se,Tt,Qt){Re=Se,He=Tt,xt=Qt,t.width=Math.floor(Se*Qt),t.height=Math.floor(Tt*Qt),this.setViewport(0,0,Se,Tt)},this.getCurrentViewport=function(Se){return Se.copy(ne)},this.getViewport=function(Se){return Se.copy(Bt)},this.setViewport=function(Se,Tt,Qt,Nt){Se.isVector4?Bt.set(Se.x,Se.y,Se.z,Se.w):Bt.set(Se,Tt,Qt,Nt),fn.viewport(ne.copy(Bt).multiplyScalar(xt).floor())},this.getScissor=function(Se){return Se.copy(pt)},this.setScissor=function(Se,Tt,Qt,Nt){Se.isVector4?pt.set(Se.x,Se.y,Se.z,Se.w):pt.set(Se,Tt,Qt,Nt),fn.scissor(Ge.copy(pt).multiplyScalar(xt).floor())},this.getScissorTest=function(){return ht},this.setScissorTest=function(Se){fn.setScissorTest(ht=Se)},this.setOpaqueSort=function(Se){St=Se},this.setTransparentSort=function(Se){Mt=Se},this.getClearColor=function(Se){return Se.copy(zt.getClearColor())},this.setClearColor=function(){zt.setClearColor.apply(zt,arguments)},this.getClearAlpha=function(){return zt.getClearAlpha()},this.setClearAlpha=function(){zt.setClearAlpha.apply(zt,arguments)},this.clear=function(Se=!0,Tt=!0,Qt=!0){let Nt=0;if(Se){let Kt=!1;if(null!==ee){const oi=ee.texture.format;Kt=1033===oi||1031===oi||1029===oi}if(Kt){const oi=ee.texture.type,Oi=oi===kr||oi===_t||1012===oi||oi===ni||1017===oi||1018===oi,Wi=zt.getClearColor(),Yi=zt.getClearAlpha(),vr=Wi.r,Ii=Wi.g,or=Wi.b;Oi?(x[0]=vr,x[1]=Ii,x[2]=or,x[3]=Yi,Ve.clearBufferuiv(Ve.COLOR,0,x)):(M[0]=vr,M[1]=Ii,M[2]=or,M[3]=Yi,Ve.clearBufferiv(Ve.COLOR,0,M))}else Nt|=Ve.COLOR_BUFFER_BIT}Tt&&(Nt|=Ve.DEPTH_BUFFER_BIT),Qt&&(Nt|=Ve.STENCIL_BUFFER_BIT),Ve.clear(Nt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Kn,!1),t.removeEventListener("webglcontextrestored",Ht,!1),t.removeEventListener("webglcontextcreationerror",wn,!1),mn.dispose(),In.dispose(),ri.dispose(),Ti.dispose(),br.dispose(),fe.dispose(),Xn.dispose(),ji.dispose(),Ot.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",hr),nt.removeEventListener("sessionend",Ko),Bn&&(Bn.dispose(),Bn=null),Zo.stop()},this.renderBufferDirect=function(Se,Tt,Qt,Nt,Kt,oi){null===Tt&&(Tt=Ki);const Oi=Kt.isMesh&&Kt.matrixWorld.determinant()<0,Wi=function vx(Se,Tt,Qt,Nt,Kt){!0!==Tt.isScene&&(Tt=Ki),si.resetTextureUnits();const oi=Tt.fog,Wi=null===ee?N.outputColorSpace:!0===ee.isXRRenderTarget?ee.texture.colorSpace:Dr,Yi=(Nt.isMeshStandardMaterial?br:Ti).get(Nt.envMap||(Nt.isMeshStandardMaterial?Tt.environment:null)),vr=!0===Nt.vertexColors&&!!Qt.attributes.color&&4===Qt.attributes.color.itemSize,Ii=!!Qt.attributes.tangent&&(!!Nt.normalMap||Nt.anisotropy>0),or=!!Qt.morphAttributes.position,Cs=!!Qt.morphAttributes.normal,As=!!Qt.morphAttributes.color;let tl=Gn;Nt.toneMapped&&(null===ee||!0===ee.isXRRenderTarget)&&(tl=N.toneMapping);const Gl=Qt.morphAttributes.position||Qt.morphAttributes.normal||Qt.morphAttributes.color,to=void 0!==Gl?Gl.length:0,Mr=ri.get(Nt),Am=C.state.lights;!0!==bn||!0!==Dn&&Se===j||vi.setState(Nt,Se,Se===j&&Nt.id===le);let Gs=!1;Nt.version===Mr.__version?(Mr.needsLights&&Mr.lightsStateVersion!==Am.state.version||Mr.outputColorSpace!==Wi||Kt.isInstancedMesh&&!1===Mr.instancing||!Kt.isInstancedMesh&&!0===Mr.instancing||Kt.isSkinnedMesh&&!1===Mr.skinning||!Kt.isSkinnedMesh&&!0===Mr.skinning||Kt.isInstancedMesh&&!0===Mr.instancingColor&&null===Kt.instanceColor||Kt.isInstancedMesh&&!1===Mr.instancingColor&&null!==Kt.instanceColor||Mr.envMap!==Yi||!0===Nt.fog&&Mr.fog!==oi||void 0!==Mr.numClippingPlanes&&(Mr.numClippingPlanes!==vi.numPlanes||Mr.numIntersection!==vi.numIntersection)||Mr.vertexAlphas!==vr||Mr.vertexTangents!==Ii||Mr.morphTargets!==or||Mr.morphNormals!==Cs||Mr.morphColors!==As||Mr.toneMapping!==tl||!0===An.isWebGL2&&Mr.morphTargetsCount!==to)&&(Gs=!0):(Gs=!0,Mr.__version=Nt.version);let Su=Mr.currentProgram;!0===Gs&&(Su=th(Nt,Tt,Kt));let fy=!1,nh=!1,py=!1;const Jo=Su.getUniforms(),Mc=Mr.uniforms;if(fn.useProgram(Su.program)&&(fy=!0,nh=!0,py=!0),Nt.id!==le&&(le=Nt.id,nh=!0),fy||j!==Se){Jo.setValue(Ve,"projectionMatrix",Se.projectionMatrix),Jo.setValue(Ve,"viewMatrix",Se.matrixWorldInverse);const da=Jo.map.cameraPosition;void 0!==da&&da.setValue(Ve,zi.setFromMatrixPosition(Se.matrixWorld)),An.logarithmicDepthBuffer&&Jo.setValue(Ve,"logDepthBufFC",2/(Math.log(Se.far+1)/Math.LN2)),(Nt.isMeshPhongMaterial||Nt.isMeshToonMaterial||Nt.isMeshLambertMaterial||Nt.isMeshBasicMaterial||Nt.isMeshStandardMaterial||Nt.isShaderMaterial)&&Jo.setValue(Ve,"isOrthographic",!0===Se.isOrthographicCamera),j!==Se&&(j=Se,nh=!0,py=!0)}if(Kt.isSkinnedMesh){Jo.setOptional(Ve,Kt,"bindMatrix"),Jo.setOptional(Ve,Kt,"bindMatrixInverse");const da=Kt.skeleton;da&&(An.floatVertexTextures?(null===da.boneTexture&&da.computeBoneTexture(),Jo.setValue(Ve,"boneTexture",da.boneTexture,si),Jo.setValue(Ve,"boneTextureSize",da.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const my=Qt.morphAttributes;if((void 0!==my.position||void 0!==my.normal||void 0!==my.color&&!0===An.isWebGL2)&&We.update(Kt,Qt,Su),(nh||Mr.receiveShadow!==Kt.receiveShadow)&&(Mr.receiveShadow=Kt.receiveShadow,Jo.setValue(Ve,"receiveShadow",Kt.receiveShadow)),Nt.isMeshGouraudMaterial&&null!==Nt.envMap&&(Mc.envMap.value=Yi,Mc.flipEnvMap.value=Yi.isCubeTexture&&!1===Yi.isRenderTargetTexture?-1:1),nh&&(Jo.setValue(Ve,"toneMappingExposure",N.toneMappingExposure),Mr.needsLights&&function IC(Se,Tt){Se.ambientLightColor.needsUpdate=Tt,Se.lightProbe.needsUpdate=Tt,Se.directionalLights.needsUpdate=Tt,Se.directionalLightShadows.needsUpdate=Tt,Se.pointLights.needsUpdate=Tt,Se.pointLightShadows.needsUpdate=Tt,Se.spotLights.needsUpdate=Tt,Se.spotLightShadows.needsUpdate=Tt,Se.rectAreaLights.needsUpdate=Tt,Se.hemisphereLights.needsUpdate=Tt}(Mc,py),oi&&!0===Nt.fog&&Tn.refreshFogUniforms(Mc,oi),Tn.refreshMaterialUniforms(Mc,Nt,xt,He,Bn),_h.upload(Ve,Mr.uniformsList,Mc,si)),Nt.isShaderMaterial&&!0===Nt.uniformsNeedUpdate&&(_h.upload(Ve,Mr.uniformsList,Mc,si),Nt.uniformsNeedUpdate=!1),Nt.isSpriteMaterial&&Jo.setValue(Ve,"center",Kt.center),Jo.setValue(Ve,"modelViewMatrix",Kt.modelViewMatrix),Jo.setValue(Ve,"normalMatrix",Kt.normalMatrix),Jo.setValue(Ve,"modelMatrix",Kt.matrixWorld),Nt.isShaderMaterial||Nt.isRawShaderMaterial){const da=Nt.uniformsGroups;for(let Tm=0,yx=da.length;Tm<yx;Tm++)if(An.isWebGL2){const gy=da[Tm];ji.update(gy,Su),ji.bind(gy,Su)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Su}(Se,Tt,Qt,Nt,Kt);fn.setMaterial(Nt,Oi);let Yi=Qt.index,vr=1;if(!0===Nt.wireframe){if(Yi=Te.getWireframeAttribute(Qt),void 0===Yi)return;vr=2}const Ii=Qt.drawRange,or=Qt.attributes.position;let Cs=Ii.start*vr,As=(Ii.start+Ii.count)*vr;null!==oi&&(Cs=Math.max(Cs,oi.start*vr),As=Math.min(As,(oi.start+oi.count)*vr)),null!==Yi?(Cs=Math.max(Cs,0),As=Math.min(As,Yi.count)):null!=or&&(Cs=Math.max(Cs,0),As=Math.min(As,or.count));const tl=As-Cs;if(tl<0||tl===1/0)return;Xn.setup(Kt,Nt,Wi,Qt,Yi);let Gl,to=hn;if(null!==Yi&&(Gl=ys.get(Yi),to=Zn,to.setIndex(Gl)),Kt.isMesh)!0===Nt.wireframe?(fn.setLineWidth(Nt.wireframeLinewidth*di()),to.setMode(Ve.LINES)):to.setMode(Ve.TRIANGLES);else if(Kt.isLine){let Mr=Nt.linewidth;void 0===Mr&&(Mr=1),fn.setLineWidth(Mr*di()),to.setMode(Kt.isLineSegments?Ve.LINES:Kt.isLineLoop?Ve.LINE_LOOP:Ve.LINE_STRIP)}else Kt.isPoints?to.setMode(Ve.POINTS):Kt.isSprite&&to.setMode(Ve.TRIANGLES);if(Kt.isInstancedMesh)to.renderInstances(Cs,tl,Kt.count);else if(Qt.isInstancedBufferGeometry){const Am=Math.min(Qt.instanceCount,void 0!==Qt._maxInstanceCount?Qt._maxInstanceCount:1/0);to.renderInstances(Cs,tl,Am)}else to.render(Cs,tl)},this.compile=function(Se,Tt){function Qt(Nt,Kt,oi){!0===Nt.transparent&&2===Nt.side&&!1===Nt.forceSinglePass?(Nt.side=1,Nt.needsUpdate=!0,th(Nt,Kt,oi),Nt.side=0,Nt.needsUpdate=!0,th(Nt,Kt,oi),Nt.side=2):th(Nt,Kt,oi)}C=In.get(Se),C.init(),F.push(C),Se.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(Tt.layers)&&(C.pushLight(Nt),Nt.castShadow&&C.pushShadow(Nt))}),C.setupLights(N._useLegacyLights),Se.traverse(function(Nt){const Kt=Nt.material;if(Kt)if(Array.isArray(Kt))for(let oi=0;oi<Kt.length;oi++)Qt(Kt[oi],Se,Nt);else Qt(Kt,Se,Nt)}),F.pop(),C=null};let rs=null;function hr(){Zo.stop()}function Ko(){Zo.start()}const Zo=new jf;function px(Se,Tt,Qt,Nt){if(!1===Se.visible)return;if(Se.layers.test(Tt.layers))if(Se.isGroup)Qt=Se.renderOrder;else if(Se.isLOD)!0===Se.autoUpdate&&Se.update(Tt);else if(Se.isLight)C.pushLight(Se),Se.castShadow&&C.pushShadow(Se);else if(Se.isSprite){if(!Se.frustumCulled||pn.intersectsSprite(Se)){Nt&&zi.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(jn);const Oi=fe.update(Se),Wi=Se.material;Wi.visible&&P.push(Se,Oi,Wi,Qt,zi.z,null)}}else if((Se.isMesh||Se.isLine||Se.isPoints)&&(!Se.frustumCulled||pn.intersectsObject(Se))){const Oi=fe.update(Se),Wi=Se.material;if(Nt&&(void 0!==Se.boundingSphere?(null===Se.boundingSphere&&Se.computeBoundingSphere(),zi.copy(Se.boundingSphere.center)):(null===Oi.boundingSphere&&Oi.computeBoundingSphere(),zi.copy(Oi.boundingSphere.center)),zi.applyMatrix4(Se.matrixWorld).applyMatrix4(jn)),Array.isArray(Wi)){const Yi=Oi.groups;for(let vr=0,Ii=Yi.length;vr<Ii;vr++){const or=Yi[vr],Cs=Wi[or.materialIndex];Cs&&Cs.visible&&P.push(Se,Oi,Cs,Qt,zi.z,or)}}else Wi.visible&&P.push(Se,Oi,Wi,Qt,zi.z,null)}const oi=Se.children;for(let Oi=0,Wi=oi.length;Oi<Wi;Oi++)px(oi[Oi],Tt,Qt,Nt)}function DC(Se,Tt,Qt,Nt){const Kt=Se.opaque,oi=Se.transmissive,Oi=Se.transparent;C.setupLightsView(Qt),!0===bn&&vi.setGlobalState(N.clippingPlanes,Qt),oi.length>0&&function mT(Se,Tt,Qt,Nt){const Kt=An.isWebGL2;null===Bn&&(Bn=new H(1,1,{generateMipmaps:!0,type:nn.has("EXT_color_buffer_half_float")?gt:kr,minFilter:Br,samples:Kt?4:0})),N.getDrawingBufferSize(ei),Kt?Bn.setSize(ei.x,ei.y):Bn.setSize(Fo(ei.x),Fo(ei.y));const oi=N.getRenderTarget();N.setRenderTarget(Bn),N.getClearColor(Me),Ae=N.getClearAlpha(),Ae<1&&N.setClearColor(16777215,.5),N.clear();const Oi=N.toneMapping;N.toneMapping=Gn,wc(Se,Qt,Nt),si.updateMultisampleRenderTarget(Bn),si.updateRenderTargetMipmap(Bn);let Wi=!1;for(let Yi=0,vr=Tt.length;Yi<vr;Yi++){const Ii=Tt[Yi],or=Ii.object,Cs=Ii.geometry,As=Ii.material,tl=Ii.group;if(2===As.side&&or.layers.test(Nt.layers)){const Gl=As.side;As.side=1,As.needsUpdate=!0,mx(or,Qt,Nt,Cs,As,tl),As.side=Gl,As.needsUpdate=!0,Wi=!0}}!0===Wi&&(si.updateMultisampleRenderTarget(Bn),si.updateRenderTargetMipmap(Bn)),N.setRenderTarget(oi),N.setClearColor(Me,Ae),N.toneMapping=Oi}(Kt,oi,Tt,Qt),Nt&&fn.viewport(ne.copy(Nt)),Kt.length>0&&wc(Kt,Tt,Qt),oi.length>0&&wc(oi,Tt,Qt),Oi.length>0&&wc(Oi,Tt,Qt),fn.buffers.depth.setTest(!0),fn.buffers.depth.setMask(!0),fn.buffers.color.setMask(!0),fn.setPolygonOffset(!1)}function wc(Se,Tt,Qt){const Nt=!0===Tt.isScene?Tt.overrideMaterial:null;for(let Kt=0,oi=Se.length;Kt<oi;Kt++){const Oi=Se[Kt],Wi=Oi.object,Yi=Oi.geometry,vr=null===Nt?Oi.material:Nt,Ii=Oi.group;Wi.layers.test(Qt.layers)&&mx(Wi,Tt,Qt,Yi,vr,Ii)}}function mx(Se,Tt,Qt,Nt,Kt,oi){Se.onBeforeRender(N,Tt,Qt,Nt,Kt,oi),Se.modelViewMatrix.multiplyMatrices(Qt.matrixWorldInverse,Se.matrixWorld),Se.normalMatrix.getNormalMatrix(Se.modelViewMatrix),Kt.onBeforeRender(N,Tt,Qt,Nt,Se,oi),!0===Kt.transparent&&2===Kt.side&&!1===Kt.forceSinglePass?(Kt.side=1,Kt.needsUpdate=!0,N.renderBufferDirect(Qt,Tt,Nt,Kt,Se,oi),Kt.side=0,Kt.needsUpdate=!0,N.renderBufferDirect(Qt,Tt,Nt,Kt,Se,oi),Kt.side=2):N.renderBufferDirect(Qt,Tt,Nt,Kt,Se,oi),Se.onAfterRender(N,Tt,Qt,Nt,Kt,oi)}function th(Se,Tt,Qt){!0!==Tt.isScene&&(Tt=Ki);const Nt=ri.get(Se),Kt=C.state.lights,Oi=Kt.state.version,Wi=Ot.getParameters(Se,Kt.state,C.state.shadowsArray,Tt,Qt),Yi=Ot.getProgramCacheKey(Wi);let vr=Nt.programs;Nt.environment=Se.isMeshStandardMaterial?Tt.environment:null,Nt.fog=Tt.fog,Nt.envMap=(Se.isMeshStandardMaterial?br:Ti).get(Se.envMap||Nt.environment),void 0===vr&&(Se.addEventListener("dispose",zn),vr=new Map,Nt.programs=vr);let Ii=vr.get(Yi);if(void 0!==Ii){if(Nt.currentProgram===Ii&&Nt.lightsStateVersion===Oi)return gx(Se,Wi),Ii}else Wi.uniforms=Ot.getUniforms(Se),Se.onBuild(Qt,Wi,N),Se.onBeforeCompile(Wi,N),Ii=Ot.acquireProgram(Wi,Yi),vr.set(Yi,Ii),Nt.uniforms=Wi.uniforms;const or=Nt.uniforms;(!Se.isShaderMaterial&&!Se.isRawShaderMaterial||!0===Se.clipping)&&(or.clippingPlanes=vi.uniform),gx(Se,Wi),Nt.needsLights=function RC(Se){return Se.isMeshLambertMaterial||Se.isMeshToonMaterial||Se.isMeshPhongMaterial||Se.isMeshStandardMaterial||Se.isShadowMaterial||Se.isShaderMaterial&&!0===Se.lights}(Se),Nt.lightsStateVersion=Oi,Nt.needsLights&&(or.ambientLightColor.value=Kt.state.ambient,or.lightProbe.value=Kt.state.probe,or.directionalLights.value=Kt.state.directional,or.directionalLightShadows.value=Kt.state.directionalShadow,or.spotLights.value=Kt.state.spot,or.spotLightShadows.value=Kt.state.spotShadow,or.rectAreaLights.value=Kt.state.rectArea,or.ltc_1.value=Kt.state.rectAreaLTC1,or.ltc_2.value=Kt.state.rectAreaLTC2,or.pointLights.value=Kt.state.point,or.pointLightShadows.value=Kt.state.pointShadow,or.hemisphereLights.value=Kt.state.hemi,or.directionalShadowMap.value=Kt.state.directionalShadowMap,or.directionalShadowMatrix.value=Kt.state.directionalShadowMatrix,or.spotShadowMap.value=Kt.state.spotShadowMap,or.spotLightMatrix.value=Kt.state.spotLightMatrix,or.spotLightMap.value=Kt.state.spotLightMap,or.pointShadowMap.value=Kt.state.pointShadowMap,or.pointShadowMatrix.value=Kt.state.pointShadowMatrix);const Cs=Ii.getUniforms(),As=_h.seqWithValue(Cs.seq,or);return Nt.currentProgram=Ii,Nt.uniformsList=As,Ii}function gx(Se,Tt){const Qt=ri.get(Se);Qt.outputColorSpace=Tt.outputColorSpace,Qt.instancing=Tt.instancing,Qt.instancingColor=Tt.instancingColor,Qt.skinning=Tt.skinning,Qt.morphTargets=Tt.morphTargets,Qt.morphNormals=Tt.morphNormals,Qt.morphColors=Tt.morphColors,Qt.morphTargetsCount=Tt.morphTargetsCount,Qt.numClippingPlanes=Tt.numClippingPlanes,Qt.numIntersection=Tt.numClipIntersection,Qt.vertexAlphas=Tt.vertexAlphas,Qt.vertexTangents=Tt.vertexTangents,Qt.toneMapping=Tt.toneMapping}Zo.setAnimationLoop(function Ea(Se){rs&&rs(Se)}),typeof self<"u"&&Zo.setContext(self),this.setAnimationLoop=function(Se){rs=Se,nt.setAnimationLoop(Se),null===Se?Zo.stop():Zo.start()},nt.addEventListener("sessionstart",hr),nt.addEventListener("sessionend",Ko),this.render=function(Se,Tt){if(void 0===Tt||!0===Tt.isCamera){if(!0!==W){if(!0===Se.matrixWorldAutoUpdate&&Se.updateMatrixWorld(),null===Tt.parent&&!0===Tt.matrixWorldAutoUpdate&&Tt.updateMatrixWorld(),!0===nt.enabled&&!0===nt.isPresenting&&(!0===nt.cameraAutoUpdate&&nt.updateCamera(Tt),Tt=nt.getCamera()),!0===Se.isScene&&Se.onBeforeRender(N,Se,Tt,ee),C=In.get(Se,F.length),C.init(),F.push(C),jn.multiplyMatrices(Tt.projectionMatrix,Tt.matrixWorldInverse),pn.setFromProjectionMatrix(jn),Dn=this.localClippingEnabled,bn=vi.init(this.clippingPlanes,Dn),P=mn.get(Se,A.length),P.init(),A.push(P),px(Se,Tt,0,N.sortObjects),P.finish(),!0===N.sortObjects&&P.sort(St,Mt),this.info.render.frame++,!0===bn&&vi.beginShadows(),Pn.render(C.state.shadowsArray,Se,Tt),!0===bn&&vi.endShadows(),!0===this.info.autoReset&&this.info.reset(),zt.render(P,Se),C.setupLights(N._useLegacyLights),Tt.isArrayCamera){const Nt=Tt.cameras;for(let Kt=0,oi=Nt.length;Kt<oi;Kt++){const Oi=Nt[Kt];DC(P,Se,Oi,Oi.viewport)}}else DC(P,Se,Tt);null!==ee&&(si.updateMultisampleRenderTarget(ee),si.updateRenderTargetMipmap(ee)),!0===Se.isScene&&Se.onAfterRender(N,Se,Tt),Xn.resetDefaultState(),le=-1,j=null,F.pop(),C=F.length>0?F[F.length-1]:null,A.pop(),P=A.length>0?A[A.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Z},this.getActiveMipmapLevel=function(){return te},this.getRenderTarget=function(){return ee},this.setRenderTargetTextures=function(Se,Tt,Qt){ri.get(Se.texture).__webglTexture=Tt,ri.get(Se.depthTexture).__webglTexture=Qt;const Nt=ri.get(Se);Nt.__hasExternalTextures=!0,Nt.__hasExternalTextures&&(Nt.__autoAllocateDepthBuffer=void 0===Qt,Nt.__autoAllocateDepthBuffer||!0===nn.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Nt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Se,Tt){const Qt=ri.get(Se);Qt.__webglFramebuffer=Tt,Qt.__useDefaultFramebuffer=void 0===Tt},this.setRenderTarget=function(Se,Tt=0,Qt=0){ee=Se,Z=Tt,te=Qt;let Nt=!0,Kt=null,oi=!1,Oi=!1;if(Se){const Yi=ri.get(Se);void 0!==Yi.__useDefaultFramebuffer?(fn.bindFramebuffer(Ve.FRAMEBUFFER,null),Nt=!1):void 0===Yi.__webglFramebuffer?si.setupRenderTarget(Se):Yi.__hasExternalTextures&&si.rebindTextures(Se,ri.get(Se.texture).__webglTexture,ri.get(Se.depthTexture).__webglTexture);const vr=Se.texture;(vr.isData3DTexture||vr.isDataArrayTexture||vr.isCompressedArrayTexture)&&(Oi=!0);const Ii=ri.get(Se).__webglFramebuffer;Se.isWebGLCubeRenderTarget?(Kt=Array.isArray(Ii[Tt])?Ii[Tt][Qt]:Ii[Tt],oi=!0):Kt=An.isWebGL2&&Se.samples>0&&!1===si.useMultisampledRTT(Se)?ri.get(Se).__webglMultisampledFramebuffer:Array.isArray(Ii)?Ii[Qt]:Ii,ne.copy(Se.viewport),Ge.copy(Se.scissor),rt=Se.scissorTest}else ne.copy(Bt).multiplyScalar(xt).floor(),Ge.copy(pt).multiplyScalar(xt).floor(),rt=ht;if(fn.bindFramebuffer(Ve.FRAMEBUFFER,Kt)&&An.drawBuffers&&Nt&&fn.drawBuffers(Se,Kt),fn.viewport(ne),fn.scissor(Ge),fn.setScissorTest(rt),oi){const Yi=ri.get(Se.texture);Ve.framebufferTexture2D(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_CUBE_MAP_POSITIVE_X+Tt,Yi.__webglTexture,Qt)}else if(Oi){const Yi=ri.get(Se.texture);Ve.framebufferTextureLayer(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Yi.__webglTexture,Qt||0,Tt||0)}le=-1},this.readRenderTargetPixels=function(Se,Tt,Qt,Nt,Kt,oi,Oi){if(!Se||!Se.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Wi=ri.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&void 0!==Oi&&(Wi=Wi[Oi]),Wi){fn.bindFramebuffer(Ve.FRAMEBUFFER,Wi);try{const Yi=Se.texture,vr=Yi.format,Ii=Yi.type;if(vr!==Ui&&Un.convert(vr)!==Ve.getParameter(Ve.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const or=Ii===gt&&(nn.has("EXT_color_buffer_half_float")||An.isWebGL2&&nn.has("EXT_color_buffer_float"));if(!(Ii===kr||Un.convert(Ii)===Ve.getParameter(Ve.IMPLEMENTATION_COLOR_READ_TYPE)||Ii===ke&&(An.isWebGL2||nn.has("OES_texture_float")||nn.has("WEBGL_color_buffer_float"))||or))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Tt>=0&&Tt<=Se.width-Nt&&Qt>=0&&Qt<=Se.height-Kt&&Ve.readPixels(Tt,Qt,Nt,Kt,Un.convert(vr),Un.convert(Ii),oi)}finally{const Yi=null!==ee?ri.get(ee).__webglFramebuffer:null;fn.bindFramebuffer(Ve.FRAMEBUFFER,Yi)}}},this.copyFramebufferToTexture=function(Se,Tt,Qt=0){const Nt=Math.pow(2,-Qt),Kt=Math.floor(Tt.image.width*Nt),oi=Math.floor(Tt.image.height*Nt);si.setTexture2D(Tt,0),Ve.copyTexSubImage2D(Ve.TEXTURE_2D,Qt,0,0,Se.x,Se.y,Kt,oi),fn.unbindTexture()},this.copyTextureToTexture=function(Se,Tt,Qt,Nt=0){const Kt=Tt.image.width,oi=Tt.image.height,Oi=Un.convert(Qt.format),Wi=Un.convert(Qt.type);si.setTexture2D(Qt,0),Ve.pixelStorei(Ve.UNPACK_FLIP_Y_WEBGL,Qt.flipY),Ve.pixelStorei(Ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qt.premultiplyAlpha),Ve.pixelStorei(Ve.UNPACK_ALIGNMENT,Qt.unpackAlignment),Tt.isDataTexture?Ve.texSubImage2D(Ve.TEXTURE_2D,Nt,Se.x,Se.y,Kt,oi,Oi,Wi,Tt.image.data):Tt.isCompressedTexture?Ve.compressedTexSubImage2D(Ve.TEXTURE_2D,Nt,Se.x,Se.y,Tt.mipmaps[0].width,Tt.mipmaps[0].height,Oi,Tt.mipmaps[0].data):Ve.texSubImage2D(Ve.TEXTURE_2D,Nt,Se.x,Se.y,Oi,Wi,Tt.image),0===Nt&&Qt.generateMipmaps&&Ve.generateMipmap(Ve.TEXTURE_2D),fn.unbindTexture()},this.copyTextureToTexture3D=function(Se,Tt,Qt,Nt,Kt=0){if(N.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const oi=Se.max.x-Se.min.x+1,Oi=Se.max.y-Se.min.y+1,Wi=Se.max.z-Se.min.z+1,Yi=Un.convert(Nt.format),vr=Un.convert(Nt.type);let Ii;if(Nt.isData3DTexture)si.setTexture3D(Nt,0),Ii=Ve.TEXTURE_3D;else{if(!Nt.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");si.setTexture2DArray(Nt,0),Ii=Ve.TEXTURE_2D_ARRAY}Ve.pixelStorei(Ve.UNPACK_FLIP_Y_WEBGL,Nt.flipY),Ve.pixelStorei(Ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Nt.premultiplyAlpha),Ve.pixelStorei(Ve.UNPACK_ALIGNMENT,Nt.unpackAlignment);const or=Ve.getParameter(Ve.UNPACK_ROW_LENGTH),Cs=Ve.getParameter(Ve.UNPACK_IMAGE_HEIGHT),As=Ve.getParameter(Ve.UNPACK_SKIP_PIXELS),tl=Ve.getParameter(Ve.UNPACK_SKIP_ROWS),Gl=Ve.getParameter(Ve.UNPACK_SKIP_IMAGES),to=Qt.isCompressedTexture?Qt.mipmaps[0]:Qt.image;Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,to.width),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,to.height),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,Se.min.x),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,Se.min.y),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,Se.min.z),Qt.isDataTexture||Qt.isData3DTexture?Ve.texSubImage3D(Ii,Kt,Tt.x,Tt.y,Tt.z,oi,Oi,Wi,Yi,vr,to.data):Qt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ve.compressedTexSubImage3D(Ii,Kt,Tt.x,Tt.y,Tt.z,oi,Oi,Wi,Yi,to.data)):Ve.texSubImage3D(Ii,Kt,Tt.x,Tt.y,Tt.z,oi,Oi,Wi,Yi,vr,to),Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,or),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,Cs),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,As),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,tl),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,Gl),0===Kt&&Nt.generateMipmaps&&Ve.generateMipmap(Ii),fn.unbindTexture()},this.initTexture=function(Se){Se.isCubeTexture?si.setTextureCube(Se,0):Se.isData3DTexture?si.setTexture3D(Se,0):Se.isDataArrayTexture||Se.isCompressedArrayTexture?si.setTexture2DArray(Se,0):si.setTexture2D(Se,0),fn.unbindTexture()},this.resetState=function(){Z=0,te=0,ee=null,fn.reset(),Xn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ea}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Gi?Nr:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Nr?Gi:Dr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class SA extends lw{}).prototype.isWebGL1Renderer=!0;class k0 extends Ls{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Cg{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ir()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,a=this.stride;s<a;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ir()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ir()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Yo=new he;class ac{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Yo.fromBufferAttribute(this,t),Yo.applyMatrix4(e),this.setXYZ(t,Yo.x,Yo.y,Yo.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Yo.fromBufferAttribute(this,t),Yo.applyNormalMatrix(e),this.setXYZ(t,Yo.x,Yo.y,Yo.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Yo.fromBufferAttribute(this,t),Yo.transformDirection(e),this.setXYZ(t,Yo.x,Yo.y,Yo.z);return this}setX(e,t){return this.normalized&&(t=Ni(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ni(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=oo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=oo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=oo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=oo(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array),s=Ni(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ni(t,this.array),i=Ni(i,this.array),s=Ni(s,this.array),a=Ni(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=a,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return new J(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ac(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const cw=new he,Th=new zr,z0=new zr,Rg=new he,_p=new _i,Za=new he,pd=new pa,Dh=new _i,cc=new Ml;class md extends Xr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new _i,this.bindMatrixInverse=new _i,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new bi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Za.fromBufferAttribute(t,i),this.applyBoneTransform(i,Za),this.boundingBox.expandByPoint(Za)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new pa),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)Za.fromBufferAttribute(t,i),this.applyBoneTransform(i,Za),this.boundingSphere.expandByPoint(Za)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const s=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),pd.copy(this.boundingSphere),pd.applyMatrix4(s),!1!==e.ray.intersectsSphere(pd)&&(Dh.copy(s).invert(),cc.copy(e.ray).applyMatrix4(Dh),(null===this.boundingBox||!1!==cc.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,cc)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zr,t=this.geometry.attributes.skinWeight;for(let i=0,s=t.count;i<s;i++){e.fromBufferAttribute(t,i);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,s=this.geometry;Th.fromBufferAttribute(s.attributes.skinIndex,e),z0.fromBufferAttribute(s.attributes.skinWeight,e),cw.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const c=z0.getComponent(a);if(0!==c){const u=Th.getComponent(a);_p.multiplyMatrices(i.bones[u].matrixWorld,i.boneInverses[u]),t.addScaledVector(Rg.copy(cw).applyMatrix4(_p),c)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class uc extends Ls{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Xc extends To{constructor(e=null,t=1,i=1,s,a,c,u,f,m=Jn,v=Jn,y,_){super(null,c,u,f,m,v,s,a,y,_),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Ih=new _i,Rh=new _i;class Pg{constructor(e=[],t=[]){this.uuid=Ir(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new _i)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new _i;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let a=0,c=e.length;a<c;a++)Ih.multiplyMatrices(e[a]?e[a].matrixWorld:Rh,t[a]),Ih.toArray(i,16*a);null!==s&&(s.needsUpdate=!0)}clone(){return new Pg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Aa(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Xc(t,e,e,Ui,ke);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const a=e.bones[i];let c=t[a];void 0===c&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),c=new uc),this.bones.push(c),this.boneInverses.push((new _i).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let s=0,a=t.length;s<a;s++)e.bones.push(t[s].uuid),e.boneInverses.push(i[s].toArray());return e}}class Kc extends J{constructor(e,t,i,s=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const dl=new _i,H0=new _i,Ph=[],$0=new bi,uw=new _i,Zc=new Xr,gd=new pa;class G0 extends Xr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Kc(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,uw)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new bi),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,dl),$0.copy(e.boundingBox).applyMatrix4(dl),this.boundingBox.union($0)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new pa),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,dl),gd.copy(e.boundingSphere).applyMatrix4(dl),this.boundingSphere.union(gd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,s=this.count;if(Zc.geometry=this.geometry,Zc.material=this.material,void 0!==Zc.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),gd.copy(this.boundingSphere),gd.applyMatrix4(i),!1!==e.ray.intersectsSphere(gd)))for(let a=0;a<s;a++){this.getMatrixAt(a,dl),H0.multiplyMatrices(i,dl),Zc.matrixWorld=H0,Zc.raycast(e,Ph);for(let c=0,u=Ph.length;c<u;c++){const f=Ph[c];f.instanceId=a,f.object=this,t.push(f)}Ph.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Kc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class la extends Go{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Yn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const dw=new he,W0=new he,Lh=new _i,Oh=new Ml,bp=new pa;class dc extends Ls{constructor(e=new Zi,t=new la){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let s=1,a=t.count;s<a;s++)dw.fromBufferAttribute(t,s-1),W0.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=dw.distanceTo(W0);e.setAttribute("lineDistance",new kn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,a=e.params.Line.threshold,c=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),bp.copy(i.boundingSphere),bp.applyMatrix4(s),bp.radius+=a,!1===e.ray.intersectsSphere(bp))return;Lh.copy(s).invert(),Oh.copy(e.ray).applyMatrix4(Lh);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,m=new he,v=new he,y=new he,_=new he,x=this.isLineSegments?2:1,M=i.index,C=i.attributes.position;if(null!==M)for(let N=Math.max(0,c.start),W=Math.min(M.count,c.start+c.count)-1;N<W;N+=x){const Z=M.getX(N),te=M.getX(N+1);if(m.fromBufferAttribute(C,Z),v.fromBufferAttribute(C,te),Oh.distanceSqToSegment(m,v,_,y)>f)continue;_.applyMatrix4(this.matrixWorld);const le=e.ray.origin.distanceTo(_);le<e.near||le>e.far||t.push({distance:le,point:y.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}else for(let N=Math.max(0,c.start),W=Math.min(C.count,c.start+c.count)-1;N<W;N+=x){if(m.fromBufferAttribute(C,N),v.fromBufferAttribute(C,N+1),Oh.distanceSqToSegment(m,v,_,y)>f)continue;_.applyMatrix4(this.matrixWorld);const te=e.ray.origin.distanceTo(_);te<e.near||te>e.far||t.push({distance:te,point:y.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}const xp=new he,Nh=new he;class Lg extends dc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let s=0,a=t.count;s<a;s+=2)xp.fromBufferAttribute(t,s),Nh.fromBufferAttribute(t,s+1),i[s]=0===s?0:i[s-1],i[s+1]=i[s]+xp.distanceTo(Nh);e.setAttribute("lineDistance",new kn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Og extends dc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Ng extends Go{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Yn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Fg=new _i,j0=new Ml,Ep=new pa,Jc=new he;class Y0 extends Ls{constructor(e=new Zi,t=new Ng){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,a=e.params.Points.threshold,c=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Ep.copy(i.boundingSphere),Ep.applyMatrix4(s),Ep.radius+=a,!1===e.ray.intersectsSphere(Ep))return;Fg.copy(s).invert(),j0.copy(e.ray).applyMatrix4(Fg);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,m=i.index,y=i.attributes.position;if(null!==m)for(let M=Math.max(0,c.start),P=Math.min(m.count,c.start+c.count);M<P;M++){const C=m.getX(M);Jc.fromBufferAttribute(y,C),Qc(Jc,C,f,s,e,t,this)}else for(let M=Math.max(0,c.start),P=Math.min(y.count,c.start+c.count);M<P;M++)Jc.fromBufferAttribute(y,M),Qc(Jc,M,f,s,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}function Qc(d,e,t,i,s,a,c){const u=j0.distanceSqToPoint(d);if(u<t){const f=new he;j0.closestPointToPoint(d,f),f.applyMatrix4(i);const m=s.ray.origin.distanceTo(f);if(m<s.near||m>s.far)return;a.push({distance:m,distanceToRay:Math.sqrt(u),point:f,index:e,face:null,object:c})}}class _d extends Zi{constructor(e=1,t=1,i=1,s=32,a=1,c=!1,u=0,f=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:s,heightSegments:a,openEnded:c,thetaStart:u,thetaLength:f};const m=this;s=Math.floor(s),a=Math.floor(a);const v=[],y=[],_=[],x=[];let M=0;const P=[],C=i/2;let A=0;function N(W){const Z=M,te=new Jt,ee=new he;let le=0;const j=!0===W?e:t,ne=!0===W?1:-1;for(let rt=1;rt<=s;rt++)y.push(0,C*ne,0),_.push(0,ne,0),x.push(.5,.5),M++;const Ge=M;for(let rt=0;rt<=s;rt++){const Ae=rt/s*f+u,Re=Math.cos(Ae),He=Math.sin(Ae);ee.x=j*He,ee.y=C*ne,ee.z=j*Re,y.push(ee.x,ee.y,ee.z),_.push(0,ne,0),te.x=.5*Re+.5,te.y=.5*He*ne+.5,x.push(te.x,te.y),M++}for(let rt=0;rt<s;rt++){const Me=Z+rt,Ae=Ge+rt;!0===W?v.push(Ae,Ae+1,Me):v.push(Ae+1,Ae,Me),le+=3}m.addGroup(A,le,!0===W?1:2),A+=le}(function F(){const W=new he,Z=new he;let te=0;const ee=(t-e)/i;for(let le=0;le<=a;le++){const j=[],ne=le/a,Ge=ne*(t-e)+e;for(let rt=0;rt<=s;rt++){const Me=rt/s,Ae=Me*f+u,Re=Math.sin(Ae),He=Math.cos(Ae);Z.x=Ge*Re,Z.y=-ne*i+C,Z.z=Ge*He,y.push(Z.x,Z.y,Z.z),W.set(Re,ee,He).normalize(),_.push(W.x,W.y,W.z),x.push(Me,1-ne),j.push(M++)}P.push(j)}for(let le=0;le<s;le++)for(let j=0;j<a;j++){const Ge=P[j+1][le],rt=P[j+1][le+1],Me=P[j][le+1];v.push(P[j][le],Ge,Me),v.push(Ge,rt,Me),te+=6}m.addGroup(A,te,0),A+=te})(),!1===c&&(e>0&&N(!0),t>0&&N(!1)),this.setIndex(v),this.setAttribute("position",new kn(y,3)),this.setAttribute("normal",new kn(_,3)),this.setAttribute("uv",new kn(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _d(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Sd extends Zi{constructor(e=1,t=32,i=16,s=0,a=2*Math.PI,c=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:s,phiLength:a,thetaStart:c,thetaLength:u},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const f=Math.min(c+u,Math.PI);let m=0;const v=[],y=new he,_=new he,x=[],M=[],P=[],C=[];for(let A=0;A<=i;A++){const F=[],N=A/i;let W=0;0===A&&0===c?W=.5/t:A===i&&f===Math.PI&&(W=-.5/t);for(let Z=0;Z<=t;Z++){const te=Z/t;y.x=-e*Math.cos(s+te*a)*Math.sin(c+N*u),y.y=e*Math.cos(c+N*u),y.z=e*Math.sin(s+te*a)*Math.sin(c+N*u),M.push(y.x,y.y,y.z),_.copy(y).normalize(),P.push(_.x,_.y,_.z),C.push(te+W,1-N),F.push(m++)}v.push(F)}for(let A=0;A<i;A++)for(let F=0;F<t;F++){const W=v[A][F],Z=v[A+1][F],te=v[A+1][F+1];(0!==A||c>0)&&x.push(v[A][F+1],W,te),(A!==i-1||f<Math.PI)&&x.push(W,Z,te)}this.setIndex(x),this.setAttribute("position",new kn(M,3)),this.setAttribute("normal",new kn(P,3)),this.setAttribute("uv",new kn(C,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Cd extends Go{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Yn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Rl extends Cd{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return xr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Yn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Yn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Yn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ev extends Go{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Yn(16777215),this.specular=new Yn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function ba(d,e,t){return Pp(d)?new d.constructor(d.subarray(e,void 0!==t?t:d.length)):d.slice(e,t)}function ru(d,e,t){return!d||!t&&d.constructor===e?d:"number"==typeof e.BYTES_PER_ELEMENT?new e(d):Array.prototype.slice.call(d)}function Pp(d){return ArrayBuffer.isView(d)&&!(d instanceof DataView)}function nv(d){const t=d.length,i=new Array(t);for(let s=0;s!==t;++s)i[s]=s;return i.sort(function e(s,a){return d[s]-d[a]}),i}function Ad(d,e,t){const i=d.length,s=new d.constructor(i);for(let a=0,c=0;c!==i;++a){const u=t[a]*e;for(let f=0;f!==e;++f)s[c++]=d[u+f]}return s}function Gh(d,e,t,i){let s=1,a=d[0];for(;void 0!==a&&void 0===a[i];)a=d[s++];if(void 0===a)return;let c=a[i];if(void 0!==c)if(Array.isArray(c))do{c=a[i],void 0!==c&&(e.push(a.time),t.push.apply(t,c)),a=d[s++]}while(void 0!==a);else if(void 0!==c.toArray)do{c=a[i],void 0!==c&&(e.push(a.time),c.toArray(t,t.length)),a=d[s++]}while(void 0!==a);else do{c=a[i],void 0!==c&&(e.push(a.time),t.push(c)),a=d[s++]}while(void 0!==a)}class Td{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,s=t[i],a=t[i-1];e:{t:{let c;n:{i:if(!(e<s)){for(let u=i+2;;){if(void 0===s){if(e<a)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===u)break;if(a=s,s=t[++i],e<s)break t}c=t.length;break n}if(e>=a)break e;{const u=t[1];e<u&&(i=2,a=u);for(let f=i-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(i===f)break;if(s=a,a=t[--i-1],e>=a)break t}c=i,i=0}}for(;i<c;){const u=i+c>>>1;e<t[u]?c=u:i=u+1}if(s=t[i],a=t[i-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,a,s)}return this.interpolate_(i,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=e*s;for(let c=0;c!==s;++c)t[c]=i[a+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Lp extends Td{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:On,endingEnd:On}}intervalChanged_(e,t,i){const s=this.parameterPositions;let a=e-2,c=e+1,u=s[a],f=s[c];if(void 0===u)switch(this.getSettings_().endingStart){case $i:a=e,u=2*t-i;break;case 2402:a=s.length-2,u=t+s[a]-s[a+1];break;default:a=e,u=i}if(void 0===f)switch(this.getSettings_().endingEnd){case $i:c=e,f=2*i-t;break;case 2402:c=1,f=i+s[1]-s[0];break;default:c=e-1,f=t}const m=.5*(i-t),v=this.valueSize;this._weightPrev=m/(t-u),this._weightNext=m/(f-i),this._offsetPrev=a*v,this._offsetNext=c*v}interpolate_(e,t,i,s){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,f=e*u,m=f-u,v=this._offsetPrev,y=this._offsetNext,_=this._weightPrev,x=this._weightNext,M=(i-t)/(s-t),P=M*M,C=P*M,A=-_*C+2*_*P-_*M,F=(1+_)*C+(-1.5-2*_)*P+(-.5+_)*M+1,N=(-1-x)*C+(1.5+x)*P+.5*M,W=x*C-x*P;for(let Z=0;Z!==u;++Z)a[Z]=A*c[v+Z]+F*c[m+Z]+N*c[f+Z]+W*c[y+Z];return a}}class Op extends Td{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,f=e*u,m=f-u,v=(i-t)/(s-t),y=1-v;for(let _=0;_!==u;++_)a[_]=c[m+_]*y+c[f+_]*v;return a}}class Pl extends Td{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class fl{constructor(e,t,i,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ru(t,this.TimeBufferType),this.values=ru(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ru(e.times,Array),values:ru(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Pl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Op(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Lp(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Zt:t=this.InterpolantFactoryMethodDiscrete;break;case En:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Zt;case this.InterpolantFactoryMethodLinear:return En;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){const i=this.times,s=i.length;let a=0,c=s-1;for(;a!==s&&i[a]<e;)++a;for(;-1!==c&&i[c]>t;)--c;if(++c,0!==a||c!==s){a>=c&&(c=Math.max(c,1),a=c-1);const u=this.getValueSize();this.times=ba(i,a,c),this.values=ba(this.values,a*u,c*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,a=i.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let u=0;u!==a;u++){const f=i[u];if("number"==typeof f&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,f),e=!1;break}if(null!==c&&c>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,f,c),e=!1;break}c=f}if(void 0!==s&&Pp(s))for(let u=0,f=s.length;u!==f;++u){const m=s[u];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,m),e=!1;break}}return e}optimize(){const e=ba(this.times),t=ba(this.values),i=this.getValueSize(),s=2302===this.getInterpolation(),a=e.length-1;let c=1;for(let u=1;u<a;++u){let f=!1;const m=e[u];if(m!==e[u+1]&&(1!==u||m!==e[0]))if(s)f=!0;else{const y=u*i,_=y-i,x=y+i;for(let M=0;M!==i;++M){const P=t[y+M];if(P!==t[_+M]||P!==t[x+M]){f=!0;break}}}if(f){if(u!==c){e[c]=e[u];const y=u*i,_=c*i;for(let x=0;x!==i;++x)t[_+x]=t[y+x]}++c}}if(a>0){e[c]=e[a];for(let u=a*i,f=c*i,m=0;m!==i;++m)t[f+m]=t[u+m];++c}return c!==e.length?(this.times=ba(e,0,c),this.values=ba(t,0,c*i)):(this.times=e,this.values=t),this}clone(){const e=ba(this.times,0),t=ba(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}fl.prototype.TimeBufferType=Float32Array,fl.prototype.ValueBufferType=Float32Array,fl.prototype.DefaultInterpolation=En;class pc extends fl{}pc.prototype.ValueTypeName="bool",pc.prototype.ValueBufferType=Array,pc.prototype.DefaultInterpolation=Zt,pc.prototype.InterpolantFactoryMethodLinear=void 0,pc.prototype.InterpolantFactoryMethodSmooth=void 0;class x_ extends fl{}x_.prototype.ValueTypeName="color";class Wh extends fl{}Wh.prototype.ValueTypeName="number";class Aw extends Td{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,f=(i-t)/(s-t);let m=e*u;for(let v=m+u;m!==v;m+=4)on.slerpFlat(a,0,c,m-u,c,m,f);return a}}class su extends fl{InterpolantFactoryMethodLinear(e){return new Aw(this.times,this.values,this.getValueSize(),e)}}su.prototype.ValueTypeName="quaternion",su.prototype.DefaultInterpolation=En,su.prototype.InterpolantFactoryMethodSmooth=void 0;class ou extends fl{}ou.prototype.ValueTypeName="string",ou.prototype.ValueBufferType=Array,ou.prototype.DefaultInterpolation=Zt,ou.prototype.InterpolantFactoryMethodLinear=void 0,ou.prototype.InterpolantFactoryMethodSmooth=void 0;class Dd extends fl{}Dd.prototype.ValueTypeName="vector";class jh{constructor(e,t=-1,i,s=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=s,this.uuid=Ir(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,s=1/(e.fps||1);for(let c=0,u=i.length;c!==u;++c)t.push(iv(i[c]).scale(s));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const t=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,c=i.length;a!==c;++a)t.push(fl.toJSON(i[a]));return s}static CreateFromMorphTargetSequence(e,t,i,s){const a=t.length,c=[];for(let u=0;u<a;u++){let f=[],m=[];f.push((u+a-1)%a,u,(u+1)%a),m.push(0,1,0);const v=nv(f);f=Ad(f,1,v),m=Ad(m,1,v),!s&&0===f[0]&&(f.push(a),m.push(m[0])),c.push(new Wh(".morphTargetInfluences["+t[u].name+"]",f,m).scale(1/i))}return new this(e,-1,c)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let s=0;s<i.length;s++)if(i[s].name===t)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const s={},a=/^([\w-]*?)([\d]+)$/;for(let u=0,f=e.length;u<f;u++){const m=e[u],v=m.name.match(a);if(v&&v.length>1){const y=v[1];let _=s[y];_||(s[y]=_=[]),_.push(m)}}const c=[];for(const u in s)c.push(this.CreateFromMorphTargetSequence(u,s[u],t,i));return c}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(y,_,x,M,P){if(0!==x.length){const C=[],A=[];Gh(x,C,A,M),0!==C.length&&P.push(new y(_,C,A))}},s=[],a=e.name||"default",c=e.fps||30,u=e.blendMode;let f=e.length||-1;const m=e.hierarchy||[];for(let y=0;y<m.length;y++){const _=m[y].keys;if(_&&0!==_.length)if(_[0].morphTargets){const x={};let M;for(M=0;M<_.length;M++)if(_[M].morphTargets)for(let P=0;P<_[M].morphTargets.length;P++)x[_[M].morphTargets[P]]=-1;for(const P in x){const C=[],A=[];for(let F=0;F!==_[M].morphTargets.length;++F){const N=_[M];C.push(N.time),A.push(N.morphTarget===P?1:0)}s.push(new Wh(".morphTargetInfluence["+P+"]",C,A))}f=x.length*c}else{const x=".bones["+t[y].name+"]";i(Dd,x+".position",_,"pos",s),i(su,x+".quaternion",_,"rot",s),i(Dd,x+".scale",_,"scl",s)}}return 0===s.length?null:new this(a,f,s,u)}resetDuration(){let t=0;for(let i=0,s=this.tracks.length;i!==s;++i){const a=this.tracks[i];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function iv(d){if(void 0===d.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function E_(d){switch(d.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Wh;case"vector":case"vector2":case"vector3":case"vector4":return Dd;case"color":return x_;case"quaternion":return su;case"bool":case"boolean":return pc;case"string":return ou}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+d)}(d.type);if(void 0===d.times){const t=[],i=[];Gh(d.keys,t,i,"value"),d.times=t,d.values=i}return void 0!==e.parse?e.parse(d):new e(d.name,d.times,d.values,d.interpolation)}const au={enabled:!1,files:{},add:function(d,e){!1!==this.enabled&&(this.files[d]=e)},get:function(d){if(!1!==this.enabled)return this.files[d]},remove:function(d){delete this.files[d]},clear:function(){this.files={}}};class Id{constructor(e,t,i){const s=this;let f,a=!1,c=0,u=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(v){u++,!1===a&&void 0!==s.onStart&&s.onStart(v,c,u),a=!0},this.itemEnd=function(v){c++,void 0!==s.onProgress&&s.onProgress(v,c,u),c===u&&(a=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(v){void 0!==s.onError&&s.onError(v)},this.resolveURL=function(v){return f?f(v):v},this.setURLModifier=function(v){return f=v,this},this.addHandler=function(v,y){return m.push(v,y),this},this.removeHandler=function(v){const y=m.indexOf(v);return-1!==y&&m.splice(y,2),this},this.getHandler=function(v){for(let y=0,_=m.length;y<_;y+=2){const x=m[y],M=m[y+1];if(x.global&&(x.lastIndex=0),x.test(v))return M}return null}}}const Yh=new Id;let Rd=(()=>{class d{constructor(t){this.manager=void 0!==t?t:Yh,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const s=this;return new Promise(function(a,c){s.load(t,a,i,c)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return d.DEFAULT_MATERIAL_NAME="__DEFAULT",d})();const Ll={};class Tw extends Error{constructor(e,t){super(e),this.response=t}}class pl extends Rd{constructor(e){super(e)}load(e,t,i,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=au.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(void 0!==Ll[e])return void Ll[e].push({onLoad:t,onProgress:i,onError:s});Ll[e]=[],Ll[e].push({onLoad:t,onProgress:i,onError:s});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,f=this.responseType;fetch(c).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===m.body||void 0===m.body.getReader)return m;const v=Ll[e],y=m.body.getReader(),_=m.headers.get("Content-Length")||m.headers.get("X-File-Size"),x=_?parseInt(_):0,M=0!==x;let P=0;const C=new ReadableStream({start(A){!function F(){y.read().then(({done:N,value:W})=>{if(N)A.close();else{P+=W.byteLength;const Z=new ProgressEvent("progress",{lengthComputable:M,loaded:P,total:x});for(let te=0,ee=v.length;te<ee;te++){const le=v[te];le.onProgress&&le.onProgress(Z)}A.enqueue(W),F()}})}()}});return new Response(C)}throw new Tw(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`,m)}).then(m=>{switch(f){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>(new DOMParser).parseFromString(v,u));case"json":return m.json();default:if(void 0===u)return m.text();{const y=/charset="?([^;"\s]*)"?/i.exec(u),_=y&&y[1]?y[1].toLowerCase():void 0,x=new TextDecoder(_);return m.arrayBuffer().then(M=>x.decode(M))}}}).then(m=>{au.add(e,m);const v=Ll[e];delete Ll[e];for(let y=0,_=v.length;y<_;y++){const x=v[y];x.onLoad&&x.onLoad(m)}}).catch(m=>{const v=Ll[e];if(void 0===v)throw this.manager.itemError(e),m;delete Ll[e];for(let y=0,_=v.length;y<_;y++){const x=v[y];x.onError&&x.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class rv extends Rd{constructor(e){super(e)}load(e,t,i,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=au.get(e);if(void 0!==c)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const u=wl("img");function f(){v(),au.add(e,this),t&&t(this),a.manager.itemEnd(e)}function m(y){v(),s&&s(y),a.manager.itemError(e),a.manager.itemEnd(e)}function v(){u.removeEventListener("load",f,!1),u.removeEventListener("error",m,!1)}return u.addEventListener("load",f,!1),u.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u}}class Np extends Rd{constructor(e){super(e)}load(e,t,i,s){const a=new To,c=new rv(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(u){a.image=u,a.needsUpdate=!0,void 0!==t&&t(a)},i,s),a}}class ov extends Ls{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Yn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const av=new _i,w_=new he,M_=new he;class lv{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jt(512,512),this.map=null,this.mapPass=null,this.matrix=new _i,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Wf,this._frameExtents=new Jt(1,1),this._viewportCount=1,this._viewports=[new zr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;w_.setFromMatrixPosition(e.matrixWorld),t.position.copy(w_),M_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(M_),t.updateMatrixWorld(),av.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(av),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(av)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Iw extends lv{constructor(){super(new ho(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*ls*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(i!==t.fov||s!==t.aspect||a!==t.far)&&(t.fov=i,t.aspect=s,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class cv extends ov{constructor(e,t,i=0,s=Math.PI/3,a=0,c=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ls.DEFAULT_UP),this.updateMatrix(),this.target=new Ls,this.distance=i,this.angle=s,this.penumbra=a,this.decay=c,this.map=null,this.shadow=new Iw}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const mc=new _i,qh=new he,Xh=new he;class ml extends lv{constructor(){super(new ho(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jt(4,2),this._viewportCount=6,this._viewports=[new zr(2,1,1,1),new zr(0,1,1,1),new zr(3,1,1,1),new zr(1,1,1,1),new zr(3,0,1,1),new zr(1,0,1,1)],this._cubeDirections=[new he(1,0,0),new he(-1,0,0),new he(0,0,1),new he(0,0,-1),new he(0,1,0),new he(0,-1,0)],this._cubeUps=[new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,1,0),new he(0,0,1),new he(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,s=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),qh.setFromMatrixPosition(e.matrixWorld),i.position.copy(qh),Xh.copy(i.position),Xh.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Xh),i.updateMatrixWorld(),s.makeTranslation(-qh.x,-qh.y,-qh.z),mc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mc)}}class uv extends ov{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new ml}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Rw extends lv{constructor(){super(new ip(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class S_ extends ov{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ls.DEFAULT_UP),this.updateMatrix(),this.target=new Ls,this.shadow=new Rw}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class zs extends ov{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class lu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,s=e.length;i<s;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class D_ extends Rd{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=au.get(e);if(void 0!==c)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const u={};u.credentials="anonymous"===this.crossOrigin?"same-origin":"include",u.headers=this.requestHeader,fetch(e,u).then(function(f){return f.blob()}).then(function(f){return createImageBitmap(f,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(f){au.add(e,f),t&&t(f),a.manager.itemEnd(e)}).catch(function(f){s&&s(f),a.manager.itemError(e),a.manager.itemEnd(e)}),a.manager.itemStart(e)}}class zw{constructor(e,t,i){let s,a,c;switch(this.binding=e,this.valueSize=i,t){case"quaternion":s=this._slerp,a=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":s=this._select,a=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:s=this._lerp,a=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=a,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,s=this.valueSize,a=e*s+s;let c=this.cumulativeWeight;if(0===c){for(let u=0;u!==s;++u)i[a+u]=i[u];c=t}else c+=t,this._mixBufferRegion(i,a,0,t/c,s);this.cumulativeWeight=c}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,s=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,s=e*t+t,a=this.cumulativeWeight,c=this.cumulativeWeightAdditive,u=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1&&this._mixBufferRegion(i,s,t*this._origIndex,1-a,t),c>0&&this._mixBufferRegionAdditive(i,s,this._addIndex*t,1,t);for(let f=t,m=t+t;f!==m;++f)if(i[f]!==i[f+t]){u.setValue(i,s);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,s=i*this._origIndex;this.binding.getValue(t,s);for(let a=i,c=s;a!==c;++a)t[a]=t[s+a%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,s,a){if(s>=.5)for(let c=0;c!==a;++c)e[t+c]=e[i+c]}_slerp(e,t,i,s){on.slerpFlat(e,t,e,t,e,i,s)}_slerpAdditive(e,t,i,s,a){const c=this._workIndex*a;on.multiplyQuaternionsFlat(e,c,e,t,e,i),on.slerpFlat(e,t,e,t,e,c,s)}_lerp(e,t,i,s,a){const c=1-s;for(let u=0;u!==a;++u){const f=t+u;e[f]=e[f]*c+e[i+u]*s}}_lerpAdditive(e,t,i,s,a){for(let c=0;c!==a;++c){const u=t+c;e[u]=e[u]+e[i+c]*s}}}const Bp="\\[\\]\\.:\\/",pv=new RegExp("["+Bp+"]","g"),mv="[^"+Bp+"]",kp="[^"+Bp.replace("\\.","")+"]",jw=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",mv)+/(WCOD+)?/.source.replace("WCOD",kp)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",mv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",mv)+"$"),Yw=["material","materials","bones","map"];class qw{constructor(e,t,i){const s=i||es.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=i.length;s!==a;++s)i[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let es=(()=>{class d{constructor(t,i,s){this.path=i,this.parsedPath=s||d.parseTrackName(i),this.node=d.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new d.Composite(t,i,s):new d(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(pv,"")}static parseTrackName(t){const i=jw.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},a=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const c=s.nodeName.substring(a+1);-1!==Yw.indexOf(c)&&(s.nodeName=s.nodeName.substring(0,a),s.objectName=c)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(i);if(void 0!==s)return s}if(t.children){const s=function(c){for(let u=0;u<c.length;u++){const f=c[u];if(f.name===i||f.uuid===i)return f;const m=s(f.children);if(m)return m}return null},a=s(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)t[i++]=s[a]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,s=i.objectName,a=i.propertyName;let c=i.propertyIndex;if(t||(t=d.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(s){let v=i.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===v){v=y;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const u=t[a];if(void 0===u)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+a+" but it wasn't found.",t);let f=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?f=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(f=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==c){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[c]&&(c=t.morphTargetDictionary[c])}m=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=c}else void 0!==u.fromArray&&void 0!==u.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(m=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=a;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return d.Composite=qw,d})();es.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},es.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},es.prototype.GetterByBindingType=[es.prototype._getValue_direct,es.prototype._getValue_array,es.prototype._getValue_arrayElement,es.prototype._getValue_toArray],es.prototype.SetterByBindingTypeAndVersioning=[[es.prototype._setValue_direct,es.prototype._setValue_direct_setNeedsUpdate,es.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[es.prototype._setValue_array,es.prototype._setValue_array_setNeedsUpdate,es.prototype._setValue_array_setMatrixWorldNeedsUpdate],[es.prototype._setValue_arrayElement,es.prototype._setValue_arrayElement_setNeedsUpdate,es.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[es.prototype._setValue_fromArray,es.prototype._setValue_fromArray_setNeedsUpdate,es.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Kw{constructor(e,t,i=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=s;const a=t.tracks,c=a.length,u=new Array(c),f={endingStart:On,endingEnd:On};for(let m=0;m!==c;++m){const v=a[m].createInterpolant(null);u[m]=v,v.settings=f}this._interpolantSettings=f,this._interpolants=u,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const s=this._clip.duration,a=e._clip.duration,u=s/a;e.warp(1,a/s,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const s=this._mixer,a=s.time,c=this.timeScale;let u=this._timeScaleInterpolant;null===u&&(u=s._lendControlInterpolant(),this._timeScaleInterpolant=u);const f=u.parameterPositions,m=u.sampleValues;return f[0]=a,f[1]=a+i,m[0]=e/c,m[1]=t/c,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,s){if(!this.enabled)return void this._updateWeight(e);const a=this._startTime;if(null!==a){const f=(e-a)*i;f<0||0===i?t=0:(this._startTime=null,t=i*f)}t*=this._updateTimeScale(e);const c=this._updateTime(t),u=this._updateWeight(e);if(u>0){const f=this._interpolants,m=this._propertyBindings;if(2501===this.blendMode)for(let v=0,y=f.length;v!==y;++v)f[v].evaluate(c),m[v].accumulateAdditive(u);else for(let v=0,y=f.length;v!==y;++v)f[v].evaluate(c),m[v].accumulate(s,u)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const s=i.evaluate(e)[0];t*=s,e>i.parameterPositions[1]&&(this.stopFading(),0===s&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let s=this.time+e,a=this._loopCount;const c=2202===i;if(0===e)return-1===a?s:c&&1==(1&a)?t-s:s;if(2200===i){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else{if(!(s<0)){this.time=s;break e}s=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,c)):this._setEndings(0===this.repetitions,!0,c)),s>=t||s<0){const u=Math.floor(s/t);s-=t*u,a+=Math.abs(u);const f=this.repetitions-a;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===f){const m=e<0;this._setEndings(m,!m,c)}else this._setEndings(!1,!1,c);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=s;if(c&&1==(1&a))return t-s}return s}_setEndings(e,t,i){const s=this._interpolantSettings;i?(s.endingStart=$i,s.endingEnd=$i):(s.endingStart=e?this.zeroSlopeAtStart?$i:On:2402,s.endingEnd=t?this.zeroSlopeAtEnd?$i:On:2402)}_scheduleFading(e,t,i){const s=this._mixer,a=s.time;let c=this._weightInterpolant;null===c&&(c=s._lendControlInterpolant(),this._weightInterpolant=c);const u=c.parameterPositions,f=c.sampleValues;return u[0]=a,f[0]=t,u[1]=a+e,f[1]=i,this}}const GA=new Float32Array(1);class O_ extends mr{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,s=e._clip.tracks,a=s.length,c=e._propertyBindings,u=e._interpolants,f=i.uuid,m=this._bindingsByRootAndName;let v=m[f];void 0===v&&(v={},m[f]=v);for(let y=0;y!==a;++y){const _=s[y],x=_.name;let M=v[x];if(void 0!==M)++M.referenceCount,c[y]=M;else{if(M=c[y],void 0!==M){null===M._cacheIndex&&(++M.referenceCount,this._addInactiveBinding(M,f,x));continue}M=new zw(es.create(i,x,t&&t._propertyBindings[y].binding.parsedPath),_.ValueTypeName,_.getValueSize()),++M.referenceCount,this._addInactiveBinding(M,f,x),c[y]=M}u[y].resultBuffer=M.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,s=e._clip.uuid,a=this._actionsByClip[s];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,s,i)}const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const a=t[i];0==a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const a=t[i];0==--a.useCount&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const s=this._actions,a=this._actionsByClip;let c=a[t];if(void 0===c)c={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=c;else{const u=c.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=s.length,s.push(e),c.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],s=e._cacheIndex;i._cacheIndex=s,t[s]=i,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,c=this._actionsByClip,u=c[a],f=u.knownActions,m=f[f.length-1],v=e._byClipCacheIndex;m._byClipCacheIndex=v,f[v]=m,f.pop(),e._byClipCacheIndex=null,delete u.actionByRoot[(e._localRoot||this._root).uuid],0===f.length&&delete c[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const a=t[i];0==--a.referenceCount&&this._removeInactiveBinding(a)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,s=this._nActiveActions++,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=i,t[i]=a}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,s=--this._nActiveActions,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=i,t[i]=a}_addInactiveBinding(e,t,i){const s=this._bindingsByRootAndName,a=this._bindings;let c=s[t];void 0===c&&(c={},s[t]=c),c[i]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,s=i.rootNode.uuid,a=i.path,c=this._bindingsByRootAndName,u=c[s],f=t[t.length-1],m=e._cacheIndex;f._cacheIndex=m,t[m]=f,t.pop(),delete u[a],0===Object.keys(u).length&&delete c[s]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,s=this._nActiveBindings++,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=i,t[i]=a}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,s=--this._nActiveBindings,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=i,t[i]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new Op(new Float32Array(2),new Float32Array(2),1,GA),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,s=--this._nActiveControlInterpolants,a=t[s];e.__cacheIndex=s,t[s]=e,a.__cacheIndex=i,t[i]=a}clipAction(e,t,i){const s=t||this._root,a=s.uuid;let c="string"==typeof e?jh.findByName(s,e):e;const u=null!==c?c.uuid:e,f=this._actionsByClip[u];let m=null;if(void 0===i&&(i=null!==c?c.blendMode:2500),void 0!==f){const y=f.actionByRoot[a];if(void 0!==y&&y.blendMode===i)return y;m=f.knownActions[0],null===c&&(c=m._clip)}if(null===c)return null;const v=new Kw(this,c,t,i);return this._bindAction(v,m),this._addInactiveAction(v,u,a),v}existingAction(e,t){const i=t||this._root,s=i.uuid,a="string"==typeof e?jh.findByName(i,e):e,u=this._actionsByClip[a?a.uuid:e];return void 0!==u&&u.actionByRoot[s]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,s=this.time+=e*=this.timeScale,a=Math.sign(e),c=this._accuIndex^=1;for(let m=0;m!==i;++m)t[m]._update(s,e,a,c);const u=this._bindings,f=this._nActiveBindings;for(let m=0;m!==f;++m)u[m].apply(c);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,s=this._actionsByClip,a=s[i];if(void 0!==a){const c=a.knownActions;for(let u=0,f=c.length;u!==f;++u){const m=c[u];this._deactivateAction(m);const v=m._cacheIndex,y=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,y._cacheIndex=v,t[v]=y,t.pop(),this._removeInactiveBindingsForAction(m)}delete s[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const c in i){const f=i[c].actionByRoot[t];void 0!==f&&(this._deactivateAction(f),this._removeInactiveAction(f))}const a=this._bindingsByRootAndName[t];if(void 0!==a)for(const c in a){const u=a[c];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class fu{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(xr(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"156"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="156");class Oa{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new X);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new X);const i=this.elements,s=e.x,a=e.y,c=e.z;return t.x=i[0]*s+i[1]*a+i[2]*c,t.y=i[3]*s+i[4]*a+i[5]*c,t.z=i[6]*s+i[7]*a+i[8]*c,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new Oa);const i=this.elements,s=e.elements,a=t.elements,c=i[0],u=i[1],f=i[2],m=i[3],v=i[4],y=i[5],_=i[6],x=i[7],M=i[8],P=s[0],C=s[1],A=s[2],F=s[3],N=s[4],W=s[5],Z=s[6],te=s[7],ee=s[8];return a[0]=c*P+u*F+f*Z,a[1]=c*C+u*N+f*te,a[2]=c*A+u*W+f*ee,a[3]=m*P+v*F+y*Z,a[4]=m*C+v*N+y*te,a[5]=m*A+v*W+y*ee,a[6]=_*P+x*F+M*Z,a[7]=_*C+x*N+M*te,a[8]=_*A+x*W+M*ee,t}scale(e,t){void 0===t&&(t=new Oa);const i=this.elements,s=t.elements;for(let a=0;3!==a;a++)s[3*a+0]=e.x*i[3*a+0],s[3*a+1]=e.y*i[3*a+1],s[3*a+2]=e.z*i[3*a+2];return t}solve(e,t){void 0===t&&(t=new X);const a=[];let c,u;for(c=0;c<12;c++)a.push(0);for(c=0;c<3;c++)for(u=0;u<3;u++)a[c+4*u]=this.elements[c+3*u];a[3]=e.x,a[7]=e.y,a[11]=e.z;let f=3;const m=f;let v,_;do{if(c=m-f,0===a[c+4*c])for(u=c+1;u<m;u++)if(0!==a[c+4*u]){v=4;do{_=4-v,a[_+4*c]+=a[_+4*u]}while(--v);break}if(0!==a[c+4*c])for(u=c+1;u<m;u++){const x=a[c+4*u]/a[c+4*c];v=4;do{_=4-v,a[_+4*u]=_<=c?0:a[_+4*u]-a[_+4*c]*x}while(--v)}}while(--f);if(t.z=a[11]/a[10],t.y=(a[7]-a[6]*t.z)/a[5],t.x=(a[3]-a[2]*t.z-a[1]*t.y)/a[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e){void 0===e&&(e=new Oa);const s=Od;let a,c;for(a=0;a<3;a++)for(c=0;c<3;c++)s[a+6*c]=this.elements[a+3*c];s[3]=1,s[9]=0,s[15]=0,s[4]=0,s[10]=1,s[16]=0,s[5]=0,s[11]=0,s[17]=1;let u=3;const f=u;let m,y;do{if(a=f-u,0===s[a+6*a])for(c=a+1;c<f;c++)if(0!==s[a+6*c]){m=6;do{y=6-m,s[y+6*a]+=s[y+6*c]}while(--m);break}if(0!==s[a+6*a])for(c=a+1;c<f;c++){const _=s[a+6*c]/s[a+6*a];m=6;do{y=6-m,s[y+6*c]=y<=a?0:s[y+6*c]-s[y+6*a]*_}while(--m)}}while(--u);a=2;do{c=a-1;do{const _=s[a+6*c]/s[a+6*a];m=6;do{y=6-m,s[y+6*c]=s[y+6*c]-s[y+6*a]*_}while(--m)}while(c--)}while(--a);a=2;do{const _=1/s[a+6*a];m=6;do{y=6-m,s[y+6*a]=s[y+6*a]*_}while(--m)}while(a--);a=2;do{c=2;do{if(y=s[3+c+6*a],isNaN(y)||y===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(a,c,y)}while(c--)}while(a--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,s=e.z,a=e.w,c=t+t,u=i+i,f=s+s,m=t*c,v=t*u,y=t*f,_=i*u,x=i*f,M=s*f,P=a*c,C=a*u,A=a*f,F=this.elements;return F[0]=1-(_+M),F[1]=v-A,F[2]=y+C,F[3]=v+A,F[4]=1-(m+M),F[5]=x-P,F[6]=y-C,F[7]=x+P,F[8]=1-(m+_),this}transpose(e){void 0===e&&(e=new Oa);const t=this.elements,i=e.elements;let s;return i[0]=t[0],i[4]=t[4],i[8]=t[8],s=t[1],i[1]=t[3],i[3]=s,s=t[2],i[2]=t[6],i[6]=s,s=t[5],i[5]=t[7],i[7]=s,e}}const Od=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class X{constructor(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this.x=e,this.y=t,this.z=i}cross(e,t){void 0===t&&(t=new X);const i=e.x,s=e.y,a=e.z,c=this.x,u=this.y,f=this.z;return t.x=u*a-f*s,t.y=f*i-c*a,t.z=c*s-u*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new X(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new X(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Oa([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,s=Math.sqrt(e*e+t*t+i*i);if(s>0){const a=1/s;this.x*=a,this.y*=a,this.z*=a}else this.x=0,this.y=0,this.z=0;return s}unit(e){void 0===e&&(e=new X);const t=this.x,i=this.y,s=this.z;let a=Math.sqrt(t*t+i*i+s*s);return a>0?(a=1/a,e.x=t*a,e.y=i*a,e.z=s*a):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,s=this.z,a=e.x,c=e.y,u=e.z;return Math.sqrt((a-t)*(a-t)+(c-i)*(c-i)+(u-s)*(u-s))}distanceSquared(e){const t=this.x,i=this.y,s=this.z,a=e.x,c=e.y,u=e.z;return(a-t)*(a-t)+(c-i)*(c-i)+(u-s)*(u-s)}scale(e,t){void 0===t&&(t=new X);const s=this.y,a=this.z;return t.x=e*this.x,t.y=e*s,t.z=e*a,t}vmul(e,t){return void 0===t&&(t=new X),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i){return void 0===i&&(i=new X),i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new X),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const s=nM,a=1/i;s.set(this.x*a,this.y*a,this.z*a);const c=k_;Math.abs(s.x)<.9?(c.set(1,0,0),s.cross(c,e)):(c.set(0,1,0),s.cross(c,e)),s.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const s=this.x,a=this.y,c=this.z;i.x=s+(e.x-s)*t,i.y=a+(e.y-a)*t,i.z=c+(e.z-c)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(U_),U_.almostEquals(e,t)}clone(){return new X(this.x,this.y,this.z)}}X.ZERO=new X(0,0,0),X.UNIT_X=new X(1,0,0),X.UNIT_Y=new X(0,1,0),X.UNIT_Z=new X(0,0,1);const nM=new X,k_=new X,U_=new X;class us{constructor(e){void 0===e&&(e={}),this.lowerBound=new X,this.upperBound=new X,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,s){const a=this.lowerBound,c=this.upperBound,u=i;a.copy(e[0]),u&&u.vmult(a,a),c.copy(a);for(let f=1;f<e.length;f++){let m=e[f];u&&(u.vmult(m,iM),m=iM),m.x>c.x&&(c.x=m.x),m.x<a.x&&(a.x=m.x),m.y>c.y&&(c.y=m.y),m.y<a.y&&(a.y=m.y),m.z>c.z&&(c.z=m.z),m.z<a.z&&(a.z=m.z)}return t&&(t.vadd(a,a),t.vadd(c,c)),s&&(a.x-=s,a.y-=s,a.z-=s,c.x+=s,c.y+=s,c.z+=s),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new us).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,s=e.lowerBound,a=e.upperBound;return(s.x<=i.x&&i.x<=a.x||t.x<=a.x&&a.x<=i.x)&&(s.y<=i.y&&i.y<=a.y||t.y<=a.y&&a.y<=i.y)&&(s.z<=i.z&&i.z<=a.z||t.z<=a.z&&a.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,s=e.lowerBound,a=e.upperBound;return t.x<=s.x&&i.x>=a.x&&t.y<=s.y&&i.y>=a.y&&t.z<=s.z&&i.z>=a.z}getCorners(e,t,i,s,a,c,u,f){const m=this.lowerBound,v=this.upperBound;e.copy(m),t.set(v.x,m.y,m.z),i.set(v.x,v.y,m.z),s.set(m.x,v.y,v.z),a.set(v.x,m.y,v.z),c.set(m.x,v.y,m.z),u.set(m.x,m.y,v.z),f.copy(v)}toLocalFrame(e,t){const i=$p;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let _=0;8!==_;_++){const x=i[_];e.pointToLocal(x,x)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=$p;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let _=0;8!==_;_++){const x=i[_];e.pointToWorld(x,x)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,s=1/t.x,a=1/t.y,c=1/t.z,u=(this.lowerBound.x-i.x)*s,f=(this.upperBound.x-i.x)*s,m=(this.lowerBound.y-i.y)*a,v=(this.upperBound.y-i.y)*a,y=(this.lowerBound.z-i.z)*c,_=(this.upperBound.z-i.z)*c,x=Math.max(Math.max(Math.min(u,f),Math.min(m,v)),Math.min(y,_)),M=Math.min(Math.min(Math.max(u,f),Math.max(m,v)),Math.max(y,_));return!(M<0||x>M)}}const iM=new X,$p=[new X,new X,new X,new X,new X,new X,new X,new X];class Gp{constructor(){this.matrix=[]}get(e,t){let{index:i}=e,{index:s}=t;if(s>i){const a=s;s=i,i=a}return this.matrix[(i*(i+1)>>1)+s-1]}set(e,t,i){let{index:s}=e,{index:a}=t;if(a>s){const c=a;a=s,s=c}this.matrix[(s*(s+1)>>1)+a-1]=i?1:0}reset(){for(let e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class wv{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const s=i[e].indexOf(t);return-1!==s&&i[e].splice(s,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let s=0,a=i.length;s<a;s++)i[s].call(this,e)}return this}}class ds{constructor(e,t,i,s){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=1),this.x=e,this.y=t,this.z=i,this.w=s}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new X),this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=vl;e.tangents(i,rM),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new ds);const i=this.x,s=this.y,a=this.z,c=this.w,u=e.x,f=e.y,m=e.z,v=e.w;return t.x=i*v+c*u+s*m-a*f,t.y=s*v+c*f+a*u-i*m,t.z=a*v+c*m+i*f-s*u,t.w=c*v-i*u-s*f-a*m,t}inverse(e){void 0===e&&(e=new ds);const t=this.x,i=this.y,s=this.z,a=this.w;this.conjugate(e);const c=1/(t*t+i*i+s*s+a*a);return e.x*=c,e.y*=c,e.z*=c,e.w*=c,e}conjugate(e){return void 0===e&&(e=new ds),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new X);const i=e.x,s=e.y,a=e.z,c=this.x,u=this.y,f=this.z,m=this.w,v=m*i+u*a-f*s,y=m*s+f*i-c*a,_=m*a+c*s-u*i,x=-c*i-u*s-f*a;return t.x=v*m+x*-c+y*-f-_*-u,t.y=y*m+x*-u+_*-c-v*-f,t.z=_*m+x*-f+v*-u-y*-c,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let i,s,a;void 0===t&&(t="YZX");const c=this.x,u=this.y,f=this.z,m=this.w;if("YZX"!==t)throw new Error(`Euler order ${t} not supported yet.`);{const v=c*u+f*m;if(v>.499&&(i=2*Math.atan2(c,m),s=Math.PI/2,a=0),v<-.499&&(i=-2*Math.atan2(c,m),s=-Math.PI/2,a=0),void 0===i){const y=c*c,x=f*f;i=Math.atan2(2*u*m-2*c*f,1-u*u*2-2*x),s=Math.asin(2*v),a=Math.atan2(2*c*m-2*u*f,1-2*y-2*x)}}e.y=i,e.z=s,e.x=a}setFromEuler(e,t,i,s){void 0===s&&(s="XYZ");const a=Math.cos(e/2),c=Math.cos(t/2),u=Math.cos(i/2),f=Math.sin(e/2),m=Math.sin(t/2),v=Math.sin(i/2);return"XYZ"===s?(this.x=f*c*u+a*m*v,this.y=a*m*u-f*c*v,this.z=a*c*v+f*m*u,this.w=a*c*u-f*m*v):"YXZ"===s?(this.x=f*c*u+a*m*v,this.y=a*m*u-f*c*v,this.z=a*c*v-f*m*u,this.w=a*c*u+f*m*v):"ZXY"===s?(this.x=f*c*u-a*m*v,this.y=a*m*u+f*c*v,this.z=a*c*v+f*m*u,this.w=a*c*u-f*m*v):"ZYX"===s?(this.x=f*c*u-a*m*v,this.y=a*m*u+f*c*v,this.z=a*c*v-f*m*u,this.w=a*c*u+f*m*v):"YZX"===s?(this.x=f*c*u+a*m*v,this.y=a*m*u+f*c*v,this.z=a*c*v-f*m*u,this.w=a*c*u-f*m*v):"XZY"===s&&(this.x=f*c*u-a*m*v,this.y=a*m*u-f*c*v,this.z=a*c*v+f*m*u,this.w=a*c*u+f*m*v),this}clone(){return new ds(this.x,this.y,this.z,this.w)}slerp(e,t,i){void 0===i&&(i=new ds);const s=this.x,a=this.y,c=this.z,u=this.w;let _,x,M,P,C,f=e.x,m=e.y,v=e.z,y=e.w;return x=s*f+a*m+c*v+u*y,x<0&&(x=-x,f=-f,m=-m,v=-v,y=-y),1-x>1e-6?(_=Math.acos(x),M=Math.sin(_),P=Math.sin((1-t)*_)/M,C=Math.sin(t*_)/M):(P=1-t,C=t),i.x=P*s+C*f,i.y=P*a+C*m,i.z=P*c+C*v,i.w=P*u+C*y,i}integrate(e,t,i,s){void 0===s&&(s=new ds);const a=e.x*i.x,c=e.y*i.y,u=e.z*i.z,f=this.x,m=this.y,v=this.z,y=this.w,_=.5*t;return s.x+=_*(a*y+c*v-u*m),s.y+=_*(c*y+u*f-a*v),s.z+=_*(u*y+a*m-c*f),s.w+=_*(-a*f-c*m-u*v),s}}const vl=new X,rM=new X,sM={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let Fn=(()=>{class d{constructor(t){void 0===t&&(t={}),this.id=d.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,i){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,i,s,a){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return d.idCounter=0,d.types=sM,d})();class Ji{constructor(e){void 0===e&&(e={}),this.position=new X,this.quaternion=new ds,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Ji.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Ji.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,s){return void 0===s&&(s=new X),i.vsub(e,s),t.conjugate(Na),Na.vmult(s,s),s}static pointToWorldFrame(e,t,i,s){return void 0===s&&(s=new X),t.vmult(i,s),s.vadd(e,s),s}static vectorToWorldFrame(e,t,i){return void 0===i&&(i=new X),e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,s){return void 0===s&&(s=new X),t.w*=-1,t.vmult(i,s),t.w*=-1,s}}const Na=new ds;class Fl extends Fn{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:i=[],normals:s=[],axes:a,boundingSphereRadius:c}=e;super({type:Fn.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=i,this.faceNormals=s,0===this.faceNormals.length&&this.computeNormals(),c?this.boundingSphereRadius=c:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=a?a.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const s=new X;for(let a=0;a!==e.length;a++){const c=e[a],u=c.length;for(let f=0;f!==u;f++){t[c[f]].vsub(t[c[(f+1)%u]],s),s.normalize();let v=!1;for(let y=0;y!==i.length;y++)if(i[y].almostEquals(s)||i[y].almostEquals(s)){v=!0;break}v||i.push(s.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let s=0;s<this.faces[e].length;s++)if(!this.vertices[this.faces[e][s]])throw new Error(`Vertex ${this.faces[e][s]} not found!`);const t=this.faceNormals[e]||new X;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let s=0;s<this.faces[e].length;s++)console.warn(`.vertices[${this.faces[e][s]}] = Vec3(${this.vertices[this.faces[e][s]].toString()})`)}}}getFaceNormal(e,t){const i=this.faces[e];Fl.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,s){const a=new X,c=new X;t.vsub(e,c),i.vsub(t,a),a.cross(c,s),s.isZero()||s.normalize()}clipAgainstHull(e,t,i,s,a,c,u,f,m){const v=new X;let y=-1,_=-Number.MAX_VALUE;for(let M=0;M<i.faces.length;M++){v.copy(i.faceNormals[M]),a.vmult(v,v);const P=v.dot(c);P>_&&(_=P,y=M)}const x=[];for(let M=0;M<i.faces[y].length;M++){const P=i.vertices[i.faces[y][M]],C=new X;C.copy(P),a.vmult(C,C),s.vadd(C,C),x.push(C)}y>=0&&this.clipFaceAgainstHull(c,e,t,x,u,f,m)}findSeparatingAxis(e,t,i,s,a,c,u,f){const m=new X,v=new X,y=new X,_=new X,x=new X,M=new X;let P=Number.MAX_VALUE;const C=this;if(C.uniqueAxes)for(let A=0;A!==C.uniqueAxes.length;A++){i.vmult(C.uniqueAxes[A],m);const F=C.testSepAxis(m,e,t,i,s,a);if(!1===F)return!1;F<P&&(P=F,c.copy(m))}else{const A=u?u.length:C.faces.length;for(let F=0;F<A;F++){m.copy(C.faceNormals[u?u[F]:F]),i.vmult(m,m);const W=C.testSepAxis(m,e,t,i,s,a);if(!1===W)return!1;W<P&&(P=W,c.copy(m))}}if(e.uniqueAxes)for(let A=0;A!==e.uniqueAxes.length;A++){a.vmult(e.uniqueAxes[A],v);const F=C.testSepAxis(v,e,t,i,s,a);if(!1===F)return!1;F<P&&(P=F,c.copy(v))}else{const A=f?f.length:e.faces.length;for(let F=0;F<A;F++){v.copy(e.faceNormals[f?f[F]:F]),a.vmult(v,v);const W=C.testSepAxis(v,e,t,i,s,a);if(!1===W)return!1;W<P&&(P=W,c.copy(v))}}for(let A=0;A!==C.uniqueEdges.length;A++){i.vmult(C.uniqueEdges[A],_);for(let F=0;F!==e.uniqueEdges.length;F++)if(a.vmult(e.uniqueEdges[F],x),_.cross(x,M),!M.almostZero()){M.normalize();const N=C.testSepAxis(M,e,t,i,s,a);if(!1===N)return!1;N<P&&(P=N,c.copy(M))}}return s.vsub(t,y),y.dot(c)>0&&c.negate(c),!0}testSepAxis(e,t,i,s,a,c){Fl.project(this,e,i,s,Wp),Fl.project(t,e,a,c,Mv);const f=Wp[0],m=Wp[1],v=Mv[0],y=Mv[1];if(f<y||v<m)return!1;const _=f-y,x=v-m;return _<x?_:x}calculateLocalInertia(e,t){const i=new X,s=new X;this.computeLocalAABB(s,i);const a=i.x-s.x,c=i.y-s.y,u=i.z-s.z;t.x=1/12*e*(2*c*2*c+2*u*2*u),t.y=1/12*e*(2*a*2*a+2*u*2*u),t.z=1/12*e*(2*c*2*c+2*a*2*a)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,s,a,c,u){const f=new X,m=new X,v=new X,y=new X,_=new X,x=new X,M=new X,P=new X,C=this,F=s,N=[];let W=-1,Z=Number.MAX_VALUE;for(let ne=0;ne<C.faces.length;ne++){f.copy(C.faceNormals[ne]),i.vmult(f,f);const Ge=f.dot(e);Ge<Z&&(Z=Ge,W=ne)}if(W<0)return;const te=C.faces[W];te.connectedFaces=[];for(let ne=0;ne<C.faces.length;ne++)for(let Ge=0;Ge<C.faces[ne].length;Ge++)-1!==te.indexOf(C.faces[ne][Ge])&&ne!==W&&-1===te.connectedFaces.indexOf(ne)&&te.connectedFaces.push(ne);const ee=te.length;for(let ne=0;ne<ee;ne++){const Ge=C.vertices[te[ne]];Ge.vsub(C.vertices[te[(ne+1)%ee]],m),v.copy(m),i.vmult(v,v),t.vadd(v,v),y.copy(this.faceNormals[W]),i.vmult(y,y),t.vadd(y,y),v.cross(y,_),_.negate(_),x.copy(Ge),i.vmult(x,x),t.vadd(x,x);const Me=te.connectedFaces[ne];M.copy(this.faceNormals[Me]);const Ae=this.getPlaneConstantOfFace(Me);P.copy(M),i.vmult(P,P);const Re=Ae-P.dot(t);for(this.clipFaceAgainstPlane(F,N,P,Re);F.length;)F.shift();for(;N.length;)F.push(N.shift())}M.copy(this.faceNormals[W]);const le=this.getPlaneConstantOfFace(W);P.copy(M),i.vmult(P,P);const j=le-P.dot(t);for(let ne=0;ne<F.length;ne++){let Ge=P.dot(F[ne])+j;Ge<=a&&(console.log(`clamped: depth=${Ge} to minDist=${a}`),Ge=a),Ge<=c&&Ge<=1e-6&&u.push({point:F[ne],normal:P,depth:Ge})}}clipFaceAgainstPlane(e,t,i,s){let a,c;const u=e.length;if(u<2)return t;let f=e[e.length-1],m=e[0];a=i.dot(f)+s;for(let v=0;v<u;v++){if(m=e[v],c=i.dot(m)+s,a<0)if(c<0){const y=new X;y.copy(m),t.push(y)}else{const y=new X;f.lerp(m,a/(a-c),y),t.push(y)}else if(c<0){const y=new X;f.lerp(m,a/(a-c),y),t.push(y),t.push(m)}f=m,a=c}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new X);const i=this.vertices,s=this.worldVertices;for(let a=0;a!==this.vertices.length;a++)t.vmult(i[a],s[a]),e.vadd(s[a],s[a]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let s=0;s<this.vertices.length;s++){const a=i[s];a.x<e.x?e.x=a.x:a.x>t.x&&(t.x=a.x),a.y<e.y?e.y=a.y:a.y>t.y&&(t.y=a.y),a.z<e.z?e.z=a.z:a.z>t.z&&(t.z=a.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new X);const i=this.faceNormals,s=this.worldFaceNormals;for(let a=0;a!==t;a++)e.vmult(i[a],s[a]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const s=t[i].lengthSquared();s>e&&(e=s)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,s){const a=this.vertices;let c,u,f,m,v,y,_=new X;for(let x=0;x<a.length;x++)_.copy(a[x]),t.vmult(_,_),e.vadd(_,_),(void 0===c||_.x<c)&&(c=_.x),(void 0===m||_.x>m)&&(m=_.x),(void 0===u||_.y<u)&&(u=_.y),(void 0===v||_.y>v)&&(v=_.y),(void 0===f||_.z<f)&&(f=_.z),(void 0===y||_.z>y)&&(y=_.z);i.set(c,u,f),s.set(m,v,y)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new X);const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,s=this.vertices;if(t){for(let a=0;a<i;a++){const c=s[a];t.vmult(c,c)}for(let a=0;a<this.faceNormals.length;a++){const c=this.faceNormals[a];t.vmult(c,c)}}if(e)for(let a=0;a<i;a++){const c=s[a];c.vadd(e,c)}}pointIsInside(e){const t=this.vertices,i=this.faces,s=this.faceNormals,c=new X;this.getAveragePointLocal(c);for(let u=0;u<this.faces.length;u++){let f=s[u];const m=t[i[u][0]],v=new X;e.vsub(m,v);const y=f.dot(v),_=new X;c.vsub(m,_);const x=f.dot(_);if(y<0&&x>0||y>0&&x<0)return!1}return-1}static project(e,t,i,s,a){const c=e.vertices.length,u=aM;let f=0,m=0;const v=lM,y=e.vertices;v.setZero(),Ji.vectorToLocalFrame(i,s,t,u),Ji.pointToLocalFrame(i,s,v,v);const _=v.dot(u);m=f=y[0].dot(u);for(let x=1;x<c;x++){const M=y[x].dot(u);M>f&&(f=M),M<m&&(m=M)}if(m-=_,f-=_,m>f){const x=m;m=f,f=x}a[0]=f,a[1]=m}}const Wp=[],Mv=[],aM=(new X,new X),lM=new X;class Nd extends Fn{constructor(e){super({type:Fn.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,s=X,a=[new s(-e,-t,-i),new s(e,-t,-i),new s(e,t,-i),new s(-e,t,-i),new s(-e,-t,i),new s(e,-t,i),new s(e,t,i),new s(-e,t,i)],u=[new s(0,0,1),new s(0,1,0),new s(1,0,0)],f=new Fl({vertices:a,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:u});this.convexPolyhedronRepresentation=f,f.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new X),Nd.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const s=e;i.x=1/12*t*(2*s.y*2*s.y+2*s.z*2*s.z),i.y=1/12*t*(2*s.x*2*s.x+2*s.z*2*s.z),i.z=1/12*t*(2*s.y*2*s.y+2*s.x*2*s.x)}getSideNormals(e,t){const i=e,s=this.halfExtents;if(i[0].set(s.x,0,0),i[1].set(0,s.y,0),i[2].set(0,0,s.z),i[3].set(-s.x,0,0),i[4].set(0,-s.y,0),i[5].set(0,0,-s.z),void 0!==t)for(let a=0;a!==i.length;a++)t.vmult(i[a],i[a]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const s=this.halfExtents,a=[[s.x,s.y,s.z],[-s.x,s.y,s.z],[-s.x,-s.y,s.z],[-s.x,-s.y,-s.z],[s.x,-s.y,-s.z],[s.x,s.y,-s.z],[-s.x,s.y,-s.z],[s.x,-s.y,s.z]];for(let c=0;c<a.length;c++)Fa.set(a[c][0],a[c][1],a[c][2]),t.vmult(Fa,Fa),e.vadd(Fa,Fa),i(Fa.x,Fa.y,Fa.z)}calculateWorldAABB(e,t,i,s){const a=this.halfExtents;yl[0].set(a.x,a.y,a.z),yl[1].set(-a.x,a.y,a.z),yl[2].set(-a.x,-a.y,a.z),yl[3].set(-a.x,-a.y,-a.z),yl[4].set(a.x,-a.y,-a.z),yl[5].set(a.x,a.y,-a.z),yl[6].set(-a.x,a.y,-a.z),yl[7].set(a.x,-a.y,a.z);const c=yl[0];t.vmult(c,c),e.vadd(c,c),s.copy(c),i.copy(c);for(let u=1;u<8;u++){const f=yl[u];t.vmult(f,f),e.vadd(f,f);const m=f.x,v=f.y,y=f.z;m>s.x&&(s.x=m),v>s.y&&(s.y=v),y>s.z&&(s.z=y),m<i.x&&(i.x=m),v<i.y&&(i.y=v),y<i.z&&(i.z=y)}}}const Fa=new X,yl=[new X,new X,new X,new X,new X,new X,new X,new X];class ii extends wv{constructor(e){void 0===e&&(e={}),super(),this.id=ii.idCounter++,this.index=-1,this.world=null,this.vlambda=new X,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new X,this.previousPosition=new X,this.interpolatedPosition=new X,this.initPosition=new X,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new X,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new X,this.force=new X;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?ii.STATIC:ii.DYNAMIC,typeof e.type==typeof ii.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=ii.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new X,this.quaternion=new ds,this.initQuaternion=new ds,this.previousQuaternion=new ds,this.interpolatedQuaternion=new ds,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new X,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new X,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new X,this.invInertia=new X,this.invInertiaWorld=new Oa,this.invMassSolve=0,this.invInertiaSolve=new X,this.invInertiaWorldSolve=new Oa,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new X(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new X(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new us,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new X,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=ii.AWAKE,this.wakeUpAfterNarrowphase=!1,e===ii.SLEEPING&&this.dispatchEvent(ii.wakeupEvent)}sleep(){this.sleepState=ii.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),s=this.sleepSpeedLimit**2;t===ii.AWAKE&&i<s?(this.sleepState=ii.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(ii.sleepyEvent)):t===ii.SLEEPY&&i>s?this.wakeUp():t===ii.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(ii.sleepEvent))}}updateSolveMassProperties(){this.sleepState===ii.SLEEPING||this.type===ii.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new X),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new X),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t}addShape(e,t,i){const s=new X,a=new ds;return t&&s.copy(t),i&&a.copy(i),this.shapes.push(e),this.shapeOffsets.push(s),this.shapeOrientations.push(a),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let s=0;for(let a=0;a!==i;a++){const c=e[a];c.updateBoundingSphereRadius();const u=t[a].length(),f=c.boundingSphereRadius;u+f>s&&(s=u+f)}this.boundingRadius=s}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,s=e.length,a=V_,c=z_,u=this.quaternion,f=this.aabb,m=Yp;for(let v=0;v!==s;v++){const y=e[v];u.vmult(t[v],a),a.vadd(this.position,a),u.mult(i[v],c),y.calculateWorldAABB(a,c,m.lowerBound,m.upperBound),0===v?f.copy(m):f.extend(m)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=cM,s=H_;i.setRotationFromQuaternion(this.quaternion),i.transpose(s),i.scale(t,i),i.mmult(s,this.invInertiaWorld)}}applyForce(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;this.sleepState===ii.SLEEPING&&this.wakeUp();const i=dM;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;const i=hM,s=fM;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,s),this.applyForce(i,s)}applyTorque(e){this.type===ii.DYNAMIC&&(this.sleepState===ii.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;this.sleepState===ii.SLEEPING&&this.wakeUp();const i=t,s=pM;s.copy(e),s.scale(this.invMass,s),this.velocity.vadd(s,this.velocity);const a=mM;i.cross(e,a),this.invInertiaWorld.vmult(a,a),this.angularVelocity.vadd(a,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;const i=gM,s=vM;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,s),this.applyImpulse(i,s)}updateMassProperties(){const e=yM;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Nd.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new X;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==ii.DYNAMIC&&this.type!==ii.KINEMATIC||this.sleepState===ii.SLEEPING)return;const s=this.velocity,a=this.angularVelocity,c=this.position,u=this.force,f=this.torque,m=this.quaternion,y=this.invInertiaWorld,_=this.linearFactor,x=this.invMass*e;s.x+=u.x*x*_.x,s.y+=u.y*x*_.y,s.z+=u.z*x*_.z;const M=y.elements,P=this.angularFactor,C=f.x*P.x,A=f.y*P.y,F=f.z*P.z;a.x+=e*(M[0]*C+M[1]*A+M[2]*F),a.y+=e*(M[3]*C+M[4]*A+M[5]*F),a.z+=e*(M[6]*C+M[7]*A+M[8]*F),c.x+=s.x*e,c.y+=s.y*e,c.z+=s.z*e,m.integrate(this.angularVelocity,e,this.angularFactor,m),t&&(i?m.normalizeFast():m.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}ii.idCounter=0,ii.COLLIDE_EVENT_NAME="collide",ii.DYNAMIC=1,ii.STATIC=2,ii.KINEMATIC=4,ii.AWAKE=0,ii.SLEEPY=1,ii.SLEEPING=2,ii.wakeupEvent={type:"wakeup"},ii.sleepyEvent={type:"sleepy"},ii.sleepEvent={type:"sleep"};const V_=new X,z_=new ds,Yp=new us,cM=new Oa,H_=new Oa,dM=(new Oa,new X),hM=new X,fM=new X,pM=new X,mM=new X,gM=new X,vM=new X,yM=new X;class _M{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,t,i){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,t){return!(!(e.collisionFilterGroup&t.collisionFilterMask)||!(t.collisionFilterGroup&e.collisionFilterMask)||(e.type&ii.STATIC||e.sleepState===ii.SLEEPING)&&(t.type&ii.STATIC||t.sleepState===ii.SLEEPING))}intersectionTest(e,t,i,s){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,i,s):this.doBoundingSphereBroadphase(e,t,i,s)}doBoundingSphereBroadphase(e,t,i,s){const a=Cv;t.position.vsub(e.position,a);const c=(e.boundingRadius+t.boundingRadius)**2;a.lengthSquared()<c&&(i.push(e),s.push(t))}doBoundingBoxBroadphase(e,t,i,s){e.aabbNeedsUpdate&&e.updateAABB(),t.aabbNeedsUpdate&&t.updateAABB(),e.aabb.overlaps(t.aabb)&&(i.push(e),s.push(t))}makePairsUnique(e,t){const i=bM,s=KA,a=ZA,c=e.length;for(let u=0;u!==c;u++)s[u]=e[u],a[u]=t[u];e.length=0,t.length=0;for(let u=0;u!==c;u++){const f=s[u].id,m=a[u].id,v=f<m?`${f},${m}`:`${m},${f}`;i[v]=u,i.keys.push(v)}for(let u=0;u!==i.keys.length;u++){const f=i.keys.pop(),m=i[f];e.push(s[m]),t.push(a[m]),delete i[f]}}setWorld(e){}static boundingSphereCheck(e,t){const i=new X;return e.position.vsub(t.position,i),Math.pow(e.shapes[0].boundingSphereRadius+t.shapes[0].boundingSphereRadius,2)>i.lengthSquared()}aabbQuery(e,t,i){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const Cv=new X;new X,new ds,new X;const bM={keys:[]},KA=[],ZA=[];new X,new X,new X;class QA extends _M{constructor(){super()}collisionPairs(e,t,i){const s=e.bodies,a=s.length;let c,u;for(let f=0;f!==a;f++)for(let m=0;m!==f;m++)c=s[f],u=s[m],this.needBroadphaseCollision(c,u)&&this.intersectionTest(c,u,t,i)}aabbQuery(e,t,i){void 0===i&&(i=[]);for(let s=0;s<e.bodies.length;s++){const a=e.bodies[s];a.aabbNeedsUpdate&&a.updateAABB(),a.aabb.overlaps(t)&&i.push(a)}return i}}class lf{constructor(){this.rayFromWorld=new X,this.rayToWorld=new X,this.hitNormalWorld=new X,this.hitPointWorld=new X,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,s,a,c,u){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(s),this.shape=a,this.body=c,this.distance=u}}let EM,$_,G_,W_,qp,Fd,Xp;EM=Fn.types.SPHERE,$_=Fn.types.PLANE,G_=Fn.types.BOX,W_=Fn.types.CYLINDER,qp=Fn.types.CONVEXPOLYHEDRON,Fd=Fn.types.HEIGHTFIELD,Xp=Fn.types.TRIMESH;class Hs{get[EM](){return this._intersectSphere}get[$_](){return this._intersectPlane}get[G_](){return this._intersectBox}get[W_](){return this._intersectConvex}get[qp](){return this._intersectConvex}get[Fd](){return this._intersectHeightfield}get[Xp](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new X),void 0===t&&(t=new X),this.from=e.clone(),this.to=t.clone(),this.direction=new X,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Hs.ANY,this.result=new lf,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||Hs.ANY,this.result=t.result||new lf,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof t.checkCollisionResponse<"u")||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(kd),Kp.length=0,e.broadphase.aabbQuery(e,kd,Kp),this.intersectBodies(Kp),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const s=j_,a=wM;for(let c=0,u=e.shapes.length;c<u;c++){const f=e.shapes[c];if((!i||f.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[c],a),e.quaternion.vmult(e.shapeOffsets[c],s),s.vadd(e.position,s),this.intersectShape(f,a,s,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,s=e.length;!this.result.shouldStop&&i<s;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,s){if(function Dv(d,e,t){t.vsub(d,Ba);const i=Ba.dot(e);return e.scale(i,em),em.vadd(d,em),t.distanceTo(em)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const u=this[e.type];u&&u.call(this,e,t,i,s,e)}_intersectBox(e,t,i,s,a){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,s,a)}_intersectPlane(e,t,i,s,a){const c=this.from,u=this.to,f=this.direction,m=new X(0,0,1);t.vmult(m,m);const v=new X;c.vsub(i,v);const y=v.dot(m);if(u.vsub(i,v),y*v.dot(m)>0||c.distanceTo(u)<y)return;const x=m.dot(f);if(Math.abs(x)<this.precision)return;const M=new X,P=new X,C=new X;c.vsub(i,M);const A=-m.dot(M)/x;f.scale(A,P),c.vadd(P,C),this.reportIntersection(m,C,a,s,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,s=this.to,a=this.from;t.x=Math.min(s.x,a.x),t.y=Math.min(s.y,a.y),t.z=Math.min(s.z,a.z),i.x=Math.max(s.x,a.x),i.y=Math.max(s.y,a.y),i.z=Math.max(s.z,a.z)}_intersectHeightfield(e,t,i,s,a){const c=MM;c.from.copy(this.from),c.to.copy(this.to),Ji.pointToLocalFrame(i,t,c.from,c.from),Ji.pointToLocalFrame(i,t,c.to,c.to),c.updateDirection();const u=Av;let f,m,v,y;f=m=0,v=y=e.data.length-1;const _=new us;c.getAABB(_),e.getIndexOfPosition(_.lowerBound.x,_.lowerBound.y,u,!0),f=Math.max(f,u[0]),m=Math.max(m,u[1]),e.getIndexOfPosition(_.upperBound.x,_.upperBound.y,u,!0),v=Math.min(v,u[0]+1),y=Math.min(y,u[1]+1);for(let x=f;x<v;x++)for(let M=m;M<y;M++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(x,M,_),_.overlapsRay(c)){if(e.getConvexTrianglePillar(x,M,!1),Ji.pointToWorldFrame(i,t,e.pillarOffset,Zp),this._intersectConvex(e.pillarConvex,t,Zp,s,a,Y_),this.result.shouldStop)return;e.getConvexTrianglePillar(x,M,!0),Ji.pointToWorldFrame(i,t,e.pillarOffset,Zp),this._intersectConvex(e.pillarConvex,t,Zp,s,a,Y_)}}}_intersectSphere(e,t,i,s,a){const c=this.from,u=this.to,m=(u.x-c.x)**2+(u.y-c.y)**2+(u.z-c.z)**2,v=2*((u.x-c.x)*(c.x-i.x)+(u.y-c.y)*(c.y-i.y)+(u.z-c.z)*(c.z-i.z)),_=v**2-4*m*((c.x-i.x)**2+(c.y-i.y)**2+(c.z-i.z)**2-e.radius**2),x=uf,M=Jp;if(!(_<0))if(0===_)c.lerp(u,_,x),x.vsub(i,M),M.normalize(),this.reportIntersection(M,x,a,s,-1);else{const P=(-v-Math.sqrt(_))/(2*m),C=(-v+Math.sqrt(_))/(2*m);if(P>=0&&P<=1&&(c.lerp(u,P,x),x.vsub(i,M),M.normalize(),this.reportIntersection(M,x,a,s,-1)),this.result.shouldStop)return;C>=0&&C<=1&&(c.lerp(u,C,x),x.vsub(i,M),M.normalize(),this.reportIntersection(M,x,a,s,-1))}}_intersectConvex(e,t,i,s,a,c){const u=Qp,f=q_,m=c&&c.faceList||null,v=e.faces,y=e.vertices,_=e.faceNormals,x=this.direction,M=this.from,C=M.distanceTo(this.to),A=m?m.length:v.length,F=this.result;for(let N=0;!F.shouldStop&&N<A;N++){const W=m?m[N]:N,Z=v[W],te=_[W],ee=t,le=i;f.copy(y[Z[0]]),ee.vmult(f,f),f.vadd(le,f),f.vsub(M,f),ee.vmult(te,u);const j=x.dot(u);if(Math.abs(j)<this.precision)continue;const ne=u.dot(f)/j;if(!(ne<0)){x.scale(ne,Xo),Xo.vadd(M,Xo),ca.copy(y[Z[0]]),ee.vmult(ca,ca),le.vadd(ca,ca);for(let Ge=1;!F.shouldStop&&Ge<Z.length-1;Ge++){_l.copy(y[Z[Ge]]),bl.copy(y[Z[Ge+1]]),ee.vmult(_l,_l),ee.vmult(bl,bl),le.vadd(_l,_l),le.vadd(bl,bl);const rt=Xo.distanceTo(M);!Hs.pointInTriangle(Xo,ca,_l,bl)&&!Hs.pointInTriangle(Xo,_l,ca,bl)||rt>C||this.reportIntersection(u,Xo,a,s,W)}}}}_intersectTrimesh(e,t,i,s,a,c){const u=Tv,f=DM,m=IM,v=q_,y=CM,_=X_,x=AM,M=K_,P=TM,C=e.indices,A=this.from,F=this.to,N=this.direction;m.position.copy(i),m.quaternion.copy(t),Ji.vectorToLocalFrame(i,t,N,y),Ji.pointToLocalFrame(i,t,A,_),Ji.pointToLocalFrame(i,t,F,x),x.x*=e.scale.x,x.y*=e.scale.y,x.z*=e.scale.z,_.x*=e.scale.x,_.y*=e.scale.y,_.z*=e.scale.z,x.vsub(_,y),y.normalize();const W=_.distanceSquared(x);e.tree.rayQuery(this,m,f);for(let Z=0,te=f.length;!this.result.shouldStop&&Z!==te;Z++){const ee=f[Z];e.getNormal(ee,u),e.getVertex(C[3*ee],ca),ca.vsub(_,v);const le=y.dot(u),j=u.dot(v)/le;if(j<0)continue;y.scale(j,Xo),Xo.vadd(_,Xo),e.getVertex(C[3*ee+1],_l),e.getVertex(C[3*ee+2],bl);const ne=Xo.distanceSquared(_);!Hs.pointInTriangle(Xo,_l,ca,bl)&&!Hs.pointInTriangle(Xo,ca,_l,bl)||ne>W||(Ji.vectorToWorldFrame(t,u,P),Ji.pointToWorldFrame(i,t,Xo,M),this.reportIntersection(P,M,a,s,ee))}f.length=0}reportIntersection(e,t,i,s,a){const c=this.from,u=this.to,f=c.distanceTo(t),m=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(m.hitFaceIndex=typeof a<"u"?a:-1,this.mode){case Hs.ALL:this.hasHit=!0,m.set(c,u,e,t,i,s,f),m.hasHit=!0,this.callback(m);break;case Hs.CLOSEST:(f<m.distance||!m.hasHit)&&(this.hasHit=!0,m.hasHit=!0,m.set(c,u,e,t,i,s,f));break;case Hs.ANY:this.hasHit=!0,m.hasHit=!0,m.set(c,u,e,t,i,s,f),m.shouldStop=!0}}static pointInTriangle(e,t,i,s){s.vsub(t,Ba),i.vsub(t,cf),e.vsub(t,yu);const a=Ba.dot(Ba),c=Ba.dot(cf),u=Ba.dot(yu),f=cf.dot(cf),m=cf.dot(yu);let v,y;return(v=f*u-c*m)>=0&&(y=a*m-c*u)>=0&&v+y<a*f-c*c}}Hs.CLOSEST=1,Hs.ANY=2,Hs.ALL=4;const kd=new us,Kp=[],cf=new X,yu=new X,j_=new X,wM=new ds,Xo=new X,ca=new X,_l=new X,bl=new X;new X,new lf;const Y_={faceList:[0]},Zp=new X,MM=new Hs,Av=[],uf=new X,Jp=new X,Qp=new X,q_=(new X,new X,new X),Tv=new X,CM=new X,X_=new X,AM=new X,TM=new X,K_=new X;new us;const DM=[],IM=new Ji,Ba=new X,em=new X;class hf{static defaults(e,t){void 0===e&&(e={});for(let i in t)i in e||(e[i]=t[i]);return e}}class Iv{constructor(){this.spatial=new X,this.rotational=new X}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}}let Rv=(()=>{class d{constructor(t,i,s,a){void 0===s&&(s=-1e6),void 0===a&&(a=1e6),this.id=d.idCounter++,this.minForce=s,this.maxForce=a,this.bi=t,this.bj=i,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new Iv,this.jacobianElementB=new Iv,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(t,i,s){const a=i,c=t,u=s;this.a=4/(u*(1+4*a)),this.b=4*a/(1+4*a),this.eps=4/(u*u*c*(1+4*a))}computeB(t,i,s){const a=this.computeGW();return-this.computeGq()*t-a*i-this.computeGiMf()*s}computeGq(){const i=this.jacobianElementB,u=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+i.spatial.dot(u)}computeGW(){const i=this.jacobianElementB,s=this.bi,a=this.bj,u=a.velocity,m=a.angularVelocity;return this.jacobianElementA.multiplyVectors(s.velocity,s.angularVelocity)+i.multiplyVectors(u,m)}computeGWlambda(){const i=this.jacobianElementB,s=this.bi,a=this.bj,u=a.vlambda,m=a.wlambda;return this.jacobianElementA.multiplyVectors(s.vlambda,s.wlambda)+i.multiplyVectors(u,m)}computeGiMf(){const t=this.jacobianElementA,i=this.jacobianElementB,s=this.bi,a=this.bj,u=s.torque,f=a.force,m=a.torque,y=a.invMassSolve;return s.force.scale(s.invMassSolve,Ud),f.scale(y,Pv),s.invInertiaWorldSolve.vmult(u,_u),a.invInertiaWorldSolve.vmult(m,Vd),t.multiplyVectors(Ud,_u)+i.multiplyVectors(Pv,Vd)}computeGiMGt(){const t=this.jacobianElementA,i=this.jacobianElementB,s=this.bi,a=this.bj,m=a.invInertiaWorldSolve;let v=s.invMassSolve+a.invMassSolve;return s.invInertiaWorldSolve.vmult(t.rotational,zd),v+=zd.dot(t.rotational),m.vmult(i.rotational,zd),v+=zd.dot(i.rotational),v}addToWlambda(t){const i=this.jacobianElementA,s=this.jacobianElementB,a=this.bi,c=this.bj,u=tm;a.vlambda.addScaledVector(a.invMassSolve*t,i.spatial,a.vlambda),c.vlambda.addScaledVector(c.invMassSolve*t,s.spatial,c.vlambda),a.invInertiaWorldSolve.vmult(i.rotational,u),a.wlambda.addScaledVector(t,u,a.wlambda),c.invInertiaWorldSolve.vmult(s.rotational,u),c.wlambda.addScaledVector(t,u,c.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}return d.idCounter=0,d})();const Ud=new X,Pv=new X,_u=new X,Vd=new X,zd=new X,tm=new X;class ff extends Rv{constructor(e,t,i){void 0===i&&(i=1e6),super(e,t,0,i),this.restitution=0,this.ri=new X,this.rj=new X,this.ni=new X}computeB(e){const t=this.a,i=this.b,s=this.bi,a=this.bj,c=this.ri,u=this.rj,f=PM,m=Z_,v=s.velocity,y=s.angularVelocity,_=a.velocity,x=a.angularVelocity,M=J_,P=this.jacobianElementA,C=this.jacobianElementB,A=this.ni;c.cross(A,f),u.cross(A,m),A.negate(P.spatial),f.negate(P.rotational),C.spatial.copy(A),C.rotational.copy(m),M.copy(a.position),M.vadd(u,M),M.vsub(s.position,M),M.vsub(c,M);const F=A.dot(M),N=this.restitution+1;return-F*t-(N*_.dot(A)-N*v.dot(A)+x.dot(m)-y.dot(f))*i-e*this.computeGiMf()}getImpactVelocityAlongNormal(){const e=Lv,t=Q_,i=LM,s=eb,a=Ov;return this.bi.position.vadd(this.ri,i),this.bj.position.vadd(this.rj,s),this.bi.getVelocityAtWorldPoint(i,e),this.bj.getVelocityAtWorldPoint(s,t),e.vsub(t,a),this.ni.dot(a)}}const PM=new X,Z_=new X,J_=new X,Lv=new X,Q_=new X,LM=new X,eb=new X,Ov=new X;new X,new X,new X,new X,new X,new X,new X,new X,new X,new X;class nb extends Rv{constructor(e,t,i){super(e,t,-i,i),this.ri=new X,this.rj=new X,this.t=new X}computeB(e){const t=this.b,s=this.rj,a=jM,c=YM,u=this.t;this.ri.cross(u,a),s.cross(u,c);const f=this.jacobianElementA,m=this.jacobianElementB;return u.negate(f.spatial),a.negate(f.rotational),m.spatial.copy(u),m.rotational.copy(c),-this.computeGW()*t-e*this.computeGiMf()}}const jM=new X,YM=new X;let Nv=(()=>{class d{constructor(t,i,s){s=hf.defaults(s,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=d.idCounter++,this.materials=[t,i],this.friction=s.friction,this.restitution=s.restitution,this.contactEquationStiffness=s.contactEquationStiffness,this.contactEquationRelaxation=s.contactEquationRelaxation,this.frictionEquationStiffness=s.frictionEquationStiffness,this.frictionEquationRelaxation=s.frictionEquationRelaxation}}return d.idCounter=0,d})(),qM=(()=>{class d{constructor(t){void 0===t&&(t={});let i="";"string"==typeof t&&(i=t,t={}),this.name=i,this.id=d.idCounter++,this.friction=typeof t.friction<"u"?t.friction:-1,this.restitution=typeof t.restitution<"u"?t.restitution:-1}}return d.idCounter=0,d})();new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new Hs,new X,new X,new X,new X(1,0,0),new X(0,1,0),new X(0,0,1),new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X;class om extends Fn{constructor(e){if(super({type:Fn.types.SPHERE}),this.radius=void 0!==e?e:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(e,t){void 0===t&&(t=new X);const i=2*e*this.radius*this.radius/5;return t.x=i,t.y=i,t.z=i,t}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(e,t,i,s){const a=this.radius,c=["x","y","z"];for(let u=0;u<c.length;u++){const f=c[u];i[f]=e[f]-a,s[f]=e[f]+a}}}new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new us,new X,new us,new X,new X,new X,new X,new X,new X,new X,new us,new X,new Ji,new us;class hm{constructor(){this.equations=[]}solve(e,t){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const t=this.equations,i=t.indexOf(e);-1!==i&&t.splice(i,1)}removeAllEquations(){this.equations.length=0}}class jv extends hm{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,t){let i=0;const s=this.iterations,a=this.tolerance*this.tolerance,c=this.equations,u=c.length,f=t.bodies,m=f.length,v=e;let y,_,x,M,P,C;if(0!==u)for(let W=0;W!==m;W++)f[W].updateSolveMassProperties();const A=_S,F=bS,N=bb;A.length=u,F.length=u,N.length=u;for(let W=0;W!==u;W++){const Z=c[W];N[W]=0,F[W]=Z.computeB(v),A[W]=1/Z.computeC()}if(0!==u){for(let te=0;te!==m;te++){const ee=f[te],j=ee.wlambda;ee.vlambda.set(0,0,0),j.set(0,0,0)}for(i=0;i!==s;i++){M=0;for(let te=0;te!==u;te++){const ee=c[te];y=F[te],_=A[te],C=N[te],P=ee.computeGWlambda(),x=_*(y-P-ee.eps*C),C+x<ee.minForce?x=ee.minForce-C:C+x>ee.maxForce&&(x=ee.maxForce-C),N[te]+=x,M+=x>0?x:-x,ee.addToWlambda(x)}if(M*M<a)break}for(let te=0;te!==m;te++){const ee=f[te],le=ee.velocity,j=ee.angularVelocity;ee.vlambda.vmul(ee.linearFactor,ee.vlambda),le.vadd(ee.vlambda,le),ee.wlambda.vmul(ee.angularFactor,ee.wlambda),j.vadd(ee.wlambda,j)}let W=c.length;const Z=1/v;for(;W--;)c[W].multiplier=N[W]*Z}return i}}const bb=[],_S=[],bS=[];class wu{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let t=0;t!==e;t++)this.objects.push(t<0||arguments.length<=t?void 0:arguments[t]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}class ES extends wu{constructor(){super(...arguments),this.type=X}constructObject(){return new X}}const hs_sphereSphere=Fn.types.SPHERE,hs_spherePlane=Fn.types.SPHERE|Fn.types.PLANE,hs_boxBox=Fn.types.BOX|Fn.types.BOX,hs_sphereBox=Fn.types.SPHERE|Fn.types.BOX,hs_planeBox=Fn.types.PLANE|Fn.types.BOX,hs_convexConvex=Fn.types.CONVEXPOLYHEDRON,hs_sphereConvex=Fn.types.SPHERE|Fn.types.CONVEXPOLYHEDRON,hs_planeConvex=Fn.types.PLANE|Fn.types.CONVEXPOLYHEDRON,hs_boxConvex=Fn.types.BOX|Fn.types.CONVEXPOLYHEDRON,hs_sphereHeightfield=Fn.types.SPHERE|Fn.types.HEIGHTFIELD,hs_boxHeightfield=Fn.types.BOX|Fn.types.HEIGHTFIELD,hs_convexHeightfield=Fn.types.CONVEXPOLYHEDRON|Fn.types.HEIGHTFIELD,hs_sphereParticle=Fn.types.PARTICLE|Fn.types.SPHERE,hs_planeParticle=Fn.types.PLANE|Fn.types.PARTICLE,hs_boxParticle=Fn.types.BOX|Fn.types.PARTICLE,hs_convexParticle=Fn.types.PARTICLE|Fn.types.CONVEXPOLYHEDRON,hs_cylinderCylinder=Fn.types.CYLINDER,hs_sphereCylinder=Fn.types.SPHERE|Fn.types.CYLINDER,hs_planeCylinder=Fn.types.PLANE|Fn.types.CYLINDER,hs_boxCylinder=Fn.types.BOX|Fn.types.CYLINDER,hs_convexCylinder=Fn.types.CONVEXPOLYHEDRON|Fn.types.CYLINDER,hs_heightfieldCylinder=Fn.types.HEIGHTFIELD|Fn.types.CYLINDER,hs_particleCylinder=Fn.types.PARTICLE|Fn.types.CYLINDER,hs_sphereTrimesh=Fn.types.SPHERE|Fn.types.TRIMESH,hs_planeTrimesh=Fn.types.PLANE|Fn.types.TRIMESH;class Xd{get[hs_sphereSphere](){return this.sphereSphere}get[hs_spherePlane](){return this.spherePlane}get[hs_boxBox](){return this.boxBox}get[hs_sphereBox](){return this.sphereBox}get[hs_planeBox](){return this.planeBox}get[hs_convexConvex](){return this.convexConvex}get[hs_sphereConvex](){return this.sphereConvex}get[hs_planeConvex](){return this.planeConvex}get[hs_boxConvex](){return this.boxConvex}get[hs_sphereHeightfield](){return this.sphereHeightfield}get[hs_boxHeightfield](){return this.boxHeightfield}get[hs_convexHeightfield](){return this.convexHeightfield}get[hs_sphereParticle](){return this.sphereParticle}get[hs_planeParticle](){return this.planeParticle}get[hs_boxParticle](){return this.boxParticle}get[hs_convexParticle](){return this.convexParticle}get[hs_cylinderCylinder](){return this.convexConvex}get[hs_sphereCylinder](){return this.sphereConvex}get[hs_planeCylinder](){return this.planeConvex}get[hs_boxCylinder](){return this.boxConvex}get[hs_convexCylinder](){return this.convexConvex}get[hs_heightfieldCylinder](){return this.heightfieldCylinder}get[hs_particleCylinder](){return this.particleCylinder}get[hs_sphereTrimesh](){return this.sphereTrimesh}get[hs_planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new ES,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,t,i,s,a,c){let u;this.contactPointPool.length?(u=this.contactPointPool.pop(),u.bi=e,u.bj=t):u=new ff(e,t),u.enabled=e.collisionResponse&&t.collisionResponse&&i.collisionResponse&&s.collisionResponse;const f=this.currentContactMaterial;u.restitution=f.restitution,u.setSpookParams(f.contactEquationStiffness,f.contactEquationRelaxation,this.world.dt);const m=i.material||e.material,v=s.material||t.material;return m&&v&&m.restitution>=0&&v.restitution>=0&&(u.restitution=m.restitution*v.restitution),u.si=a||i,u.sj=c||s,u}createFrictionEquationsFromContact(e,t){const i=e.bi,s=e.bj,u=this.world,f=this.currentContactMaterial;let m=f.friction;const v=e.si.material||i.material,y=e.sj.material||s.material;if(v&&y&&v.friction>=0&&y.friction>=0&&(m=v.friction*y.friction),m>0){const _=m*(u.frictionGravity||u.gravity).length();let x=i.invMass+s.invMass;x>0&&(x=1/x);const M=this.frictionEquationPool,P=M.length?M.pop():new nb(i,s,_*x),C=M.length?M.pop():new nb(i,s,_*x);return P.bi=C.bi=i,P.bj=C.bj=s,P.minForce=C.minForce=-_*x,P.maxForce=C.maxForce=_*x,P.ri.copy(e.ri),P.rj.copy(e.rj),C.ri.copy(e.ri),C.rj.copy(e.rj),e.ni.tangents(P.t,C.t),P.setSpookParams(f.frictionEquationStiffness,f.frictionEquationRelaxation,u.dt),C.setSpookParams(f.frictionEquationStiffness,f.frictionEquationRelaxation,u.dt),P.enabled=C.enabled=e.enabled,t.push(P,C),!0}return!1}createFrictionFromAverage(e){let t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||1===e)return;const i=this.frictionResult[this.frictionResult.length-2],s=this.frictionResult[this.frictionResult.length-1];Kd.setZero(),bc.setZero(),yf.setZero();const a=t.bi;for(let u=0;u!==e;u++)t=this.result[this.result.length-1-u],t.bi!==a?(Kd.vadd(t.ni,Kd),bc.vadd(t.ri,bc),yf.vadd(t.rj,yf)):(Kd.vsub(t.ni,Kd),bc.vadd(t.rj,bc),yf.vadd(t.ri,yf));const c=1/e;bc.scale(c,i.ri),yf.scale(c,i.rj),s.ri.copy(i.ri),s.rj.copy(i.rj),Kd.normalize(),Kd.tangents(i.t,s.t)}getContacts(e,t,i,s,a,c,u){this.contactPointPool=a,this.frictionEquationPool=u,this.result=s,this.frictionResult=c;const f=aT,m=Zd,v=Sb,y=Cb;for(let _=0,x=e.length;_!==x;_++){const M=e[_],P=t[_];let C=null;M.material&&P.material&&(C=i.getContactMaterial(M.material,P.material)||null);const A=M.type&ii.KINEMATIC&&P.type&ii.STATIC||M.type&ii.STATIC&&P.type&ii.KINEMATIC||M.type&ii.KINEMATIC&&P.type&ii.KINEMATIC;for(let F=0;F<M.shapes.length;F++){M.quaternion.mult(M.shapeOrientations[F],f),M.quaternion.vmult(M.shapeOffsets[F],v),v.vadd(M.position,v);const N=M.shapes[F];for(let W=0;W<P.shapes.length;W++){P.quaternion.mult(P.shapeOrientations[W],m),P.quaternion.vmult(P.shapeOffsets[W],y),y.vadd(P.position,y);const Z=P.shapes[W];if(!(N.collisionFilterMask&Z.collisionFilterGroup&&Z.collisionFilterMask&N.collisionFilterGroup)||v.distanceTo(y)>N.boundingSphereRadius+Z.boundingSphereRadius)continue;let te=null;N.material&&Z.material&&(te=i.getContactMaterial(N.material,Z.material)||null),this.currentContactMaterial=te||C||i.defaultContactMaterial;const le=this[N.type|Z.type];if(le){let j=!1;j=N.type<Z.type?le.call(this,N,Z,v,y,f,m,M,P,N,Z,A):le.call(this,Z,N,y,v,m,f,P,M,N,Z,A),j&&A&&(i.shapeOverlapKeeper.set(N.id,Z.id),i.bodyOverlapKeeper.set(M.id,P.id))}}}}}sphereSphere(e,t,i,s,a,c,u,f,m,v,y){if(y)return i.distanceSquared(s)<(e.radius+t.radius)**2;const _=this.createContactEquation(u,f,e,t,m,v);s.vsub(i,_.ni),_.ni.normalize(),_.ri.copy(_.ni),_.rj.copy(_.ni),_.ri.scale(e.radius,_.ri),_.rj.scale(-t.radius,_.rj),_.ri.vadd(i,_.ri),_.ri.vsub(u.position,_.ri),_.rj.vadd(s,_.rj),_.rj.vsub(f.position,_.rj),this.result.push(_),this.createFrictionEquationsFromContact(_,this.frictionResult)}spherePlane(e,t,i,s,a,c,u,f,m,v,y){const _=this.createContactEquation(u,f,e,t,m,v);if(_.ni.set(0,0,1),c.vmult(_.ni,_.ni),_.ni.negate(_.ni),_.ni.normalize(),_.ni.scale(e.radius,_.ri),i.vsub(s,xc),_.ni.scale(_.ni.dot(xc),Lb),xc.vsub(Lb,_.rj),-xc.dot(_.ni)<=e.radius){if(y)return!0;const x=_.ri,M=_.rj;x.vadd(i,x),x.vsub(u.position,x),M.vadd(s,M),M.vsub(f.position,M),this.result.push(_),this.createFrictionEquationsFromContact(_,this.frictionResult)}}boxBox(e,t,i,s,a,c,u,f,m,v,y){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,i,s,a,c,u,f,e,t,y)}sphereBox(e,t,i,s,a,c,u,f,m,v,y){const _=this.v3pool,x=xf;i.vsub(s,_f),t.getSideNormals(x,c);const M=e.radius;let P=!1;const C=NS,A=FS,F=Fb;let N=null,W=0,Z=0,te=0,ee=null;for(let He=0,xt=x.length;He!==xt&&!1===P;He++){const St=Nb;St.copy(x[He]);const Mt=St.length();St.normalize();const Bt=_f.dot(St);if(Bt<Mt+M&&Bt>0){const pt=LS,ht=bf;pt.copy(x[(He+1)%3]),ht.copy(x[(He+2)%3]);const pn=pt.length(),bn=ht.length();pt.normalize(),ht.normalize();const Dn=_f.dot(pt),Bn=_f.dot(ht);if(Dn<pn&&Dn>-pn&&Bn<bn&&Bn>-bn){const jn=Math.abs(Bt-Mt-M);if((null===ee||jn<ee)&&(ee=jn,Z=Dn,te=Bn,N=Mt,C.copy(St),A.copy(pt),F.copy(ht),W++,y))return!0}}}if(W){P=!0;const He=this.createContactEquation(u,f,e,t,m,v);C.scale(-M,He.ri),He.ni.copy(C),He.ni.negate(He.ni),C.scale(N,C),A.scale(Z,A),C.vadd(A,C),F.scale(te,F),C.vadd(F,He.rj),He.ri.vadd(i,He.ri),He.ri.vsub(u.position,He.ri),He.rj.vadd(s,He.rj),He.rj.vsub(f.position,He.rj),this.result.push(He),this.createFrictionEquationsFromContact(He,this.frictionResult)}let le=_.get();const j=OS;for(let He=0;2!==He&&!P;He++)for(let xt=0;2!==xt&&!P;xt++)for(let St=0;2!==St&&!P;St++)if(le.set(0,0,0),He?le.vadd(x[0],le):le.vsub(x[0],le),xt?le.vadd(x[1],le):le.vsub(x[1],le),St?le.vadd(x[2],le):le.vsub(x[2],le),s.vadd(le,j),j.vsub(i,j),j.lengthSquared()<M*M){if(y)return!0;P=!0;const Mt=this.createContactEquation(u,f,e,t,m,v);Mt.ri.copy(j),Mt.ri.normalize(),Mt.ni.copy(Mt.ri),Mt.ri.scale(M,Mt.ri),Mt.rj.copy(le),Mt.ri.vadd(i,Mt.ri),Mt.ri.vsub(u.position,Mt.ri),Mt.rj.vadd(s,Mt.rj),Mt.rj.vsub(f.position,Mt.rj),this.result.push(Mt),this.createFrictionEquationsFromContact(Mt,this.frictionResult)}_.release(le),le=null;const ne=_.get(),Ge=_.get(),rt=_.get(),Me=_.get(),Ae=_.get(),Re=x.length;for(let He=0;He!==Re&&!P;He++)for(let xt=0;xt!==Re&&!P;xt++)if(He%3!=xt%3){x[xt].cross(x[He],ne),ne.normalize(),x[He].vadd(x[xt],Ge),rt.copy(i),rt.vsub(Ge,rt),rt.vsub(s,rt);const St=rt.dot(ne);ne.scale(St,Me);let Mt=0;for(;Mt===He%3||Mt===xt%3;)Mt++;Ae.copy(i),Ae.vsub(Me,Ae),Ae.vsub(Ge,Ae),Ae.vsub(s,Ae);const Bt=Math.abs(St),pt=Ae.length();if(Bt<x[Mt].length()&&pt<M){if(y)return!0;P=!0;const ht=this.createContactEquation(u,f,e,t,m,v);Ge.vadd(Me,ht.rj),ht.rj.copy(ht.rj),Ae.negate(ht.ni),ht.ni.normalize(),ht.ri.copy(ht.rj),ht.ri.vadd(s,ht.ri),ht.ri.vsub(i,ht.ri),ht.ri.normalize(),ht.ri.scale(M,ht.ri),ht.ri.vadd(i,ht.ri),ht.ri.vsub(u.position,ht.ri),ht.rj.vadd(s,ht.rj),ht.rj.vsub(f.position,ht.rj),this.result.push(ht),this.createFrictionEquationsFromContact(ht,this.frictionResult)}}_.release(ne,Ge,rt,Me,Ae)}planeBox(e,t,i,s,a,c,u,f,m,v,y){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,i,s,a,c,u,f,e,t,y)}convexConvex(e,t,i,s,a,c,u,f,m,v,y,_,x){const M=zb;if(!(i.distanceTo(s)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,i,a,s,c,M,_,x)){const P=[],C=Ef;e.clipAgainstHull(i,a,t,s,c,M,-100,100,P);let A=0;for(let F=0;F!==P.length;F++){if(y)return!0;const N=this.createContactEquation(u,f,e,t,m,v),W=N.ri,Z=N.rj;M.negate(N.ni),P[F].normal.negate(C),C.scale(P[F].depth,C),P[F].point.vadd(C,W),Z.copy(P[F].point),W.vsub(i,W),Z.vsub(s,Z),W.vadd(i,W),W.vsub(u.position,W),Z.vadd(s,Z),Z.vsub(f.position,Z),this.result.push(N),A++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(N,this.frictionResult)}this.enableFrictionReduction&&A&&this.createFrictionFromAverage(A)}}sphereConvex(e,t,i,s,a,c,u,f,m,v,y){const _=this.v3pool;i.vsub(s,Bb);const x=t.faceNormals,M=t.faces,P=t.vertices,C=e.radius;let A=!1;for(let F=0;F!==P.length;F++){const W=kS;c.vmult(P[F],W),s.vadd(W,W);const Z=Ub;if(W.vsub(i,Z),Z.lengthSquared()<C*C){if(y)return!0;A=!0;const te=this.createContactEquation(u,f,e,t,m,v);return te.ri.copy(Z),te.ri.normalize(),te.ni.copy(te.ri),te.ri.scale(C,te.ri),W.vsub(s,te.rj),te.ri.vadd(i,te.ri),te.ri.vsub(u.position,te.ri),te.rj.vadd(s,te.rj),te.rj.vsub(f.position,te.rj),this.result.push(te),void this.createFrictionEquationsFromContact(te,this.frictionResult)}}for(let F=0,N=M.length;F!==N&&!1===A;F++){const Z=M[F],te=US;c.vmult(x[F],te);const ee=lT;c.vmult(P[Z[0]],ee),ee.vadd(s,ee);const le=cT;te.scale(-C,le),i.vadd(le,le);const j=uT;le.vsub(ee,j);const ne=j.dot(te),Ge=dT;if(i.vsub(ee,Ge),ne<0&&Ge.dot(te)>0){const rt=[];for(let Me=0,Ae=Z.length;Me!==Ae;Me++){const Re=_.get();c.vmult(P[Z[Me]],Re),s.vadd(Re,Re),rt.push(Re)}if(Ob(rt,te,i)){if(y)return!0;A=!0;const Me=this.createContactEquation(u,f,e,t,m,v);te.scale(-C,Me.ri),te.negate(Me.ni);const Ae=_.get();te.scale(-ne,Ae);const Re=_.get();te.scale(-C,Re),i.vsub(s,Me.rj),Me.rj.vadd(Re,Me.rj),Me.rj.vadd(Ae,Me.rj),Me.rj.vadd(s,Me.rj),Me.rj.vsub(f.position,Me.rj),Me.ri.vadd(i,Me.ri),Me.ri.vsub(u.position,Me.ri),_.release(Ae),_.release(Re),this.result.push(Me),this.createFrictionEquationsFromContact(Me,this.frictionResult);for(let He=0,xt=rt.length;He!==xt;He++)_.release(rt[He]);return}for(let Me=0;Me!==Z.length;Me++){const Ae=_.get(),Re=_.get();c.vmult(P[Z[(Me+1)%Z.length]],Ae),c.vmult(P[Z[(Me+2)%Z.length]],Re),s.vadd(Ae,Ae),s.vadd(Re,Re);const He=kb;Re.vsub(Ae,He);const xt=BS;He.unit(xt);const St=_.get(),Mt=_.get();i.vsub(Ae,Mt);const Bt=Mt.dot(xt);xt.scale(Bt,St),St.vadd(Ae,St);const pt=_.get();if(St.vsub(i,pt),Bt>0&&Bt*Bt<He.lengthSquared()&&pt.lengthSquared()<C*C){if(y)return!0;const ht=this.createContactEquation(u,f,e,t,m,v);St.vsub(s,ht.rj),St.vsub(i,ht.ni),ht.ni.normalize(),ht.ni.scale(C,ht.ri),ht.rj.vadd(s,ht.rj),ht.rj.vsub(f.position,ht.rj),ht.ri.vadd(i,ht.ri),ht.ri.vsub(u.position,ht.ri),this.result.push(ht),this.createFrictionEquationsFromContact(ht,this.frictionResult);for(let pn=0,bn=rt.length;pn!==bn;pn++)_.release(rt[pn]);return _.release(Ae),_.release(Re),_.release(St),_.release(pt),void _.release(Mt)}_.release(Ae),_.release(Re),_.release(St),_.release(pt),_.release(Mt)}for(let Me=0,Ae=rt.length;Me!==Ae;Me++)_.release(rt[Me])}}}planeConvex(e,t,i,s,a,c,u,f,m,v,y){const _=Vb,x=vm;x.set(0,0,1),a.vmult(x,x);let M=0;const P=VS;for(let C=0;C!==t.vertices.length;C++)if(_.copy(t.vertices[C]),c.vmult(_,_),s.vadd(_,_),_.vsub(i,P),x.dot(P)<=0){if(y)return!0;const F=this.createContactEquation(u,f,e,t,m,v),N=zS;x.scale(x.dot(P),N),_.vsub(N,N),N.vsub(i,F.ri),F.ni.copy(x),_.vsub(s,F.rj),F.ri.vadd(i,F.ri),F.ri.vsub(u.position,F.ri),F.rj.vadd(s,F.rj),F.rj.vsub(f.position,F.rj),this.result.push(F),M++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(F,this.frictionResult)}this.enableFrictionReduction&&M&&this.createFrictionFromAverage(M)}boxConvex(e,t,i,s,a,c,u,f,m,v,y){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,i,s,a,c,u,f,e,t,y)}sphereHeightfield(e,t,i,s,a,c,u,f,m,v,y){const _=t.data,x=e.radius,M=t.elementSize,P=Wb,C=KS;Ji.pointToLocalFrame(s,c,i,C);let A=Math.floor((C.x-x)/M)-1,F=Math.ceil((C.x+x)/M)+1,N=Math.floor((C.y-x)/M)-1,W=Math.ceil((C.y+x)/M)+1;if(F<0||W<0||A>_.length||N>_[0].length)return;A<0&&(A=0),F<0&&(F=0),N<0&&(N=0),W<0&&(W=0),A>=_.length&&(A=_.length-1),F>=_.length&&(F=_.length-1),W>=_[0].length&&(W=_[0].length-1),N>=_[0].length&&(N=_[0].length-1);const Z=[];if(t.getRectMinMax(A,N,F,W,Z),C.z-x>Z[1]||C.z+x<Z[0])return;const le=this.result;for(let j=A;j<F;j++)for(let ne=N;ne<W;ne++){const Ge=le.length;let rt=!1;if(t.getConvexTrianglePillar(j,ne,!1),Ji.pointToWorldFrame(s,c,t.pillarOffset,P),i.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(rt=this.sphereConvex(e,t.pillarConvex,i,P,a,c,u,f,e,t,y)),y&&rt||(t.getConvexTrianglePillar(j,ne,!0),Ji.pointToWorldFrame(s,c,t.pillarOffset,P),i.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(rt=this.sphereConvex(e,t.pillarConvex,i,P,a,c,u,f,e,t,y)),y&&rt))return!0;if(le.length-Ge>2)return}}boxHeightfield(e,t,i,s,a,c,u,f,m,v,y){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,i,s,a,c,u,f,e,t,y)}convexHeightfield(e,t,i,s,a,c,u,f,m,v,y){const _=t.data,x=t.elementSize,M=e.boundingSphereRadius,P=XS,C=Gb,A=wf;Ji.pointToLocalFrame(s,c,i,A);let F=Math.floor((A.x-M)/x)-1,N=Math.ceil((A.x+M)/x)+1,W=Math.floor((A.y-M)/x)-1,Z=Math.ceil((A.y+M)/x)+1;if(N<0||Z<0||F>_.length||W>_[0].length)return;F<0&&(F=0),N<0&&(N=0),W<0&&(W=0),Z<0&&(Z=0),F>=_.length&&(F=_.length-1),N>=_.length&&(N=_.length-1),Z>=_[0].length&&(Z=_[0].length-1),W>=_[0].length&&(W=_[0].length-1);const te=[];if(t.getRectMinMax(F,W,N,Z,te),!(A.z-M>te[1]||A.z+M<te[0]))for(let j=F;j<N;j++)for(let ne=W;ne<Z;ne++){let Ge=!1;if(t.getConvexTrianglePillar(j,ne,!1),Ji.pointToWorldFrame(s,c,t.pillarOffset,P),i.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(Ge=this.convexConvex(e,t.pillarConvex,i,P,a,c,u,f,null,null,y,C,null)),y&&Ge||(t.getConvexTrianglePillar(j,ne,!0),Ji.pointToWorldFrame(s,c,t.pillarOffset,P),i.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(Ge=this.convexConvex(e,t.pillarConvex,i,P,a,c,u,f,null,null,y,C,null)),y&&Ge))return!0}}sphereParticle(e,t,i,s,a,c,u,f,m,v,y){const _=WS;if(_.set(0,0,1),s.vsub(i,_),_.lengthSquared()<=e.radius*e.radius){if(y)return!0;const M=this.createContactEquation(f,u,t,e,m,v);_.normalize(),M.rj.copy(_),M.rj.scale(e.radius,M.rj),M.ni.copy(_),M.ni.negate(M.ni),M.ri.set(0,0,0),this.result.push(M),this.createFrictionEquationsFromContact(M,this.frictionResult)}}planeParticle(e,t,i,s,a,c,u,f,m,v,y){const _=HS;_.set(0,0,1),u.quaternion.vmult(_,_);const x=$S;if(s.vsub(u.position,x),_.dot(x)<=0){if(y)return!0;const P=this.createContactEquation(f,u,t,e,m,v);P.ni.copy(_),P.ni.negate(P.ni),P.ri.set(0,0,0);const C=GS;_.scale(_.dot(s),C),s.vsub(C,C),P.rj.copy(C),this.result.push(P),this.createFrictionEquationsFromContact(P,this.frictionResult)}}boxParticle(e,t,i,s,a,c,u,f,m,v,y){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,i,s,a,c,u,f,e,t,y)}convexParticle(e,t,i,s,a,c,u,f,m,v,y){let _=-1;const x=Hb,M=qS;let P=null;const C=YS;if(C.copy(s),C.vsub(i,C),a.conjugate(jS),jS.vmult(C,C),e.pointIsInside(C)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(i,a),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(a);for(let A=0,F=e.faces.length;A!==F;A++){const W=e.worldFaceNormals[A];s.vsub(e.worldVertices[e.faces[A][0]],$b);const Z=-W.dot($b);if(null===P||Math.abs(Z)<Math.abs(P)){if(y)return!0;P=Z,_=A,x.copy(W)}}if(-1!==_){const A=this.createContactEquation(f,u,t,e,m,v);x.scale(P,M),M.vadd(s,M),M.vsub(i,M),A.rj.copy(M),x.negate(A.ni),A.ri.set(0,0,0);const F=A.ri,N=A.rj;F.vadd(s,F),F.vsub(f.position,F),N.vadd(i,N),N.vsub(u.position,N),this.result.push(A),this.createFrictionEquationsFromContact(A,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,t,i,s,a,c,u,f,m,v,y){return this.convexHeightfield(t,e,s,i,c,a,f,u,m,v,y)}particleCylinder(e,t,i,s,a,c,u,f,m,v,y){return this.convexParticle(t,e,s,i,c,a,f,u,m,v,y)}sphereTrimesh(e,t,i,s,a,c,u,f,m,v,y){const _=ua,x=Ab,M=Tb,P=AS,C=Db,A=Ib,F=DS,N=mm,W=CS,Z=IS;Ji.pointToLocalFrame(s,c,i,C);const te=e.radius;F.lowerBound.set(C.x-te,C.y-te,C.z-te),F.upperBound.set(C.x+te,C.y+te,C.z+te),t.getTrianglesInAABB(F,Z);const ee=pm,le=e.radius*e.radius;for(let Me=0;Me<Z.length;Me++)for(let Ae=0;Ae<3;Ae++)if(t.getVertex(t.indices[3*Z[Me]+Ae],ee),ee.vsub(C,W),W.lengthSquared()<=le){if(N.copy(ee),Ji.pointToWorldFrame(s,c,N,ee),ee.vsub(i,W),y)return!0;let Re=this.createContactEquation(u,f,e,t,m,v);Re.ni.copy(W),Re.ni.normalize(),Re.ri.copy(Re.ni),Re.ri.scale(e.radius,Re.ri),Re.ri.vadd(i,Re.ri),Re.ri.vsub(u.position,Re.ri),Re.rj.copy(ee),Re.rj.vsub(f.position,Re.rj),this.result.push(Re),this.createFrictionEquationsFromContact(Re,this.frictionResult)}for(let Me=0;Me<Z.length;Me++)for(let Ae=0;Ae<3;Ae++){t.getVertex(t.indices[3*Z[Me]+Ae],_),t.getVertex(t.indices[3*Z[Me]+(Ae+1)%3],x),x.vsub(_,M),C.vsub(x,A);const Re=A.dot(M);C.vsub(_,A);let He=A.dot(M);if(He>0&&Re<0&&(C.vsub(_,A),P.copy(M),P.normalize(),He=A.dot(P),P.scale(He,A),A.vadd(_,A),A.distanceTo(C)<e.radius)){if(y)return!0;const St=this.createContactEquation(u,f,e,t,m,v);A.vsub(C,St.ni),St.ni.normalize(),St.ni.scale(e.radius,St.ri),St.ri.vadd(i,St.ri),St.ri.vsub(u.position,St.ri),Ji.pointToWorldFrame(s,c,A,A),A.vsub(f.position,St.rj),Ji.vectorToWorldFrame(c,St.ni,St.ni),Ji.vectorToWorldFrame(c,St.ri,St.ri),this.result.push(St),this.createFrictionEquationsFromContact(St,this.frictionResult)}}const j=Rb,ne=Pb,Ge=TS,rt=Jd;for(let Me=0,Ae=Z.length;Me!==Ae;Me++){t.getTriangleVertices(Z[Me],j,ne,Ge),t.getNormal(Z[Me],rt),C.vsub(j,A);let Re=A.dot(rt);if(rt.scale(Re,A),C.vsub(A,A),Re=A.distanceTo(C),Hs.pointInTriangle(A,j,ne,Ge)&&Re<e.radius){if(y)return!0;let He=this.createContactEquation(u,f,e,t,m,v);A.vsub(C,He.ni),He.ni.normalize(),He.ni.scale(e.radius,He.ri),He.ri.vadd(i,He.ri),He.ri.vsub(u.position,He.ri),Ji.pointToWorldFrame(s,c,A,A),A.vsub(f.position,He.rj),Ji.vectorToWorldFrame(c,He.ni,He.ni),Ji.vectorToWorldFrame(c,He.ri,He.ri),this.result.push(He),this.createFrictionEquationsFromContact(He,this.frictionResult)}}Z.length=0}planeTrimesh(e,t,i,s,a,c,u,f,m,v,y){const _=new X,x=wS;x.set(0,0,1),a.vmult(x,x);for(let M=0;M<t.vertices.length/3;M++){t.getVertex(M,_);const P=new X;P.copy(_),Ji.pointToWorldFrame(s,c,P,_);const C=MS;if(_.vsub(i,C),x.dot(C)<=0){if(y)return!0;const F=this.createContactEquation(u,f,e,t,m,v);F.ni.copy(x);const N=SS;x.scale(C.dot(x),N),_.vsub(N,N),F.ri.copy(N),F.ri.vsub(u.position,F.ri),F.rj.copy(_),F.rj.vsub(f.position,F.rj),this.result.push(F),this.createFrictionEquationsFromContact(F,this.frictionResult)}}}}const Kd=new X,bc=new X,yf=new X,Sb=new X,Cb=new X,aT=new ds,Zd=new ds,wS=new X,MS=new X,SS=new X,Jd=new X,CS=new X;new X;const pm=new X,mm=new X,ua=new X,Ab=new X,Tb=new X,AS=new X,Db=new X,Ib=new X,Rb=new X,Pb=new X,TS=new X,DS=new us,IS=[],xc=new X,Lb=new X,RS=new X,PS=new X,gm=new X;function Ob(d,e,t){let i=null;const s=d.length;for(let a=0;a!==s;a++){const c=d[a],u=RS;d[(a+1)%s].vsub(c,u);const f=PS;u.cross(e,f);const m=gm;t.vsub(c,m);const v=f.dot(m);if(!(null===i||v>0&&!0===i||v<=0&&!1===i))return!1;null===i&&(i=v>0)}return!0}const _f=new X,Nb=new X,LS=new X,bf=new X,xf=[new X,new X,new X,new X,new X,new X],OS=new X,NS=new X,FS=new X,Fb=new X,Bb=new X,kb=new X,BS=new X,Ub=new X,kS=new X,US=new X,lT=new X,cT=new X,uT=new X,dT=new X;new X,new X;const Vb=new X,vm=new X,VS=new X,zS=new X,zb=new X,Ef=new X,HS=new X,$S=new X,GS=new X,WS=new X,jS=new ds,YS=new X;new X;const Hb=new X,$b=new X,qS=new X,wf=new X,XS=new X,Gb=[0],KS=new X,Wb=new X;class jb{constructor(){this.current=[],this.previous=[]}getKey(e,t){if(t<e){const i=t;t=e,e=i}return e<<16|t}set(e,t){const i=this.getKey(e,t),s=this.current;let a=0;for(;i>s[a];)a++;if(i!==s[a]){for(let c=s.length-1;c>=a;c--)s[c+1]=s[c];s[a]=i}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,t){const i=this.current,s=this.previous,a=i.length,c=s.length;let u=0;for(let f=0;f<a;f++){let m=!1;const v=i[f];for(;v>s[u];)u++;m=v===s[u],m||Kv(e,v)}u=0;for(let f=0;f<c;f++){let m=!1;const v=s[f];for(;v>i[u];)u++;m=i[u]===v,m||Kv(t,v)}}}function Kv(d,e){d.push((4294901760&e)>>16,65535&e)}const Zv=(d,e)=>d<e?`${d}-${e}`:`${e}-${d}`;class Jv{constructor(){this.data={keys:[]}}get(e,t){const i=Zv(e,t);return this.data[i]}set(e,t,i){const s=Zv(e,t);this.get(e,t)||this.data.keys.push(s),this.data[s]=i}delete(e,t){const i=Zv(e,t),s=this.data.keys.indexOf(i);-1!==s&&this.data.keys.splice(s,1),delete this.data[i]}reset(){const e=this.data,t=e.keys;for(;t.length>0;)delete e[t.pop()]}}class ZS extends wv{constructor(e){void 0===e&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==e.quatNormalizeSkip?e.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==e.quatNormalizeFast&&e.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new X,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new X,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=void 0!==e.broadphase?e.broadphase:new QA,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==e.solver?e.solver:new jv,this.constraints=[],this.narrowphase=new Xd(this),this.collisionMatrix=new Gp,this.collisionMatrixPrevious=new Gp,this.bodyOverlapKeeper=new jb,this.shapeOverlapKeeper=new jb,this.contactmaterials=[],this.contactMaterialTable=new Jv,this.defaultMaterial=new qM("default"),this.defaultContactMaterial=new Nv(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,t){return this.contactMaterialTable.get(e.id,t.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)}rayTest(e,t,i){i instanceof lf?this.raycastClosest(e,t,{skipBackfaces:!0},i):this.raycastAll(e,t,{skipBackfaces:!0},i)}raycastAll(e,t,i,s){return void 0===i&&(i={}),i.mode=Hs.ALL,i.from=e,i.to=t,i.callback=s,ym.intersectWorld(this,i)}raycastAny(e,t,i,s){return void 0===i&&(i={}),i.mode=Hs.ANY,i.from=e,i.to=t,i.result=s,ym.intersectWorld(this,i)}raycastClosest(e,t,i,s){return void 0===i&&(i={}),i.mode=Hs.CLOSEST,i.from=e,i.to=t,i.result=s,ym.intersectWorld(this,i)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof ii&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const t=this.bodies.length-1,i=this.bodies,s=i.indexOf(e);if(-1!==s){i.splice(s,1);for(let a=0;a!==i.length;a++)i[a].index=a;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const t=this.bodies;for(let i=0;i<t.length;i++){const s=t[i].shapes;for(let a=0;a<s.length;a++){const c=s[a];if(c.id===e)return c}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const t=this.contactmaterials.indexOf(e);-1!==t&&(this.contactmaterials.splice(t,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,t){void 0===e&&(e=1/60),void 0===t&&(t=10);const i=eo.now()/1e3;this.step(e,this.lastCallTime?i-this.lastCallTime:void 0,t),this.lastCallTime=i}step(e,t,i){if(void 0===i&&(i=10),void 0===t)this.internalStep(e),this.time+=e;else{this.accumulator+=t;const s=eo.now();let a=0;for(;this.accumulator>=e&&a<i&&(this.internalStep(e),this.accumulator-=e,a++,!(eo.now()-s>1e3*e)););this.accumulator=this.accumulator%e;const c=this.accumulator/e;for(let u=0;u!==this.bodies.length;u++){const f=this.bodies[u];f.previousPosition.lerp(f.position,c,f.interpolatedPosition),f.previousQuaternion.slerp(f.quaternion,c,f.interpolatedQuaternion),f.previousQuaternion.normalize()}this.time+=t}}internalStep(e){this.dt=e;const t=this.contacts,i=Yb,s=tC,a=this.bodies.length,c=this.bodies,u=this.solver,f=this.gravity,m=this.doProfiling,v=this.profile,y=ii.DYNAMIC;let _=-1/0;const x=this.constraints,M=eC;f.length();const P=f.x,C=f.y,A=f.z;let F=0;for(m&&(_=eo.now()),F=0;F!==a;F++){const Me=c[F];if(Me.type===y){const Ae=Me.force,Re=Me.mass;Ae.x+=Re*P,Ae.y+=Re*C,Ae.z+=Re*A}}for(let Me=0,Ae=this.subsystems.length;Me!==Ae;Me++)this.subsystems[Me].update();m&&(_=eo.now()),i.length=0,s.length=0,this.broadphase.collisionPairs(this,i,s),m&&(v.broadphase=eo.now()-_);let N=x.length;for(F=0;F!==N;F++){const Me=x[F];if(!Me.collideConnected)for(let Ae=i.length-1;Ae>=0;Ae-=1)(Me.bodyA===i[Ae]&&Me.bodyB===s[Ae]||Me.bodyB===i[Ae]&&Me.bodyA===s[Ae])&&(i.splice(Ae,1),s.splice(Ae,1))}this.collisionMatrixTick(),m&&(_=eo.now());const W=Qv,Z=t.length;for(F=0;F!==Z;F++)W.push(t[F]);t.length=0;const te=this.frictionEquations.length;for(F=0;F!==te;F++)M.push(this.frictionEquations[F]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,s,this,t,W,this.frictionEquations,M),m&&(v.narrowphase=eo.now()-_),m&&(_=eo.now()),F=0;F<this.frictionEquations.length;F++)u.addEquation(this.frictionEquations[F]);const ee=t.length;for(let Me=0;Me!==ee;Me++){const Ae=t[Me],Re=Ae.bi,He=Ae.bj,xt=Ae.si,St=Ae.sj;let Mt;Mt=Re.material&&He.material&&this.getContactMaterial(Re.material,He.material)||this.defaultContactMaterial,Re.material&&He.material&&Re.material.restitution>=0&&He.material.restitution>=0&&(Ae.restitution=Re.material.restitution*He.material.restitution),u.addEquation(Ae),Re.allowSleep&&Re.type===ii.DYNAMIC&&Re.sleepState===ii.SLEEPING&&He.sleepState===ii.AWAKE&&He.type!==ii.STATIC&&He.velocity.lengthSquared()+He.angularVelocity.lengthSquared()>=2*He.sleepSpeedLimit**2&&(Re.wakeUpAfterNarrowphase=!0),He.allowSleep&&He.type===ii.DYNAMIC&&He.sleepState===ii.SLEEPING&&Re.sleepState===ii.AWAKE&&Re.type!==ii.STATIC&&Re.velocity.lengthSquared()+Re.angularVelocity.lengthSquared()>=2*Re.sleepSpeedLimit**2&&(He.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Re,He,!0),this.collisionMatrixPrevious.get(Re,He)||(Mf.body=He,Mf.contact=Ae,Re.dispatchEvent(Mf),Mf.body=Re,He.dispatchEvent(Mf)),this.bodyOverlapKeeper.set(Re.id,He.id),this.shapeOverlapKeeper.set(xt.id,St.id)}for(this.emitContactEvents(),m&&(v.makeContactConstraints=eo.now()-_,_=eo.now()),F=0;F!==a;F++){const Me=c[F];Me.wakeUpAfterNarrowphase&&(Me.wakeUp(),Me.wakeUpAfterNarrowphase=!1)}for(N=x.length,F=0;F!==N;F++){const Me=x[F];Me.update();for(let Ae=0,Re=Me.equations.length;Ae!==Re;Ae++)u.addEquation(Me.equations[Ae])}u.solve(e,this),m&&(v.solve=eo.now()-_),u.removeAllEquations();const le=Math.pow;for(F=0;F!==a;F++){const Me=c[F];if(Me.type&y){const Ae=le(1-Me.linearDamping,e),Re=Me.velocity;Re.scale(Ae,Re);const He=Me.angularVelocity;if(He){const xt=le(1-Me.angularDamping,e);He.scale(xt,He)}}}this.dispatchEvent(QS),m&&(_=eo.now());const ne=this.stepnumber%(this.quatNormalizeSkip+1)==0,Ge=this.quatNormalizeFast;for(F=0;F!==a;F++)c[F].integrate(e,ne,Ge);this.clearForces(),this.broadphase.dirty=!0,m&&(v.integrate=eo.now()-_),this.stepnumber+=1,this.dispatchEvent(JS);let rt=!0;if(this.allowSleep)for(rt=!1,F=0;F!==a;F++){const Me=c[F];Me.sleepTick(this.time),Me.sleepState!==ii.SLEEPING&&(rt=!0)}this.hasActiveBodies=rt}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(kl,Ul),e){for(let a=0,c=kl.length;a<c;a+=2)Sf.bodyA=this.getBodyById(kl[a]),Sf.bodyB=this.getBodyById(kl[a+1]),this.dispatchEvent(Sf);Sf.bodyA=Sf.bodyB=null}if(t){for(let a=0,c=Ul.length;a<c;a+=2)Cf.bodyA=this.getBodyById(Ul[a]),Cf.bodyB=this.getBodyById(Ul[a+1]),this.dispatchEvent(Cf);Cf.bodyA=Cf.bodyB=null}kl.length=Ul.length=0;const i=this.hasAnyEventListener("beginShapeContact"),s=this.hasAnyEventListener("endShapeContact");if((i||s)&&this.shapeOverlapKeeper.getDiff(kl,Ul),i){for(let a=0,c=kl.length;a<c;a+=2){const u=this.getShapeById(kl[a]),f=this.getShapeById(kl[a+1]);Vl.shapeA=u,Vl.shapeB=f,u&&(Vl.bodyA=u.body),f&&(Vl.bodyB=f.body),this.dispatchEvent(Vl)}Vl.bodyA=Vl.bodyB=Vl.shapeA=Vl.shapeB=null}if(s){for(let a=0,c=Ul.length;a<c;a+=2){const u=this.getShapeById(Ul[a]),f=this.getShapeById(Ul[a+1]);zl.shapeA=u,zl.shapeB=f,u&&(zl.bodyA=u.body),f&&(zl.bodyB=f.body),this.dispatchEvent(zl)}zl.bodyA=zl.bodyB=zl.shapeA=zl.shapeB=null}}clearForces(){const e=this.bodies,t=e.length;for(let i=0;i!==t;i++){const s=e[i];s.force.set(0,0,0),s.torque.set(0,0,0)}}}new us;const ym=new Hs,eo=globalThis.performance||{};if(!eo.now){let d=Date.now();eo.timing&&eo.timing.navigationStart&&(d=eo.timing.navigationStart),eo.now=()=>Date.now()-d}new X;const JS={type:"postStep"},QS={type:"preStep"},Mf={type:ii.COLLIDE_EVENT_NAME,body:null,contact:null},Qv=[],eC=[],Yb=[],tC=[],kl=[],Ul=[],Sf={type:"beginContact",bodyA:null,bodyB:null},Cf={type:"endContact",bodyA:null,bodyB:null},Vl={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},zl={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};function nC(d,e,t){let{color:i=65280,scale:s=1,onInit:a,onUpdate:c}=void 0===t?{}:t;const u=[],f=new sa({color:null!=i?i:65280,wireframe:!0}),m=new X,v=new X,y=new X,_=new ds,x=new Sd(1),M=new Mo(1,1,1),P=new Bc(10,10,10,10);function te(le,j){let ne=u[le],Ge=!1;return function Z(le,j){if(!le)return!1;const{geometry:ne}=le;return ne instanceof Sd&&j.type===Fn.types.SPHERE||ne instanceof Mo&&j.type===Fn.types.BOX||ne instanceof Bc&&j.type===Fn.types.PLANE||ne.id===j.geometryId&&j.type===Fn.types.CYLINDER||ne.id===j.geometryId&&j.type===Fn.types.CONVEXPOLYHEDRON||ne.id===j.geometryId&&j.type===Fn.types.TRIMESH||ne.id===j.geometryId&&j.type===Fn.types.HEIGHTFIELD}(ne,j)||(ne&&d.remove(ne),u[le]=ne=function N(le){let j=new Xr;const{SPHERE:ne,BOX:Ge,PLANE:rt,CYLINDER:Me,CONVEXPOLYHEDRON:Ae,TRIMESH:Re,HEIGHTFIELD:He}=Fn.types;switch(le.type){case ne:j=new Xr(x,f);break;case Ge:j=new Xr(M,f);break;case rt:j=new Xr(P,f);break;case Me:{const xt=new _d(le.radiusTop,le.radiusBottom,le.height,le.numSegments);j=new Xr(xt,f),le.geometryId=xt.id;break}case Ae:{const xt=function C(le){const j=new Zi,ne=[];for(let rt=0;rt<le.vertices.length;rt++){const Me=le.vertices[rt];ne.push(Me.x,Me.y,Me.z)}j.setAttribute("position",new kn(ne,3));const Ge=[];for(let rt=0;rt<le.faces.length;rt++){const Me=le.faces[rt],Ae=Me[0];for(let Re=1;Re<Me.length-1;Re++)Ge.push(Ae,Me[Re],Me[Re+1])}return j.setIndex(Ge),j.computeBoundingSphere(),j.computeVertexNormals(),j}(le);j=new Xr(xt,f),le.geometryId=xt.id;break}case Re:{const xt=function A(le){const j=new Zi,ne=[],Ge=m,rt=v,Me=y;for(let Ae=0;Ae<le.indices.length/3;Ae++)le.getTriangleVertices(Ae,Ge,rt,Me),ne.push(Ge.x,Ge.y,Ge.z),ne.push(rt.x,rt.y,rt.z),ne.push(Me.x,Me.y,Me.z);return j.setAttribute("position",new kn(ne,3)),j.computeBoundingSphere(),j.computeVertexNormals(),j}(le);j=new Xr(xt,f),le.geometryId=xt.id;break}case He:{const xt=function F(le){const j=new Zi,ne=le.elementSize||1,Ge=le.data.flatMap((Me,Ae)=>Me.flatMap((Re,He)=>[Ae*ne,He*ne,Re])),rt=[];for(let Me=0;Me<le.data.length-1;Me++)for(let Ae=0;Ae<le.data[Me].length-1;Ae++){const Re=le.data[Me].length,He=Me*Re+Ae;rt.push(He+1,He+Re,He+Re+1),rt.push(He+Re,He+1,He)}return j.setIndex(rt),j.setAttribute("position",new kn(Ge,3)),j.computeBoundingSphere(),j.computeVertexNormals(),j}(le);j=new Xr(xt,f),le.geometryId=xt.id;break}}return d.add(j),j}(j),Ge=!0),function W(le,j){const{SPHERE:ne,BOX:Ge,PLANE:rt,CYLINDER:Me,CONVEXPOLYHEDRON:Ae,TRIMESH:Re,HEIGHTFIELD:He}=Fn.types;switch(j.type){case ne:{const{radius:xt}=j;le.scale.set(xt*s,xt*s,xt*s);break}case Ge:le.scale.copy(j.halfExtents),le.scale.multiplyScalar(2*s);break;case rt:break;case Me:case Ae:le.scale.set(1*s,1*s,1*s);break;case Re:le.scale.copy(j.scale).multiplyScalar(s);break;case He:le.scale.set(1*s,1*s,1*s)}}(ne,j),Ge}return P.translate(0,0,1e-4),{update:function ee(){const le=u,j=m,ne=_;let Ge=0;for(const rt of e.bodies)for(let Me=0;Me!==rt.shapes.length;Me++){const Ae=rt.shapes[Me],Re=te(Ge,Ae),He=le[Ge];He&&(rt.quaternion.vmult(rt.shapeOffsets[Me],j),rt.position.vadd(j,j),rt.quaternion.mult(rt.shapeOrientations[Me],ne),He.position.copy(j),He.quaternion.copy(ne),Re&&a instanceof Function&&a(rt,He,Ae),!Re&&c instanceof Function&&c(rt,He,Ae)),Ge++}for(let rt=Ge;rt<le.length;rt++){const Me=le[rt];Me&&d.remove(Me)}le.length=Ge}}}const ey={type:"change"},_m={type:"start"},qb={type:"end"},bm=new Ml,ty=new ya,iC=Math.cos(70*Bo_DEG2RAD);class rC extends mr{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new he,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(We){We.addEventListener("keydown",fe),this._domElementKeyEvents=We},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",fe),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(ey),i.update(),a=s.NONE},this.update=function(){const We=new he,hn=(new on).setFromUnitVectors(e.up,new he(0,1,0)),Zn=hn.clone().invert(),Un=new he,Xn=new on,ji=new he,wr=2*Math.PI;return function(Kn=null){const Ht=i.object.position;We.copy(Ht).sub(i.target),We.applyQuaternion(hn),u.setFromVector3(We),i.autoRotate&&a===s.NONE&&Ge(function j(We){return null!==We?2*Math.PI/60*i.autoRotateSpeed*We:2*Math.PI/60/60*i.autoRotateSpeed}(Kn)),i.enableDamping?(u.theta+=f.theta*i.dampingFactor,u.phi+=f.phi*i.dampingFactor):(u.theta+=f.theta,u.phi+=f.phi);let wn=i.minAzimuthAngle,zn=i.maxAzimuthAngle;isFinite(wn)&&isFinite(zn)&&(wn<-Math.PI?wn+=wr:wn>Math.PI&&(wn-=wr),zn<-Math.PI?zn+=wr:zn>Math.PI&&(zn-=wr),u.theta=wn<=zn?Math.max(wn,Math.min(zn,u.theta)):u.theta>(wn+zn)/2?Math.max(wn,u.theta):Math.min(zn,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(v,i.dampingFactor):i.target.add(v),u.radius=Mt(i.zoomToCursor&&te||i.object.isOrthographicCamera?u.radius:u.radius*m),We.setFromSpherical(u),We.applyQuaternion(Zn),Ht.copy(i.target).add(We),i.object.lookAt(i.target),!0===i.enableDamping?(f.theta*=1-i.dampingFactor,f.phi*=1-i.dampingFactor,v.multiplyScalar(1-i.dampingFactor)):(f.set(0,0,0),v.set(0,0,0));let gr=!1;if(i.zoomToCursor&&te){let Wr=null;if(i.object.isPerspectiveCamera){const rs=We.length();Wr=Mt(rs*m),i.object.position.addScaledVector(W,rs-Wr),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const rs=new he(Z.x,Z.y,0);rs.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),gr=!0;const Ea=new he(Z.x,Z.y,0);Ea.unproject(i.object),i.object.position.sub(Ea).add(rs),i.object.updateMatrixWorld(),Wr=We.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==Wr&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Wr).add(i.object.position):(bm.origin.copy(i.object.position),bm.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(bm.direction))<iC?e.lookAt(i.target):(ty.setFromNormalAndCoplanarPoint(i.object.up,i.target),bm.intersectPlane(ty,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),gr=!0);return m=1,te=!1,!!(gr||Un.distanceToSquared(i.object.position)>c||8*(1-Xn.dot(i.object.quaternion))>c||ji.distanceToSquared(i.target)>0)&&(i.dispatchEvent(ey),Un.copy(i.object.position),Xn.copy(i.object.quaternion),ji.copy(i.target),gr=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",mn),i.domElement.removeEventListener("pointerdown",ri),i.domElement.removeEventListener("pointercancel",Ti),i.domElement.removeEventListener("wheel",Te),i.domElement.removeEventListener("pointermove",si),i.domElement.removeEventListener("pointerup",Ti),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",fe),i._domElementKeyEvents=null)};const i=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=s.NONE;const c=1e-6,u=new fu,f=new fu;let m=1;const v=new he,y=new Jt,_=new Jt,x=new Jt,M=new Jt,P=new Jt,C=new Jt,A=new Jt,F=new Jt,N=new Jt,W=new he,Z=new Jt;let te=!1;const ee=[],le={};function ne(){return Math.pow(.95,i.zoomSpeed)}function Ge(We){f.theta-=We}function rt(We){f.phi-=We}const Me=function(){const We=new he;return function(Zn,Un){We.setFromMatrixColumn(Un,0),We.multiplyScalar(-Zn),v.add(We)}}(),Ae=function(){const We=new he;return function(Zn,Un){!0===i.screenSpacePanning?We.setFromMatrixColumn(Un,1):(We.setFromMatrixColumn(Un,0),We.crossVectors(i.object.up,We)),We.multiplyScalar(Zn),v.add(We)}}(),Re=function(){const We=new he;return function(Zn,Un){const Xn=i.domElement;if(i.object.isPerspectiveCamera){We.copy(i.object.position).sub(i.target);let wr=We.length();wr*=Math.tan(i.object.fov/2*Math.PI/180),Me(2*Zn*wr/Xn.clientHeight,i.object.matrix),Ae(2*Un*wr/Xn.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(Me(Zn*(i.object.right-i.object.left)/i.object.zoom/Xn.clientWidth,i.object.matrix),Ae(Un*(i.object.top-i.object.bottom)/i.object.zoom/Xn.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function He(We){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?m/=We:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function xt(We){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?m*=We:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function St(We){if(!i.zoomToCursor)return;te=!0;const hn=i.domElement.getBoundingClientRect(),Un=We.clientY-hn.top,ji=hn.height;Z.x=(We.clientX-hn.left)/hn.width*2-1,Z.y=-Un/ji*2+1,W.set(Z.x,Z.y,1).unproject(i.object).sub(i.object.position).normalize()}function Mt(We){return Math.max(i.minDistance,Math.min(i.maxDistance,We))}function Bt(We){y.set(We.clientX,We.clientY)}function ht(We){M.set(We.clientX,We.clientY)}function ei(){1===ee.length?y.set(ee[0].pageX,ee[0].pageY):y.set(.5*(ee[0].pageX+ee[1].pageX),.5*(ee[0].pageY+ee[1].pageY))}function zi(){1===ee.length?M.set(ee[0].pageX,ee[0].pageY):M.set(.5*(ee[0].pageX+ee[1].pageX),.5*(ee[0].pageY+ee[1].pageY))}function Ki(){const We=ee[0].pageX-ee[1].pageX,hn=ee[0].pageY-ee[1].pageY,Zn=Math.sqrt(We*We+hn*hn);A.set(0,Zn)}function Cn(We){if(1==ee.length)_.set(We.pageX,We.pageY);else{const Zn=zt(We);_.set(.5*(We.pageX+Zn.x),.5*(We.pageY+Zn.y))}x.subVectors(_,y).multiplyScalar(i.rotateSpeed);const hn=i.domElement;Ge(2*Math.PI*x.x/hn.clientHeight),rt(2*Math.PI*x.y/hn.clientHeight),y.copy(_)}function nn(We){if(1===ee.length)P.set(We.pageX,We.pageY);else{const hn=zt(We);P.set(.5*(We.pageX+hn.x),.5*(We.pageY+hn.y))}C.subVectors(P,M).multiplyScalar(i.panSpeed),Re(C.x,C.y),M.copy(P)}function An(We){const hn=zt(We),Zn=We.pageX-hn.x,Un=We.pageY-hn.y,Xn=Math.sqrt(Zn*Zn+Un*Un);F.set(0,Xn),N.set(0,Math.pow(F.y/A.y,i.zoomSpeed)),He(N.y),A.copy(F)}function ri(We){!1!==i.enabled&&(0===ee.length&&(i.domElement.setPointerCapture(We.pointerId),i.domElement.addEventListener("pointermove",si),i.domElement.addEventListener("pointerup",Ti)),function In(We){ee.push(We)}(We),"touch"===We.pointerType?function Ot(We){switch(Pn(We),ee.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;ei(),a=s.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;zi(),a=s.TOUCH_PAN;break;default:a=s.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function di(){i.enableZoom&&Ki(),i.enablePan&&zi()})(),a=s.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Ve(){i.enableZoom&&Ki(),i.enableRotate&&ei()})(),a=s.TOUCH_DOLLY_ROTATE;break;default:a=s.NONE}break;default:a=s.NONE}a!==s.NONE&&i.dispatchEvent(_m)}(We):function br(We){let hn;switch(We.button){case 0:hn=i.mouseButtons.LEFT;break;case 1:hn=i.mouseButtons.MIDDLE;break;case 2:hn=i.mouseButtons.RIGHT;break;default:hn=-1}switch(hn){case 1:if(!1===i.enableZoom)return;(function pt(We){St(We),A.set(We.clientX,We.clientY)})(We),a=s.DOLLY;break;case 0:if(We.ctrlKey||We.metaKey||We.shiftKey){if(!1===i.enablePan)return;ht(We),a=s.PAN}else{if(!1===i.enableRotate)return;Bt(We),a=s.ROTATE}break;case 2:if(We.ctrlKey||We.metaKey||We.shiftKey){if(!1===i.enableRotate)return;Bt(We),a=s.ROTATE}else{if(!1===i.enablePan)return;ht(We),a=s.PAN}break;default:a=s.NONE}a!==s.NONE&&i.dispatchEvent(_m)}(We))}function si(We){!1!==i.enabled&&("touch"===We.pointerType?function Tn(We){switch(Pn(We),a){case s.TOUCH_ROTATE:if(!1===i.enableRotate)return;Cn(We),i.update();break;case s.TOUCH_PAN:if(!1===i.enablePan)return;nn(We),i.update();break;case s.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function fn(We){i.enableZoom&&An(We),i.enablePan&&nn(We)})(We),i.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function gi(We){i.enableZoom&&An(We),i.enableRotate&&Cn(We)})(We),i.update();break;default:a=s.NONE}}(We):function ys(We){switch(a){case s.ROTATE:if(!1===i.enableRotate)return;!function pn(We){_.set(We.clientX,We.clientY),x.subVectors(_,y).multiplyScalar(i.rotateSpeed);const hn=i.domElement;Ge(2*Math.PI*x.x/hn.clientHeight),rt(2*Math.PI*x.y/hn.clientHeight),y.copy(_),i.update()}(We);break;case s.DOLLY:if(!1===i.enableZoom)return;!function bn(We){F.set(We.clientX,We.clientY),N.subVectors(F,A),N.y>0?He(ne()):N.y<0&&xt(ne()),A.copy(F),i.update()}(We);break;case s.PAN:if(!1===i.enablePan)return;!function Dn(We){P.set(We.clientX,We.clientY),C.subVectors(P,M).multiplyScalar(i.panSpeed),Re(C.x,C.y),M.copy(P),i.update()}(We)}}(We))}function Ti(We){(function vi(We){delete le[We.pointerId];for(let hn=0;hn<ee.length;hn++)if(ee[hn].pointerId==We.pointerId)return void ee.splice(hn,1)})(We),0===ee.length&&(i.domElement.releasePointerCapture(We.pointerId),i.domElement.removeEventListener("pointermove",si),i.domElement.removeEventListener("pointerup",Ti)),i.dispatchEvent(qb),a=s.NONE}function Te(We){!1===i.enabled||!1===i.enableZoom||a!==s.NONE||(We.preventDefault(),i.dispatchEvent(_m),function Bn(We){St(We),We.deltaY<0?xt(ne()):We.deltaY>0&&He(ne()),i.update()}(We),i.dispatchEvent(qb))}function fe(We){!1===i.enabled||!1===i.enablePan||function jn(We){let hn=!1;switch(We.code){case i.keys.UP:We.ctrlKey||We.metaKey||We.shiftKey?rt(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Re(0,i.keyPanSpeed),hn=!0;break;case i.keys.BOTTOM:We.ctrlKey||We.metaKey||We.shiftKey?rt(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Re(0,-i.keyPanSpeed),hn=!0;break;case i.keys.LEFT:We.ctrlKey||We.metaKey||We.shiftKey?Ge(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Re(i.keyPanSpeed,0),hn=!0;break;case i.keys.RIGHT:We.ctrlKey||We.metaKey||We.shiftKey?Ge(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Re(-i.keyPanSpeed,0),hn=!0}hn&&(We.preventDefault(),i.update())}(We)}function mn(We){!1!==i.enabled&&We.preventDefault()}function Pn(We){let hn=le[We.pointerId];void 0===hn&&(hn=new Jt,le[We.pointerId]=hn),hn.set(We.pageX,We.pageY)}function zt(We){return le[(We.pointerId===ee[0].pointerId?ee[1]:ee[0]).pointerId]}i.domElement.addEventListener("contextmenu",mn),i.domElement.addEventListener("pointerdown",ri),i.domElement.addEventListener("pointercancel",Ti),i.domElement.addEventListener("wheel",Te,{passive:!1}),this.update()}}function Zb(d,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),d;if(2===e||1===e){let t=d.getIndex();if(null===t){const c=[],u=d.getAttribute("position");if(void 0===u)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),d;for(let f=0;f<u.count;f++)c.push(f);d.setIndex(c),t=d.getIndex()}const i=t.count-2,s=[];if(2===e)for(let c=1;c<=i;c++)s.push(t.getX(0)),s.push(t.getX(c)),s.push(t.getX(c+1));else for(let c=0;c<i;c++)c%2==0?(s.push(t.getX(c)),s.push(t.getX(c+1)),s.push(t.getX(c+2))):(s.push(t.getX(c+2)),s.push(t.getX(c+1)),s.push(t.getX(c)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=d.clone();return a.setIndex(s),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),d}class Qb extends Rd{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new rx(t)}),this.register(function(t){return new bC(t)}),this.register(function(t){return new xC(t)}),this.register(function(t){return new EC(t)}),this.register(function(t){return new pC(t)}),this.register(function(t){return new mC(t)}),this.register(function(t){return new gC(t)}),this.register(function(t){return new vC(t)}),this.register(function(t){return new ix(t)}),this.register(function(t){return new yC(t)}),this.register(function(t){return new fC(t)}),this.register(function(t){return new _C(t)}),this.register(function(t){return new tx(t)}),this.register(function(t){return new wC(t)}),this.register(function(t){return new sx(t)})}load(e,t,i,s){const a=this;let c;c=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:lu.extractUrlBase(e),this.manager.itemStart(e);const u=function(m){s?s(m):console.error(m),a.manager.itemError(e),a.manager.itemEnd(e)},f=new pl(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(m){try{a.parse(m,c,function(v){t(v),a.manager.itemEnd(e)},u)}catch(v){u(v)}},i,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){let a;const c={},u={},f=new TextDecoder;if("string"==typeof e)a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(f.decode(new Uint8Array(e,0,4))===ny){try{c[Er.KHR_BINARY_GLTF]=new ox(e)}catch(y){return void(s&&s(y))}a=JSON.parse(c[Er.KHR_BINARY_GLTF].content)}else a=JSON.parse(f.decode(e));else a=e;if(void 0===a.asset||a.asset.version[0]<2)return void(s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const m=new ly(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});m.fileLoader.setRequestHeader(this.requestHeader);for(let v=0;v<this.pluginCallbacks.length;v++){const y=this.pluginCallbacks[v](m);u[y.name]=y,c[y.name]=!0}if(a.extensionsUsed)for(let v=0;v<a.extensionsUsed.length;++v){const y=a.extensionsUsed[v],_=a.extensionsRequired||[];switch(y){case Er.KHR_MATERIALS_UNLIT:c[y]=new nx;break;case Er.KHR_DRACO_MESH_COMPRESSION:c[y]=new ax(a,this.dracoLoader);break;case Er.KHR_TEXTURE_TRANSFORM:c[y]=new lx;break;case Er.KHR_MESH_QUANTIZATION:c[y]=new cx;break;default:_.indexOf(y)>=0&&void 0===u[y]&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}m.setExtensions(c),m.setPlugins(u),m.parse(i,s)}parseAsync(e,t){const i=this;return new Promise(function(s,a){i.parse(e,t,s,a)})}}function ex(){let d={};return{get:function(e){return d[e]},add:function(e,t){d[e]=t},remove:function(e){delete d[e]},removeAll:function(){d={}}}}const Er={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class tx{constructor(e){this.parser=e,this.name=Er.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){const a=t[i];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let s=t.cache.get(i);if(s)return s;const a=t.json,f=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let m;const v=new Yn(16777215);void 0!==f.color&&v.setRGB(f.color[0],f.color[1],f.color[2],Dr);const y=void 0!==f.range?f.range:0;switch(f.type){case"directional":m=new S_(v),m.target.position.set(0,0,-1),m.add(m.target);break;case"point":m=new uv(v),m.distance=y;break;case"spot":m=new cv(v),m.distance=y,f.spot=f.spot||{},f.spot.innerConeAngle=void 0!==f.spot.innerConeAngle?f.spot.innerConeAngle:0,f.spot.outerConeAngle=void 0!==f.spot.outerConeAngle?f.spot.outerConeAngle:Math.PI/4,m.angle=f.spot.outerConeAngle,m.penumbra=1-f.spot.innerConeAngle/f.spot.outerConeAngle,m.target.position.set(0,0,-1),m.add(m.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+f.type)}return m.position.set(0,0,0),m.decay=2,$l(m,f),void 0!==f.intensity&&(m.intensity=f.intensity),m.name=t.createUniqueName(f.name||"light_"+e),s=Promise.resolve(m),t.cache.add(i,s),s}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,a=i.json.nodes[e],u=(a.extensions&&a.extensions[this.name]||{}).light;return void 0===u?null:this._loadLight(u).then(function(f){return i._getNodeRef(t.cache,u,f)})}}class nx{constructor(){this.name=Er.KHR_MATERIALS_UNLIT}getMaterialType(){return sa}extendParams(e,t,i){const s=[];e.color=new Yn(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const c=a.baseColorFactor;e.color.setRGB(c[0],c[1],c[2],Dr),e.opacity=c[3]}void 0!==a.baseColorTexture&&s.push(i.assignTexture(e,"map",a.baseColorTexture,Gi))}return Promise.all(s)}}class ix{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name].emissiveStrength;return void 0!==a&&(t.emissiveIntensity=a),Promise.resolve()}}class rx{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];if(void 0!==c.clearcoatFactor&&(t.clearcoat=c.clearcoatFactor),void 0!==c.clearcoatTexture&&a.push(i.assignTexture(t,"clearcoatMap",c.clearcoatTexture)),void 0!==c.clearcoatRoughnessFactor&&(t.clearcoatRoughness=c.clearcoatRoughnessFactor),void 0!==c.clearcoatRoughnessTexture&&a.push(i.assignTexture(t,"clearcoatRoughnessMap",c.clearcoatRoughnessTexture)),void 0!==c.clearcoatNormalTexture&&(a.push(i.assignTexture(t,"clearcoatNormalMap",c.clearcoatNormalTexture)),void 0!==c.clearcoatNormalTexture.scale)){const u=c.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Jt(u,u)}return Promise.all(a)}}class fC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];return void 0!==c.iridescenceFactor&&(t.iridescence=c.iridescenceFactor),void 0!==c.iridescenceTexture&&a.push(i.assignTexture(t,"iridescenceMap",c.iridescenceTexture)),void 0!==c.iridescenceIor&&(t.iridescenceIOR=c.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==c.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=c.iridescenceThicknessMinimum),void 0!==c.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=c.iridescenceThicknessMaximum),void 0!==c.iridescenceThicknessTexture&&a.push(i.assignTexture(t,"iridescenceThicknessMap",c.iridescenceThicknessTexture)),Promise.all(a)}}class pC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new Yn(0,0,0),t.sheenRoughness=0,t.sheen=1;const c=s.extensions[this.name];if(void 0!==c.sheenColorFactor){const u=c.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],Dr)}return void 0!==c.sheenRoughnessFactor&&(t.sheenRoughness=c.sheenRoughnessFactor),void 0!==c.sheenColorTexture&&a.push(i.assignTexture(t,"sheenColorMap",c.sheenColorTexture,Gi)),void 0!==c.sheenRoughnessTexture&&a.push(i.assignTexture(t,"sheenRoughnessMap",c.sheenRoughnessTexture)),Promise.all(a)}}class mC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];return void 0!==c.transmissionFactor&&(t.transmission=c.transmissionFactor),void 0!==c.transmissionTexture&&a.push(i.assignTexture(t,"transmissionMap",c.transmissionTexture)),Promise.all(a)}}class gC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];t.thickness=void 0!==c.thicknessFactor?c.thicknessFactor:0,void 0!==c.thicknessTexture&&a.push(i.assignTexture(t,"thicknessMap",c.thicknessTexture)),t.attenuationDistance=c.attenuationDistance||1/0;const u=c.attenuationColor||[1,1,1];return t.attenuationColor=(new Yn).setRGB(u[0],u[1],u[2],Dr),Promise.all(a)}}class vC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name];return t.ior=void 0!==a.ior?a.ior:1.5,Promise.resolve()}}class yC{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];t.specularIntensity=void 0!==c.specularFactor?c.specularFactor:1,void 0!==c.specularTexture&&a.push(i.assignTexture(t,"specularIntensityMap",c.specularTexture));const u=c.specularColorFactor||[1,1,1];return t.specularColor=(new Yn).setRGB(u[0],u[1],u[2],Dr),void 0!==c.specularColorTexture&&a.push(i.assignTexture(t,"specularColorMap",c.specularColorTexture,Gi)),Promise.all(a)}}class _C{constructor(e){this.parser=e,this.name=Er.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Rl:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],c=s.extensions[this.name];return void 0!==c.anisotropyStrength&&(t.anisotropy=c.anisotropyStrength),void 0!==c.anisotropyRotation&&(t.anisotropyRotation=c.anisotropyRotation),void 0!==c.anisotropyTexture&&a.push(i.assignTexture(t,"anisotropyMap",c.anisotropyTexture)),Promise.all(a)}}class bC{constructor(e){this.parser=e,this.name=Er.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const a=s.extensions[this.name],c=t.options.ktx2Loader;if(!c){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,c)}}class xC{constructor(e){this.parser=e,this.name=Er.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,a=s.textures[e];if(!a.extensions||!a.extensions[t])return null;const c=a.extensions[t],u=s.images[c.source];let f=i.textureLoader;if(u.uri){const m=i.options.manager.getHandler(u.uri);null!==m&&(f=m)}return this.detectSupport().then(function(m){if(m)return i.loadTextureImage(e,c.source,f);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class EC{constructor(e){this.parser=e,this.name=Er.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,a=s.textures[e];if(!a.extensions||!a.extensions[t])return null;const c=a.extensions[t],u=s.images[c.source];let f=i.textureLoader;if(u.uri){const m=i.options.manager.getHandler(u.uri);null!==m&&(f=m)}return this.detectSupport().then(function(m){if(m)return i.loadTextureImage(e,c.source,f);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class wC{constructor(e){this.name=Er.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],a=this.parser.getDependency("buffer",s.buffer),c=this.parser.options.meshoptDecoder;if(!c||!c.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(u){const v=s.count,y=s.byteStride,_=new Uint8Array(u,s.byteOffset||0,s.byteLength||0);return c.decodeGltfBufferAsync?c.decodeGltfBufferAsync(v,y,_,s.mode,s.filter).then(function(x){return x.buffer}):c.ready.then(function(){const x=new ArrayBuffer(v*y);return c.decodeGltfBuffer(new Uint8Array(x),v,y,_,s.mode,s.filter),x})})}return null}}class sx{constructor(e){this.name=Er.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const s=t.meshes[i.mesh];for(const m of s.primitives)if(m.mode!==Ua.TRIANGLES&&m.mode!==Ua.TRIANGLE_STRIP&&m.mode!==Ua.TRIANGLE_FAN&&void 0!==m.mode)return null;const c=i.extensions[this.name].attributes,u=[],f={};for(const m in c)u.push(this.parser.getDependency("accessor",c[m]).then(v=>(f[m]=v,f[m])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(m=>{const v=m.pop(),y=v.isGroup?v.children:[v],_=m[0].count,x=[];for(const M of y){const P=new _i,C=new he,A=new on,F=new he(1,1,1),N=new G0(M.geometry,M.material,_);for(let W=0;W<_;W++)f.TRANSLATION&&C.fromBufferAttribute(f.TRANSLATION,W),f.ROTATION&&A.fromBufferAttribute(f.ROTATION,W),f.SCALE&&F.fromBufferAttribute(f.SCALE,W),N.setMatrixAt(W,P.compose(C,A,F));for(const W in f)"TRANSLATION"!==W&&"ROTATION"!==W&&"SCALE"!==W&&M.geometry.setAttribute(W,f[W]);Ls.prototype.copy.call(N,M),this.parser.assignFinalMaterial(N),x.push(N)}return v.isGroup?(v.clear(),v.add(...x),v):x[0]}))}}const ny="glTF";class ox{constructor(e){this.name=Er.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ny)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-12,a=new DataView(e,12);let c=0;for(;c<s;){const u=a.getUint32(c,!0);c+=4;const f=a.getUint32(c,!0);if(c+=4,1313821514===f){const m=new Uint8Array(e,12+c,u);this.content=i.decode(m)}else if(5130562===f){const m=12+c;this.body=e.slice(m,m+u)}c+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ax{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Er.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,s=this.dracoLoader,a=e.extensions[this.name].bufferView,c=e.extensions[this.name].attributes,u={},f={},m={};for(const v in c){const y=Mm[v]||v.toLowerCase();u[y]=c[v]}for(const v in e.attributes){const y=Mm[v]||v.toLowerCase();if(void 0!==c[v]){const _=i.accessors[e.attributes[v]];m[y]=eh[_.componentType].name,f[y]=!0===_.normalized}}return t.getDependency("bufferView",a).then(function(v){return new Promise(function(y){s.decodeDracoFile(v,function(_){for(const x in _.attributes){const P=f[x];void 0!==P&&(_.attributes[x].normalized=P)}y(_)},u,m)})})}}class lx{constructor(){this.name=Er.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class cx{constructor(){this.name=Er.KHR_MESH_QUANTIZATION}}class ry extends Td{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=e*s*3+s;for(let c=0;c!==s;c++)t[c]=i[a+c];return t}interpolate_(e,t,i,s){const a=this.resultBuffer,c=this.sampleValues,u=this.valueSize,f=2*u,m=3*u,v=s-t,y=(i-t)/v,_=y*y,x=_*y,M=e*m,P=M-m,C=-2*x+3*_,A=x-_,F=1-C,N=A-_+y;for(let W=0;W!==u;W++)a[W]=F*c[P+W+u]+N*(c[P+W+f]*v)+C*c[M+W+u]+A*(c[M+W]*v);return a}}const ux=new on;class dx extends ry{interpolate_(e,t,i,s){const a=super.interpolate_(e,t,i,s);return ux.fromArray(a).normalize().toArray(a),a}}const Ua={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},eh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},sy={9728:Jn,9729:lr,9984:1004,9985:1007,9986:1005,9987:Br},Em={33071:Ei,33648:1002,10497:jr},wm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mm={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Hl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},hx={CUBICSPLINE:void 0,LINEAR:En,STEP:Zt};function Ec(d,e,t){for(const i in t.extensions)void 0===d[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function $l(d,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(d.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function oy(d,e){if(d.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)d.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(d.morphTargetInfluences.length===t.length){d.morphTargetDictionary={};for(let i=0,s=t.length;i<s;i++)d.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ay(d){let e;const t=d.extensions&&d.extensions[Er.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+Cm(t.attributes):d.indices+":"+Cm(d.attributes)+":"+d.mode,void 0!==d.targets)for(let i=0,s=d.targets.length;i<s;i++)e+=":"+Cm(d.targets[i]);return e}function Cm(d){let e="";const t=Object.keys(d).sort();for(let i=0,s=t.length;i<s;i++)e+=t[i]+":"+d[t[i]]+";";return e}function Tf(d){switch(d){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const CC=new _i;class ly{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ex,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=!1,a=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),s=navigator.userAgent.indexOf("Firefox")>-1,a=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||s&&a<98?new Np(this.options.manager):new D_(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new pl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,s=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(c){return c._markDefs&&c._markDefs()}),Promise.all(this._invokeAll(function(c){return c.beforeRoot&&c.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(c){const u={scene:c[0][s.scene||0],scenes:c[0],animations:c[1],cameras:c[2],asset:s.asset,parser:i,userData:{}};Ec(a,u,s),$l(u,s),Promise.all(i._invokeAll(function(f){return f.afterRoot&&f.afterRoot(u)})).then(function(){e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let s=0,a=t.length;s<a;s++){const c=t[s].joints;for(let u=0,f=c.length;u<f;u++)e[c[u]].isBone=!0}for(let s=0,a=e.length;s<a;s++){const c=e[s];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(i[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const s=i.clone(),a=(c,u)=>{const f=this.associations.get(c);null!=f&&this.associations.set(u,f);for(const[m,v]of c.children.entries())a(v,u.children[m])};return a(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const s=e(t[i]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let s=0;s<t.length;s++){const a=e(t[s]);a&&i.push(a)}return i}getDependency(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":s=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e)}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(a,c){return i.getDependency(e,c)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Er.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(a,c){i.load(lu.resolveURL(t.uri,s.path),a,void 0,function(){c(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const a=t.byteOffset||0;return i.slice(a,a+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){const c=wm[s.type],f=!0===s.normalized,m=new(0,eh[s.componentType])(s.count*c);return Promise.resolve(new J(m,c,f))}const a=[];return a.push(void 0!==s.bufferView?this.getDependency("bufferView",s.bufferView):null),void 0!==s.sparse&&(a.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(a).then(function(c){const u=c[0],f=wm[s.type],m=eh[s.componentType],v=m.BYTES_PER_ELEMENT,_=s.byteOffset||0,x=void 0!==s.bufferView?i.bufferViews[s.bufferView].byteStride:void 0,M=!0===s.normalized;let P,C;if(x&&x!==v*f){const A=Math.floor(_/x),F="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+A+":"+s.count;let N=t.cache.get(F);N||(P=new m(u,A*x,s.count*x/v),N=new Cg(P,x/v),t.cache.add(F,N)),C=new ac(N,f,_%x/v,M)}else P=null===u?new m(s.count*f):new m(u,_,s.count*f),C=new J(P,f,M);if(void 0!==s.sparse){const W=s.sparse.values.byteOffset||0,Z=new(0,eh[s.sparse.indices.componentType])(c[1],s.sparse.indices.byteOffset||0,s.sparse.count*wm.SCALAR),te=new m(c[2],W,s.sparse.count*f);null!==u&&(C=new J(C.array.slice(),C.itemSize,C.normalized));for(let ee=0,le=Z.length;ee<le;ee++){const j=Z[ee];if(C.setX(j,te[ee*f]),f>=2&&C.setY(j,te[ee*f+1]),f>=3&&C.setZ(j,te[ee*f+2]),f>=4&&C.setW(j,te[ee*f+3]),f>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return C})}loadTexture(e){const t=this.json,a=t.textures[e].source,c=t.images[a];let u=this.textureLoader;if(c.uri){const f=this.options.manager.getHandler(c.uri);null!==f&&(u=f)}return this.loadTextureImage(e,a,u)}loadTextureImage(e,t,i){const s=this,a=this.json,c=a.textures[e],u=a.images[t],f=(u.uri||u.bufferView)+":"+c.sampler;if(this.textureCache[f])return this.textureCache[f];const m=this.loadImageSource(t,i).then(function(v){v.flipY=!1,v.name=c.name||u.name||"",""===v.name&&"string"==typeof u.uri&&!1===u.uri.startsWith("data:image/")&&(v.name=u.uri);const _=(a.samplers||{})[c.sampler]||{};return v.magFilter=sy[_.magFilter]||lr,v.minFilter=sy[_.minFilter]||Br,v.wrapS=Em[_.wrapS]||jr,v.wrapT=Em[_.wrapT]||jr,s.associations.set(v,{textures:e}),v}).catch(function(){return null});return this.textureCache[f]=m,m}loadImageSource(e,t){const s=this.json,a=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(y=>y.clone());const c=s.images[e],u=self.URL||self.webkitURL;let f=c.uri||"",m=!1;if(void 0!==c.bufferView)f=this.getDependency("bufferView",c.bufferView).then(function(y){m=!0;const _=new Blob([y],{type:c.mimeType});return f=u.createObjectURL(_),f});else if(void 0===c.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const v=Promise.resolve(f).then(function(y){return new Promise(function(_,x){let M=_;!0===t.isImageBitmapLoader&&(M=function(P){const C=new To(P);C.needsUpdate=!0,_(C)}),t.load(lu.resolveURL(y,a.path),M,void 0,x)})}).then(function(y){return!0===m&&u.revokeObjectURL(f),y.userData.mimeType=c.mimeType||function SC(d){return d.search(/\.jpe?g($|\?)/i)>0||0===d.search(/^data\:image\/jpeg/)?"image/jpeg":d.search(/\.webp($|\?)/i)>0||0===d.search(/^data\:image\/webp/)?"image/webp":"image/png"}(c.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",f),y});return this.sourceCache[e]=v,v}assignTexture(e,t,i,s){const a=this;return this.getDependency("texture",i.index).then(function(c){if(!c)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((c=c.clone()).channel=i.texCoord),a.extensions[Er.KHR_TEXTURE_TRANSFORM]){const u=void 0!==i.extensions?i.extensions[Er.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const f=a.associations.get(c);c=a.extensions[Er.KHR_TEXTURE_TRANSFORM].extendTexture(c,u),a.associations.set(c,f)}}return void 0!==s&&(c.colorSpace=s),e[t]=c,c})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const s=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,c=void 0===t.attributes.normal;if(e.isPoints){const u="PointsMaterial:"+i.uuid;let f=this.cache.get(u);f||(f=new Ng,Go.prototype.copy.call(f,i),f.color.copy(i.color),f.map=i.map,f.sizeAttenuation=!1,this.cache.add(u,f)),i=f}else if(e.isLine){const u="LineBasicMaterial:"+i.uuid;let f=this.cache.get(u);f||(f=new la,Go.prototype.copy.call(f,i),f.color.copy(i.color),f.map=i.map,this.cache.add(u,f)),i=f}if(s||a||c){let u="ClonedMaterial:"+i.uuid+":";s&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),c&&(u+="flat-shading:");let f=this.cache.get(u);f||(f=i.clone(),a&&(f.vertexColors=!0),c&&(f.flatShading=!0),s&&(f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(i))),i=f}e.material=i}getMaterialType(){return Cd}loadMaterial(e){const t=this,s=this.extensions,a=this.json.materials[e];let c;const u={},m=[];if((a.extensions||{})[Er.KHR_MATERIALS_UNLIT]){const y=s[Er.KHR_MATERIALS_UNLIT];c=y.getMaterialType(),m.push(y.extendParams(u,a,t))}else{const y=a.pbrMetallicRoughness||{};if(u.color=new Yn(1,1,1),u.opacity=1,Array.isArray(y.baseColorFactor)){const _=y.baseColorFactor;u.color.setRGB(_[0],_[1],_[2],Dr),u.opacity=_[3]}void 0!==y.baseColorTexture&&m.push(t.assignTexture(u,"map",y.baseColorTexture,Gi)),u.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,u.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(m.push(t.assignTexture(u,"metalnessMap",y.metallicRoughnessTexture)),m.push(t.assignTexture(u,"roughnessMap",y.metallicRoughnessTexture))),c=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),m.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,u)})))}!0===a.doubleSided&&(u.side=2);const v=a.alphaMode||"OPAQUE";if("BLEND"===v?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,"MASK"===v&&(u.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&c!==sa&&(m.push(t.assignTexture(u,"normalMap",a.normalTexture)),u.normalScale=new Jt(1,1),void 0!==a.normalTexture.scale)){const y=a.normalTexture.scale;u.normalScale.set(y,y)}if(void 0!==a.occlusionTexture&&c!==sa&&(m.push(t.assignTexture(u,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(u.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&c!==sa){const y=a.emissiveFactor;u.emissive=(new Yn).setRGB(y[0],y[1],y[2],Dr)}return void 0!==a.emissiveTexture&&c!==sa&&m.push(t.assignTexture(u,"emissiveMap",a.emissiveTexture,Gi)),Promise.all(m).then(function(){const y=new c(u);return a.name&&(y.name=a.name),$l(y,a),t.associations.set(y,{materials:e}),a.extensions&&Ec(s,y,a),y})}createUniqueName(e){const t=es.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,s=this.primitiveCache;function a(u){return i[Er.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(f){return cy(f,u,t)})}const c=[];for(let u=0,f=e.length;u<f;u++){const m=e[u],v=ay(m),y=s[v];if(y)c.push(y.promise);else{let _;_=m.extensions&&m.extensions[Er.KHR_DRACO_MESH_COMPRESSION]?a(m):cy(new Zi,m,t),s[v]={primitive:m,promise:_},c.push(_)}}return Promise.all(c)}loadMesh(e){const t=this,s=this.extensions,a=this.json.meshes[e],c=a.primitives,u=[];for(let f=0,m=c.length;f<m;f++){const v=void 0===c[f].material?(void 0===(d=this.cache).DefaultMaterial&&(d.DefaultMaterial=new Cd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),d.DefaultMaterial):this.getDependency("material",c[f].material);u.push(v)}var d;return u.push(t.loadGeometries(c)),Promise.all(u).then(function(f){const m=f.slice(0,f.length-1),v=f[f.length-1],y=[];for(let x=0,M=v.length;x<M;x++){const P=v[x],C=c[x];let A;const F=m[x];if(C.mode===Ua.TRIANGLES||C.mode===Ua.TRIANGLE_STRIP||C.mode===Ua.TRIANGLE_FAN||void 0===C.mode)A=!0===a.isSkinnedMesh?new md(P,F):new Xr(P,F),!0===A.isSkinnedMesh&&A.normalizeSkinWeights(),C.mode===Ua.TRIANGLE_STRIP?A.geometry=Zb(A.geometry,1):C.mode===Ua.TRIANGLE_FAN&&(A.geometry=Zb(A.geometry,2));else if(C.mode===Ua.LINES)A=new Lg(P,F);else if(C.mode===Ua.LINE_STRIP)A=new dc(P,F);else if(C.mode===Ua.LINE_LOOP)A=new Og(P,F);else{if(C.mode!==Ua.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+C.mode);A=new Y0(P,F)}Object.keys(A.geometry.morphAttributes).length>0&&oy(A,a),A.name=t.createUniqueName(a.name||"mesh_"+e),$l(A,a),C.extensions&&Ec(s,A,C),t.assignFinalMaterial(A),y.push(A)}for(let x=0,M=y.length;x<M;x++)t.associations.set(y[x],{meshes:e,primitives:x});if(1===y.length)return a.extensions&&Ec(s,y[0],a),y[0];const _=new Dl;a.extensions&&Ec(s,_,a),t.associations.set(_,{meshes:e});for(let x=0,M=y.length;x<M;x++)_.add(y[x]);return _})}loadCamera(e){let t;const i=this.json.cameras[e],s=i[i.type];if(s)return"perspective"===i.type?t=new ho(Bo_radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===i.type&&(t=new ip(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),$l(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let s=0,a=t.joints.length;s<a;s++)i.push(this._loadNodeShallow(t.joints[s]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(s){const a=s.pop(),c=s,u=[],f=[];for(let m=0,v=c.length;m<v;m++){const y=c[m];if(y){u.push(y);const _=new _i;null!==a&&_.fromArray(a.array,16*m),f.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[m])}return new Pg(u,f)})}loadAnimation(e){const i=this,s=this.json.animations[e],a=s.name?s.name:"animation_"+e,c=[],u=[],f=[],m=[],v=[];for(let y=0,_=s.channels.length;y<_;y++){const x=s.channels[y],M=s.samplers[x.sampler],P=x.target,A=void 0!==s.parameters?s.parameters[M.input]:M.input,F=void 0!==s.parameters?s.parameters[M.output]:M.output;void 0!==P.node&&(c.push(this.getDependency("node",P.node)),u.push(this.getDependency("accessor",A)),f.push(this.getDependency("accessor",F)),m.push(M),v.push(P))}return Promise.all([Promise.all(c),Promise.all(u),Promise.all(f),Promise.all(m),Promise.all(v)]).then(function(y){const _=y[0],x=y[1],M=y[2],P=y[3],C=y[4],A=[];for(let F=0,N=_.length;F<N;F++){const W=_[F],Z=x[F],te=M[F],ee=P[F],le=C[F];if(void 0===W)continue;W.updateMatrix&&W.updateMatrix();const j=i._createAnimationTracks(W,Z,te,ee,le);if(j)for(let ne=0;ne<j.length;ne++)A.push(j[ne])}return new jh(a,void 0,A)})}createNodeMesh(e){const i=this,s=this.json.nodes[e];return void 0===s.mesh?null:i.getDependency("mesh",s.mesh).then(function(a){const c=i._getNodeRef(i.meshCache,s.mesh,a);return void 0!==s.weights&&c.traverse(function(u){if(u.isMesh)for(let f=0,m=s.weights.length;f<m;f++)u.morphTargetInfluences[f]=s.weights[f]}),c})}loadNode(e){const i=this,s=this.json.nodes[e],a=i._loadNodeShallow(e),c=[],u=s.children||[];for(let m=0,v=u.length;m<v;m++)c.push(i.getDependency("node",u[m]));const f=void 0===s.skin?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([a,Promise.all(c),f]).then(function(m){const v=m[0],y=m[1],_=m[2];null!==_&&v.traverse(function(x){x.isSkinnedMesh&&x.bind(_,CC)});for(let x=0,M=y.length;x<M;x++)v.add(y[x]);return v})}_loadNodeShallow(e){const i=this.extensions,s=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const a=this.json.nodes[e],c=a.name?s.createUniqueName(a.name):"",u=[],f=s._invokeOne(function(m){return m.createNodeMesh&&m.createNodeMesh(e)});return f&&u.push(f),void 0!==a.camera&&u.push(s.getDependency("camera",a.camera).then(function(m){return s._getNodeRef(s.cameraCache,a.camera,m)})),s._invokeAll(function(m){return m.createNodeAttachment&&m.createNodeAttachment(e)}).forEach(function(m){u.push(m)}),this.nodeCache[e]=Promise.all(u).then(function(m){let v;if(v=!0===a.isBone?new uc:m.length>1?new Dl:1===m.length?m[0]:new Ls,v!==m[0])for(let y=0,_=m.length;y<_;y++)v.add(m[y]);if(a.name&&(v.userData.name=a.name,v.name=c),$l(v,a),a.extensions&&Ec(i,v,a),void 0!==a.matrix){const y=new _i;y.fromArray(a.matrix),v.applyMatrix4(y)}else void 0!==a.translation&&v.position.fromArray(a.translation),void 0!==a.rotation&&v.quaternion.fromArray(a.rotation),void 0!==a.scale&&v.scale.fromArray(a.scale);return s.associations.has(v)||s.associations.set(v,{}),s.associations.get(v).nodes=e,v}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],s=this,a=new Dl;i.name&&(a.name=s.createUniqueName(i.name)),$l(a,i),i.extensions&&Ec(t,a,i);const c=i.nodes||[],u=[];for(let f=0,m=c.length;f<m;f++)u.push(s.getDependency("node",c[f]));return Promise.all(u).then(function(f){for(let v=0,y=f.length;v<y;v++)a.add(f[v]);return s.associations=(v=>{const y=new Map;for(const[_,x]of s.associations)(_ instanceof Go||_ instanceof To)&&y.set(_,x);return v.traverse(_=>{const x=s.associations.get(_);null!=x&&y.set(_,x)}),y})(a),a})}_createAnimationTracks(e,t,i,s,a){const c=[],u=e.name?e.name:e.uuid,f=[];let m;switch(Hl[a.path]===Hl.weights?e.traverse(function(_){_.morphTargetInfluences&&f.push(_.name?_.name:_.uuid)}):f.push(u),Hl[a.path]){case Hl.weights:m=Wh;break;case Hl.rotation:m=su;break;case Hl.position:case Hl.scale:m=Dd;break;default:m=1===i.itemSize?Wh:Dd}const v=void 0!==s.interpolation?hx[s.interpolation]:En,y=this._getArrayFromAccessor(i);for(let _=0,x=f.length;_<x;_++){const M=new m(f[_]+"."+Hl[a.path],t.array,y,v);"CUBICSPLINE"===s.interpolation&&this._createCubicSplineTrackInterpolant(M),c.push(M)}return c}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=Tf(t.constructor),s=new Float32Array(t.length);for(let a=0,c=t.length;a<c;a++)s[a]=t[a]*i;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof su?dx:ry)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function cy(d,e,t){const i=e.attributes,s=[];function a(c,u){return t.getDependency("accessor",c).then(function(f){d.setAttribute(u,f)})}for(const c in i){const u=Mm[c]||c.toLowerCase();u in d.attributes||s.push(a(i[c],u))}if(void 0!==e.indices&&!d.index){const c=t.getDependency("accessor",e.indices).then(function(u){d.setIndex(u)});s.push(c)}return Vo.workingColorSpace!==Dr&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Vo.workingColorSpace}" not supported.`),$l(d,e),function AC(d,e,t){const i=e.attributes,s=new bi;if(void 0===i.POSITION)return;{const u=t.json.accessors[i.POSITION],f=u.min,m=u.max;if(void 0===f||void 0===m)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(s.set(new he(f[0],f[1],f[2]),new he(m[0],m[1],m[2])),u.normalized){const v=Tf(eh[u.componentType]);s.min.multiplyScalar(v),s.max.multiplyScalar(v)}}const a=e.targets;if(void 0!==a){const u=new he,f=new he;for(let m=0,v=a.length;m<v;m++){const y=a[m];if(void 0!==y.POSITION){const _=t.json.accessors[y.POSITION],x=_.min,M=_.max;if(void 0!==x&&void 0!==M){if(f.setX(Math.max(Math.abs(x[0]),Math.abs(M[0]))),f.setY(Math.max(Math.abs(x[1]),Math.abs(M[1]))),f.setZ(Math.max(Math.abs(x[2]),Math.abs(M[2]))),_.normalized){const P=Tf(eh[_.componentType]);f.multiplyScalar(P)}u.max(f)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(u)}d.boundingBox=s;const c=new pa;s.getCenter(c.center),c.radius=s.min.distanceTo(s.max)/2,d.boundingSphere=c}(d,e,t),Promise.all(s).then(function(){return void 0!==e.targets?function MC(d,e,t){let i=!1,s=!1,a=!1;for(let m=0,v=e.length;m<v;m++){const y=e[m];if(void 0!==y.POSITION&&(i=!0),void 0!==y.NORMAL&&(s=!0),void 0!==y.COLOR_0&&(a=!0),i&&s&&a)break}if(!i&&!s&&!a)return Promise.resolve(d);const c=[],u=[],f=[];for(let m=0,v=e.length;m<v;m++){const y=e[m];if(i){const _=void 0!==y.POSITION?t.getDependency("accessor",y.POSITION):d.attributes.position;c.push(_)}if(s){const _=void 0!==y.NORMAL?t.getDependency("accessor",y.NORMAL):d.attributes.normal;u.push(_)}if(a){const _=void 0!==y.COLOR_0?t.getDependency("accessor",y.COLOR_0):d.attributes.color;f.push(_)}}return Promise.all([Promise.all(c),Promise.all(u),Promise.all(f)]).then(function(m){const y=m[1],_=m[2];return i&&(d.morphAttributes.position=m[0]),s&&(d.morphAttributes.normal=y),a&&(d.morphAttributes.color=_),d.morphTargetsRelative=!0,d})}(d,e.targets,t):d})}const Mu=["threeCanvas"];let uy=(()=>{var d;class e{constructor(){}ngAfterViewInit(){this.createScene(),this.createPhysicsWorld(),requestAnimationFrame(i=>this.render(i))}createScene(){this.scene=new k0,this.camera=new ho(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new lw({canvas:this.canvasRef.nativeElement,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.directionalLight=new S_(16777215,2.5),this.directionalLight.position.set(-30,100,-10),this.directionalLight.target.position.set(15,30,20),this.directionalLight.castShadow=!0,this.directionalLight.shadow.camera.top=1,this.scene.add(this.directionalLight);const i=new zs(16777215,.1);i.position.set(0,0,0),i.castShadow=!0,this.scene.add(i),(new Np).load("assets/texture/HeightMap.jpg",y=>this.onTextureLoaded(y));const a=new Sd(1),c=new ev({color:16711680});this.threeSphere=new Xr(a,c),this.threeSphere.castShadow=!0,this.scene.add(this.threeSphere);const u=new Mo(2,2,2),f=new Cd({color:65535});this.threeCube=new Xr(u,f),this.threeCube.castShadow=!0,this.scene.add(this.threeCube),(new Qb).load("assets/models/simpleGolem_wAnim.glb",y=>{y.scene.scale.set(.5,.5,.5),y.scene.position.set(15,5.3,10),y.scene.traverse(_=>{if(_.isMesh){_.castShadow=!0,_.receiveShadow=!0,this.mixer=new O_(_);const x=y.animations;x.length>0&&this.mixer.clipAction(x[0]).play(),_.material=new Cd({color:Yn.NAMES.rosybrown}),y.scene.castShadow=!0}}),this.scene.add(y.scene)}),new rC(this.camera,this.canvasRef.nativeElement)}createPhysicsWorld(){this.physicsWorld=new ZS({gravity:new X(0,-9.82,0)}),this.cannonSphere=new ii({mass:3,shape:new om(1),position:new X(17.2,10,23)}),this.physicsWorld.addBody(this.cannonSphere),this.cannonCube=new ii({mass:1,shape:new om(1),position:new X(25,10,1)}),this.physicsWorld.addBody(this.cannonCube),this.cannonDebugger=new nC(this.scene,this.physicsWorld)}render(i){this.renderer.render(this.scene,this.camera),this.animate(i),requestAnimationFrame(s=>this.render(s))}generateTerrain(i){const s=[],a=[],c=[];let u=0;for(let y=0;y<i.height;y++)for(let _=0;_<i.width;_++){let x=0;x+=i.data[4*(y*i.height+_)]/128,x+=i.data[4*(y*i.height+_+1)]/128,x+=i.data[4*(y*i.height+_+2)]/128,isNaN(x)&&(x=0),u<x&&(u=x),a.push(_,x,y),c.push(_/(i.width-1),y/(i.height-1))}for(let y=0;y<i.height-1;y++)for(let _=0;_<i.width-1;_++){const M=_+1+y*i.width,P=_+(y+1)*i.width,C=_+1+(y+1)*i.width;s.push(_+y*i.width,M,P),s.push(M,C,P)}const f=new Zi;f.setIndex(s),f.setAttribute("position",new J(new Float32Array(a),3)),f.setAttribute("uv",new J(new Float32Array(c),2)),f.computeVertexNormals();const m=new ev({vertexColors:!1,wireframe:!1,flatShading:!1,normalMap:(new Np).load("assets/texture/NormalMapSample.jpg"),map:(new Np).load("assets/texture/Sample.jpg"),side:1});this.map=new Xr(f,m),this.map.receiveShadow=!0,this.map.position.set(0,0,0),this.map.castShadow=!0;const v=[];for(let y=0;y<a.length;y+=3)v.push(new X(a[y],a[y+1],a[y+2]));this.terrainShape=new Fl({vertices:v,faces:this.chunkArray(s,3)}),this.cannonTerrain=new ii({mass:0,shape:this.terrainShape,position:new X(0,0,0)}),this.scene.add(this.map),this.physicsWorld.addBody(this.cannonTerrain)}onTextureLoaded(i){const s=document.createElement("canvas");s.width=i.image.width,s.height=i.image.height;const a=s.getContext("2d");a.drawImage(i.image,0,0);const c=a.getImageData(0,0,s.width,s.height);this.camera.position.x=c.width/2,this.camera.position.y=c.height/1.5,this.camera.position.z=c.width,this.camera.lookAt(c.width/2,0,c.width/2),this.generateTerrain(c)}chunkArray(i,s){const a=[];for(let c=0;c<i.length;c+=s)a.push(i.slice(c,c+s));return a}convertToThreeVector(i){return new he(i.x,i.y,i.z)}convertToThreeQuaternion(i){return new on(i.x,i.y,i.z,i.w)}animate(i){this.physicsWorld.step(1/60);const c=.001*i*.5,u=50*Math.cos(c),f=50*Math.sin(c);if(this.directionalLight.position.set(u,-10,f),this.cannonSphere.position.y<-5||this.cannonSphere.velocity.y<.01&&this.cannonSphere.velocity.y>0&&this.cannonSphere.velocity.x<.05&&this.cannonSphere.velocity.z<.05){const m=32*Math.random(),v=32*Math.random();this.cannonSphere.position.set(m,10,v),this.cannonSphere.velocity.set(0,0,0)}if(this.cannonCube.position.y<-5||this.cannonCube.velocity.y<.01&&this.cannonCube.velocity.y>0&&this.cannonCube.velocity.x<.05&&this.cannonCube.velocity.z<.05){const m=32*Math.random(),v=32*Math.random();this.cannonCube.position.set(m,10,v),this.cannonCube.velocity.set(0,0,0)}this.threeSphere.position.copy(this.convertToThreeVector(this.cannonSphere.position)),this.threeSphere.quaternion.copy(this.convertToThreeQuaternion(this.cannonSphere.quaternion)),this.threeCube.position.copy(this.convertToThreeVector(this.cannonCube.position)),this.threeCube.quaternion.copy(this.convertToThreeQuaternion(this.cannonCube.quaternion));try{this.mixer.update(.005)}catch(m){console.log(m)}}}return(d=e).\u0275fac=function(i){return new(i||d)},d.\u0275cmp=se.Xpm({type:d,selectors:[["app-main"]],viewQuery:function(i,s){if(1&i&&se.Gf(Mu,5),2&i){let a;se.iGM(a=se.CRH())&&(s.canvasRef=a.first)}},decls:2,vars:0,consts:[["threeCanvas",""]],template:function(i,s){1&i&&se._UZ(0,"canvas",null,0)}}),e})(),TC=(()=>{var d;class e{constructor(){}}return(d=e).\u0275fac=function(i){return new(i||d)},d.\u0275cmp=se.Xpm({type:d,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){1&i&&(se.TgZ(0,"ion-app"),se._UZ(1,"app-main"),se.qZA())},dependencies:[ft.dr,uy]}),e})();const fT=[{path:"home",loadChildren:()=>re.e(6260).then(re.bind(re,6260)).then(d=>d.HomePageModule)},{path:"",redirectTo:"home",pathMatch:"full"},{path:"main",component:uy}];let dy=(()=>{var d;class e{}return(d=e).\u0275fac=function(i){return new(i||d)},d.\u0275mod=se.oAB({type:d}),d.\u0275inj=se.cJS({imports:[Ye.Bz.forRoot(fT,{preloadingStrategy:Ye.wm}),Ye.Bz]}),e})(),hy=(()=>{var d;class e{}return(d=e).\u0275fac=function(i){return new(i||d)},d.\u0275mod=se.oAB({type:d,bootstrap:[TC]}),d.\u0275inj=se.cJS({providers:[{provide:Ye.wN,useClass:Pe.r4}],imports:[p.b2,ft.Pc.forRoot(),dy]}),e})();(0,se.G48)(),p.q6().bootstrapModule(hy).catch(d=>console.log(d))},5619:(Qn,Vt,re)=>{"use strict";re.d(Vt,{X:()=>se});var p=re(8645);class se extends p.x{constructor(Pe){super(),this._value=Pe}get value(){return this.getValue()}_subscribe(Pe){const ft=super._subscribe(Pe);return!ft.closed&&Pe.next(this._value),ft}getValue(){const{hasError:Pe,thrownError:ft,_value:Fe}=this;if(Pe)throw ft;return this._throwIfClosed(),Fe}next(Pe){super.next(this._value=Pe)}}},5592:(Qn,Vt,re)=>{"use strict";re.d(Vt,{y:()=>Dt});var p=re(305),se=re(7394),Ye=re(4850),Pe=re(8407),ft=re(2653),Fe=re(4674),Be=re(1441);let Dt=(()=>{class mt{constructor(tt){tt&&(this._subscribe=tt)}lift(tt){const je=new mt;return je.source=this,je.operator=tt,je}subscribe(tt,je,Rt){const Ze=function Le(mt){return mt&&mt instanceof p.Lv||function yt(mt){return mt&&(0,Fe.m)(mt.next)&&(0,Fe.m)(mt.error)&&(0,Fe.m)(mt.complete)}(mt)&&(0,se.Nn)(mt)}(tt)?tt:new p.Hp(tt,je,Rt);return(0,Be.x)(()=>{const{operator:Je,source:et}=this;Ze.add(Je?Je.call(Ze,et):et?this._subscribe(Ze):this._trySubscribe(Ze))}),Ze}_trySubscribe(tt){try{return this._subscribe(tt)}catch(je){tt.error(je)}}forEach(tt,je){return new(je=Pt(je))((Rt,Ze)=>{const Je=new p.Hp({next:et=>{try{tt(et)}catch($t){Ze($t),Je.unsubscribe()}},error:Ze,complete:Rt});this.subscribe(Je)})}_subscribe(tt){var je;return null===(je=this.source)||void 0===je?void 0:je.subscribe(tt)}[Ye.L](){return this}pipe(...tt){return(0,Pe.U)(tt)(this)}toPromise(tt){return new(tt=Pt(tt))((je,Rt)=>{let Ze;this.subscribe(Je=>Ze=Je,Je=>Rt(Je),()=>je(Ze))})}}return mt.create=ct=>new mt(ct),mt})();function Pt(mt){var ct;return null!==(ct=null!=mt?mt:ft.config.Promise)&&void 0!==ct?ct:Promise}},8645:(Qn,Vt,re)=>{"use strict";re.d(Vt,{x:()=>Be});var p=re(5592),se=re(7394);const Pe=(0,re(2306).d)(Pt=>function(){Pt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ft=re(9039),Fe=re(1441);let Be=(()=>{class Pt extends p.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Le){const mt=new Dt(this,this);return mt.operator=Le,mt}_throwIfClosed(){if(this.closed)throw new Pe}next(Le){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const mt of this.currentObservers)mt.next(Le)}})}error(Le){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Le;const{observers:mt}=this;for(;mt.length;)mt.shift().error(Le)}})}complete(){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Le}=this;for(;Le.length;)Le.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Le;return(null===(Le=this.observers)||void 0===Le?void 0:Le.length)>0}_trySubscribe(Le){return this._throwIfClosed(),super._trySubscribe(Le)}_subscribe(Le){return this._throwIfClosed(),this._checkFinalizedStatuses(Le),this._innerSubscribe(Le)}_innerSubscribe(Le){const{hasError:mt,isStopped:ct,observers:tt}=this;return mt||ct?se.Lc:(this.currentObservers=null,tt.push(Le),new se.w0(()=>{this.currentObservers=null,(0,ft.P)(tt,Le)}))}_checkFinalizedStatuses(Le){const{hasError:mt,thrownError:ct,isStopped:tt}=this;mt?Le.error(ct):tt&&Le.complete()}asObservable(){const Le=new p.y;return Le.source=this,Le}}return Pt.create=(yt,Le)=>new Dt(yt,Le),Pt})();class Dt extends Be{constructor(yt,Le){super(),this.destination=yt,this.source=Le}next(yt){var Le,mt;null===(mt=null===(Le=this.destination)||void 0===Le?void 0:Le.next)||void 0===mt||mt.call(Le,yt)}error(yt){var Le,mt;null===(mt=null===(Le=this.destination)||void 0===Le?void 0:Le.error)||void 0===mt||mt.call(Le,yt)}complete(){var yt,Le;null===(Le=null===(yt=this.destination)||void 0===yt?void 0:yt.complete)||void 0===Le||Le.call(yt)}_subscribe(yt){var Le,mt;return null!==(mt=null===(Le=this.source)||void 0===Le?void 0:Le.subscribe(yt))&&void 0!==mt?mt:se.Lc}}},305:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Hp:()=>Rt,Lv:()=>mt});var p=re(4674),se=re(7394),Ye=re(2653),Pe=re(3894),ft=re(2420);const Fe=Pt("C",void 0,void 0);function Pt(st,ot,bt){return{kind:st,value:ot,error:bt}}var yt=re(7599),Le=re(1441);class mt extends se.w0{constructor(ot){super(),this.isStopped=!1,ot?(this.destination=ot,(0,se.Nn)(ot)&&ot.add(this)):this.destination=$t}static create(ot,bt,$e){return new Rt(ot,bt,$e)}next(ot){this.isStopped?et(function Dt(st){return Pt("N",st,void 0)}(ot),this):this._next(ot)}error(ot){this.isStopped?et(function Be(st){return Pt("E",void 0,st)}(ot),this):(this.isStopped=!0,this._error(ot))}complete(){this.isStopped?et(Fe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ot){this.destination.next(ot)}_error(ot){try{this.destination.error(ot)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ct=Function.prototype.bind;function tt(st,ot){return ct.call(st,ot)}class je{constructor(ot){this.partialObserver=ot}next(ot){const{partialObserver:bt}=this;if(bt.next)try{bt.next(ot)}catch($e){Ze($e)}}error(ot){const{partialObserver:bt}=this;if(bt.error)try{bt.error(ot)}catch($e){Ze($e)}else Ze(ot)}complete(){const{partialObserver:ot}=this;if(ot.complete)try{ot.complete()}catch(bt){Ze(bt)}}}class Rt extends mt{constructor(ot,bt,$e){let me;if(super(),(0,p.m)(ot)||!ot)me={next:null!=ot?ot:void 0,error:null!=bt?bt:void 0,complete:null!=$e?$e:void 0};else{let ve;this&&Ye.config.useDeprecatedNextContext?(ve=Object.create(ot),ve.unsubscribe=()=>this.unsubscribe(),me={next:ot.next&&tt(ot.next,ve),error:ot.error&&tt(ot.error,ve),complete:ot.complete&&tt(ot.complete,ve)}):me=ot}this.destination=new je(me)}}function Ze(st){Ye.config.useDeprecatedSynchronousErrorHandling?(0,Le.O)(st):(0,Pe.h)(st)}function et(st,ot){const{onStoppedNotification:bt}=Ye.config;bt&&yt.z.setTimeout(()=>bt(st,ot))}const $t={closed:!0,next:ft.Z,error:function Je(st){throw st},complete:ft.Z}},7394:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Lc:()=>Fe,w0:()=>ft,Nn:()=>Be});var p=re(4674);const Ye=(0,re(2306).d)(Pt=>function(Le){Pt(this),this.message=Le?`${Le.length} errors occurred during unsubscription:\n${Le.map((mt,ct)=>`${ct+1}) ${mt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Le});var Pe=re(9039);class ft{constructor(yt){this.initialTeardown=yt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let yt;if(!this.closed){this.closed=!0;const{_parentage:Le}=this;if(Le)if(this._parentage=null,Array.isArray(Le))for(const tt of Le)tt.remove(this);else Le.remove(this);const{initialTeardown:mt}=this;if((0,p.m)(mt))try{mt()}catch(tt){yt=tt instanceof Ye?tt.errors:[tt]}const{_finalizers:ct}=this;if(ct){this._finalizers=null;for(const tt of ct)try{Dt(tt)}catch(je){yt=null!=yt?yt:[],je instanceof Ye?yt=[...yt,...je.errors]:yt.push(je)}}if(yt)throw new Ye(yt)}}add(yt){var Le;if(yt&&yt!==this)if(this.closed)Dt(yt);else{if(yt instanceof ft){if(yt.closed||yt._hasParent(this))return;yt._addParent(this)}(this._finalizers=null!==(Le=this._finalizers)&&void 0!==Le?Le:[]).push(yt)}}_hasParent(yt){const{_parentage:Le}=this;return Le===yt||Array.isArray(Le)&&Le.includes(yt)}_addParent(yt){const{_parentage:Le}=this;this._parentage=Array.isArray(Le)?(Le.push(yt),Le):Le?[Le,yt]:yt}_removeParent(yt){const{_parentage:Le}=this;Le===yt?this._parentage=null:Array.isArray(Le)&&(0,Pe.P)(Le,yt)}remove(yt){const{_finalizers:Le}=this;Le&&(0,Pe.P)(Le,yt),yt instanceof ft&&yt._removeParent(this)}}ft.EMPTY=(()=>{const Pt=new ft;return Pt.closed=!0,Pt})();const Fe=ft.EMPTY;function Be(Pt){return Pt instanceof ft||Pt&&"closed"in Pt&&(0,p.m)(Pt.remove)&&(0,p.m)(Pt.add)&&(0,p.m)(Pt.unsubscribe)}function Dt(Pt){(0,p.m)(Pt)?Pt():Pt.unsubscribe()}},2653:(Qn,Vt,re)=>{"use strict";re.d(Vt,{config:()=>p});const p={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(Qn,Vt,re)=>{"use strict";re.d(Vt,{a:()=>yt});var p=re(5592),se=re(7453),Ye=re(7715),Pe=re(2737),ft=re(7400),Fe=re(4564),Be=re(2714),Dt=re(8251),Pt=re(7103);function yt(...ct){const tt=(0,Fe.yG)(ct),je=(0,Fe.jO)(ct),{args:Rt,keys:Ze}=(0,se.D)(ct);if(0===Rt.length)return(0,Ye.D)([],tt);const Je=new p.y(function Le(ct,tt,je=Pe.y){return Rt=>{mt(tt,()=>{const{length:Ze}=ct,Je=new Array(Ze);let et=Ze,$t=Ze;for(let st=0;st<Ze;st++)mt(tt,()=>{const ot=(0,Ye.D)(ct[st],tt);let bt=!1;ot.subscribe((0,Dt.x)(Rt,$e=>{Je[st]=$e,bt||(bt=!0,$t--),$t||Rt.next(je(Je.slice()))},()=>{--et||Rt.complete()}))},Rt)},Rt)}}(Rt,tt,Ze?et=>(0,Be.n)(Ze,et):Pe.y));return je?Je.pipe((0,ft.Z)(je)):Je}function mt(ct,tt,je){ct?(0,Pt.f)(je,ct,tt):tt()}},7715:(Qn,Vt,re)=>{"use strict";re.d(Vt,{D:()=>$e});var p=re(4829),se=re(7103),Ye=re(9360),Pe=re(8251);function ft(me,ve=0){return(0,Ye.e)((Ue,Ce)=>{Ue.subscribe((0,Pe.x)(Ce,at=>(0,se.f)(Ce,me,()=>Ce.next(at),ve),()=>(0,se.f)(Ce,me,()=>Ce.complete(),ve),at=>(0,se.f)(Ce,me,()=>Ce.error(at),ve)))})}function Fe(me,ve=0){return(0,Ye.e)((Ue,Ce)=>{Ce.add(me.schedule(()=>Ue.subscribe(Ce),ve))})}var Pt=re(5592),Le=re(4971),mt=re(4674);function tt(me,ve){if(!me)throw new Error("Iterable cannot be null");return new Pt.y(Ue=>{(0,se.f)(Ue,ve,()=>{const Ce=me[Symbol.asyncIterator]();(0,se.f)(Ue,ve,()=>{Ce.next().then(at=>{at.done?Ue.complete():Ue.next(at.value)})},0,!0)})})}var je=re(8382),Rt=re(4026),Ze=re(4266),Je=re(3664),et=re(5726),$t=re(9853),st=re(541);function $e(me,ve){return ve?function bt(me,ve){if(null!=me){if((0,je.c)(me))return function Be(me,ve){return(0,p.Xf)(me).pipe(Fe(ve),ft(ve))}(me,ve);if((0,Ze.z)(me))return function yt(me,ve){return new Pt.y(Ue=>{let Ce=0;return ve.schedule(function(){Ce===me.length?Ue.complete():(Ue.next(me[Ce++]),Ue.closed||this.schedule())})})}(me,ve);if((0,Rt.t)(me))return function Dt(me,ve){return(0,p.Xf)(me).pipe(Fe(ve),ft(ve))}(me,ve);if((0,et.D)(me))return tt(me,ve);if((0,Je.T)(me))return function ct(me,ve){return new Pt.y(Ue=>{let Ce;return(0,se.f)(Ue,ve,()=>{Ce=me[Le.h](),(0,se.f)(Ue,ve,()=>{let at,lt;try{({value:at,done:lt}=Ce.next())}catch(dt){return void Ue.error(dt)}lt?Ue.complete():Ue.next(at)},0,!0)}),()=>(0,mt.m)(null==Ce?void 0:Ce.return)&&Ce.return()})}(me,ve);if((0,st.L)(me))return function ot(me,ve){return tt((0,st.Q)(me),ve)}(me,ve)}throw(0,$t.z)(me)}(me,ve):(0,p.Xf)(me)}},2438:(Qn,Vt,re)=>{"use strict";re.d(Vt,{R:()=>yt});var p=re(4829),se=re(5592),Ye=re(1631),Pe=re(4266),ft=re(4674),Fe=re(7400);const Be=["addListener","removeListener"],Dt=["addEventListener","removeEventListener"],Pt=["on","off"];function yt(je,Rt,Ze,Je){if((0,ft.m)(Ze)&&(Je=Ze,Ze=void 0),Je)return yt(je,Rt,Ze).pipe((0,Fe.Z)(Je));const[et,$t]=function tt(je){return(0,ft.m)(je.addEventListener)&&(0,ft.m)(je.removeEventListener)}(je)?Dt.map(st=>ot=>je[st](Rt,ot,Ze)):function mt(je){return(0,ft.m)(je.addListener)&&(0,ft.m)(je.removeListener)}(je)?Be.map(Le(je,Rt)):function ct(je){return(0,ft.m)(je.on)&&(0,ft.m)(je.off)}(je)?Pt.map(Le(je,Rt)):[];if(!et&&(0,Pe.z)(je))return(0,Ye.z)(st=>yt(st,Rt,Ze))((0,p.Xf)(je));if(!et)throw new TypeError("Invalid event target");return new se.y(st=>{const ot=(...bt)=>st.next(1<bt.length?bt:bt[0]);return et(ot),()=>$t(ot)})}function Le(je,Rt){return Ze=>Je=>je[Ze](Rt,Je)}},4829:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Xf:()=>ct});var p=re(7582),se=re(4266),Ye=re(4026),Pe=re(5592),ft=re(8382),Fe=re(5726),Be=re(9853),Dt=re(3664),Pt=re(541),yt=re(4674),Le=re(3894),mt=re(4850);function ct(st){if(st instanceof Pe.y)return st;if(null!=st){if((0,ft.c)(st))return function tt(st){return new Pe.y(ot=>{const bt=st[mt.L]();if((0,yt.m)(bt.subscribe))return bt.subscribe(ot);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(st);if((0,se.z)(st))return function je(st){return new Pe.y(ot=>{for(let bt=0;bt<st.length&&!ot.closed;bt++)ot.next(st[bt]);ot.complete()})}(st);if((0,Ye.t)(st))return function Rt(st){return new Pe.y(ot=>{st.then(bt=>{ot.closed||(ot.next(bt),ot.complete())},bt=>ot.error(bt)).then(null,Le.h)})}(st);if((0,Fe.D)(st))return Je(st);if((0,Dt.T)(st))return function Ze(st){return new Pe.y(ot=>{for(const bt of st)if(ot.next(bt),ot.closed)return;ot.complete()})}(st);if((0,Pt.L)(st))return function et(st){return Je((0,Pt.Q)(st))}(st)}throw(0,Be.z)(st)}function Je(st){return new Pe.y(ot=>{(function $t(st,ot){var bt,$e,me,ve;return(0,p.mG)(this,void 0,void 0,function*(){try{for(bt=(0,p.KL)(st);!($e=yield bt.next()).done;)if(ot.next($e.value),ot.closed)return}catch(Ue){me={error:Ue}}finally{try{$e&&!$e.done&&(ve=bt.return)&&(yield ve.call(bt))}finally{if(me)throw me.error}}ot.complete()})})(st,ot).catch(bt=>ot.error(bt))})}},2096:(Qn,Vt,re)=>{"use strict";re.d(Vt,{of:()=>Ye});var p=re(4564),se=re(7715);function Ye(...Pe){const ft=(0,p.yG)(Pe);return(0,se.D)(Pe,ft)}},8251:(Qn,Vt,re)=>{"use strict";re.d(Vt,{x:()=>se});var p=re(305);function se(Pe,ft,Fe,Be,Dt){return new Ye(Pe,ft,Fe,Be,Dt)}class Ye extends p.Lv{constructor(ft,Fe,Be,Dt,Pt,yt){super(ft),this.onFinalize=Pt,this.shouldUnsubscribe=yt,this._next=Fe?function(Le){try{Fe(Le)}catch(mt){ft.error(mt)}}:super._next,this._error=Dt?function(Le){try{Dt(Le)}catch(mt){ft.error(mt)}finally{this.unsubscribe()}}:super._error,this._complete=Be?function(){try{Be()}catch(Le){ft.error(Le)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ft;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Fe}=this;super.unsubscribe(),!Fe&&(null===(ft=this.onFinalize)||void 0===ft||ft.call(this))}}}},2181:(Qn,Vt,re)=>{"use strict";re.d(Vt,{h:()=>Ye});var p=re(9360),se=re(8251);function Ye(Pe,ft){return(0,p.e)((Fe,Be)=>{let Dt=0;Fe.subscribe((0,se.x)(Be,Pt=>Pe.call(ft,Pt,Dt++)&&Be.next(Pt)))})}},7398:(Qn,Vt,re)=>{"use strict";re.d(Vt,{U:()=>Ye});var p=re(9360),se=re(8251);function Ye(Pe,ft){return(0,p.e)((Fe,Be)=>{let Dt=0;Fe.subscribe((0,se.x)(Be,Pt=>{Be.next(Pe.call(ft,Pt,Dt++))}))})}},1631:(Qn,Vt,re)=>{"use strict";re.d(Vt,{z:()=>Dt});var p=re(7398),se=re(4829),Ye=re(9360),Pe=re(7103),ft=re(8251),Be=re(4674);function Dt(Pt,yt,Le=1/0){return(0,Be.m)(yt)?Dt((mt,ct)=>(0,p.U)((tt,je)=>yt(mt,tt,ct,je))((0,se.Xf)(Pt(mt,ct))),Le):("number"==typeof yt&&(Le=yt),(0,Ye.e)((mt,ct)=>function Fe(Pt,yt,Le,mt,ct,tt,je,Rt){const Ze=[];let Je=0,et=0,$t=!1;const st=()=>{$t&&!Ze.length&&!Je&&yt.complete()},ot=$e=>Je<mt?bt($e):Ze.push($e),bt=$e=>{tt&&yt.next($e),Je++;let me=!1;(0,se.Xf)(Le($e,et++)).subscribe((0,ft.x)(yt,ve=>{null==ct||ct(ve),tt?ot(ve):yt.next(ve)},()=>{me=!0},void 0,()=>{if(me)try{for(Je--;Ze.length&&Je<mt;){const ve=Ze.shift();je?(0,Pe.f)(yt,je,()=>bt(ve)):bt(ve)}st()}catch(ve){yt.error(ve)}}))};return Pt.subscribe((0,ft.x)(yt,ot,()=>{$t=!0,st()})),()=>{null==Rt||Rt()}}(mt,ct,Pt,Le)))}},4664:(Qn,Vt,re)=>{"use strict";re.d(Vt,{w:()=>Pe});var p=re(4829),se=re(9360),Ye=re(8251);function Pe(ft,Fe){return(0,se.e)((Be,Dt)=>{let Pt=null,yt=0,Le=!1;const mt=()=>Le&&!Pt&&Dt.complete();Be.subscribe((0,Ye.x)(Dt,ct=>{null==Pt||Pt.unsubscribe();let tt=0;const je=yt++;(0,p.Xf)(ft(ct,je)).subscribe(Pt=(0,Ye.x)(Dt,Rt=>Dt.next(Fe?Fe(ct,Rt,je,tt++):Rt),()=>{Pt=null,mt()}))},()=>{Le=!0,mt()}))})}},7599:(Qn,Vt,re)=>{"use strict";re.d(Vt,{z:()=>p});const p={setTimeout(se,Ye,...Pe){const{delegate:ft}=p;return null!=ft&&ft.setTimeout?ft.setTimeout(se,Ye,...Pe):setTimeout(se,Ye,...Pe)},clearTimeout(se){const{delegate:Ye}=p;return((null==Ye?void 0:Ye.clearTimeout)||clearTimeout)(se)},delegate:void 0}},4971:(Qn,Vt,re)=>{"use strict";re.d(Vt,{h:()=>se});const se=function p(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Qn,Vt,re)=>{"use strict";re.d(Vt,{L:()=>p});const p="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(Qn,Vt,re)=>{"use strict";re.d(Vt,{jO:()=>Pe,yG:()=>ft});var p=re(4674);function Ye(Be){return Be[Be.length-1]}function Pe(Be){return(0,p.m)(Ye(Be))?Be.pop():void 0}function ft(Be){return function se(Be){return Be&&(0,p.m)(Be.schedule)}(Ye(Be))?Be.pop():void 0}},7453:(Qn,Vt,re)=>{"use strict";re.d(Vt,{D:()=>ft});const{isArray:p}=Array,{getPrototypeOf:se,prototype:Ye,keys:Pe}=Object;function ft(Be){if(1===Be.length){const Dt=Be[0];if(p(Dt))return{args:Dt,keys:null};if(function Fe(Be){return Be&&"object"==typeof Be&&se(Be)===Ye}(Dt)){const Pt=Pe(Dt);return{args:Pt.map(yt=>Dt[yt]),keys:Pt}}}return{args:Be,keys:null}}},9039:(Qn,Vt,re)=>{"use strict";function p(se,Ye){if(se){const Pe=se.indexOf(Ye);0<=Pe&&se.splice(Pe,1)}}re.d(Vt,{P:()=>p})},2306:(Qn,Vt,re)=>{"use strict";function p(se){const Pe=se(ft=>{Error.call(ft),ft.stack=(new Error).stack});return Pe.prototype=Object.create(Error.prototype),Pe.prototype.constructor=Pe,Pe}re.d(Vt,{d:()=>p})},2714:(Qn,Vt,re)=>{"use strict";function p(se,Ye){return se.reduce((Pe,ft,Fe)=>(Pe[ft]=Ye[Fe],Pe),{})}re.d(Vt,{n:()=>p})},1441:(Qn,Vt,re)=>{"use strict";re.d(Vt,{O:()=>Pe,x:()=>Ye});var p=re(2653);let se=null;function Ye(ft){if(p.config.useDeprecatedSynchronousErrorHandling){const Fe=!se;if(Fe&&(se={errorThrown:!1,error:null}),ft(),Fe){const{errorThrown:Be,error:Dt}=se;if(se=null,Be)throw Dt}}else ft()}function Pe(ft){p.config.useDeprecatedSynchronousErrorHandling&&se&&(se.errorThrown=!0,se.error=ft)}},7103:(Qn,Vt,re)=>{"use strict";function p(se,Ye,Pe,ft=0,Fe=!1){const Be=Ye.schedule(function(){Pe(),Fe?se.add(this.schedule(null,ft)):this.unsubscribe()},ft);if(se.add(Be),!Fe)return Be}re.d(Vt,{f:()=>p})},2737:(Qn,Vt,re)=>{"use strict";function p(se){return se}re.d(Vt,{y:()=>p})},4266:(Qn,Vt,re)=>{"use strict";re.d(Vt,{z:()=>p});const p=se=>se&&"number"==typeof se.length&&"function"!=typeof se},5726:(Qn,Vt,re)=>{"use strict";re.d(Vt,{D:()=>se});var p=re(4674);function se(Ye){return Symbol.asyncIterator&&(0,p.m)(null==Ye?void 0:Ye[Symbol.asyncIterator])}},4674:(Qn,Vt,re)=>{"use strict";function p(se){return"function"==typeof se}re.d(Vt,{m:()=>p})},8382:(Qn,Vt,re)=>{"use strict";re.d(Vt,{c:()=>Ye});var p=re(4850),se=re(4674);function Ye(Pe){return(0,se.m)(Pe[p.L])}},3664:(Qn,Vt,re)=>{"use strict";re.d(Vt,{T:()=>Ye});var p=re(4971),se=re(4674);function Ye(Pe){return(0,se.m)(null==Pe?void 0:Pe[p.h])}},4026:(Qn,Vt,re)=>{"use strict";re.d(Vt,{t:()=>se});var p=re(4674);function se(Ye){return(0,p.m)(null==Ye?void 0:Ye.then)}},541:(Qn,Vt,re)=>{"use strict";re.d(Vt,{L:()=>Pe,Q:()=>Ye});var p=re(7582),se=re(4674);function Ye(ft){return(0,p.FC)(this,arguments,function*(){const Be=ft.getReader();try{for(;;){const{value:Dt,done:Pt}=yield(0,p.qq)(Be.read());if(Pt)return yield(0,p.qq)(void 0);yield yield(0,p.qq)(Dt)}}finally{Be.releaseLock()}})}function Pe(ft){return(0,se.m)(null==ft?void 0:ft.getReader)}},9360:(Qn,Vt,re)=>{"use strict";re.d(Vt,{A:()=>se,e:()=>Ye});var p=re(4674);function se(Pe){return(0,p.m)(null==Pe?void 0:Pe.lift)}function Ye(Pe){return ft=>{if(se(ft))return ft.lift(function(Fe){try{return Pe(Fe,this)}catch(Be){this.error(Be)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Z:()=>Pe});var p=re(7398);const{isArray:se}=Array;function Pe(ft){return(0,p.U)(Fe=>function Ye(ft,Fe){return se(Fe)?ft(...Fe):ft(Fe)}(ft,Fe))}},2420:(Qn,Vt,re)=>{"use strict";function p(){}re.d(Vt,{Z:()=>p})},8407:(Qn,Vt,re)=>{"use strict";re.d(Vt,{U:()=>Ye,z:()=>se});var p=re(2737);function se(...Pe){return Ye(Pe)}function Ye(Pe){return 0===Pe.length?p.y:1===Pe.length?Pe[0]:function(Fe){return Pe.reduce((Be,Dt)=>Dt(Be),Fe)}}},3894:(Qn,Vt,re)=>{"use strict";re.d(Vt,{h:()=>Ye});var p=re(2653),se=re(7599);function Ye(Pe){se.z.setTimeout(()=>{const{onUnhandledError:ft}=p.config;if(!ft)throw Pe;ft(Pe)})}},9853:(Qn,Vt,re)=>{"use strict";function p(se){return new TypeError(`You provided ${null!==se&&"object"==typeof se?"an invalid object":`'${se}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}re.d(Vt,{z:()=>p})},863:(Qn,Vt,re)=>{var p={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,5248,433],"./ion-datetime_3.entry.js":[7059,5248,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,8592,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,8592,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,8592,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function se(Ye){if(!re.o(p,Ye))return Promise.resolve().then(()=>{var Fe=new Error("Cannot find module '"+Ye+"'");throw Fe.code="MODULE_NOT_FOUND",Fe});var Pe=p[Ye],ft=Pe[0];return Promise.all(Pe.slice(1).map(re.e)).then(()=>re(ft))}se.keys=()=>Object.keys(p),se.id=863,Qn.exports=se},6814:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Do:()=>Rt,EM:()=>jl,HT:()=>Pe,JF:()=>Uo,K0:()=>Fe,Mx:()=>ms,O5:()=>Os,PM:()=>xl,S$:()=>ct,V_:()=>Dt,Ye:()=>Ze,b0:()=>je,bD:()=>nl,ez:()=>Ma,q:()=>Ye,tP:()=>Et,w_:()=>ft});var p=re(9212);let se=null;function Ye(){return se}function Pe(R){se||(se=R)}class ft{}const Fe=new p.OlP("DocumentToken");let Be=(()=>{var R;class H{historyGo(z){throw new Error("Not implemented")}}return(R=H).\u0275fac=function(z){return new(z||R)},R.\u0275prov=p.Yz7({token:R,factory:()=>(0,p.f3M)(Pt),providedIn:"platform"}),H})();const Dt=new p.OlP("Location Initialized");let Pt=(()=>{var R;class H extends Be{constructor(){super(),this._doc=(0,p.f3M)(Fe),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ye().getBaseHref(this._doc)}onPopState(z){const ue=Ye().getGlobalEventTarget(this._doc,"window");return ue.addEventListener("popstate",z,!1),()=>ue.removeEventListener("popstate",z)}onHashChange(z){const ue=Ye().getGlobalEventTarget(this._doc,"window");return ue.addEventListener("hashchange",z,!1),()=>ue.removeEventListener("hashchange",z)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(z){this._location.pathname=z}pushState(z,ue,De){this._history.pushState(z,ue,De)}replaceState(z,ue,De){this._history.replaceState(z,ue,De)}forward(){this._history.forward()}back(){this._history.back()}historyGo(z=0){this._history.go(z)}getState(){return this._history.state}}return(R=H).\u0275fac=function(z){return new(z||R)},R.\u0275prov=p.Yz7({token:R,factory:()=>new R,providedIn:"platform"}),H})();function yt(R,H){if(0==R.length)return H;if(0==H.length)return R;let Ee=0;return R.endsWith("/")&&Ee++,H.startsWith("/")&&Ee++,2==Ee?R+H.substring(1):1==Ee?R+H:R+"/"+H}function Le(R){const H=R.match(/#|\?|$/),Ee=H&&H.index||R.length;return R.slice(0,Ee-("/"===R[Ee-1]?1:0))+R.slice(Ee)}function mt(R){return R&&"?"!==R[0]?"?"+R:R}let ct=(()=>{var R;class H{historyGo(z){throw new Error("Not implemented")}}return(R=H).\u0275fac=function(z){return new(z||R)},R.\u0275prov=p.Yz7({token:R,factory:()=>(0,p.f3M)(je),providedIn:"root"}),H})();const tt=new p.OlP("appBaseHref");let je=(()=>{var R;class H extends ct{constructor(z,ue){var De,jt,on;super(),this._platformLocation=z,this._removeListenerFns=[],this._baseHref=null!==(De=null!==(jt=null!=ue?ue:this._platformLocation.getBaseHrefFromDOM())&&void 0!==jt?jt:null===(on=(0,p.f3M)(Fe).location)||void 0===on?void 0:on.origin)&&void 0!==De?De:""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}prepareExternalUrl(z){return yt(this._baseHref,z)}path(z=!1){const ue=this._platformLocation.pathname+mt(this._platformLocation.search),De=this._platformLocation.hash;return De&&z?`${ue}${De}`:ue}pushState(z,ue,De,jt){const on=this.prepareExternalUrl(De+mt(jt));this._platformLocation.pushState(z,ue,on)}replaceState(z,ue,De,jt){const on=this.prepareExternalUrl(De+mt(jt));this._platformLocation.replaceState(z,ue,on)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(z=0){var ue,De;null===(ue=(De=this._platformLocation).historyGo)||void 0===ue||ue.call(De,z)}}return(R=H).\u0275fac=function(z){return new(z||R)(p.LFG(Be),p.LFG(tt,8))},R.\u0275prov=p.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),H})(),Rt=(()=>{var R;class H extends ct{constructor(z,ue){super(),this._platformLocation=z,this._baseHref="",this._removeListenerFns=[],null!=ue&&(this._baseHref=ue)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}path(z=!1){let ue=this._platformLocation.hash;return null==ue&&(ue="#"),ue.length>0?ue.substring(1):ue}prepareExternalUrl(z){const ue=yt(this._baseHref,z);return ue.length>0?"#"+ue:ue}pushState(z,ue,De,jt){let on=this.prepareExternalUrl(De+mt(jt));0==on.length&&(on=this._platformLocation.pathname),this._platformLocation.pushState(z,ue,on)}replaceState(z,ue,De,jt){let on=this.prepareExternalUrl(De+mt(jt));0==on.length&&(on=this._platformLocation.pathname),this._platformLocation.replaceState(z,ue,on)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(z=0){var ue,De;null===(ue=(De=this._platformLocation).historyGo)||void 0===ue||ue.call(De,z)}}return(R=H).\u0275fac=function(z){return new(z||R)(p.LFG(Be),p.LFG(tt,8))},R.\u0275prov=p.Yz7({token:R,factory:R.\u0275fac}),H})(),Ze=(()=>{var R;class H{constructor(z){this._subject=new p.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=z;const ue=this._locationStrategy.getBaseHref();this._basePath=function st(R){if(new RegExp("^(https?:)?//").test(R)){const[,Ee]=R.split(/\/\/[^\/]+/);return Ee}return R}(Le($t(ue))),this._locationStrategy.onPopState(De=>{this._subject.emit({url:this.path(!0),pop:!0,state:De.state,type:De.type})})}ngOnDestroy(){var z;null===(z=this._urlChangeSubscription)||void 0===z||z.unsubscribe(),this._urlChangeListeners=[]}path(z=!1){return this.normalize(this._locationStrategy.path(z))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(z,ue=""){return this.path()==this.normalize(z+mt(ue))}normalize(z){return H.stripTrailingSlash(function et(R,H){if(!R||!H.startsWith(R))return H;const Ee=H.substring(R.length);return""===Ee||["/",";","?","#"].includes(Ee[0])?Ee:H}(this._basePath,$t(z)))}prepareExternalUrl(z){return z&&"/"!==z[0]&&(z="/"+z),this._locationStrategy.prepareExternalUrl(z)}go(z,ue="",De=null){this._locationStrategy.pushState(De,"",z,ue),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+mt(ue)),De)}replaceState(z,ue="",De=null){this._locationStrategy.replaceState(De,"",z,ue),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+mt(ue)),De)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(z=0){var ue,De;null===(ue=(De=this._locationStrategy).historyGo)||void 0===ue||ue.call(De,z)}onUrlChange(z){return this._urlChangeListeners.push(z),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(ue=>{this._notifyUrlChangeListeners(ue.url,ue.state)})),()=>{const ue=this._urlChangeListeners.indexOf(z);var De;this._urlChangeListeners.splice(ue,1),0===this._urlChangeListeners.length&&(null===(De=this._urlChangeSubscription)||void 0===De||De.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(z="",ue){this._urlChangeListeners.forEach(De=>De(z,ue))}subscribe(z,ue,De){return this._subject.subscribe({next:z,error:ue,complete:De})}}return(R=H).normalizeQueryParams=mt,R.joinWithSlash=yt,R.stripTrailingSlash=Le,R.\u0275fac=function(z){return new(z||R)(p.LFG(ct))},R.\u0275prov=p.Yz7({token:R,factory:()=>function Je(){return new Ze((0,p.LFG)(ct))}(),providedIn:"root"}),H})();function $t(R){return R.replace(/\/index.html$/,"")}function ms(R,H){H=encodeURIComponent(H);for(const Ee of R.split(";")){const z=Ee.indexOf("="),[ue,De]=-1==z?[Ee,""]:[Ee.slice(0,z),Ee.slice(z+1)];if(ue.trim()===H)return decodeURIComponent(De)}return null}let Os=(()=>{var R;class H{constructor(z,ue){this._viewContainer=z,this._context=new ro,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=ue}set ngIf(z){this._context.$implicit=this._context.ngIf=z,this._updateView()}set ngIfThen(z){de("ngIfThen",z),this._thenTemplateRef=z,this._thenViewRef=null,this._updateView()}set ngIfElse(z){de("ngIfElse",z),this._elseTemplateRef=z,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(z,ue){return!0}}return(R=H).\u0275fac=function(z){return new(z||R)(p.Y36(p.s_b),p.Y36(p.Rgc))},R.\u0275dir=p.lG2({type:R,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),H})();class ro{constructor(){this.$implicit=null,this.ngIf=null}}function de(R,H){if(H&&!H.createEmbeddedView)throw new Error(`${R} must be a TemplateRef, but received '${(0,p.AaK)(H)}'.`)}let Et=(()=>{var R;class H{constructor(z){this._viewContainerRef=z,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(z){if(this._shouldRecreateView(z)){var ue;const De=this._viewContainerRef;if(this._viewRef&&De.remove(De.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const jt=this._createContextForwardProxy();this._viewRef=De.createEmbeddedView(this.ngTemplateOutlet,jt,{injector:null!==(ue=this.ngTemplateOutletInjector)&&void 0!==ue?ue:void 0})}}_shouldRecreateView(z){return!!z.ngTemplateOutlet||!!z.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(z,ue,De)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,ue,De),get:(z,ue,De)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,ue,De)}})}}return(R=H).\u0275fac=function(z){return new(z||R)(p.Y36(p.s_b))},R.\u0275dir=p.lG2({type:R,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[p.TTD]}),H})(),Ma=(()=>{var R;class H{}return(R=H).\u0275fac=function(z){return new(z||R)},R.\u0275mod=p.oAB({type:R}),R.\u0275inj=p.cJS({}),H})();const nl="browser",il="server";function xl(R){return R===il}let jl=(()=>{var R;class H{}return(R=H).\u0275prov=(0,p.Yz7)({token:R,providedIn:"root",factory:()=>new Au((0,p.LFG)(Fe),window)}),H})();class Au{constructor(H,Ee){this.document=H,this.window=Ee,this.offset=()=>[0,0]}setOffset(H){this.offset=Array.isArray(H)?()=>H:H}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(H){this.supportsScrolling()&&this.window.scrollTo(H[0],H[1])}scrollToAnchor(H){if(!this.supportsScrolling())return;const Ee=function sl(R,H){const Ee=R.getElementById(H)||R.getElementsByName(H)[0];if(Ee)return Ee;if("function"==typeof R.createTreeWalker&&R.body&&"function"==typeof R.body.attachShadow){const z=R.createTreeWalker(R.body,NodeFilter.SHOW_ELEMENT);let ue=z.currentNode;for(;ue;){const De=ue.shadowRoot;if(De){const jt=De.getElementById(H)||De.querySelector(`[name="${H}"]`);if(jt)return jt}ue=z.nextNode()}}return null}(this.document,H);Ee&&(this.scrollToElement(Ee),Ee.focus())}setHistoryScrollRestoration(H){this.supportsScrolling()&&(this.window.history.scrollRestoration=H)}scrollToElement(H){const Ee=H.getBoundingClientRect(),z=Ee.left+this.window.pageXOffset,ue=Ee.top+this.window.pageYOffset,De=this.offset();this.window.scrollTo(z-De[0],ue-De[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class Uo{}},9212:(Qn,Vt,re)=>{"use strict";re.d(Vt,{tb:()=>FC,AFp:()=>gE,ip1:()=>CT,hGG:()=>aI,z2F:()=>Dm,Ojb:()=>fA,sBO:()=>Rd,Sil:()=>mD,EJc:()=>KD,Xts:()=>kc,SBq:()=>wp,lqb:()=>ul,qLn:()=>Ja,vpe:()=>ml,XFs:()=>Di,OlP:()=>de,zs3:()=>Xa,ZZ4:()=>Ug,aQg:()=>Cp,soG:()=>xx,YKP:()=>uy,h0i:()=>Mu,R0b:()=>zs,FiY:()=>Xf,Lbi:()=>jy,g9A:()=>vE,Qsj:()=>DA,FYo:()=>q0,JOm:()=>lp,tp0:()=>Kf,Rgc:()=>Ti,dDg:()=>VD,eoX:()=>ST,GfV:()=>vT,s_b:()=>tm,ifc:()=>Gi,T8G:()=>Nw,VuI:()=>PI,LMc:()=>OI,MMx:()=>e,Lck:()=>TC,eFA:()=>NT,G48:()=>tI,Gpc:()=>ar,f3M:()=>oe,$WT:()=>ws,_c5:()=>oI,qFp:()=>NI,r_H:()=>lE,rg0:()=>Bg,c2e:()=>yT,zSh:()=>eg,wAp:()=>Zd,I6F:()=>PC,vHH:()=>vn,lri:()=>wT,rWj:()=>MT,cg1:()=>bc,kuF:()=>Cr,kL8:()=>Sb,dqk:()=>_r,Z0I:()=>nr,eJc:()=>Vc,QGY:()=>Xb,F4k:()=>Kb,RDi:()=>dA,AaK:()=>li,qOj:()=>pv,Xq5:()=>gv,TTD:()=>ur,_Bn:()=>cy,jDz:()=>i,xp6:()=>c_,uIk:()=>Qh,ekj:()=>ds,Suo:()=>wr,Xpm:()=>ol,lG2:()=>Ru,Yz7:()=>Hi,cJS:()=>bs,oAB:()=>Lo,Yjl:()=>Tc,Y36:()=>fc,_UZ:()=>jv,GkF:()=>Xv,qZA:()=>hm,TgZ:()=>dm,n5z:()=>Wf,LFG:()=>ie,$8M:()=>Wm,$Z:()=>d_,NdJ:()=>Af,CRH:()=>nt,oxw:()=>lC,Hsn:()=>uC,F$t:()=>cC,Q6J:()=>$p,iGM:()=>Xn,P3R:()=>Dg,YNc:()=>$d,_uU:()=>ux,Gf:()=>ji});let se=null,Pe=1;function Fe(n){const r=se;return se=n,r}function ct(n){if((!bt(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Pe)){if(!n.producerMustRecompute(n)&&!et(n))return n.dirty=!1,void(n.lastCleanEpoch=Pe);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Pe}}function et(n){$e(n);for(let r=0;r<n.producerNode.length;r++){const o=n.producerNode[r],l=n.producerLastReadVersion[r];if(l!==o.version||(ct(o),l!==o.version))return!0}return!1}function ot(n,r){if(function me(n){var r,o;null!==(r=n.liveConsumerNode)&&void 0!==r||(n.liveConsumerNode=[]),null!==(o=n.liveConsumerIndexOfThis)&&void 0!==o||(n.liveConsumerIndexOfThis=[])}(n),$e(n),1===n.liveConsumerNode.length)for(let l=0;l<n.producerNode.length;l++)ot(n.producerNode[l],n.producerIndexOfThis[l]);const o=n.liveConsumerNode.length-1;if(n.liveConsumerNode[r]=n.liveConsumerNode[o],n.liveConsumerIndexOfThis[r]=n.liveConsumerIndexOfThis[o],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,r<n.liveConsumerNode.length){const l=n.liveConsumerIndexOfThis[r],h=n.liveConsumerNode[r];$e(h),h.producerIndexOfThis[l]=r}}function bt(n){var r,o;return n.consumerIsAlwaysLive||(null!==(r=null==n||null===(o=n.liveConsumerNode)||void 0===o?void 0:o.length)&&void 0!==r?r:0)>0}function $e(n){var r,o,l;null!==(r=n.producerNode)&&void 0!==r||(n.producerNode=[]),null!==(o=n.producerIndexOfThis)&&void 0!==o||(n.producerIndexOfThis=[]),null!==(l=n.producerLastReadVersion)&&void 0!==l||(n.producerLastReadVersion=[])}let ln=null;var Xt=re(8645),Ft=re(7394),It=re(5619),tn=re(7398);function Ut(n){for(let r in n)if(n[r]===Ut)return r;throw Error("Could not find renamed property on target object.")}function ti(n,r){for(const o in r)r.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(n[o]=r[o])}function li(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(li).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function Gn(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const Ci=Ut({__forward_ref__:Ut});function ar(n){return n.__forward_ref__=ar,n.toString=function(){return li(this())},n}function Rn(n){return mi(n)?n():n}function mi(n){return"function"==typeof n&&n.hasOwnProperty(Ci)&&n.__forward_ref__===ar}function hi(n){return n&&!!n.\u0275providers}const Fr="https://g.co/ng/security#xss";class vn extends Error{constructor(r,o){super(Cr(r,o)),this.code=r}}function Cr(n,r){return`NG0${Math.abs(n)}${r?": "+r:""}`}const fr=Ut({\u0275cmp:Ut}),jr=Ut({\u0275dir:Ut}),Ei=Ut({\u0275pipe:Ut}),Zr=Ut({\u0275mod:Ut}),Jn=Ut({\u0275fac:Ut}),Ar=Ut({__NG_ELEMENT_ID__:Ut}),fs=Ut({__NG_ENV_ID__:Ut});function xn(n){return"string"==typeof n?n:null==n?"":String(n)}function kr(n,r){throw new vn(-201,!1)}function cr(n,r){null==n&&function qn(n,r,o,l){throw new Error(`ASSERTION ERROR: ${n}`+(null==l?"":` [Expected=> ${o} ${l} ${r} <=Actual]`))}(r,n,null,"!=")}function Hi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function bs(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ts(n){return ps(n,Tr)||ps(n,Is)}function nr(n){return null!==Ts(n)}function ps(n,r){return n.hasOwnProperty(r)?n[r]:null}function Ds(n){return n&&(n.hasOwnProperty(ms)||n.hasOwnProperty(Or))?n[ms]:null}const Tr=Ut({\u0275prov:Ut}),ms=Ut({\u0275inj:Ut}),Is=Ut({ngInjectableDef:Ut}),Or=Ut({ngInjectorDef:Ut});var Di=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Di||{});let os;function ir(){return os}function ci(n){const r=os;return os=n,r}function Co(n,r,o){const l=Ts(n);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:o&Di.Optional?null:void 0!==r?r:void kr(li(n))}const _r=globalThis;class de{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=Hi({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Xe={},Wt="__NG_DI_FLAG__",Yt="ngTempTokenPath",Zt=/\n/gm,Wn="__source";let On;function pr(n){const r=On;return On=n,r}function I(n,r=Di.Default){if(void 0===On)throw new vn(-203,!1);return null===On?Co(n,void 0,r):On.get(n,r&Di.Optional?null:void 0,r)}function ie(n,r=Di.Default){return(ir()||I)(Rn(n),r)}function oe(n,r=Di.Default){return ie(n,Ke(r))}function Ke(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function yi(n){const r=[];for(let o=0;o<n.length;o++){const l=Rn(n[o]);if(Array.isArray(l)){if(0===l.length)throw new vn(900,!1);let h,g=Di.Default;for(let b=0;b<l.length;b++){const E=l[b],T=as(E);"number"==typeof T?-1===T?h=E.token:g|=T:h=E}r.push(ie(h,g))}else r.push(ie(l))}return r}function Nr(n,r){return n[Wt]=r,n.prototype[Wt]=r,n}function as(n){return n[Wt]}function Ns(n){return{toString:n}.toString()}var yo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(yo||{}),Gi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Gi||{});const Dr={},Li=[];function Va(n,r,o){let l=n.length;for(;;){const h=n.indexOf(r,o);if(-1===h)return h;if(0===h||n.charCodeAt(h-1)<=32){const g=r.length;if(h+g===l||n.charCodeAt(h+g)<=32)return h}o=h+1}}function Qo(n,r,o){let l=0;for(;l<o.length;){const h=o[l];if("number"==typeof h){if(0!==h)break;l++;const g=o[l++],b=o[l++],E=o[l++];n.setAttribute(r,b,E,g)}else{const g=h,b=o[++l];Wl(g)?n.setProperty(r,g,b):n.setAttribute(r,g,b),l++}}return l}function za(n){return 3===n||4===n||6===n}function Wl(n){return 64===n.charCodeAt(0)}function Ma(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let o=-1;for(let l=0;l<r.length;l++){const h=r[l];"number"==typeof h?o=h:0===o||nl(n,o,h,null,-1===o||2===o?r[++l]:null)}}return n}function nl(n,r,o,l,h){let g=0,b=n.length;if(-1===r)b=-1;else for(;g<n.length;){const E=n[g++];if("number"==typeof E){if(E===r){b=-1;break}if(E>r){b=g-1;break}}}for(;g<n.length;){const E=n[g];if("number"==typeof E)break;if(E===o){if(null===l)return void(null!==h&&(n[g+1]=h));if(l===n[g+1])return void(n[g+2]=h)}g++,null!==l&&g++,null!==h&&g++}-1!==b&&(n.splice(b,0,r),g=b+1),n.splice(g++,0,o),null!==l&&n.splice(g++,0,l),null!==h&&n.splice(g++,0,h)}const il="ng-template";function Sc(n,r,o){let l=0,h=!0;for(;l<n.length;){let g=n[l++];if("string"==typeof g&&h){const b=n[l++];if(o&&"class"===g&&-1!==Va(b.toLowerCase(),r,0))return!0}else{if(1===g){for(;l<n.length&&"string"==typeof(g=n[l++]);)if(g.toLowerCase()===r)return!0;return!1}"number"==typeof g&&(h=!1)}}return!1}function rl(n){return 4===n.type&&n.value!==il}function rh(n,r,o){return r===(4!==n.type||o?n.value:il)}function xl(n,r,o){let l=4;const h=n.attrs||[],g=function Au(n){for(let r=0;r<n.length;r++)if(za(n[r]))return r;return n.length}(h);let b=!1;for(let E=0;E<r.length;E++){const T=r[E];if("number"!=typeof T){if(!b)if(4&l){if(l=2|1&l,""!==T&&!rh(n,T,o)||""===T&&1===r.length){if(Ao(l))return!1;b=!0}}else{const V=8&l?T:r[++E];if(8&l&&null!==n.attrs){if(!Sc(n.attrs,V,o)){if(Ao(l))return!1;b=!0}continue}const Q=sh(8&l?"class":T,h,rl(n),o);if(-1===Q){if(Ao(l))return!1;b=!0;continue}if(""!==V){let we;we=Q>g?"":h[Q+1].toLowerCase();const ze=8&l?we:null;if(ze&&-1!==Va(ze,V,0)||2&l&&V!==we){if(Ao(l))return!1;b=!0}}}}else{if(!b&&!Ao(l)&&!Ao(T))return!1;if(b&&Ao(T))continue;b=!1,l=T|1&l}}return Ao(l)||b}function Ao(n){return 0==(1&n)}function sh(n,r,o,l){if(null===r)return-1;let h=0;if(l||!o){let g=!1;for(;h<r.length;){const b=r[h];if(b===n)return h;if(3===b||6===b)g=!0;else{if(1===b||2===b){let E=r[++h];for(;"string"==typeof E;)E=r[++h];continue}if(4===b)break;if(0===b){h+=4;continue}}h+=g?1:2}return-1}return function sl(n,r){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const l=n[o];if("number"==typeof l)return-1;if(l===r)return o;o++}return-1}(r,n)}function El(n,r,o=!1){for(let l=0;l<r.length;l++)if(xl(n,r[l],o))return!0;return!1}function Yl(n,r){e:for(let o=0;o<r.length;o++){const l=r[o];if(n.length===l.length){for(let h=0;h<n.length;h++)if(n[h]!==l[h])continue e;return!0}}return!1}function Uo(n,r){return n?":not("+r.trim()+")":r}function Tu(n){let r=n[0],o=1,l=2,h="",g=!1;for(;o<n.length;){let b=n[o];if("string"==typeof b)if(2&l){const E=n[++o];h+="["+b+(E.length>0?'="'+E+'"':"")+"]"}else 8&l?h+="."+b:4&l&&(h+=" "+b);else""!==h&&!Ao(b)&&(r+=Uo(g,h),h=""),l=b,g=g||!Ao(l);o++}return""!==h&&(r+=Uo(g,h)),r}function ol(n){return Ns(()=>{var r;const o=Ca(n),l={...o,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===yo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:null!==(r=n.signals)&&void 0!==r&&r,data:n.data||{},encapsulation:n.encapsulation||Gi.Emulated,styles:n.styles||Li,_:null,schemas:n.schemas||null,tView:null,id:""};Pu(l);const h=n.dependencies;return l.directiveDefs=al(h,!1),l.pipeDefs=al(h,!0),l.id=function Ha(n){let r=0;const o=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const h of o)r=Math.imul(31,r)+h.charCodeAt(0)<<0;return r+=2147483648,"c"+r}(l),l})}function Du(n){return qi(n)||gs(n)}function Iu(n){return null!==n}function Lo(n){return Ns(()=>({type:n.type,bootstrap:n.bootstrap||Li,declarations:n.declarations||Li,imports:n.imports||Li,exports:n.exports||Li,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Ac(n,r){if(null==n)return Dr;const o={};for(const l in n)if(n.hasOwnProperty(l)){let h=n[l],g=h;Array.isArray(h)&&(g=h[1],h=h[0]),o[h]=l,r&&(r[h]=g)}return o}function Ru(n){return Ns(()=>{const r=Ca(n);return Pu(r),r})}function Tc(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function qi(n){return n[fr]||null}function gs(n){return n[jr]||null}function Es(n){return n[Ei]||null}function ws(n){const r=qi(n)||gs(n)||Es(n);return null!==r&&r.standalone}function Fs(n,r){const o=n[Zr]||null;if(!o&&!0===r)throw new Error(`Type ${li(n)} does not have '\u0275mod' property.`);return o}function Ca(n){const r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputTransforms:null,inputConfig:n.inputs||Dr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Li,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ac(n.inputs,r),outputs:Ac(n.outputs),debugInfo:null}}function Pu(n){var r;null===(r=n.features)||void 0===r||r.forEach(o=>o(n))}function al(n,r){if(!n)return null;const o=r?Es:Du;return()=>("function"==typeof n?n():n).map(l=>o(l)).filter(Iu)}const mr=0,dn=1,pi=2,rr=3,ls=4,Ir=5,xr=6,Oo=7,xi=8,so=9,$=10,O=11,ae=12,G=13,_e=14,en=15,ui=16,Rr=17,$r=18,Bs=19,No=20,_o=21,Aa=22,Fo=23,Ai=25,oo=1,Bo=7,Fi=9,is=10;var ha=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n[n.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",n}(ha||{});function Rs(n){return Array.isArray(n)&&"object"==typeof n[oo]}function Ur(n){return Array.isArray(n)&&!0===n[oo]}function wl(n){return 0!=(4&n.flags)}function ll(n){return n.componentOffset>-1}function ql(n){return 1==(1&n.flags)}function bo(n){return!!n.template}function fa(n){return 0!=(512&n[pi])}function he(n,r){return n.hasOwnProperty(Jn)?n[Jn]:null}class er{constructor(r,o,l){this.previousValue=r,this.currentValue=o,this.firstChange=l}isFirstChange(){return this.firstChange}}function ur(){return bi}function bi(n){return n.type.prototype.ngOnChanges&&(n.setInput=tr),dr}function dr(){const n=Ms(this),r=null==n?void 0:n.current;if(r){const o=n.previous;if(o===Dr)n.previous=r;else for(let l in r)o[l]=r[l];n.current=null,this.ngOnChanges(r)}}function tr(n,r,o,l){const h=this.declaredInputs[o],g=Ms(n)||function ks(n,r){return n[Pr]=r}(n,{previous:Dr,current:null}),b=g.current||(g.current={}),E=g.previous,T=E[h];b[h]=new er(T&&T.currentValue,r,E===Dr),n[l]=r}ur.ngInherit=!0;const Pr="__ngSimpleChanges__";function Ms(n){return n[Pr]||null}const qr=function(n,r,o){};let Ta=!1;function Hr(n){for(;Array.isArray(n);)n=n[mr];return n}function qs(n,r){return Hr(r[n.index])}function Ho(n,r){return n.data[r]}function xo(n,r){const o=r[n];return Rs(o)?o:o[mr]}function Jl(n){return 128==(128&n[pi])}function na(n,r){return null==r?null:n[r]}function Ml(n){n[Rr]=0}function _i(n){1024&n[pi]||(n[pi]|=1024,Jl(n)&&Lc(n))}function ia(n){var r;return 9216&n[pi]||(null===(r=n[Fo])||void 0===r?void 0:r.dirty)}function Ql(n){if(ia(n))Lc(n);else if(64&n[pi])if(function Pc(){return Ta}())n[pi]|=1024,Lc(n);else{var r;null===(r=n[$].changeDetectionScheduler)||void 0===r||r.notify()}}function Lc(n){var r;null===(r=n[$].changeDetectionScheduler)||void 0===r||r.notify();let o=n[rr];for(;null!==o&&!(Ur(o)&&o[pi]&ha.HasChildViewsToRefresh||Rs(o)&&8192&o[pi]);){if(Ur(o))o[pi]|=ha.HasChildViewsToRefresh;else if(o[pi]|=8192,!Jl(o))break;o=o[rr]}}function ma(n,r){if(256==(256&n[pi]))throw new vn(911,!1);null===n[_o]&&(n[_o]=[]),n[_o].push(r)}const fi={lFrame:D(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Bu(){return fi.bindingsEnabled}function Ps(){return null!==fi.skipHydrationRootTNode}function qt(){return fi.lFrame.lView}function sr(){return fi.lFrame.tView}function Gr(){let n=Ls();for(;null!==n&&64===n.type;)n=n.parent;return n}function Ls(){return fi.lFrame.currentTNode}function lo(n,r){const o=fi.lFrame;o.currentTNode=n,o.isParent=r}function Uu(){return fi.lFrame.isParent}function Da(){fi.lFrame.isParent=!1}function $o(){return fi.lFrame.bindingIndex++}function Ff(n,r){const o=fi.lFrame;o.bindingIndex=o.bindingRootIndex=n,tc(r)}function tc(n){fi.lFrame.currentDirectiveIndex=n}function Yn(){return fi.lFrame.currentQueryIndex}function co(n){fi.lFrame.currentQueryIndex=n}function sa(n){const r=n[dn];return 2===r.type?r.declTNode:1===r.type?n[Ir]:null}function Ya(n,r,o){if(o&Di.SkipSelf){let h=r,g=n;for(;!(h=h.parent,null!==h||o&Di.Host||(h=sa(g),null===h||(g=g[_e],10&h.type))););if(null===h)return!1;r=h,n=g}const l=fi.lFrame=w();return l.currentTNode=r,l.lView=n,!0}function Bf(n){const r=w(),o=n[dn];fi.lFrame=r,r.currentTNode=o.firstChild,r.lView=n,r.tView=o,r.contextLView=n,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function w(){const n=fi.lFrame,r=null===n?null:n.child;return null===r?D(n):r}function D(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function L(){const n=fi.lFrame;return fi.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const S=L;function B(){const n=L();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ce(){return fi.lFrame.selectedIndex}function it(n){fi.lFrame.selectedIndex=n}function At(){const n=fi.lFrame;return Ho(n.tView,n.selectedIndex)}let kn=!0;function qa(){return kn}function oa(n){kn=n}function Ia(n,r){for(let V=r.directiveStart,Y=r.directiveEnd;V<Y;V++){const we=n.data[V].type.prototype,{ngAfterContentInit:ze,ngAfterContentChecked:Ct,ngAfterViewInit:an,ngAfterViewChecked:gn,ngOnDestroy:Hn}=we;var o,l,h,g,b,E,T;ze&&(null!==(o=n.contentHooks)&&void 0!==o?o:n.contentHooks=[]).push(-V,ze),Ct&&((null!==(l=n.contentHooks)&&void 0!==l?l:n.contentHooks=[]).push(V,Ct),(null!==(h=n.contentCheckHooks)&&void 0!==h?h:n.contentCheckHooks=[]).push(V,Ct)),an&&(null!==(g=n.viewHooks)&&void 0!==g?g:n.viewHooks=[]).push(-V,an),gn&&((null!==(b=n.viewHooks)&&void 0!==b?b:n.viewHooks=[]).push(V,gn),(null!==(E=n.viewCheckHooks)&&void 0!==E?E:n.viewCheckHooks=[]).push(V,gn)),null!=Hn&&(null!==(T=n.destroyHooks)&&void 0!==T?T:n.destroyHooks=[]).push(V,Hn)}}function Wo(n,r,o){uo(n,r,3,o)}function wo(n,r,o,l){(3&n[pi])===o&&uo(n,r,o,l)}function va(n,r){let o=n[pi];(3&o)===r&&(o&=16383,o+=1,n[pi]=o)}function uo(n,r,o,l){const g=null!=l?l:-1,b=r.length-1;let E=0;for(let T=void 0!==l?65535&n[Rr]:0;T<b;T++)if("number"==typeof r[T+1]){if(E=r[T],null!=l&&E>=l)break}else r[T]<0&&(n[Rr]+=65536),(E<g||-1==g)&&(wy(n,o,r,T),n[Rr]=(4294901760&n[Rr])+T+2),T++}function Zi(n,r){qr(4,n,r);const o=Fe(null);try{r.call(n)}finally{Fe(o),qr(5,n,r)}}function wy(n,r,o,l){const h=o[l]<0,g=o[l+1],E=n[h?-o[l]:o[l]];h?n[pi]>>14<n[Rr]>>16&&(3&n[pi])===r&&(n[pi]+=16384,Zi(E,g)):Zi(E,g)}const Ra=-1;class nc{constructor(r,o,l){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=l}}function Gu(n){return n!==Ra}function rc(n){return 32767&n}function Wu(n,r){let o=function Sy(n){return n>>16}(n),l=r;for(;o>0;)l=l[_e],o--;return l}let kf=!0;function Nc(n){const r=kf;return kf=n,r}const Xr=255,Cy=5;let Uf=0;const Mo={};function So(n,r){const o=$m(n,r);if(-1!==o)return o;const l=r[dn];l.firstCreatePass&&(n.injectorIndex=r.length,Hm(l.data,n),Hm(r,null),Hm(l.blueprint,null));const h=Vf(n,r),g=n.injectorIndex;if(Gu(h)){const b=rc(h),E=Wu(h,r),T=E[dn].data;for(let V=0;V<8;V++)r[g+V]=E[b+V]|T[b+V]}return r[g+8]=h,g}function Hm(n,r){n.push(0,0,0,0,0,0,0,0,r)}function $m(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function Vf(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,l=null,h=r;for(;null!==h;){if(l=Bc(h),null===l)return Ra;if(o++,h=h[_e],-1!==l.injectorIndex)return l.injectorIndex|o<<16}return Ra}function Gm(n,r,o){!function ju(n,r,o){let l;"string"==typeof o?l=o.charCodeAt(0)||0:o.hasOwnProperty(Ar)&&(l=o[Ar]),null==l&&(l=o[Ar]=Uf++);const h=l&Xr;r.data[n+(h>>Cy)]|=1<<h}(n,r,o)}function Al(n,r,o){if(o&Di.Optional||void 0!==n)return n;kr()}function zf(n,r,o,l){if(o&Di.Optional&&void 0===l&&(l=null),!(o&(Di.Self|Di.Host))){const h=n[so],g=ci(void 0);try{return h?h.get(r,l,o&Di.Optional):Co(r,l,o&Di.Optional)}finally{ci(g)}}return Al(l,0,o)}function ho(n,r,o,l=Di.Default,h){if(null!==n){if(2048&r[pi]&&!(l&Di.Self)){const b=function Rx(n,r,o,l,h){let g=n,b=r;for(;null!==g&&null!==b&&2048&b[pi]&&!(512&b[pi]);){const E=Fc(g,b,o,l|Di.Self,Mo);if(E!==Mo)return E;let T=g.parent;if(!T){const V=b[No];if(V){const Y=V.get(o,Mo,l);if(Y!==Mo)return Y}T=Bc(b),b=b[_e]}g=T}return h}(n,r,o,l,Mo);if(b!==Mo)return b}const g=Fc(n,r,o,l,Mo);if(g!==Mo)return g}return zf(r,o,l,h)}function Fc(n,r,o,l,h){const g=function Ix(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(Ar)?n[Ar]:void 0;return"number"==typeof r?r>=0?r&Xr:Gf:r}(o);if("function"==typeof g){if(!Ya(r,n,l))return l&Di.Host?Al(h,0,l):zf(r,o,l,h);try{let b;if(b=g(l),null!=b||l&Di.Optional)return b;kr()}finally{S()}}else if("number"==typeof g){let b=null,E=$m(n,r),T=Ra,V=l&Di.Host?r[en][Ir]:null;for((-1===E||l&Di.SkipSelf)&&(T=-1===E?Vf(n,r):r[E+8],T!==Ra&&Ay(l,!1)?(b=r[dn],E=rc(T),r=Wu(T,r)):E=-1);-1!==E;){const Y=r[dn];if($f(g,E,Y.data)){const Q=Yu(E,r,o,b,l,V);if(Q!==Mo)return Q}T=r[E+8],T!==Ra&&Ay(l,r[dn].data[E+8]===V)&&$f(g,E,r)?(b=Y,E=rc(T),r=Wu(T,r)):E=-1}}return h}function Yu(n,r,o,l,h,g){const b=r[dn],E=b.data[n+8],Y=Hf(E,b,o,null==l?ll(E)&&kf:l!=b&&0!=(3&E.type),h&Di.Host&&g===E);return null!==Y?cl(r,b,Y,E):Mo}function Hf(n,r,o,l,h){const g=n.providerIndexes,b=r.data,E=1048575&g,T=n.directiveStart,Y=g>>20,we=h?E+Y:n.directiveEnd;for(let ze=l?E:E+Y;ze<we;ze++){const Ct=b[ze];if(ze<T&&o===Ct||ze>=T&&Ct.type===o)return ze}if(h){const ze=b[T];if(ze&&bo(ze)&&ze.type===o)return T}return null}function cl(n,r,o,l){let h=n[o];const g=r.data;if(function My(n){return n instanceof nc}(h)){const b=h;b.resolving&&function no(n,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new vn(-200,`Circular dependency in DI detected for ${n}${o}`)}(function wi(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():xn(n)}(g[o]));const E=Nc(b.canSeeViewProviders);b.resolving=!0;const V=b.injectImpl?ci(b.injectImpl):null;Ya(n,l,Di.Default);try{h=n[o]=b.factory(void 0,g,n,l),r.firstCreatePass&&o>=l.directiveStart&&function Eo(n,r,o){const{ngOnChanges:l,ngOnInit:h,ngDoCheck:g}=r.type.prototype;if(l){var b,E;const Q=bi(r);(null!==(b=o.preOrderHooks)&&void 0!==b?b:o.preOrderHooks=[]).push(n,Q),(null!==(E=o.preOrderCheckHooks)&&void 0!==E?E:o.preOrderCheckHooks=[]).push(n,Q)}var T,V,Y;h&&(null!==(T=o.preOrderHooks)&&void 0!==T?T:o.preOrderHooks=[]).push(0-n,h),g&&((null!==(V=o.preOrderHooks)&&void 0!==V?V:o.preOrderHooks=[]).push(n,g),(null!==(Y=o.preOrderCheckHooks)&&void 0!==Y?Y:o.preOrderCheckHooks=[]).push(n,g))}(o,g[o],r)}finally{null!==V&&ci(V),Nc(E),b.resolving=!1,S()}}return h}function $f(n,r,o){return!!(o[r+(n>>Cy)]&1<<n)}function Ay(n,r){return!(n&Di.Self||n&Di.Host&&r)}class cs{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,l){return ho(this._tNode,this._lView,r,Ke(l),o)}}function Gf(){return new cs(Gr(),qt())}function Wf(n){return Ns(()=>{const r=n.prototype.constructor,o=r[Jn]||jf(r),l=Object.prototype;let h=Object.getPrototypeOf(n.prototype).constructor;for(;h&&h!==l;){const g=h[Jn]||jf(h);if(g&&g!==o)return g;h=Object.getPrototypeOf(h)}return g=>new g})}function jf(n){return mi(n)?()=>{const r=jf(Rn(n));return r&&r()}:he(n)}function Bc(n){const r=n[dn],o=r.type;return 2===o?r.declTNode:1===o?n[Ir]:null}function Wm(n){return function Dx(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const o=n.attrs;if(o){const l=o.length;let h=0;for(;h<l;){const g=o[h];if(za(g))break;if(0===g)h+=2;else if("number"==typeof g)for(h++;h<l&&"string"==typeof o[h];)h++;else{if(g===r)return o[h+1];h+=2}}}return null}(Gr(),n)}const Ku="__parameters__";function Ju(n,r,o){return Ns(()=>{const l=function jm(n){return function(...o){if(n){const l=n(...o);for(const h in l)this[h]=l[h]}}}(r);function h(...g){if(this instanceof h)return l.apply(this,g),this;const b=new h(...g);return E.annotation=b,E;function E(T,V,Y){const Q=T.hasOwnProperty(Ku)?T[Ku]:Object.defineProperty(T,Ku,{value:[]})[Ku];for(;Q.length<=Y;)Q.push(null);return(Q[Y]=Q[Y]||[]).push(b),T}}return o&&(h.prototype=Object.create(o.prototype)),h.prototype.ngMetadataName=n,h.annotationCls=h,h})}function ed(n,r){n.forEach(o=>Array.isArray(o)?ed(o,r):r(o))}function Dy(n,r,o){r>=n.length?n.push(o):n.splice(r,0,o)}function Yf(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function uh(n,r){const o=[];for(let l=0;l<n;l++)o.push(r);return o}function _a(n,r,o){let l=td(n,r);return l>=0?n[1|l]=o:(l=~l,function Iy(n,r,o,l){let h=n.length;if(h==r)n.push(o,l);else if(1===h)n.push(l,n[0]),n[0]=o;else{for(h--,n.push(n[h-1],n[h]);h>r;)n[h]=n[h-2],h--;n[r]=o,n[r+1]=l}}(n,l,r,o)),l}function qm(n,r){const o=td(n,r);if(o>=0)return n[1|o]}function td(n,r){return function Ry(n,r,o){let l=0,h=n.length>>o;for(;h!==l;){const g=l+(h-l>>1),b=n[g<<o];if(r===b)return g<<o;b>r?h=g:l=g+1}return~(h<<o)}(n,r,1)}const Xf=Nr(Ju("Optional"),8),Kf=Nr(Ju("SkipSelf"),4),kc=new de("ENVIRONMENT_INITIALIZER"),Ny=new de("INJECTOR",-1),Zm=new de("INJECTOR_DEF_TYPES");class Jf{get(r,o=Xe){if(o===Xe){const l=new Error(`NullInjectorError: No provider for ${li(r)}!`);throw l.name="NullInjectorError",l}return o}}function Qx(...n){return{\u0275providers:By(0,n),\u0275fromNgModule:!0}}function By(n,...r){const o=[],l=new Set;let h;const g=b=>{o.push(b)};return ed(r,b=>{const E=b;Qf(E,g,[],l)&&(h||(h=[]),h.push(E))}),void 0!==h&&ky(h,g),o}function ky(n,r){for(let o=0;o<n.length;o++){const{ngModule:l,providers:h}=n[o];Jm(h,g=>{r(g,l)})}}function Qf(n,r,o,l){if(!(n=Rn(n)))return!1;let h=null,g=Ds(n);const b=!g&&qi(n);if(g||b){if(b&&!b.standalone)return!1;h=n}else{const T=n.ngModule;if(g=Ds(T),!g)return!1;h=T}const E=l.has(h);if(b){if(E)return!1;if(l.add(h),b.dependencies){const T="function"==typeof b.dependencies?b.dependencies():b.dependencies;for(const V of T)Qf(V,r,o,l)}}else{if(!g)return!1;{if(null!=g.imports&&!E){let V;l.add(h);try{ed(g.imports,Y=>{Qf(Y,r,o,l)&&(V||(V=[]),V.push(Y))})}finally{}void 0!==V&&ky(V,r)}if(!E){const V=he(h)||(()=>new h);r({provide:h,useFactory:V,deps:Li},h),r({provide:Zm,useValue:h,multi:!0},h),r({provide:kc,useValue:()=>ie(h),multi:!0},h)}const T=g.providers;if(null!=T&&!E){const V=n;Jm(T,Y=>{r(Y,V)})}}}return h!==n&&void 0!==n.providers}function Jm(n,r){for(let o of n)hi(o)&&(o=o.\u0275providers),Array.isArray(o)?Jm(o,r):r(o)}const eE=Ut({provide:String,useValue:Ut});function Qm(n){return null!==n&&"object"==typeof n&&eE in n}function Uc(n){return"function"==typeof n}const eg=new de("Set Injector scope."),ep={},nE={};let tg;function tp(){return void 0===tg&&(tg=new Jf),tg}class ul{}class id extends ul{get destroyed(){return this._destroyed}constructor(r,o,l,h){super(),this.parent=o,this.source=l,this.scopes=h,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,ig(r,b=>this.processProvider(b)),this.records.set(Ny,rd(void 0,this)),h.has("environment")&&this.records.set(ul,rd(void 0,this));const g=this.records.get(eg);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(Zm,Li,Di.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();const r=this._onDestroyHooks;this._onDestroyHooks=[];for(const o of r)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(r){return this.assertNotDestroyed(),this._onDestroyHooks.push(r),()=>this.removeOnDestroy(r)}runInContext(r){this.assertNotDestroyed();const o=pr(this),l=ci(void 0);try{return r()}finally{pr(o),ci(l)}}get(r,o=Xe,l=Di.Default){if(this.assertNotDestroyed(),r.hasOwnProperty(fs))return r[fs](this);l=Ke(l);const g=pr(this),b=ci(void 0);try{if(!(l&Di.SkipSelf)){let T=this.records.get(r);if(void 0===T){const V=function aE(n){return"function"==typeof n||"object"==typeof n&&n instanceof de}(r)&&Ts(r);T=V&&this.injectableDefInScope(V)?rd(ng(r),ep):null,this.records.set(r,T)}if(null!=T)return this.hydrate(r,T)}return(l&Di.Self?tp():this.parent).get(r,o=l&Di.Optional&&o===Xe?null:o)}catch(E){if("NullInjectorError"===E.name){if((E[Yt]=E[Yt]||[]).unshift(li(r)),g)throw E;return function Po(n,r,o,l){const h=n[Yt];throw r[Wn]&&h.unshift(r[Wn]),n.message=function ns(n,r,o,l=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let h=li(r);if(Array.isArray(r))h=r.map(li).join(" -> ");else if("object"==typeof r){let g=[];for(let b in r)if(r.hasOwnProperty(b)){let E=r[b];g.push(b+":"+("string"==typeof E?JSON.stringify(E):li(E)))}h=`{${g.join(", ")}}`}return`${o}${l?"("+l+")":""}[${h}]: ${n.replace(Zt,"\n  ")}`}("\n"+n.message,h,o,l),n.ngTokenPath=h,n[Yt]=null,n}(E,r,"R3InjectorError",this.source)}throw E}finally{ci(b),pr(g)}}resolveInjectorInitializers(){const r=pr(this),o=ci(void 0);try{const h=this.get(kc,Li,Di.Self);for(const g of h)g()}finally{pr(r),ci(o)}}toString(){const r=[],o=this.records;for(const l of o.keys())r.push(li(l));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new vn(205,!1)}processProvider(r){let o=Uc(r=Rn(r))?r:Rn(r&&r.provide);const l=function rE(n){return Qm(n)?rd(void 0,n.useValue):rd(zy(n),ep)}(r);if(Uc(r)||!0!==r.multi)this.records.get(o);else{let h=this.records.get(o);h||(h=rd(void 0,ep,!0),h.factory=()=>yi(h.multi),this.records.set(o,h)),o=r,h.multi.push(r)}this.records.set(o,l)}hydrate(r,o){return o.value===ep&&(o.value=nE,o.value=o.factory()),"object"==typeof o.value&&o.value&&function oE(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this._ngOnDestroyHooks.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=Rn(r.providedIn);return"string"==typeof o?"any"===o||this.scopes.has(o):this.injectorDefTypes.has(o)}removeOnDestroy(r){const o=this._onDestroyHooks.indexOf(r);-1!==o&&this._onDestroyHooks.splice(o,1)}}function ng(n){const r=Ts(n),o=null!==r?r.factory:he(n);if(null!==o)return o;if(n instanceof de)throw new vn(204,!1);if(n instanceof Function)return function iE(n){const r=n.length;if(r>0)throw uh(r,"?"),new vn(204,!1);const o=function vo(n){return n&&(n[Tr]||n[Is])||null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new vn(204,!1)}function zy(n,r,o){let l;if(Uc(n)){const h=Rn(n);return he(h)||ng(h)}if(Qm(n))l=()=>Rn(n.useValue);else if(function Vy(n){return!(!n||!n.useFactory)}(n))l=()=>n.useFactory(...yi(n.deps||[]));else if(function Uy(n){return!(!n||!n.useExisting)}(n))l=()=>ie(Rn(n.useExisting));else{const h=Rn(n&&(n.useClass||n.provide));if(!function sE(n){return!!n.deps}(n))return he(h)||ng(h);l=()=>new h(...yi(n.deps))}return l}function rd(n,r,o=!1){return{factory:n,value:r,multi:o?[]:void 0}}function ig(n,r){for(const o of n)Array.isArray(o)?ig(o,r):o&&hi(o)?ig(o.\u0275providers,r):r(o)}function lE(n,r){n instanceof id&&n.assertNotDestroyed();const l=pr(n),h=ci(void 0);try{return r()}finally{pr(l),ci(h)}}function fE(n,r=null,o=null,l){const h=pE(n,r,o,l);return h.resolveInjectorInitializers(),h}function pE(n,r=null,o=null,l,h=new Set){const g=[o||Li,Qx(n)];return l=l||("object"==typeof n?void 0:li(n)),new id(g,r||tp(),l||null,h)}let Wy,Xa=(()=>{var n;class r{static create(l,h){if(Array.isArray(l))return fE({name:""},h,l,"");{var g;const b=null!==(g=l.name)&&void 0!==g?g:"";return fE({name:b},l.parent,l.providers,b)}}}return(n=r).THROW_IF_NOT_FOUND=Xe,n.NULL=new Jf,n.\u0275prov=Hi({token:n,providedIn:"any",factory:()=>ie(Ny)}),n.__NG_ELEMENT_ID__=-1,r})();function Vc(n){return!!Fs(n)}function dA(n){Wy=n}const gE=new de("AppId",{providedIn:"root",factory:()=>hA}),hA="ng",vE=new de("Platform Initializer"),jy=new de("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),fA=new de("CSP nonce",{providedIn:"root",factory:()=>{var n;return(null===(n=function zc(){if(void 0!==Wy)return Wy;if(typeof document<"u")return document;throw new vn(210,!1)}().body)||void 0===n||null===(n=n.querySelector("[ngCspNonce]"))||void 0===n?void 0:n.getAttribute("ngCspNonce"))||null}});function Pa(n){return n instanceof Function?n():n}function op(n){return 128==(128&n.flags)}var lp=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(lp||{});const SE=/^>|^->|<!--|-->|--!>|<!-$/g,CE=/(<|>)/g,AE="\u200b$1\u200b";const cp=new Map;let t0=0;const Vs="__ngContext__";function po(n,r){Rs(r)?(n[Vs]=r[Bs],function r0(n){cp.set(n[Bs],n)}(r)):n[Vs]=r}let dg;function hg(n,r){return dg(n,r)}function gh(n){const r=n[rr];return Ur(r)?r[rr]:r}function h0(n){return p0(n[ae])}function f0(n){return p0(n[ls])}function p0(n){for(;null!==n&&!Ur(n);)n=n[ls];return n}function ld(n,r,o,l,h){if(null!=l){let g,b=!1;Ur(l)?g=l:Rs(l)&&(b=!0,l=l[mr]);const E=Hr(l);0===n&&null!==o?null==h?y0(r,o,E):jc(r,o,E,h||null,!0):1===n&&null!==o?jc(r,o,E,h||null,!0):2===n?function fp(n,r,o){const l=yh(n,r);l&&function GE(n,r,o,l){n.removeChild(r,o,l)}(n,l,r,o)}(r,E,b):3===n&&r.destroyNode(E),null!=g&&function _g(n,r,o,l,h){const g=o[Bo];g!==Hr(o)&&ld(r,n,l,g,h);for(let E=is;E<o.length;E++){const T=o[E];cd(T[dn],T,n,r,l,g)}}(r,n,g,o,h)}}function fg(n,r){return n.createComment(function cg(n){return n.replace(SE,r=>r.replace(CE,AE))}(r))}function dp(n,r,o){return n.createElement(r,o)}function g0(n,r){const o=n[Fi],l=o.indexOf(r);o.splice(l,1)}function vh(n,r){if(n.length<=is)return;const o=is+r,l=n[o];if(l){const h=l[ui];null!==h&&h!==n&&g0(h,l),r>0&&(n[o-1][ls]=l[ls]);const g=Yf(n,is+r);!function FE(n,r){cd(n,r,r[O],2,null,null),r[mr]=null,r[Ir]=null}(l[dn],l);const b=g[$r];null!==b&&b.detachView(g[dn]),l[rr]=null,l[ls]=null,l[pi]&=-129}return l}function hp(n,r){if(!(256&r[pi])){const o=r[O];o.destroyNode&&cd(n,r,o,3,null,null),function UE(n){let r=n[ae];if(!r)return pg(n[dn],n);for(;r;){let o=null;if(Rs(r))o=r[ae];else{const l=r[is];l&&(o=l)}if(!o){for(;r&&!r[ls]&&r!==n;)Rs(r)&&pg(r[dn],r),r=r[rr];null===r&&(r=n),Rs(r)&&pg(r[dn],r),o=r&&r[ls]}r=o}}(r)}}function pg(n,r){if(!(256&r[pi])){r[pi]&=-129,r[pi]|=256,r[Fo]&&function $t(n){if($e(n),bt(n))for(let r=0;r<n.producerNode.length;r++)ot(n.producerNode[r],n.producerIndexOfThis[r]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(r[Fo]),function $E(n,r){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let l=0;l<o.length;l+=2){const h=r[o[l]];if(!(h instanceof nc)){const g=o[l+1];if(Array.isArray(g))for(let b=0;b<g.length;b+=2){const E=h[g[b]],T=g[b+1];qr(4,E,T);try{T.call(E)}finally{qr(5,E,T)}}else{qr(4,h,g);try{g.call(h)}finally{qr(5,h,g)}}}}}(n,r),function HE(n,r){const o=n.cleanup,l=r[Oo];if(null!==o)for(let g=0;g<o.length-1;g+=2)if("string"==typeof o[g]){const b=o[g+3];b>=0?l[b]():l[-b].unsubscribe(),g+=2}else o[g].call(l[o[g+1]]);null!==l&&(r[Oo]=null);const h=r[_o];if(null!==h){r[_o]=null;for(let g=0;g<h.length;g++)(0,h[g])()}}(n,r),1===r[dn].type&&r[O].destroy();const o=r[ui];if(null!==o&&Ur(r[rr])){o!==r[rr]&&g0(o,r);const l=r[$r];null!==l&&l.detachView(n)}!function s0(n){cp.delete(n[Bs])}(r)}}function mg(n,r,o){return function v0(n,r,o){let l=r;for(;null!==l&&40&l.type;)l=(r=l).parent;if(null===l)return o[mr];{const{componentOffset:h}=l;if(h>-1){const{encapsulation:g}=n.data[l.directiveStart+h];if(g===Gi.None||g===Gi.Emulated)return null}return qs(l,o)}}(n,r.parent,o)}function jc(n,r,o,l,h){n.insertBefore(r,o,l,h)}function y0(n,r,o){n.appendChild(r,o)}function _0(n,r,o,l,h){null!==l?jc(n,r,o,l,h):y0(n,r,o)}function yh(n,r){return n.parentNode(r)}function _h(n,r,o){return x0(n,r,o)}let vg,gp,x0=function gg(n,r,o){return 40&n.type?qs(n,o):null};function bh(n,r,o,l){const h=mg(n,l,r),g=r[O],E=_h(l.parent||r[Ir],l,r);if(null!=h)if(Array.isArray(o))for(let T=0;T<o.length;T++)_0(g,h,o[T],E,!1);else _0(g,h,o,E,!1);void 0!==vg&&vg(g,l,r,o,h)}function xh(n,r){if(null!==r){const o=r.type;if(3&o)return qs(r,n);if(4&o)return yg(-1,n[r.index]);if(8&o){const l=r.child;if(null!==l)return xh(n,l);{const h=n[r.index];return Ur(h)?yg(-1,h):Hr(h)}}if(32&o)return hg(r,n)()||Hr(n[r.index]);{const l=w0(n,r);return null!==l?Array.isArray(l)?l[0]:xh(gh(n[en]),l):xh(n,r.next)}}return null}function w0(n,r){return null!==r?n[en][Ir].projection[r.projection]:null}function yg(n,r){const o=is+n+1;if(o<r.length){const l=r[o],h=l[dn].firstChild;if(null!==h)return xh(l,h)}return r[Bo]}function Yc(n,r,o,l,h,g,b){for(;null!=o;){const E=l[o.index],T=o.type;if(b&&0===r&&(E&&po(Hr(E),l),o.flags|=2),32!=(32&o.flags))if(8&T)Yc(n,r,o.child,l,h,g,!1),ld(r,n,h,E,g);else if(32&T){const V=hg(o,l);let Y;for(;Y=V();)ld(r,n,h,Y,g);ld(r,n,h,E,g)}else 16&T?C0(n,r,l,o,h,g):ld(r,n,h,E,g);o=b?o.projectionNext:o.next}}function cd(n,r,o,l,h,g){Yc(o,l,n.firstChild,r,h,g,!1)}function C0(n,r,o,l,h,g){const b=o[en],T=b[Ir].projection[l.projection];if(Array.isArray(T))for(let V=0;V<T.length;V++)ld(r,n,h,T[V],g);else{let V=T;const Y=b[rr];op(l)&&(V.flags|=128),Yc(n,r,V,Y,h,g,!0)}}function A0(n,r,o){""===o?n.removeAttribute(r,"class"):n.setAttribute(r,"class",o)}function bg(n,r,o){const{mergedAttrs:l,classes:h,styles:g}=o;null!==l&&Qo(n,r,l),null!==h&&A0(n,r,h),null!==g&&function YE(n,r,o){n.setAttribute(r,"style",o)}(n,r,g)}function I0(n){var r;return(null===(r=function xg(){if(void 0===gp&&(gp=null,_r.trustedTypes))try{gp=_r.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return gp}())||void 0===r?void 0:r.createScriptURL(n))||n}class R0{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Fr})`}}function oc(n){return n instanceof R0?n.changingThisBreaksApplicationSecurity:n}function Eh(n,r){const o=function ew(n){return n instanceof R0&&n.getTypeName()||null}(n);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see ${Fr})`)}return o===r}const aw=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Ka=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Ka||{});function Ag(n){const r=lc();return r?r.sanitize(Ka.URL,n)||"":Eh(n,"URL")?oc(n):function Eg(n){return(n=String(n)).match(aw)?n:"unsafe:"+n}(xn(n))}function Ch(n){const r=lc();if(r)return I0(r.sanitize(Ka.RESOURCE_URL,n)||"");if(Eh(n,"ResourceURL"))return I0(oc(n));throw new vn(904,!1)}function Dg(n,r,o){return function Tg(n,r){return"src"===r&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===r&&("base"===n||"link"===n)?Ch:Ag}(r,o)(n)}function lc(){const n=qt();return n&&n[$].sanitizer}class V0{}let Ph=(n,r,o)=>null;function Zc(n,r,o=!1){return Ph(n,r,o)}class Lg{}class Og{}class Ep{resolveComponentFactory(r){throw function Ng(n){const r=Error(`No component factory found for ${li(n)}.`);return r.ngComponent=n,r}(r)}}let Jc=(()=>{class r{}return r.NULL=new Ep,r})();function Y0(){return Qc(Gr(),qt())}function Qc(n,r){return new wp(qs(n,r))}let wp=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=Y0,r})();function TA(n){return n instanceof wp?n.nativeElement:n}class q0{}let DA=(()=>{class r{constructor(){this.destroyNode=null}}return r.__NG_ELEMENT_ID__=()=>function IA(){const n=qt(),o=xo(Gr().index,n);return(Rs(o)?o:n)[O]}(),r})(),RA=(()=>{var n;class r{}return(n=r).\u0275prov=Hi({token:n,providedIn:"root",factory:()=>null}),r})();const La={};function Bg(n){const r=Fe(null);try{return n()}finally{Fe(r)}}function vd(n){return!!kg(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function kg(n){return null!==n&&("function"==typeof n||"object"==typeof n)}class Q0{constructor(){}supports(r){return vd(r)}create(r){return new Fh(r)}}const fw=(n,r)=>r;class Fh{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||fw}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,l=this._removalsHead,h=0,g=null;for(;o||l;){const b=!l||o&&o.currentIndex<t_(l,h,g)?o:l,E=t_(b,h,g),T=b.currentIndex;if(b===l)h--,l=l._nextRemoved;else if(o=o._next,null==b.previousIndex)h++;else{g||(g=[]);const V=E-h,Y=T-h;if(V!=Y){for(let we=0;we<V;we++){const ze=we<g.length?g[we]:g[we]=0,Ct=ze+we;Y<=Ct&&Ct<V&&(g[we]=ze+1)}g[b.previousIndex]=Y-V}}E!==T&&r(b,E,T)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!vd(r))throw new vn(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let h,g,b,o=this._itHead,l=!1;if(Array.isArray(r)){this.length=r.length;for(let E=0;E<this.length;E++)g=r[E],b=this._trackByFn(E,g),null!==o&&Object.is(o.trackById,b)?(l&&(o=this._verifyReinsertion(o,g,b,E)),Object.is(o.item,g)||this._addIdentityChange(o,g)):(o=this._mismatch(o,g,b,E),l=!0),o=o._next}else h=0,function J0(n,r){if(Array.isArray(n))for(let o=0;o<n.length;o++)r(n[o]);else{const o=n[Symbol.iterator]();let l;for(;!(l=o.next()).done;)r(l.value)}}(r,E=>{b=this._trackByFn(h,E),null!==o&&Object.is(o.trackById,b)?(l&&(o=this._verifyReinsertion(o,E,b,h)),Object.is(o.item,E)||this._addIdentityChange(o,E)):(o=this._mismatch(o,E,b,h),l=!0),o=o._next,h++}),this.length=h;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,l,h){let g;return null===r?g=this._itTail:(g=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,g,h)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(l,h))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,g,h)):r=this._addAfter(new pw(o,l),g,h),r}_verifyReinsertion(r,o,l,h){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==g?r=this._reinsertAfter(g,r._prev,h):r.currentIndex!=h&&(r.currentIndex=h,this._addToMoves(r,h)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const h=r._prevRemoved,g=r._nextRemoved;return null===h?this._removalsHead=g:h._nextRemoved=g,null===g?this._removalsTail=h:g._prevRemoved=h,this._insertAfter(r,o,l),this._addToMoves(r,l),r}_moveAfter(r,o,l){return this._unlink(r),this._insertAfter(r,o,l),this._addToMoves(r,l),r}_addAfter(r,o,l){return this._insertAfter(r,o,l),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,l){const h=null===o?this._itHead:o._next;return r._next=h,r._prev=o,null===h?this._itTail=r:h._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new e_),this._linkedRecords.put(r),r.currentIndex=l,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,l=r._next;return null===o?this._itHead=l:o._next=l,null===l?this._itTail=o:l._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new e_),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class pw{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class mw{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===o||o<=l.currentIndex)&&Object.is(l.trackById,r))return l;return null}remove(r){const o=r._prevDup,l=r._nextDup;return null===o?this._head=l:o._nextDup=l,null===l?this._tail=o:l._prevDup=o,null===this._head}}class e_{constructor(){this.map=new Map}put(r){const o=r.trackById;let l=this.map.get(o);l||(l=new mw,this.map.set(o,l)),l.add(r)}get(r,o){const h=this.map.get(r);return h?h.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function t_(n,r,o){const l=n.previousIndex;if(null===l)return l;let h=0;return o&&l<o.length&&(h=o[l]),l+r+h}class yd{constructor(){}supports(r){return r instanceof Map||kg(r)}create(){return new n_}}class n_{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||kg(r)))throw new vn(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(l,h)=>{if(o&&o.key===h)this._maybeAddToChanges(o,l),this._appendAfter=o,o=o._next;else{const g=this._getOrCreateRecordForKey(h,l);o=this._insertBeforeOrAppend(o,g)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let l=o;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const l=r._prev;return o._next=r,o._prev=l,r._prev=o,l&&(l._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const h=this._records.get(r);this._maybeAddToChanges(h,o);const g=h._prev,b=h._next;return g&&(g._next=b),b&&(b._prev=g),h._next=null,h._prev=null,h}const l=new gw(r);return this._records.set(r,l),l.currentValue=o,this._addToAdditions(l),l}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(l=>o(r[l],l))}}class gw{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Sp(){return new Ug([new Q0])}let Ug=(()=>{var n;class r{constructor(l){this.factories=l}static create(l,h){if(null!=h){const g=h.factories.slice();l=l.concat(g)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||Sp()),deps:[[r,new Kf,new Xf]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(null!=h)return h;throw new vn(901,!1)}}return(n=r).\u0275prov=Hi({token:n,providedIn:"root",factory:Sp}),r})();function Vg(){return new Cp([new yd])}let Cp=(()=>{var n;class r{constructor(l){this.factories=l}static create(l,h){if(h){const g=h.factories.slice();l=l.concat(g)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||Vg()),deps:[[r,new Kf,new Xf]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(h)return h;throw new vn(901,!1)}}return(n=r).\u0275prov=Hi({token:n,providedIn:"root",factory:Vg}),r})();function Bh(n,r,o,l,h=!1){for(;null!==o;){const g=r[o.index];null!==g&&l.push(Hr(g)),Ur(g)&&kh(g,l);const b=o.type;if(8&b)Bh(n,r,o.child,l);else if(32&b){const E=hg(o,r);let T;for(;T=E();)l.push(T)}else if(16&b){const E=w0(r,o);if(Array.isArray(E))l.push(...E);else{const T=gh(r[en]);Bh(T[dn],T,E,l,!0)}}o=h?o.projectionNext:o.next}return l}function kh(n,r){for(let o=is;o<n.length;o++){const l=n[o],h=l[dn].firstChild;null!==h&&Bh(l[dn],l,h,r)}n[Bo]!==n[mr]&&r.push(n[Bo])}let Uh=[];const Gg={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Lc(n.lView)},consumerOnSignalRead(){this.lView[Fo]=this}};function bd(n){return n.ngOriginalError}class Ja{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r);this._console.error("ERROR",r),o&&this._console.error("ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&bd(r);for(;o&&bd(o);)o=bd(o);return o||null}}const Ap=new de("",{providedIn:"root",factory:()=>oe(Ja).handleError.bind(void 0)}),tu=new de("",{providedIn:"root",factory:()=>!1}),Xi={};function c_(n){u_(sr(),qt(),ce()+n,!1)}function u_(n,r,o,l){if(!l)if(3==(3&r[pi])){const g=n.preOrderCheckHooks;null!==g&&Wo(r,g,o)}else{const g=n.preOrderHooks;null!==g&&wo(r,g,0,o)}it(o)}function fc(n,r=Di.Default){const o=qt();return null===o?ie(n,r):ho(Gr(),o,Rn(n),r)}function d_(){throw new Error("invalid")}function Tp(n,r,o,l,h,g,b,E,T,V,Y){const Q=r.blueprint.slice();return Q[mr]=h,Q[pi]=204|l,(null!==V||n&&2048&n[pi])&&(Q[pi]|=2048),Ml(Q),Q[rr]=Q[_e]=n,Q[xi]=o,Q[$]=b||n&&n[$],Q[O]=E||n&&n[O],Q[so]=T||n&&n[so]||null,Q[Ir]=g,Q[Bs]=function n0(){return t0++}(),Q[xr]=Y,Q[No]=V,Q[en]=2==r.type?n[en]:Q,Q}function Kr(n,r,o,l,h){let g=n.data[r];if(null===g)g=function Ed(n,r,o,l,h){const g=Ls(),b=Uu(),T=n.data[r]=function Yg(n,r,o,l,h,g){let b=r?r.injectorIndex:-1,E=0;return Ps()&&(E|=128),{type:o,index:l,insertBeforeIndex:null,injectorIndex:b,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:E,providerIndexes:0,value:h,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,b?g:g&&g.parent,o,r,l,h);return null===n.firstChild&&(n.firstChild=T),null!==g&&(b?null==g.child&&null!==T.parent&&(g.child=T):null===g.next&&(g.next=T,T.prev=g)),T}(n,r,o,l,h),function Bm(){return fi.lFrame.inI18n}()&&(g.flags|=32);else if(64&g.type){g.type=o,g.value=l,g.attrs=h;const b=function Io(){const n=fi.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();g.injectorIndex=null===b?-1:b.injectorIndex}return lo(g,!0),g}function wd(n,r,o,l){if(0===o)return-1;const h=r.length;for(let g=0;g<o;g++)r.push(l),n.blueprint.push(l),n.data.push(null);return h}function zh(n,r,o,l,h){const g=ce(),b=2&l;try{it(-1),b&&r.length>Ai&&u_(n,r,Ai,!1),qr(b?2:0,h),o(l,h)}finally{it(g),qr(b?3:1,h)}}function Md(n,r,o){if(wl(r)){const l=Fe(null);try{const g=r.directiveEnd;for(let b=r.directiveStart;b<g;b++){const E=n.data[b];E.contentQueries&&E.contentQueries(1,o[b],b)}}finally{Fe(l)}}}function Wg(n,r,o){Bu()&&(function xw(n,r,o,l){const h=o.directiveStart,g=o.directiveEnd;ll(o)&&function Mw(n,r,o){const l=qs(r,n),h=h_(o);let b=16;o.signals?b=4096:o.onPush&&(b=64);const E=Ad(n,Tp(n,h,null,b,l,r,null,n[$].rendererFactory.createRenderer(l,o),null,null,null));n[r.index]=E}(r,o,n.data[h+o.componentOffset]),n.firstCreatePass||So(o,r),po(l,r);const b=o.initialInputs;for(let E=h;E<g;E++){const T=n.data[E],V=cl(r,n,E,o);po(V,r),null!==b&&Sw(0,E-h,V,T,0,b),bo(T)&&(xo(o.index,r)[xi]=cl(r,n,E,o))}}(n,r,o,qs(o,r)),64==(64&o.flags)&&Jg(n,r,o))}function iu(n,r,o=qs){const l=r.localNames;if(null!==l){let h=r.index+1;for(let g=0;g<l.length;g+=2){const b=l[g+1],E=-1===b?o(r,n):n[b];n[h++]=E}}}function h_(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=Dp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):r}function Dp(n,r,o,l,h,g,b,E,T,V,Y){const Q=Ai+l,we=Q+h,ze=function f_(n,r){const o=[];for(let l=0;l<r;l++)o.push(l<n?null:Xi);return o}(Q,we),Ct="function"==typeof V?V():V;return ze[dn]={type:n,blueprint:ze,template:o,queries:null,viewQuery:E,declTNode:r,data:ze.slice().fill(null,Q),bindingStartIndex:Q,expandoStartIndex:we,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof b?b():b,firstChild:null,schemas:T,consts:Ct,incompleteFirstPass:!1,ssrId:Y}}let p_=n=>null;function v_(n,r,o,l){for(let h in n)if(n.hasOwnProperty(h)){o=null===o?{}:o;const g=n[h];null===l?y_(o,r,h,g):l.hasOwnProperty(h)&&y_(o,r,l[h],g)}return o}function y_(n,r,o,l){n.hasOwnProperty(o)?n[o].push(r,l):n[o]=[r,l]}function $h(n,r,o,l){if(Bu()){const h=null===l?null:{"":-1},g=function Ew(n,r){const o=n.directiveRegistry;let l=null,h=null;if(o)for(let b=0;b<o.length;b++){const E=o[b];if(El(r,E.selectors,!1))if(l||(l=[]),bo(E))if(null!==E.findHostDirectiveDefs){const T=[];h=h||new Map,E.findHostDirectiveDefs(E,T,h),l.unshift(...T,E),Qg(n,r,T.length)}else l.unshift(E),Qg(n,r,0);else{var g;h=h||new Map,null===(g=E.findHostDirectiveDefs)||void 0===g||g.call(E,E,l,h),l.push(E)}}return null===l?null:[l,h]}(n,o);let b,E;null===g?b=E=null:[b,E]=g,null!==b&&Rp(n,r,o,b,h,E),h&&function Cd(n,r,o){if(r){const l=n.localNames=[];for(let h=0;h<r.length;h+=2){const g=o[r[h+1]];if(null==g)throw new vn(-301,!1);l.push(r[h],g)}}}(o,l,h)}o.mergedAttrs=Ma(o.mergedAttrs,o.attrs)}function Rp(n,r,o,l,h,g){for(let Q=0;Q<l.length;Q++)Gm(So(o,r),n,l[Q].type);!function ev(n,r,o){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+o,n.providerIndexes=r}(o,n.data.length,l.length);for(let Q=0;Q<l.length;Q++){const we=l[Q];we.providersResolver&&we.providersResolver(we)}let b=!1,E=!1,T=wd(n,r,l.length,null);for(let Q=0;Q<l.length;Q++){const we=l[Q];o.mergedAttrs=Ma(o.mergedAttrs,we.hostAttrs),ww(n,o,r,T,we),Rl(T,we,h),null!==we.contentQueries&&(o.flags|=4),(null!==we.hostBindings||null!==we.hostAttrs||0!==we.hostVars)&&(o.flags|=64);const ze=we.type.prototype;var V,Y;!b&&(ze.ngOnChanges||ze.ngOnInit||ze.ngDoCheck)&&((null!==(V=n.preOrderHooks)&&void 0!==V?V:n.preOrderHooks=[]).push(o.index),b=!0),E||!ze.ngOnChanges&&!ze.ngDoCheck||((null!==(Y=n.preOrderCheckHooks)&&void 0!==Y?Y:n.preOrderCheckHooks=[]).push(o.index),E=!0),T++}!function qg(n,r,o){const h=r.directiveEnd,g=n.data,b=r.attrs,E=[];let T=null,V=null;for(let Y=r.directiveStart;Y<h;Y++){const Q=g[Y],we=o?o.get(Q):null,Ct=we?we.outputs:null;T=v_(Q.inputs,Y,T,we?we.inputs:null),V=v_(Q.outputs,Y,V,Ct);const an=null===T||null===b||rl(r)?null:ru(T,Y,b);E.push(an)}null!==T&&(T.hasOwnProperty("class")&&(r.flags|=8),T.hasOwnProperty("style")&&(r.flags|=16)),r.initialInputs=E,r.inputs=T,r.outputs=V}(n,o,g)}function Jg(n,r,o){const l=o.directiveStart,h=o.directiveEnd,g=o.index,b=function ra(){return fi.lFrame.currentDirectiveIndex}();try{it(g);for(let E=l;E<h;E++){const T=n.data[E],V=r[E];tc(E),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&__(T,V)}}finally{it(-1),tc(b)}}function __(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function Qg(n,r,o){var l;r.componentOffset=o,(null!==(l=n.components)&&void 0!==l?l:n.components=[]).push(r.index)}function Rl(n,r,o){if(o){if(r.exportAs)for(let l=0;l<r.exportAs.length;l++)o[r.exportAs[l]]=n;bo(r)&&(o[""]=n)}}function ww(n,r,o,l,h){n.data[l]=h;const g=h.factory||(h.factory=he(h.type)),b=new nc(g,bo(h),fc);n.blueprint[l]=b,o[l]=b,function Kg(n,r,o,l,h){const g=h.hostBindings;if(g){let b=n.hostBindingOpCodes;null===b&&(b=n.hostBindingOpCodes=[]);const E=~r.index;(function Zg(n){let r=n.length;for(;r>0;){const o=n[--r];if("number"==typeof o&&o<0)return o}return 0})(b)!=E&&b.push(E),b.push(o,l,g)}}(n,r,l,wd(n,o,h.hostVars,Xi),h)}function hl(n,r,o,l,h,g){const b=qs(n,r);!function tv(n,r,o,l,h,g,b){if(null==g)n.removeAttribute(r,h,o);else{const E=null==b?xn(g):b(g,l||"",h);n.setAttribute(r,h,E,o)}}(r[O],b,g,n.value,o,l,h)}function Sw(n,r,o,l,h,g){const b=g[r];if(null!==b)for(let E=0;E<b.length;)ba(l,o,b[E++],b[E++],b[E++])}function ba(n,r,o,l,h){const g=Fe(null);try{const b=n.inputTransforms;null!==b&&b.hasOwnProperty(l)&&(h=b[l].call(r,h)),null!==n.setInput?n.setInput(r,h,o,l):r[l]=h}finally{Fe(g)}}function ru(n,r,o){let l=null,h=0;for(;h<o.length;){const g=o[h];if(0!==g)if(5!==g){if("number"==typeof g)break;if(n.hasOwnProperty(g)){null===l&&(l=[]);const b=n[g];for(let E=0;E<b.length;E+=2)if(b[E]===r){l.push(g,b[E+1],o[h+1]);break}}h+=2}else h+=2;else h+=4}return l}function Pp(n,r,o,l){return[n,!0,0,r,null,l,null,o,null,null]}function nv(n,r){const o=n.contentQueries;if(null!==o){const l=Fe(null);try{for(let h=0;h<o.length;h+=2){const b=o[h+1];if(-1!==b){const E=n.data[b];co(o[h]),E.contentQueries(2,r[b],b)}}}finally{Fe(l)}}}function Ad(n,r){return n[ae]?n[G][ls]=r:n[ae]=r,n[G]=r,r}function Gh(n,r,o){co(0);const l=Fe(null);try{r(n,o)}finally{Fe(l)}}function b_(n){return n[Oo]||(n[Oo]=[])}function Cw(n){return n.cleanup||(n.cleanup=[])}function Lp(n,r){const o=n[so],l=o?o.get(Ja,null):null;l&&l.handleError(r)}function Op(n,r,o,l,h){for(let g=0;g<o.length;){const b=o[g++],E=o[g++];ba(n.data[b],r[b],l,E,h)}}function Aw(n,r,o,l){var h;const g=r[pi];if(256==(256&g))return;null===(h=r[$].inlineEffectRunner)||void 0===h||h.flush(),Bf(r);let E=null,T=null;(function su(n){return 2!==n.type})(n)&&(T=function Hg(n){var r;return null!==(r=n[Fo])&&void 0!==r?r:function $g(n){var r;const o=null!==(r=Uh.pop())&&void 0!==r?r:Object.create(Gg);return o.lView=n,o}(n)}(r),E=function Ze(n){return n&&(n.nextProducerIndex=0),Fe(n)}(T));try{Ml(r),function Vu(n){return fi.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&zh(n,r,o,2,l);const V=3==(3&g);if(V){const we=n.preOrderCheckHooks;null!==we&&Wo(r,we,null)}else{const we=n.preOrderHooks;null!==we&&wo(r,we,0,null),va(r,0)}if(function Dd(n){for(let r=h0(n);null!==r;r=f0(r)){if(!(r[pi]&ha.HasTransplantedViews))continue;const o=r[Fi];for(let l=0;l<o.length;l++){_i(o[l])}}}(r),ou(r,0),null!==n.contentQueries&&nv(n,r),V){const we=n.contentCheckHooks;null!==we&&Wo(r,we)}else{const we=n.contentHooks;null!==we&&wo(r,we,1),va(r,1)}!function xd(n,r){const o=n.hostBindingOpCodes;if(null!==o)try{for(let l=0;l<o.length;l++){const h=o[l];if(h<0)it(~h);else{const g=h,b=o[++l],E=o[++l];Ff(b,g),E(2,r[g])}}}finally{it(-1)}}(n,r);const Y=n.components;null!==Y&&au(r,Y,0);const Q=n.viewQuery;if(null!==Q&&Gh(2,Q,l),V){const we=n.viewCheckHooks;null!==we&&Wo(r,we)}else{const we=n.viewHooks;null!==we&&wo(r,we,2),va(r,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[Aa]){for(const we of r[Aa])we();r[Aa]=null}r[pi]&=-73}catch(V){throw Lc(r),V}finally{null!==T&&(function Je(n,r){if(Fe(r),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(bt(n))for(let o=n.nextProducerIndex;o<n.producerNode.length;o++)ot(n.producerNode[o],n.producerIndexOfThis[o]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}(T,E),function _d(n){n.lView[Fo]!==n&&(n.lView=null,Uh.push(n))}(T)),B()}}function ou(n,r){for(let o=h0(n);null!==o;o=f0(o)){o[pi]&=~ha.HasChildViewsToRefresh;for(let l=is;l<o.length;l++)E_(o[l],r)}}function jh(n,r,o){E_(xo(r,n),o)}function E_(n,r){Jl(n)&&iv(n,r)}function iv(n,r){const l=n[dn],h=n[pi],g=n[Fo];let b=!!(0===r&&16&h);if(b||(b=!!(64&h&&0===r)),b||(b=!!(1024&h)),b||(b=!(null==g||!g.dirty||!et(g))),g&&(g.dirty=!1),n[pi]&=-9217,b)Aw(l,n,l.template,n[xi]);else if(8192&h){ou(n,1);const E=l.components;null!==E&&au(n,E,1)}}function au(n,r,o){for(let l=0;l<r.length;l++)jh(n,r[l],o)}function Id(n){var r;for(null===(r=n[$].changeDetectionScheduler)||void 0===r||r.notify();n;){n[pi]|=64;const o=gh(n);if(fa(n)&&!o)return n;n=o}return null}class Yh{get rootNodes(){const r=this._lView,o=r[dn];return Bh(o,r,o.firstChild,[])}constructor(r,o,l=!0){this._lView=r,this._cdRefInjectingView=o,this.notifyErrorHandler=l,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[xi]}set context(r){this._lView[xi]=r}get destroyed(){return 256==(256&this._lView[pi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[rr];if(Ur(r)){const o=r[8],l=o?o.indexOf(this):-1;l>-1&&(vh(r,l),Yf(o,l))}this._attachedToViewContainer=!1}hp(this._lView[dn],this._lView)}onDestroy(r){ma(this._lView,r)}markForCheck(){Id(this._cdRefInjectingView||this._lView)}detach(){this._lView[pi]&=-129}reattach(){Ql(this._lView),this._lView[pi]|=128}detectChanges(){this._lView[pi]|=1024,function pc(n,r=!0){const o=n[$],l=o.rendererFactory,h=o.afterRenderEventManager;var b;null===(b=l.begin)||void 0===b||b.call(l),null==h||h.begin();try{!function x_(n){iv(n,0);let r=0;for(;ia(n);){if(100===r)throw new vn(103,!1);r++,iv(n,1)}}(n)}catch(V){throw r&&Lp(n,V),V}finally{var E,T;null===(E=l.end)||void 0===E||E.call(l),null===(T=o.inlineEffectRunner)||void 0===T||T.flush(),null==h||h.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new vn(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function kE(n,r){cd(n,r,r[O],2,null,null)}(this._lView[dn],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new vn(902,!1);this._appRef=r,Ql(this._lView)}}let Rd=(()=>{class r{}return r.__NG_ELEMENT_ID__=Ll,r})();function Ll(n){return function Tw(n,r,o){if(ll(n)&&!o){const l=xo(n.index,r);return new Yh(l,l)}return 47&n.type?new Yh(r[en],r):null}(Gr(),qt(),16==(16&n))}let sv=(()=>{var n;class r{}return(n=r).__NG_ELEMENT_ID__=Np,n.__NG_ENV_ID__=o=>o,r})();class UA extends sv{constructor(r){super(),this._lView=r}onDestroy(r){return ma(this._lView,r),()=>function Cl(n,r){if(null===n[_o])return;const o=n[_o].indexOf(r);-1!==o&&n[_o].splice(o,1)}(this._lView,r)}}function Np(){return new UA(qt())}const cv=new Set;function mc(n){var r,o;cv.has(n)||(cv.add(n),null===(r=performance)||void 0===r||null===(o=r.mark)||void 0===o||o.call(r,"mark_feature_usage",{detail:{feature:n}}))}function Xh(n){return r=>{setTimeout(n,void 0,r)}}const ml=class qh extends Xt.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,l){let h=r,g=o||(()=>null),b=l;if(r&&"object"==typeof r){var E,T,V;const Q=r;h=null===(E=Q.next)||void 0===E?void 0:E.bind(Q),g=null===(T=Q.error)||void 0===T?void 0:T.bind(Q),b=null===(V=Q.complete)||void 0===V?void 0:V.bind(Q)}this.__isAsync&&(g=Xh(g),h&&(h=Xh(h)),b&&(b=Xh(b)));const Y=super.subscribe({next:h,error:g,complete:b});return r instanceof Ft.w0&&r.add(Y),Y}};function uv(...n){}class zs{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ml(!1),this.onMicrotaskEmpty=new ml(!1),this.onStable=new ml(!1),this.onError=new ml(!1),typeof Zone>"u")throw new vn(908,!1);Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!l&&o,h.shouldCoalesceRunChangeDetection=l,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function Rw(){const n="function"==typeof _r.requestAnimationFrame;let r=_r[n?"requestAnimationFrame":"setTimeout"],o=_r[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&r&&o){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const h=o[Zone.__symbol__("OriginalDelegate")];h&&(o=h)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function hv(n){const r=()=>{!function Lw(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(_r,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,lu(n),n.isCheckStableRunning=!0,dv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),lu(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,l,h,g,b,E)=>{if(function Ow(n){var r;return!(!Array.isArray(n)||1!==n.length)&&!0===(null===(r=n[0].data)||void 0===r?void 0:r.__ignore_ng_zone__)}(E))return o.invokeTask(h,g,b,E);try{return C_(n),o.invokeTask(h,g,b,E)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||n.shouldCoalesceRunChangeDetection)&&r(),A_(n)}},onInvoke:(o,l,h,g,b,E,T)=>{try{return C_(n),o.invoke(h,g,b,E,T)}finally{n.shouldCoalesceRunChangeDetection&&r(),A_(n)}},onHasTask:(o,l,h,g)=>{o.hasTask(h,g),l===h&&("microTask"==g.change?(n._hasPendingMicrotasks=g.microTask,lu(n),dv(n)):"macroTask"==g.change&&(n.hasPendingMacrotasks=g.macroTask))},onHandleError:(o,l,h,g)=>(o.handleError(h,g),n.runOutsideAngular(()=>n.onError.emit(g)),!1)})}(h)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!zs.isInAngularZone())throw new vn(909,!1)}static assertNotInAngularZone(){if(zs.isInAngularZone())throw new vn(909,!1)}run(r,o,l){return this._inner.run(r,o,l)}runTask(r,o,l,h){const g=this._inner,b=g.scheduleEventTask("NgZoneEvent: "+h,r,Pw,uv,uv);try{return g.runTask(b,o,l)}finally{g.cancelTask(b)}}runGuarded(r,o,l){return this._inner.runGuarded(r,o,l)}runOutsideAngular(r){return this._outer.run(r)}}const Pw={};function dv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function lu(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function C_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function A_(n){n._nesting--,dv(n)}class VA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ml,this.onMicrotaskEmpty=new ml,this.onStable=new ml,this.onError=new ml}run(r,o,l){return r.apply(o,l)}runGuarded(r,o,l){return r.apply(o,l)}runOutsideAngular(r){return r()}runTask(r,o,l,h){return r.apply(o,l)}}var gc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(gc||{});const D_={destroy(){}};function Nw(n,r){var o,l,h;!r&&function rg(n){if(!ir()&&!function $i(){return On}())throw new vn(-203,!1)}();const g=null!==(o=null==r?void 0:r.injector)&&void 0!==o?o:oe(Xa);if(!function Hc(n){return"browser"===(null!=n?n:oe(Xa)).get(jy)}(g))return D_;mc("NgAfterNextRender");const b=g.get(Zh),E=null!==(l=b.handler)&&void 0!==l?l:b.handler=new Bw,T=null!==(h=null==r?void 0:r.phase)&&void 0!==h?h:gc.MixedReadWrite,V=()=>{E.unregister(Q),Y()},Y=g.get(sv).onDestroy(V),Q=new Fw(g,T,()=>{V(),n()});return E.register(Q),{destroy:V}}class Fw{constructor(r,o,l){this.phase=o,this.callbackFn=l,this.zone=r.get(zs),this.errorHandler=r.get(Ja,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(o){var r;null===(r=this.errorHandler)||void 0===r||r.handleError(o)}}}class Bw{constructor(){this.executingCallbacks=!1,this.buckets={[gc.EarlyRead]:new Set,[gc.Write]:new Set,[gc.MixedReadWrite]:new Set,[gc.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new vn(102,!1)}register(r){(this.executingCallbacks?this.deferredCallbacks:this.buckets[r.phase]).add(r)}unregister(r){this.buckets[r.phase].delete(r),this.deferredCallbacks.delete(r)}execute(){this.executingCallbacks=!0;for(const r of Object.values(this.buckets))for(const o of r)o.invoke();this.executingCallbacks=!1;for(const r of this.deferredCallbacks)this.buckets[r.phase].add(r);this.deferredCallbacks.clear()}destroy(){for(const r of Object.values(this.buckets))r.clear();this.deferredCallbacks.clear()}}let Zh=(()=>{var n;class r{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){var l;null===(l=this.handler)||void 0===l||l.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){var l;for(const h of this.internalCallbacks)h();this.internalCallbacks.length=0,null===(l=this.handler)||void 0===l||l.execute()}}ngOnDestroy(){var l;null===(l=this.handler)||void 0===l||l.destroy(),this.handler=null,this.internalCallbacks.length=0}}return(n=r).\u0275prov=Hi({token:n,providedIn:"root",factory:()=>new n}),r})();function R_(n,r){const o=xo(r,n),l=o[dn];!function cu(n,r){for(let o=r.length;o<n.blueprint.length;o++)r.push(n.blueprint[o])}(l,o);const h=o[mr];null!==h&&null===o[xr]&&(o[xr]=Zc(h,o[so])),P_(l,o,o[xi])}function P_(n,r,o){Bf(r);try{const l=n.viewQuery;null!==l&&Gh(1,l,o);const h=n.template;null!==h&&zh(n,r,h,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&nv(n,r),n.staticViewQueries&&Gh(2,n.viewQuery,o);const g=n.components;null!==g&&function kw(n,r){for(let o=0;o<r.length;o++)R_(n,r[o])}(r,g)}catch(l){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),l}finally{r[pi]&=-5,B()}}function Jh(n,r,o){let l=o?n.styles:null,h=o?n.classes:null,g=0;if(null!==r)for(let b=0;b<r.length;b++){const E=r[b];"number"==typeof E?g=E:1==g?h=Gn(h,E):2==g&&(l=Gn(l,E+": "+r[++b]+";"))}o?n.styles=l:n.stylesWithoutHost=l,o?n.classes=h:n.classesWithoutHost=h}class vc extends Jc{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=qi(r);return new Fp(o,this.ngModule)}}function fv(n){const r=[];for(let o in n)n.hasOwnProperty(o)&&r.push({propName:n[o],templateName:o});return r}class uu{constructor(r,o){this.injector=r,this.parentInjector=o}get(r,o,l){l=Ke(l);const h=this.injector.get(r,La,l);return h!==La||o===La?h:this.parentInjector.get(r,o,l)}}class Fp extends Og{get inputs(){const r=this.componentDef,o=r.inputTransforms,l=fv(r.inputs);if(null!==o)for(const h of l)o.hasOwnProperty(h.propName)&&(h.transform=o[h.propName]);return l}get outputs(){return fv(this.componentDef.outputs)}constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function Sa(n){return n.map(Tu).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}create(r,o,l,h){var b;let E=(h=h||this.ngModule)instanceof ul?h:null===(b=h)||void 0===b?void 0:b.injector;E&&null!==this.componentDef.getStandaloneInjector&&(E=this.componentDef.getStandaloneInjector(E)||E);const T=E?new uu(r,E):r,V=T.get(q0,null);if(null===V)throw new vn(407,!1);const ze={rendererFactory:V,sanitizer:T.get(RA,null),inlineEffectRunner:null,afterRenderEventManager:T.get(Zh,null),changeDetectionScheduler:T.get(V0,null)},Ct=V.createRenderer(null,this.componentDef),an=this.componentDef.selectors[0][0]||"div",gn=l?function Hh(n,r,o,l){const g=l.get(tu,!1)||o===Gi.ShadowDom,b=n.selectRootElement(r,g);return function jg(n){p_(n)}(b),b}(Ct,l,this.componentDef.encapsulation,T):dp(Ct,an,function Uw(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(an));let Hn=512;this.componentDef.signals?Hn|=4096:this.componentDef.onPush||(Hn|=16);let rn=null;null!==gn&&(rn=Zc(gn,T,!0));const Bi=Dp(0,null,null,1,0,null,null,null,null,null,null),Qi=Tp(null,Bi,null,Hn,null,null,ze,Ct,T,null,rn);let Vr,ko;Bf(Qi);try{const Cu=this.componentDef;let Rm,YC=null;Cu.findHostDirectiveDefs?(Rm=[],YC=new Map,Cu.findHostDirectiveDefs(Cu,Rm,YC),Rm.push(Cu)):Rm=[Cu];const FI=function du(n,r){const o=n[dn],l=Ai;return n[l]=r,Kr(o,l,2,"#host",null)}(Qi,gn),BI=function L_(n,r,o,l,h,g,b){const E=h[dn];!function Vw(n,r,o,l){for(const h of n)r.mergedAttrs=Ma(r.mergedAttrs,h.hostAttrs);null!==r.mergedAttrs&&(Jh(r,r.mergedAttrs,!0),null!==o&&bg(l,o,r))}(l,n,r,b);let T=null;null!==r&&(T=Zc(r,h[so]));const V=g.rendererFactory.createRenderer(r,o);let Y=16;o.signals?Y=4096:o.onPush&&(Y=64);const Q=Tp(h,h_(o),null,Y,h[n.index],n,g,V,null,null,T);return E.firstCreatePass&&Qg(E,n,l.length-1),Ad(h,Q),h[n.index]=Q}(FI,gn,Cu,Rm,Qi,ze,Ct);ko=Ho(Bi,Ai),gn&&function HA(n,r,o,l){if(l)Qo(n,o,["ng-version","17.0.8"]);else{const{attrs:h,classes:g}=function Cc(n){const r=[],o=[];let l=1,h=2;for(;l<n.length;){let g=n[l];if("string"==typeof g)2===h?""!==g&&r.push(g,n[++l]):8===h&&o.push(g);else{if(!Ao(h))break;h=g}l++}return{attrs:r,classes:o}}(r.selectors[0]);h&&Qo(n,o,h),g&&g.length>0&&A0(n,o,g.join(" "))}}(Ct,Cu,gn,l),void 0!==o&&function $A(n,r,o){const l=n.projection=[];for(let h=0;h<r.length;h++){const g=o[h];l.push(null!=g?Array.from(g):null)}}(ko,this.ngContentSelectors,o),Vr=function hu(n,r,o,l,h,g){const b=Gr(),E=h[dn],T=qs(b,h);Rp(E,h,b,o,null,l);for(let Y=0;Y<o.length;Y++)po(cl(h,E,b.directiveStart+Y,b),h);Jg(E,h,b),T&&po(T,h);const V=cl(h,E,b.directiveStart+b.componentOffset,b);if(n[xi]=h[xi]=V,null!==g)for(const Y of g)Y(V,r);return Md(E,b,n),V}(BI,Cu,Rm,YC,Qi,[zw]),P_(Bi,Qi,null)}finally{B()}return new zA(this.componentType,Vr,Qc(ko,Qi),Qi,ko)}}class zA extends Lg{constructor(r,o,l,h,g){super(),this.location=l,this._rootLView=h,this._tNode=g,this.previousInputValues=null,this.instance=o,this.hostView=this.changeDetectorRef=new Yh(h,void 0,!1),this.componentType=r}setInput(r,o){const l=this._tNode.inputs;let h;if(null!==l&&(h=l[r])){var g;if(null!==(g=this.previousInputValues)&&void 0!==g||(this.previousInputValues=new Map),this.previousInputValues.has(r)&&Object.is(this.previousInputValues.get(r),o))return;const b=this._rootLView;Op(b[dn],b,h,r,o),this.previousInputValues.set(r,o),Id(xo(this._tNode.index,b))}}get injector(){return new cs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function zw(){const n=Gr();Ia(qt()[dn],n)}function pv(n){let r=function Bp(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),o=!0;const l=[n];for(;r;){let h;if(bo(n))h=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new vn(903,!1);h=r.\u0275dir}if(h){if(o){l.push(h);const b=n;b.inputs=kp(n.inputs),b.inputTransforms=kp(n.inputTransforms),b.declaredInputs=kp(n.declaredInputs),b.outputs=kp(n.outputs);const E=h.hostBindings;E&&Gw(n,E);const T=h.viewQuery,V=h.contentQueries;if(T&&Hw(n,T),V&&$w(n,V),ti(n.inputs,h.inputs),ti(n.declaredInputs,h.declaredInputs),ti(n.outputs,h.outputs),null!==h.inputTransforms&&(null===b.inputTransforms&&(b.inputTransforms={}),ti(b.inputTransforms,h.inputTransforms)),bo(h)&&h.data.animation){const Y=n.data;Y.animation=(Y.animation||[]).concat(h.data.animation)}}const g=h.features;if(g)for(let b=0;b<g.length;b++){const E=g[b];E&&E.ngInherit&&E(n),E===pv&&(o=!1)}}r=Object.getPrototypeOf(r)}!function mv(n){let r=0,o=null;for(let l=n.length-1;l>=0;l--){const h=n[l];h.hostVars=r+=h.hostVars,h.hostAttrs=Ma(h.hostAttrs,o=Ma(o,h.hostAttrs))}}(l)}function kp(n){return n===Dr?{}:n===Li?[]:n}function Hw(n,r){const o=n.viewQuery;n.viewQuery=o?(l,h)=>{r(l,h),o(l,h)}:r}function $w(n,r){const o=n.contentQueries;n.contentQueries=o?(l,h,g)=>{r(l,h,g),o(l,h,g)}:r}function Gw(n,r){const o=n.hostBindings;n.hostBindings=o?(l,h)=>{r(l,h),o(l,h)}:r}function gv(n){const r=n.inputConfig,o={};for(const l in r)if(r.hasOwnProperty(l)){const h=r[l];Array.isArray(h)&&h[2]&&(o[l]=h[2])}n.inputTransforms=o}function mo(n,r,o){return!Object.is(n[r],o)&&(n[r]=o,!0)}function Qh(n,r,o,l){const h=qt();return mo(h,$o(),r)&&(sr(),hl(At(),h,n,r,o,l)),Qh}function xv(n,r){return n<<17|r<<2}function vu(n){return n>>17&32767}function Ld(n){return 2|n}function yc(n){return(131068&n)>>2}function B_(n,r){return-131069&n|r<<2}function vs(n){return 1|n}function Qw(n,r,o,l,h){const g=n[o+1],b=null===r;let E=l?vu(g):yc(g),T=!1;for(;0!==E&&(!1===T||b);){const Y=n[E+1];YA(n[E],r)&&(T=!0,n[E+1]=l?vs(Y):Ld(Y)),E=l?vu(Y):yc(Y)}T&&(n[o+1]=l?Ld(g):vs(g))}function YA(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&td(n,r)>=0}function $p(n,r,o){const l=qt();return mo(l,$o(),r)&&function qo(n,r,o,l,h,g,b,E){const T=qs(r,o);let Y,V=r.inputs;!E&&null!=V&&(Y=V[l])?(Op(n,o,Y,l,h),ll(r)&&function Xg(n,r){const o=xo(r,n);16&o[pi]||(o[pi]|=64)}(o,r.index)):3&r.type&&(l=function Ip(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(l),h=null!=b?b(h,r.value||"",l):h,g.setProperty(T,l,h))}(sr(),At(),l,n,r,l[O],o,!1),$p}function Gp(n,r,o,l,h){const b=h?"class":"style";Op(n,o,r.inputs[b],b,l)}function ds(n,r){return function Ji(n,r,o,l){const h=qt(),g=sr(),b=function Ss(n){const r=fi.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,o}(2);g.firstUpdatePass&&function Wp(n,r,o,l){const h=n.data;if(null===h[o+1]){const g=h[ce()],b=function Fl(n,r){return r>=n.expandoStartIndex}(n,o);(function H_(n,r){return 0!=(n.flags&(r?8:16))})(g,l)&&null===r&&!b&&(r=!1),r=function Mv(n,r,o,l){const h=function zu(n){const r=fi.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let g=l?r.residualClasses:r.residualStyles;if(null===h)0===(l?r.classBindings:r.styleBindings)&&(o=Fa(o=Nd(null,n,r,o,l),r.attrs,l),g=null);else{const b=r.directiveStylingLast;if(-1===b||n[b]!==h)if(o=Nd(h,n,r,o,l),null===g){let T=function oM(n,r,o){const l=o?r.classBindings:r.styleBindings;if(0!==yc(l))return n[vu(l)]}(n,r,l);void 0!==T&&Array.isArray(T)&&(T=Nd(null,n,r,T[1],l),T=Fa(T,r.attrs,l),function aM(n,r,o,l){n[vu(o?r.classBindings:r.styleBindings)]=l}(n,r,l,T))}else g=function lM(n,r,o){let l;const h=r.directiveEnd;for(let g=1+r.directiveStylingLast;g<h;g++)l=Fa(l,n[g].hostAttrs,o);return Fa(l,r.attrs,o)}(n,r,l)}return void 0!==g&&(l?r.residualClasses=g:r.residualStyles=g),o}(h,g,r,l),function Hp(n,r,o,l,h,g){let b=g?r.classBindings:r.styleBindings,E=vu(b),T=yc(b);n[l]=o;let Y,V=!1;if(Array.isArray(o)?(Y=o[1],(null===Y||td(o,Y)>0)&&(V=!0)):Y=o,h)if(0!==T){const we=vu(n[E+1]);n[l+1]=xv(we,E),0!==we&&(n[we+1]=B_(n[we+1],l)),n[E+1]=function F_(n,r){return 131071&n|r<<17}(n[E+1],l)}else n[l+1]=xv(E,0),0!==E&&(n[E+1]=B_(n[E+1],l)),E=l;else n[l+1]=xv(T,0),0===E?E=l:n[T+1]=B_(n[T+1],l),T=l;V&&(n[l+1]=Ld(n[l+1])),Qw(n,Y,l,!0),Qw(n,Y,l,!1),function jA(n,r,o,l,h){const g=h?n.residualClasses:n.residualStyles;null!=g&&"string"==typeof r&&td(g,r)>=0&&(o[l+1]=vs(o[l+1]))}(r,Y,n,l,g),b=xv(E,T),g?r.classBindings=b:r.styleBindings=b}(h,g,r,o,b,l)}}(g,n,b,l),r!==Xi&&mo(h,b,r)&&function V_(n,r,o,l,h,g,b,E){if(!(3&r.type))return;const T=n.data,V=T[E+1],Y=function zp(n){return 1==(1&n)}(V)?z_(T,r,o,h,yc(V),b):void 0;Yp(Y)||(Yp(g)||function WA(n){return 2==(2&n)}(V)&&(g=z_(T,null,o,h,E,b)),function jE(n,r,o,l,h){if(r)h?n.addClass(o,l):n.removeClass(o,l);else{let g=-1===l.indexOf("-")?void 0:lp.DashCase;null==h?n.removeStyle(o,l,g):("string"==typeof h&&h.endsWith("!important")&&(h=h.slice(0,-10),g|=lp.Important),n.setStyle(o,l,h,g))}}(l,b,function Ga(n,r){return Hr(r[n])}(ce(),o),h,g))}(g,g.data[ce()],h,h[O],n,h[b+1]=function cM(n,r){return null==n||""===n||("string"==typeof r?n+=r:"object"==typeof n&&(n=li(oc(n)))),n}(r,o),l,b)}(n,r,null,!0),ds}function Nd(n,r,o,l,h){let g=null;const b=o.directiveEnd;let E=o.directiveStylingLast;for(-1===E?E=o.directiveStart:E++;E<b&&(g=r[E],l=Fa(l,g.hostAttrs,h),g!==n);)E++;return null!==n&&(o.directiveStylingLast=E),l}function Fa(n,r,o){const l=o?1:2;let h=-1;if(null!==r)for(let g=0;g<r.length;g++){const b=r[g];"number"==typeof b?h=b:h===l&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),_a(n,b,!!o||r[++g]))}return void 0===n?null:n}function z_(n,r,o,l,h,g){const b=null===r;let E;for(;h>0;){const T=n[h],V=Array.isArray(T),Y=V?T[1]:T,Q=null===Y;let we=o[h+1];we===Xi&&(we=Q?Li:void 0);let ze=Q?qm(we,l):Y===l?we:void 0;if(V&&!Yp(ze)&&(ze=qm(T,l)),Yp(ze)&&(E=ze,b))return E;const Ct=n[h+1];h=b?vu(Ct):yc(Ct)}if(null!==r){let T=g?r.residualClasses:r.residualStyles;null!=T&&(E=qm(T,l))}return E}function Yp(n){return void 0!==n}function _u(n,r){return!r||null===r.firstChild||op(n)}function Vd(n,r,o,l=!0){const h=r[dn];if(function VE(n,r,o,l){const h=is+l,g=o.length;l>0&&(o[h-1][ls]=r),l<g-is?(r[ls]=o[h],Dy(o,is+l,r)):(o.push(r),r[ls]=null),r[rr]=o;const b=r[ui];null!==b&&o!==b&&function zE(n,r){const o=n[Fi];r[en]!==r[rr][rr][en]&&(n[pi]|=ha.HasTransplantedViews),null===o?n[Fi]=[r]:o.push(r)}(b,r);const E=r[$r];null!==E&&E.insertView(n),Ql(r),r[pi]|=128}(h,r,n,o),l){const b=yg(o,n),E=r[O],T=yh(E,n[Bo]);null!==T&&function BE(n,r,o,l,h,g){l[mr]=h,l[Ir]=r,cd(n,l,o,1,h,g)}(h,n[Ir],E,r,T,b)}const g=r[xr];null!==g&&null!==g.firstChild&&(g.firstChild=null)}let tm=(()=>{class r{}return r.__NG_ELEMENT_ID__=ff,r})();function ff(){return Q_(Gr(),qt())}const PM=tm,Z_=class extends PM{constructor(r,o,l){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=l}get element(){return Qc(this._hostTNode,this._hostLView)}get injector(){return new cs(this._hostTNode,this._hostLView)}get parentInjector(){const r=Vf(this._hostTNode,this._hostLView);if(Gu(r)){const o=Wu(r,this._hostLView),l=rc(r);return new cs(o[dn].data[l+8],o)}return new cs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=J_(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-is}createEmbeddedView(r,o,l){let h,g;"number"==typeof l?h=l:null!=l&&(h=l.index,g=l.injector);const E=r.createEmbeddedViewImpl(o||{},g,null);return this.insertImpl(E,h,_u(this._hostTNode,null)),E}createComponent(r,o,l,h,g){var b,T;const V=r&&!function ch(n){return"function"==typeof n}(r);let Y;if(V)Y=o;else{const Hn=o||{};Y=Hn.index,l=Hn.injector,h=Hn.projectableNodes,g=Hn.environmentInjector||Hn.ngModuleRef}const Q=V?r:new Fp(qi(r)),we=l||this.parentInjector;if(!g&&null==Q.ngModule){const rn=(V?we:this.parentInjector).get(ul,null);rn&&(g=rn)}const ze=qi(null!==(b=Q.componentType)&&void 0!==b?b:{}),Ct=(null==ze?void 0:ze.id,null),an=null!==(T=null==Ct?void 0:Ct.firstChild)&&void 0!==T?T:null,gn=Q.create(we,h,an,g);return this.insertImpl(gn.hostView,Y,_u(this._hostTNode,Ct)),gn}insert(r,o){return this.insertImpl(r,o,!0)}insertImpl(r,o,l){const h=r._lView;if(function Nu(n){return Ur(n[rr])}(h)){const E=this.indexOf(r);if(-1!==E)this.detach(E);else{const T=h[rr],V=new Z_(T,T[Ir],T[rr]);V.detach(V.indexOf(r))}}const g=this._adjustIndex(o),b=this._lContainer;return Vd(b,h,g,l),r.attachToViewContainerRef(),Dy(Lv(b),g,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=J_(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),l=vh(this._lContainer,o);l&&(Yf(Lv(this._lContainer),o),hp(l[dn],l))}detach(r){const o=this._adjustIndex(r,-1),l=vh(this._lContainer,o);return l&&null!=Yf(Lv(this._lContainer),o)?new Yh(l):null}_adjustIndex(r,o=0){return null==r?this.length+o:r}};function J_(n){return n[8]}function Lv(n){return n[8]||(n[8]=[])}function Q_(n,r){let o;const l=r[n.index];return Ur(l)?o=l:(o=Pp(l,r,null,n),r[n.index]=o,Ad(r,o)),eb(o,r,n,l),new Z_(o,n,r)}let eb=function tb(n,r,o,l){if(n[Bo])return;let h;h=8&o.type?Hr(l):function LM(n,r){const o=n[O],l=o.createComment(""),h=qs(r,n);return jc(o,yh(o,h),l,function WE(n,r){return n.nextSibling(r)}(o,h),!1),l}(r,o),n[Bo]=h},Ov=(n,r,o)=>!1;function $d(n,r,o,l,h,g,b,E){const T=qt(),V=sr(),Y=n+Ai,Q=V.firstCreatePass?function BM(n,r,o,l,h,g,b,E,T){const V=r.consts,Y=Kr(r,n,4,b||null,na(V,E));$h(r,o,Y,na(V,T)),Ia(r,Y);const Q=Y.tView=Dp(2,Y,l,h,g,r.directiveRegistry,r.pipeRegistry,null,r.schemas,V,null);return null!==r.queries&&(r.queries.template(r,Y),Q.queries=r.queries.embeddedTView(Y)),Y}(Y,V,T,r,o,l,h,g,b):V.data[Y];lo(Q,!1);const we=kM(V,T,Q,n);qa()&&bh(V,T,we,Q),po(we,T);const ze=Pp(we,T,we,Q);return T[Y]=ze,Ad(T,ze),function OM(n,r,o){return Ov(n,r,o)}(ze,Q,T),ql(Q)&&Wg(V,T,Q),null!=b&&iu(T,Q,E),$d}let kM=function UM(n,r,o,l){return oa(!0),r[O].createComment("")};function dm(n,r,o,l){const h=qt(),g=sr(),b=Ai+n,E=h[O],T=g.firstCreatePass?function yS(n,r,o,l,h,g){const b=r.consts,T=Kr(r,n,2,l,na(b,h));return $h(r,o,T,na(b,g)),null!==T.attrs&&Jh(T,T.attrs,!1),null!==T.mergedAttrs&&Jh(T,T.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,T),T}(b,g,h,r,o,l):g.data[b],V=bb(g,h,T,E,r,n);h[b]=V;const Y=ql(T);return lo(T,!0),bg(E,V,T),32!=(32&T.flags)&&qa()&&bh(g,h,V,T),0===function ah(){return fi.lFrame.elementDepthCount}()&&po(V,h),function Fu(){fi.lFrame.elementDepthCount++}(),Y&&(Wg(g,h,T),Md(g,T,h)),null!==l&&iu(h,T),dm}function hm(){let n=Gr();Uu()?Da():(n=n.parent,lo(n,!1));const r=n;(function ja(n){return fi.skipHydrationRootTNode===n})(r)&&function Lf(){fi.skipHydrationRootTNode=null}(),function xy(){fi.lFrame.elementDepthCount--}();const o=sr();return o.firstCreatePass&&(Ia(o,n),wl(n)&&o.queries.elementEnd(n)),null!=r.classesWithoutHost&&function $u(n){return 0!=(8&n.flags)}(r)&&Gp(o,r,qt(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function km(n){return 0!=(16&n.flags)}(r)&&Gp(o,r,qt(),r.stylesWithoutHost,!1),hm}function jv(n,r,o,l){return dm(n,r,o,l),hm(),jv}let bb=(n,r,o,l,h,g)=>(oa(!0),dp(l,h,function Lr(){return fi.lFrame.currentNamespace}()));function Yv(n,r,o){const l=qt(),h=sr(),g=n+Ai,b=h.firstCreatePass?function oT(n,r,o,l,h){const g=r.consts,b=na(g,l),E=Kr(r,n,8,"ng-container",b);return null!==b&&Jh(E,b,!0),$h(r,o,E,na(g,h)),null!==r.queries&&r.queries.elementStart(r,E),E}(g,h,l,r,o):h.data[g];lo(b,!0);const E=xb(h,l,b,n);return l[g]=E,qa()&&bh(h,l,E,b),po(E,l),ql(b)&&(Wg(h,l,b),Md(h,b,l)),null!=o&&iu(l,b),Yv}function qv(){let n=Gr();const r=sr();return Uu()?Da():(n=n.parent,lo(n,!1)),r.firstCreatePass&&(Ia(r,n),wl(n)&&r.queries.elementEnd(n)),qv}function Xv(n,r,o){return Yv(n,r,o),qv(),Xv}let xb=(n,r,o,l)=>(oa(!0),fg(r[O],""));const wu=void 0;var hs=["en",[["a","p"],["AM","PM"],wu],[["AM","PM"],wu,wu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wu,"{1} 'at' {0}",wu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ES(n){const o=Math.floor(Math.abs(n)),l=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===l?1:5}];let Xd={};function bc(n){const r=function wS(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=Cb(r);if(o)return o;const l=r.split("-")[0];if(o=Cb(l),o)return o;if("en"===l)return hs;throw new vn(701,!1)}function Sb(n){return bc(n)[Zd.PluralCase]}function Cb(n){return n in Xd||(Xd[n]=_r.ng&&_r.ng.common&&_r.ng.common.locales&&_r.ng.common.locales[n]),Xd[n]}var Zd=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Zd||{});const Jd="en-US";let Ab=Jd;function Xb(n){return!!n&&"function"==typeof n.then}function Kb(n){return!!n&&"function"==typeof n.subscribe}function Af(n,r,o,l){const h=qt(),g=sr(),b=Gr();return function xm(n,r,o,l,h,g,b){const E=ql(l),V=n.firstCreatePass&&Cw(n),Y=r[xi],Q=b_(r);let we=!0;if(3&l.type||b){const an=qs(l,r),gn=b?b(an):an,Hn=Q.length,rn=b?Qi=>b(Hr(Qi[l.index])):l.index;let Bi=null;if(!b&&E&&(Bi=function hT(n,r,o,l){const h=n.cleanup;if(null!=h)for(let g=0;g<h.length-1;g+=2){const b=h[g];if(b===o&&h[g+1]===l){const E=r[Oo],T=h[g+2];return E.length>T?E[T]:null}"string"==typeof b&&(g+=2)}return null}(n,r,h,l.index)),null!==Bi)(Bi.__ngLastListenerFn__||Bi).__ngNextListenerFn__=g,Bi.__ngLastListenerFn__=g,we=!1;else{g=aC(l,r,Y,g,!1);const Qi=o.listen(gn,h,g);Q.push(g,Qi),V&&V.push(h,rn,Hn,Hn+1)}}else g=aC(l,r,Y,g,!1);const ze=l.outputs;let Ct;if(we&&null!==ze&&(Ct=ze[h])){const an=Ct.length;if(an)for(let gn=0;gn<an;gn+=2){const Vr=r[Ct[gn]][Ct[gn+1]].subscribe(g),ko=Q.length;Q.push(g,Vr),V&&V.push(h,l.index,ko,-(ko+1))}}}(g,h,h[O],b,n,r,l),Af}function oC(n,r,o,l){try{return qr(6,r,o),!1!==o(l)}catch(h){return Lp(n,h),!1}finally{qr(7,r,o)}}function aC(n,r,o,l,h){return function g(b){if(b===Function)return l;Id(n.componentOffset>-1?xo(n.index,r):r);let T=oC(r,o,l,b),V=g.__ngNextListenerFn__;for(;V;)T=oC(r,o,V,b)&&T,V=V.__ngNextListenerFn__;return h&&!1===T&&b.preventDefault(),T}}function lC(n=1){return function J(n){return(fi.lFrame.contextLView=function Sl(n,r){for(;n>0;)r=r[_e],n--;return r}(n,fi.lFrame.contextLView))[xi]}(n)}function Zb(n,r){let o=null;const l=function jl(n){const r=n.attrs;if(null!=r){const o=r.indexOf(5);if(!(1&o))return r[o+1]}return null}(n);for(let h=0;h<r.length;h++){const g=r[h];if("*"!==g){if(null===l?El(n,g,!0):Yl(l,g))return h}else o=h}return o}function cC(n){const r=qt()[en][Ir];if(!r.projection){const l=r.projection=uh(n?n.length:1,null),h=l.slice();let g=r.child;for(;null!==g;){const b=n?Zb(g,n):0;null!==b&&(h[b]?h[b].projectionNext=g:l[b]=g,h[b]=g),g=g.next}}}function uC(n,r=0,o){const l=qt(),h=sr(),g=Kr(h,Ai+n,16,null,o||null);null===g.projection&&(g.projection=r),Da(),(!l[xr]||Ps())&&32!=(32&g.flags)&&function S0(n,r,o){C0(r[O],0,r,o,mg(n,o,r),_h(o.parent||r[Ir],o,r))}(h,l,g)}function ux(n,r=""){const o=qt(),l=sr(),h=n+Ai,g=l.firstCreatePass?Kr(l,h,1,r,null):l.data[h],b=dx(l,o,g,r,n);o[h]=b,qa()&&bh(l,o,b,g),lo(g,!1)}let dx=(n,r,o,l,h)=>(oa(!0),function up(n,r){return n.createText(r)}(r[O],l));function oy(n,r,o,l,h){if(n=Rn(n),Array.isArray(n))for(let g=0;g<n.length;g++)oy(n[g],r,o,l,h);else{const g=sr(),b=qt(),E=Gr();let T=Uc(n)?n:Rn(n.provide);const V=zy(n),Y=1048575&E.providerIndexes,Q=E.directiveStart,we=E.providerIndexes>>20;if(Uc(n)||!n.multi){const ze=new nc(V,h,fc),Ct=Tf(T,r,h?Y:Y+we,Q);-1===Ct?(Gm(So(E,b),g,T),ay(g,n,r.length),r.push(T),E.directiveStart++,E.directiveEnd++,h&&(E.providerIndexes+=1048576),o.push(ze),b.push(ze)):(o[Ct]=ze,b[Ct]=ze)}else{const ze=Tf(T,r,Y+we,Q),Ct=Tf(T,r,Y,Y+we),gn=Ct>=0&&o[Ct];if(h&&!gn||!h&&!(ze>=0&&o[ze])){Gm(So(E,b),g,T);const Hn=function AC(n,r,o,l,h){const g=new nc(n,o,fc);return g.multi=[],g.index=r,g.componentProviders=0,Cm(g,h,l&&!o),g}(h?CC:SC,o.length,h,l,V);!h&&gn&&(o[Ct].providerFactory=Hn),ay(g,n,r.length,0),r.push(T),E.directiveStart++,E.directiveEnd++,h&&(E.providerIndexes+=1048576),o.push(Hn),b.push(Hn)}else ay(g,n,ze>-1?ze:Ct,Cm(o[h?Ct:ze],V,!h&&l));!h&&l&&gn&&o[Ct].componentProviders++}}}function ay(n,r,o,l){const h=Uc(r),g=function tE(n){return!!n.useClass}(r);if(h||g){const T=(g?Rn(r.useClass):r).prototype.ngOnDestroy;if(T){const V=n.destroyHooks||(n.destroyHooks=[]);if(!h&&r.multi){const Y=V.indexOf(o);-1===Y?V.push(o,[l,T]):V[Y+1].push(l,T)}else V.push(o,T)}}}function Cm(n,r,o){return o&&n.componentProviders++,n.multi.push(r)-1}function Tf(n,r,o,l){for(let h=o;h<l;h++)if(r[h]===n)return h;return-1}function SC(n,r,o,l){return ly(this.multi,[])}function CC(n,r,o,l){const h=this.multi;let g;if(this.providerFactory){const b=this.providerFactory.componentProviders,E=cl(o,o[dn],this.providerFactory.index,l);g=E.slice(0,b),ly(h,g);for(let T=b;T<E.length;T++)g.push(E[T])}else g=[],ly(h,g);return g}function ly(n,r){for(let o=0;o<n.length;o++)r.push((0,n[o])());return r}function cy(n,r=[]){return o=>{o.providersResolver=(l,h)=>function MC(n,r,o){const l=sr();if(l.firstCreatePass){const h=bo(n);oy(o,l.data,l.blueprint,h,!0),oy(r,l.data,l.blueprint,h,!1)}}(l,h?h(n):n,r)}}class Mu{}class uy{}function TC(n,r){return new dy(n,null!=r?r:null,[])}class dy extends Mu{constructor(r,o,l){super(),this._parent=o,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vc(this);const h=Fs(r);this._bootstrapComponents=Pa(h.bootstrap),this._r3Injector=pE(r,o,[{provide:Mu,useValue:this},{provide:Jc,useValue:this.componentFactoryResolver},...l],li(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class hy extends uy{constructor(r){super(),this.moduleType=r}create(r){return new dy(this.moduleType,r,[])}}class d extends Mu{constructor(r){super(),this.componentFactoryResolver=new vc(this),this.instance=null;const o=new id([...r.providers,{provide:Mu,useValue:this},{provide:Jc,useValue:this.componentFactoryResolver}],r.parent||tp(),r.debugName,new Set(["environment"]));this.injector=o,r.runEnvironmentInitializers&&o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function e(n,r,o=null){return new d({providers:n,parent:r,debugName:o,runEnvironmentInitializers:!0}).injector}let t=(()=>{var n;class r{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l)){const h=By(0,l.type),g=h.length>0?e([h],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l,g)}return this.cachedInjectors.get(l)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return(n=r).\u0275prov=Hi({token:n,providedIn:"environment",factory:()=>new n(ie(ul))}),r})();function i(n){mc("NgStandalone"),n.getStandaloneInjector=r=>r.get(t).getOrCreateStandaloneInjector(n)}function ri(){return this._results[Symbol.iterator]()}class si{get changes(){var r;return null!==(r=this._changes)&&void 0!==r?r:this._changes=new ml}constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const o=si.prototype;o[Symbol.iterator]||(o[Symbol.iterator]=ri)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){this.dirty=!1;const l=function aa(n){return n.flat(Number.POSITIVE_INFINITY)}(r);(this._changesDetected=!function Fx(n,r,o){if(n.length!==r.length)return!1;for(let l=0;l<n.length;l++){let h=n[l],g=r[l];if(o&&(h=o(h),g=o(g)),g!==h)return!1}return!0}(this._results,l,o))&&(this._results=l,this.length=l.length,this.last=l[this.length-1],this.first=l[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let Ti=(()=>{class r{}return r.__NG_ELEMENT_ID__=Te,r})();const br=Ti,ys=class extends br{constructor(r,o,l){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=l}get ssrId(){var r;return(null===(r=this._declarationTContainer.tView)||void 0===r?void 0:r.ssrId)||null}createEmbeddedView(r,o){return this.createEmbeddedViewImpl(r,o)}createEmbeddedViewImpl(r,o,l){const h=function Ud(n,r,o,l){var h,g;const b=r.tView,V=Tp(n,b,o,4096&n[pi]?4096:16,null,r,null,null,null,null!==(h=null==l?void 0:l.injector)&&void 0!==h?h:null,null!==(g=null==l?void 0:l.dehydratedView)&&void 0!==g?g:null);V[ui]=n[r.index];const Q=n[$r];return null!==Q&&(V[$r]=Q.createEmbeddedView(b)),P_(b,V,o),V}(this._declarationLView,this._declarationTContainer,r,{injector:o,dehydratedView:l});return new Yh(h)}};function Te(){return fe(Gr(),qt())}function fe(n,r){return 4&n.type?new ys(r,n,Qc(n,r)):null}class Ot{constructor(r){this.queryList=r,this.matches=null}clone(){return new Ot(this.queryList)}setDirty(){this.queryList.setDirty()}}class Tn{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const l=null!==r.contentQueries?r.contentQueries[0]:o.length,h=[];for(let g=0;g<l;g++){const b=o.getByIndex(g);h.push(this.queries[b.indexInDeclarationView].clone())}return new Tn(h)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==gr(r,o).matches&&this.queries[o].setDirty()}}class mn{constructor(r,o,l=null){this.predicate=r,this.flags=o,this.read=l}}class In{constructor(r=[]){this.queries=r}elementStart(r,o){for(let l=0;l<this.queries.length;l++)this.queries[l].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let l=0;l<this.length;l++){const h=null!==o?o.length:0,g=this.getByIndex(l).embeddedTView(r,h);g&&(g.indexInDeclarationView=l,null!==o?o.push(g):o=[g])}return null!==o?new In(o):null}template(r,o){for(let l=0;l<this.queries.length;l++)this.queries[l].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class vi{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new vi(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let l=r.parent;for(;null!==l&&8&l.type&&l.index!==o;)l=l.parent;return o===(null!==l?l.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const l=this.metadata.predicate;if(Array.isArray(l))for(let h=0;h<l.length;h++){const g=l[h];this.matchTNodeWithReadOption(r,o,Pn(o,g)),this.matchTNodeWithReadOption(r,o,Hf(o,r,g,!1,!1))}else l===Ti?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,Hf(o,r,l,!1,!1))}matchTNodeWithReadOption(r,o,l){if(null!==l){const h=this.metadata.read;if(null!==h)if(h===wp||h===tm||h===Ti&&4&o.type)this.addMatch(o.index,-2);else{const g=Hf(o,r,h,!1,!1);null!==g&&this.addMatch(o.index,g)}else this.addMatch(o.index,l)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function Pn(n,r){const o=n.localNames;if(null!==o)for(let l=0;l<o.length;l+=2)if(o[l]===r)return o[l+1];return null}function We(n,r,o,l){return-1===o?function zt(n,r){return 11&n.type?Qc(n,r):4&n.type?fe(n,r):null}(r,n):-2===o?function hn(n,r,o){return o===wp?Qc(r,n):o===Ti?fe(r,n):o===tm?Q_(r,n):void 0}(n,r,l):cl(n,n[dn],o,r)}function Zn(n,r,o,l){const h=r[$r].queries[l];if(null===h.matches){const g=n.data,b=o.matches,E=[];for(let T=0;T<b.length;T+=2){const V=b[T];E.push(V<0?null:We(r,g[V],b[T+1],o.metadata.read))}h.matches=E}return h.matches}function Un(n,r,o,l){const h=n.queries.getByIndex(o),g=h.matches;if(null!==g){const b=Zn(n,r,h,o);for(let E=0;E<g.length;E+=2){const T=g[E];if(T>0)l.push(b[E/2]);else{const V=g[E+1],Y=r[-T];for(let Q=is;Q<Y.length;Q++){const we=Y[Q];we[ui]===we[rr]&&Un(we[dn],we,V,l)}if(null!==Y[Fi]){const Q=Y[Fi];for(let we=0;we<Q.length;we++){const ze=Q[we];Un(ze[dn],ze,V,l)}}}}}return l}function Xn(n){const r=qt(),o=sr(),l=Yn();co(l+1);const h=gr(o,l);if(n.dirty&&function ta(n){return 4==(4&n[pi])}(r)===(2==(2&h.metadata.flags))){if(null===h.matches)n.reset([]);else{const g=h.crossesNgTemplate?Un(o,r,l,[]):Zn(o,r,h,l);n.reset(g,TA),n.notifyOnChanges()}return!0}return!1}function ji(n,r,o){const l=sr();l.firstCreatePass&&(wn(l,new mn(n,r,o),-1),2==(2&r)&&(l.staticViewQueries=!0)),Ht(l,qt(),r)}function wr(n,r,o,l){const h=sr();if(h.firstCreatePass){const g=Gr();wn(h,new mn(r,o,l),g.index),function zn(n,r){const o=n.contentQueries||(n.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,r)}(h,n),2==(2&o)&&(h.staticContentQueries=!0)}Ht(h,qt(),o)}function nt(){return function Kn(n,r){return n[$r].queries[r].queryList}(qt(),Yn())}function Ht(n,r,o){const l=new si(4==(4&o));(function g_(n,r,o,l){const h=b_(r);h.push(o),n.firstCreatePass&&Cw(n).push(l,h.length-1)})(n,r,l,l.destroy),null===r[$r]&&(r[$r]=new Tn),r[$r].queries.push(new Ot(l))}function wn(n,r,o){null===n.queries&&(n.queries=new In),n.queries.track(new vi(r,o))}function gr(n,r){return n.queries.getByIndex(r)}class vT{constructor(r){this.full=r;const o=r.split(".");this.major=o[0],this.minor=o[1],this.patch=o.slice(2).join(".")}}let yT=(()=>{var n;class r{log(l){console.log(l)}warn(l){console.warn(l)}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),r})();class pD{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let mD=(()=>{var n;class r{compileModuleSync(l){return new hy(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const h=this.compileModuleSync(l),b=Pa(Fs(l).declarations).reduce((E,T)=>{const V=qi(T);return V&&E.push(new Fp(V)),E},[]);return new pD(h,b)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})(),PC=(()=>{var n;class r{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new It.X(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const l=this.taskId++;return this.pendingTasks.add(l),l}remove(l){this.pendingTasks.delete(l),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})();const wT=new de(""),MT=new de("");let OC,VD=(()=>{var n;class r{constructor(l,h,g){this._ngZone=l,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,OC||(function zD(n){OC=n}(g),g.addToWindow(h)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{zs.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(l)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,h,g){let b=-1;h&&h>0&&(b=setTimeout(()=>{this._callbacks=this._callbacks.filter(E=>E.timeoutId!==b),l(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:l,timeoutId:b,updateCb:g})}whenStable(l,h,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,h,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,h,g){return[]}}return(n=r).\u0275fac=function(l){return new(l||n)(ie(zs),ie(ST),ie(MT))},n.\u0275prov=Hi({token:n,factory:n.\u0275fac}),r})(),ST=(()=>{var n;class r{constructor(){this._applications=new Map}registerApplication(l,h){this._applications.set(l,h)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,h=!0){var g,b;return null!==(g=null===(b=OC)||void 0===b?void 0:b.findTestabilityInTree(this,l,h))&&void 0!==g?g:null}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),r})();const CT=new de("Application Initializer");let NC=(()=>{var n;class r{constructor(){var l;this.initialized=!1,this.done=!1,this.donePromise=new Promise((h,g)=>{this.resolve=h,this.reject=g}),this.appInits=null!==(l=oe(CT,{optional:!0}))&&void 0!==l?l:[]}runInitializers(){if(this.initialized)return;const l=[];for(const g of this.appInits){const b=g();if(Xb(b))l.push(b);else if(Kb(b)){const E=new Promise((T,V)=>{b.subscribe({complete:T,error:V})});l.push(E)}}const h=()=>{this.done=!0,this.resolve()};Promise.all(l).then(()=>{h()}).catch(g=>{this.reject(g)}),0===l.length&&h(),this.initialized=!0}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})();const FC=new de("appBootstrapListener");function DT(n,r){return Array.isArray(r)?r.reduce(DT,n):{...n,...r}}let Dm=(()=>{var n;class r{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=oe(Ap),this.componentTypes=[],this.components=[],this.isStable=oe(PC).hasPendingTasks.pipe((0,tn.U)(l=>!l)),this._injector=oe(ul)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,h){const g=l instanceof Og;if(!this._injector.get(NC).done)throw!g&&ws(l),new vn(405,!1);let E;E=g?l:this._injector.get(Jc).resolveComponentFactory(l),this.componentTypes.push(E.componentType);const T=function $D(n){return n.isBoundToModule}(E)?void 0:this._injector.get(Mu),Y=E.create(Xa.NULL,[],h||E.selector,T),Q=Y.location.nativeElement,we=Y.injector.get(wT,null);return null==we||we.registerApplication(Q),Y.onDestroy(()=>{this.detachView(Y.hostView),bx(this.components,Y),null==we||we.unregisterApplication(Q)}),this._loadComponent(Y),Y}tick(){if(this._runningTick)throw new vn(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this.internalErrorHandler(l)}finally{this._runningTick=!1}}attachView(l){const h=l;this._views.push(h),h.attachToAppRef(this)}detachView(l){const h=l;bx(this._views,h),h.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l);const h=this._injector.get(FC,[]);[...this._bootstrapListeners,...h].forEach(g=>g(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>bx(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new vn(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})();function bx(n,r){const o=n.indexOf(r);o>-1&&n.splice(o,1)}let WD=(()=>{var n;class r{constructor(){this.zone=oe(zs),this.applicationRef=oe(Dm)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){var l;null===(l=this._onMicrotaskEmptySubscription)||void 0===l||l.unsubscribe()}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})();function jD(){const n=oe(zs),r=oe(Ja);return o=>n.runOutsideAngular(()=>r.handleError(o))}let qD=(()=>{var n;class r{constructor(){this.subscription=new Ft.w0,this.initialized=!1,this.zone=oe(zs),this.pendingTasks=oe(PC)}initialize(){if(this.initialized)return;this.initialized=!0;let l=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(l=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{zs.assertNotInAngularZone(),queueMicrotask(()=>{null!==l&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(l),l=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{var h;zs.assertInAngularZone(),null!==(h=l)&&void 0!==h||(l=this.pendingTasks.add())}))}ngOnDestroy(){this.subscription.unsubscribe()}}return(n=r).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),r})();const xx=new de("LocaleId",{providedIn:"root",factory:()=>oe(xx,Di.Optional|Di.SkipSelf)||function XD(){return typeof $localize<"u"&&$localize.locale||Jd}()}),KD=new de("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"}),BC=new de("PlatformDestroyListeners");let LT=(()=>{var n;class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,h){const g=function T_(n="zone.js",r){return"noop"===n?new VA:"zone.js"===n?new zs(r):n}(null==h?void 0:h.ngZone,function PT(n){var r,o;return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:null!==(r=null==n?void 0:n.eventCoalescing)&&void 0!==r&&r,shouldCoalesceRunChangeDetection:null!==(o=null==n?void 0:n.runCoalescing)&&void 0!==o&&o}}({eventCoalescing:null==h?void 0:h.ngZoneEventCoalescing,runCoalescing:null==h?void 0:h.ngZoneRunCoalescing}));return g.run(()=>{const b=function pT(n,r,o){return new dy(n,r,o)}(l.moduleType,this.injector,function RT(n){return[{provide:zs,useFactory:n},{provide:kc,multi:!0,useFactory:()=>{const r=oe(WD,{optional:!0});return()=>r.initialize()}},{provide:kc,multi:!0,useFactory:()=>{const r=oe(qD);return()=>{r.initialize()}}},{provide:Ap,useFactory:jD}]}(()=>g)),E=b.injector.get(Ja,null);return g.runOutsideAngular(()=>{const T=g.onError.subscribe({next:V=>{E.handleError(V)}});b.onDestroy(()=>{bx(this._modules,b),T.unsubscribe()})}),function TT(n,r,o){try{const l=o();return Xb(l)?l.catch(h=>{throw r.runOutsideAngular(()=>n.handleError(h)),h}):l}catch(l){throw r.runOutsideAngular(()=>n.handleError(l)),l}}(E,g,()=>{const T=b.injector.get(NC);return T.runInitializers(),T.donePromise.then(()=>(function Tb(n){cr(n,"Expected localeId to be defined"),"string"==typeof n&&(Ab=n.toLowerCase().replace(/_/g,"-"))}(b.injector.get(xx,Jd)||Jd),this._moduleDoBootstrap(b),b))})})}bootstrapModule(l,h=[]){const g=DT({},h);return function HD(n,r,o){const l=new hy(o);return Promise.resolve(l)}(0,0,l).then(b=>this.bootstrapModuleFactory(b,g))}_moduleDoBootstrap(l){const h=l.injector.get(Dm);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(g=>h.bootstrap(g));else{if(!l.instance.ngDoBootstrap)throw new vn(-403,!1);l.instance.ngDoBootstrap(h)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new vn(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const l=this._injector.get(BC,null);l&&(l.forEach(h=>h()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(n=r).\u0275fac=function(l){return new(l||n)(ie(Xa))},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),r})(),ih=null;const OT=new de("AllowMultipleToken");function NT(n,r,o=[]){const l=`Platform: ${r}`,h=new de(l);return(g=[])=>{let b=kC();if(!b||b.injector.get(OT,!1)){const E=[...o,...g,{provide:h,useValue:!0}];n?n(E):function JD(n){if(ih&&!ih.get(OT,!1))throw new vn(400,!1);(function AT(){!function Mi(n){ln=n}(()=>{throw new vn(600,!1)})})(),ih=n;const r=n.get(LT);(function BT(n){const r=n.get(vE,null);null==r||r.forEach(o=>o())})(n)}(function FT(n=[],r){return Xa.create({name:r,providers:[{provide:eg,useValue:"platform"},{provide:BC,useValue:new Set([()=>ih=null])},...n]})}(E,l))}return function QD(n){const r=kC();if(!r)throw new vn(401,!1);return r}()}}function kC(){var n,r;return null!==(n=null===(r=ih)||void 0===r?void 0:r.get(LT))&&void 0!==n?n:null}function tI(){}const oI=NT(null,"core",[]);let aI=(()=>{var n;class r{constructor(l){}}return(n=r).\u0275fac=function(l){return new(l||n)(ie(Dm))},n.\u0275mod=Lo({type:n}),n.\u0275inj=bs({}),r})();function PI(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function OI(n,r){const o=qi(n),l=r.elementInjector||tp();return new Fp(o).create(l,r.projectableNodes,r.hostElement,r.environmentInjector)}function NI(n){const r=qi(n);if(!r)return null;const o=new Fp(r);return{get selector(){return o.selector},get type(){return o.componentType},get inputs(){return o.inputs},get outputs(){return o.outputs},get ngContentSelectors(){return o.ngContentSelectors},get isStandalone(){return r.standalone},get isSignal(){return r.signals}}}},95:(Qn,Vt,re)=>{"use strict";re.d(Vt,{u5:()=>xi,Fd:()=>Sa,qQ:()=>ol,Cf:()=>$e,JU:()=>je,a5:()=>ki});var p=re(9212),Ye=(re(6814),re(7715)),Pe=re(5592),ft=re(7453),Fe=re(4829),Be=re(4564),Dt=re(8251),Pt=re(7400),yt=re(2714),mt=re(7398);const je=new p.OlP("NgValueAccessor");function ot($){return null==$||("string"==typeof $||Array.isArray($))&&0===$.length}const $e=new p.OlP("NgValidators");function Oe($){return null}function ye($){return null!=$}function Ie($){return(0,p.QGY)($)?(0,Ye.D)($):$}function xe($){let O={};return $.forEach(ae=>{O=null!=ae?{...O,...ae}:O}),0===Object.keys(O).length?null:O}function wt($,O){return O.map(ae=>ae($))}function un($){return $.map(O=>function ut($){return!$.validate}(O)?O:ae=>O.validate(ae))}function yn($){return null!=$?function Mn($){if(!$)return null;const O=$.filter(ye);return 0==O.length?null:function(ae){return xe(wt(ae,O))}}(un($)):null}function ai($){return null!=$?function Ln($){if(!$)return null;const O=$.filter(ye);return 0==O.length?null:function(ae){return function Le(...$){const O=(0,Be.jO)($),{args:ae,keys:G}=(0,ft.D)($),_e=new Pe.y(en=>{const{length:ui}=ae;if(!ui)return void en.complete();const Rr=new Array(ui);let $r=ui,Bs=ui;for(let No=0;No<ui;No++){let _o=!1;(0,Fe.Xf)(ae[No]).subscribe((0,Dt.x)(en,Aa=>{_o||(_o=!0,Bs--),Rr[No]=Aa},()=>$r--,void 0,()=>{(!$r||!_o)&&(Bs||en.next(G?(0,yt.n)(G,Rr):Rr),en.complete())}))}});return O?_e.pipe((0,Pt.Z)(O)):_e}(wt(ae,O).map(Ie)).pipe((0,mt.U)(xe))}}(un($)):null}class li{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(O){this._rawValidators=O||[],this._composedValidatorFn=yn(this._rawValidators)}_setAsyncValidators(O){this._rawAsyncValidators=O||[],this._composedAsyncValidatorFn=ai(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(O){this._onDestroyCallbacks.push(O)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(O=>O()),this._onDestroyCallbacks=[]}reset(O=void 0){this.control&&this.control.reset(O)}hasError(O,ae){return!!this.control&&this.control.hasError(O,ae)}getError(O,ae){return this.control?this.control.getError(O,ae):null}}class ki extends li{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}const io=new p.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>js}),js="always";let oe=(()=>{var $;class O{}return($=O).\u0275fac=function(G){return new(G||$)},$.\u0275mod=p.oAB({type:$}),$.\u0275inj=p.cJS({}),O})();function Yl($){return"number"==typeof $?$:parseFloat($)}let Uo=(()=>{var $;class O{constructor(){this._validator=Oe}ngOnChanges(G){if(this.inputName in G){const _e=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(_e),this._validator=this._enabled?this.createValidator(_e):Oe,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}}return($=O).\u0275fac=function(G){return new(G||$)},$.\u0275dir=p.lG2({type:$,features:[p.TTD]}),O})();const Tu={provide:$e,useExisting:(0,p.Gpc)(()=>Sa),multi:!0};let Sa=(()=>{var $;class O extends Uo{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=G=>Yl(G),this.createValidator=G=>function at($){return O=>{if(ot(O.value)||ot($))return null;const ae=parseFloat(O.value);return!isNaN(ae)&&ae>$?{max:{max:$,actual:O.value}}:null}}(G)}}return($=O).\u0275fac=(()=>{let ae;return function(_e){return(ae||(ae=p.n5z($)))(_e||$)}})(),$.\u0275dir=p.lG2({type:$,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(G,_e){2&G&&p.uIk("max",_e._enabled?_e.max:null)},inputs:{max:"max"},features:[p._Bn([Tu]),p.qOj]}),O})();const Cc={provide:$e,useExisting:(0,p.Gpc)(()=>ol),multi:!0};let ol=(()=>{var $;class O extends Uo{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=G=>Yl(G),this.createValidator=G=>function Ce($){return O=>{if(ot(O.value)||ot($))return null;const ae=parseFloat(O.value);return!isNaN(ae)&&ae<$?{min:{min:$,actual:O.value}}:null}}(G)}}return($=O).\u0275fac=(()=>{let ae;return function(_e){return(ae||(ae=p.n5z($)))(_e||$)}})(),$.\u0275dir=p.lG2({type:$,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(G,_e){2&G&&p.uIk("min",_e._enabled?_e.min:null)},inputs:{min:"min"},features:[p._Bn([Cc]),p.qOj]}),O})(),Ha=(()=>{var $;class O{}return($=O).\u0275fac=function(G){return new(G||$)},$.\u0275mod=p.oAB({type:$}),$.\u0275inj=p.cJS({imports:[oe]}),O})(),xi=(()=>{var $;class O{static withConfig(G){var _e;return{ngModule:O,providers:[{provide:io,useValue:null!==(_e=G.callSetDisabledState)&&void 0!==_e?_e:js}]}}}return($=O).\u0275fac=function(G){return new(G||$)},$.\u0275mod=p.oAB({type:$}),$.\u0275inj=p.cJS({imports:[Ha]}),O})()},6593:(Qn,Vt,re)=>{"use strict";re.d(Vt,{Dx:()=>Gn,b2:()=>It,q6:()=>ai});var p=re(9212),se=re(6814);class Ye extends se.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Pe extends Ye{static makeCurrent(){(0,se.HT)(new Pe)}onAndCancel(qe,_t,ke){return qe.addEventListener(_t,ke),()=>{qe.removeEventListener(_t,ke)}}dispatchEvent(qe,_t){qe.dispatchEvent(_t)}remove(qe){qe.parentNode&&qe.parentNode.removeChild(qe)}createElement(qe,_t){return(_t=_t||this.getDefaultDocument()).createElement(qe)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(qe){return qe.nodeType===Node.ELEMENT_NODE}isShadowRoot(qe){return qe instanceof DocumentFragment}getGlobalEventTarget(qe,_t){return"window"===_t?window:"document"===_t?qe:"body"===_t?qe.body:null}getBaseHref(qe){const _t=function Fe(){return ft=ft||document.querySelector("base"),ft?ft.getAttribute("href"):null}();return null==_t?null:function Be(kt){return new URL(kt,document.baseURI).pathname}(_t)}resetBaseElement(){ft=null}getUserAgent(){return window.navigator.userAgent}getCookie(qe){return(0,se.Mx)(document.cookie,qe)}}let ft=null,Pt=(()=>{var kt;class qe{build(){return new XMLHttpRequest}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();const yt=new p.OlP("EventManagerPlugins");let Le=(()=>{var kt;class qe{constructor(ke,gt){this._zone=gt,this._eventNameToPlugin=new Map,ke.forEach(sn=>{sn.manager=this}),this._plugins=ke.slice().reverse()}addEventListener(ke,gt,sn){return this._findPluginFor(gt).addEventListener(ke,gt,sn)}getZone(){return this._zone}_findPluginFor(ke){let gt=this._eventNameToPlugin.get(ke);if(gt)return gt;if(gt=this._plugins.find(Sn=>Sn.supports(ke)),!gt)throw new p.vHH(5101,!1);return this._eventNameToPlugin.set(ke,gt),gt}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(yt),p.LFG(p.R0b))},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();class mt{constructor(qe){this._doc=qe}}const ct="ng-app-id";let tt=(()=>{var kt;class qe{constructor(ke,gt,sn,Sn={}){this.doc=ke,this.appId=gt,this.nonce=sn,this.platformId=Sn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,se.PM)(Sn),this.resetHostNodes()}addStyles(ke){for(const gt of ke)1===this.changeUsageCount(gt,1)&&this.onStyleAdded(gt)}removeStyles(ke){for(const gt of ke)this.changeUsageCount(gt,-1)<=0&&this.onStyleRemoved(gt)}ngOnDestroy(){const ke=this.styleNodesInDOM;ke&&(ke.forEach(gt=>gt.remove()),ke.clear());for(const gt of this.getAllStyles())this.onStyleRemoved(gt);this.resetHostNodes()}addHost(ke){this.hostNodes.add(ke);for(const gt of this.getAllStyles())this.addStyleToHost(ke,gt)}removeHost(ke){this.hostNodes.delete(ke)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(ke){for(const gt of this.hostNodes)this.addStyleToHost(gt,ke)}onStyleRemoved(ke){var gt;const sn=this.styleRef;null===(gt=sn.get(ke))||void 0===gt||null===(gt=gt.elements)||void 0===gt||gt.forEach(Sn=>Sn.remove()),sn.delete(ke)}collectServerRenderedStyles(){var ke;const gt=null===(ke=this.doc.head)||void 0===ke?void 0:ke.querySelectorAll(`style[${ct}="${this.appId}"]`);if(null!=gt&&gt.length){const sn=new Map;return gt.forEach(Sn=>{null!=Sn.textContent&&sn.set(Sn.textContent,Sn)}),sn}return null}changeUsageCount(ke,gt){const sn=this.styleRef;if(sn.has(ke)){const Sn=sn.get(ke);return Sn.usage+=gt,Sn.usage}return sn.set(ke,{usage:gt,elements:[]}),gt}getStyleElement(ke,gt){const sn=this.styleNodesInDOM,Sn=null==sn?void 0:sn.get(gt);if((null==Sn?void 0:Sn.parentNode)===ke)return sn.delete(gt),Sn.removeAttribute(ct),Sn;{const ni=this.doc.createElement("style");return this.nonce&&ni.setAttribute("nonce",this.nonce),ni.textContent=gt,this.platformIsServer&&ni.setAttribute(ct,this.appId),ke.appendChild(ni),ni}}addStyleToHost(ke,gt){var sn;const Sn=this.getStyleElement(ke,gt),ni=this.styleRef,Ri=null===(sn=ni.get(gt))||void 0===sn?void 0:sn.elements;Ri?Ri.push(Sn):ni.set(gt,{elements:[Sn],usage:1})}resetHostNodes(){const ke=this.hostNodes;ke.clear(),ke.add(this.doc.head)}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(se.K0),p.LFG(p.AFp),p.LFG(p.Ojb,8),p.LFG(p.Lbi))},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();const je={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Rt=/%COMP%/g,st=new p.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function $e(kt,qe){return qe.map(_t=>_t.replace(Rt,kt))}let me=(()=>{var kt;class qe{constructor(ke,gt,sn,Sn,ni,Ri,Ui,Yr=null){this.eventManager=ke,this.sharedStylesHost=gt,this.appId=sn,this.removeStylesOnCompDestroy=Sn,this.doc=ni,this.platformId=Ri,this.ngZone=Ui,this.nonce=Yr,this.rendererByCompId=new Map,this.platformIsServer=(0,se.PM)(Ri),this.defaultRenderer=new ve(ke,ni,Ui,this.platformIsServer)}createRenderer(ke,gt){if(!ke||!gt)return this.defaultRenderer;this.platformIsServer&&gt.encapsulation===p.ifc.ShadowDom&&(gt={...gt,encapsulation:p.ifc.Emulated});const sn=this.getOrCreateRenderer(ke,gt);return sn instanceof ln?sn.applyToHost(ke):sn instanceof dt&&sn.applyStyles(),sn}getOrCreateRenderer(ke,gt){const sn=this.rendererByCompId;let Sn=sn.get(gt.id);if(!Sn){const ni=this.doc,Ri=this.ngZone,Ui=this.eventManager,Yr=this.sharedStylesHost,cr=this.removeStylesOnCompDestroy,qn=this.platformIsServer;switch(gt.encapsulation){case p.ifc.Emulated:Sn=new ln(Ui,Yr,gt,this.appId,cr,ni,Ri,qn);break;case p.ifc.ShadowDom:return new lt(Ui,Yr,ke,gt,ni,Ri,this.nonce,qn);default:Sn=new dt(Ui,Yr,gt,cr,ni,Ri,qn)}sn.set(gt.id,Sn)}return Sn}ngOnDestroy(){this.rendererByCompId.clear()}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(Le),p.LFG(tt),p.LFG(p.AFp),p.LFG(st),p.LFG(se.K0),p.LFG(p.Lbi),p.LFG(p.R0b),p.LFG(p.Ojb))},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();class ve{constructor(qe,_t,ke,gt){this.eventManager=qe,this.doc=_t,this.ngZone=ke,this.platformIsServer=gt,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(qe,_t){return _t?this.doc.createElementNS(je[_t]||_t,qe):this.doc.createElement(qe)}createComment(qe){return this.doc.createComment(qe)}createText(qe){return this.doc.createTextNode(qe)}appendChild(qe,_t){(at(qe)?qe.content:qe).appendChild(_t)}insertBefore(qe,_t,ke){qe&&(at(qe)?qe.content:qe).insertBefore(_t,ke)}removeChild(qe,_t){qe&&qe.removeChild(_t)}selectRootElement(qe,_t){let ke="string"==typeof qe?this.doc.querySelector(qe):qe;if(!ke)throw new p.vHH(-5104,!1);return _t||(ke.textContent=""),ke}parentNode(qe){return qe.parentNode}nextSibling(qe){return qe.nextSibling}setAttribute(qe,_t,ke,gt){if(gt){_t=gt+":"+_t;const sn=je[gt];sn?qe.setAttributeNS(sn,_t,ke):qe.setAttribute(_t,ke)}else qe.setAttribute(_t,ke)}removeAttribute(qe,_t,ke){if(ke){const gt=je[ke];gt?qe.removeAttributeNS(gt,_t):qe.removeAttribute(`${ke}:${_t}`)}else qe.removeAttribute(_t)}addClass(qe,_t){qe.classList.add(_t)}removeClass(qe,_t){qe.classList.remove(_t)}setStyle(qe,_t,ke,gt){gt&(p.JOm.DashCase|p.JOm.Important)?qe.style.setProperty(_t,ke,gt&p.JOm.Important?"important":""):qe.style[_t]=ke}removeStyle(qe,_t,ke){ke&p.JOm.DashCase?qe.style.removeProperty(_t):qe.style[_t]=""}setProperty(qe,_t,ke){null!=qe&&(qe[_t]=ke)}setValue(qe,_t){qe.nodeValue=_t}listen(qe,_t,ke){if("string"==typeof qe&&!(qe=(0,se.q)().getGlobalEventTarget(this.doc,qe)))throw new Error(`Unsupported event target ${qe} for event ${_t}`);return this.eventManager.addEventListener(qe,_t,this.decoratePreventDefault(ke))}decoratePreventDefault(qe){return _t=>{if("__ngUnwrap__"===_t)return qe;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>qe(_t)):qe(_t))&&_t.preventDefault()}}}function at(kt){return"TEMPLATE"===kt.tagName&&void 0!==kt.content}class lt extends ve{constructor(qe,_t,ke,gt,sn,Sn,ni,Ri){super(qe,sn,Sn,Ri),this.sharedStylesHost=_t,this.hostEl=ke,this.shadowRoot=ke.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ui=$e(gt.id,gt.styles);for(const Yr of Ui){const cr=document.createElement("style");ni&&cr.setAttribute("nonce",ni),cr.textContent=Yr,this.shadowRoot.appendChild(cr)}}nodeOrShadowRoot(qe){return qe===this.hostEl?this.shadowRoot:qe}appendChild(qe,_t){return super.appendChild(this.nodeOrShadowRoot(qe),_t)}insertBefore(qe,_t,ke){return super.insertBefore(this.nodeOrShadowRoot(qe),_t,ke)}removeChild(qe,_t){return super.removeChild(this.nodeOrShadowRoot(qe),_t)}parentNode(qe){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(qe)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class dt extends ve{constructor(qe,_t,ke,gt,sn,Sn,ni,Ri){super(qe,sn,Sn,ni),this.sharedStylesHost=_t,this.removeStylesOnCompDestroy=gt,this.styles=Ri?$e(Ri,ke.styles):ke.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class ln extends dt{constructor(qe,_t,ke,gt,sn,Sn,ni,Ri){const Ui=gt+"-"+ke.id;super(qe,_t,ke,sn,Sn,ni,Ri,Ui),this.contentAttr=function ot(kt){return"_ngcontent-%COMP%".replace(Rt,kt)}(Ui),this.hostAttr=function bt(kt){return"_nghost-%COMP%".replace(Rt,kt)}(Ui)}applyToHost(qe){this.applyStyles(),this.setAttribute(qe,this.hostAttr,"")}createElement(qe,_t){const ke=super.createElement(qe,_t);return super.setAttribute(ke,this.contentAttr,""),ke}}let $n=(()=>{var kt;class qe extends mt{constructor(ke){super(ke)}supports(ke){return!0}addEventListener(ke,gt,sn){return ke.addEventListener(gt,sn,!1),()=>this.removeEventListener(ke,gt,sn)}removeEventListener(ke,gt,sn){return ke.removeEventListener(gt,sn)}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(se.K0))},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();const Mi=["alt","control","meta","shift"],Lt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Oe={alt:kt=>kt.altKey,control:kt=>kt.ctrlKey,meta:kt=>kt.metaKey,shift:kt=>kt.shiftKey};let ye=(()=>{var kt;class qe extends mt{constructor(ke){super(ke)}supports(ke){return null!=qe.parseEventName(ke)}addEventListener(ke,gt,sn){const Sn=qe.parseEventName(gt),ni=qe.eventCallback(Sn.fullKey,sn,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,se.q)().onAndCancel(ke,Sn.domEventName,ni))}static parseEventName(ke){const gt=ke.toLowerCase().split("."),sn=gt.shift();if(0===gt.length||"keydown"!==sn&&"keyup"!==sn)return null;const Sn=qe._normalizeKey(gt.pop());let ni="",Ri=gt.indexOf("code");if(Ri>-1&&(gt.splice(Ri,1),ni="code."),Mi.forEach(Yr=>{const cr=gt.indexOf(Yr);cr>-1&&(gt.splice(cr,1),ni+=Yr+".")}),ni+=Sn,0!=gt.length||0===Sn.length)return null;const Ui={};return Ui.domEventName=sn,Ui.fullKey=ni,Ui}static matchEventFullKeyCode(ke,gt){let sn=Lt[ke.key]||ke.key,Sn="";return gt.indexOf("code.")>-1&&(sn=ke.code,Sn="code."),!(null==sn||!sn)&&(sn=sn.toLowerCase()," "===sn?sn="space":"."===sn&&(sn="dot"),Mi.forEach(ni=>{ni!==sn&&(0,Oe[ni])(ke)&&(Sn+=ni+".")}),Sn+=sn,Sn===gt)}static eventCallback(ke,gt,sn){return Sn=>{qe.matchEventFullKeyCode(Sn,ke)&&sn.runGuarded(()=>gt(Sn))}}static _normalizeKey(ke){return"esc"===ke?"escape":ke}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(se.K0))},kt.\u0275prov=p.Yz7({token:kt,factory:kt.\u0275fac}),qe})();const ai=(0,p.eFA)(p._c5,"browser",[{provide:p.Lbi,useValue:se.bD},{provide:p.g9A,useValue:function un(){Pe.makeCurrent()},multi:!0},{provide:se.K0,useFactory:function yn(){return(0,p.RDi)(document),document},deps:[]}]),Si=new p.OlP(""),Xt=[{provide:p.rWj,useClass:class Dt{addToWindow(qe){p.dqk.getAngularTestability=(ke,gt=!0)=>{const sn=qe.findTestabilityInTree(ke,gt);if(null==sn)throw new p.vHH(5103,!1);return sn},p.dqk.getAllAngularTestabilities=()=>qe.getAllTestabilities(),p.dqk.getAllAngularRootElements=()=>qe.getAllRootElements(),p.dqk.frameworkStabilizers||(p.dqk.frameworkStabilizers=[]),p.dqk.frameworkStabilizers.push(ke=>{const gt=p.dqk.getAllAngularTestabilities();let sn=gt.length,Sn=!1;const ni=function(Ri){Sn=Sn||Ri,sn--,0==sn&&ke(Sn)};gt.forEach(Ri=>{Ri.whenStable(ni)})})}findTestabilityInTree(qe,_t,ke){if(null==_t)return null;const gt=qe.getTestability(_t);return null!=gt?gt:ke?(0,se.q)().isShadowRoot(_t)?this.findTestabilityInTree(qe,_t.host,!0):this.findTestabilityInTree(qe,_t.parentElement,!0):null}},deps:[]},{provide:p.lri,useClass:p.dDg,deps:[p.R0b,p.eoX,p.rWj]},{provide:p.dDg,useClass:p.dDg,deps:[p.R0b,p.eoX,p.rWj]}],Ft=[{provide:p.zSh,useValue:"root"},{provide:p.qLn,useFactory:function Mn(){return new p.qLn},deps:[]},{provide:yt,useClass:$n,multi:!0,deps:[se.K0,p.R0b,p.Lbi]},{provide:yt,useClass:ye,multi:!0,deps:[se.K0]},me,tt,Le,{provide:p.FYo,useExisting:me},{provide:se.JF,useClass:Pt,deps:[]},[]];let It=(()=>{var kt;class qe{constructor(ke){}static withServerTransition(ke){return{ngModule:qe,providers:[{provide:p.AFp,useValue:ke.appId}]}}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(Si,12))},kt.\u0275mod=p.oAB({type:kt}),kt.\u0275inj=p.cJS({providers:[...Ft,...Xt],imports:[se.ez,p.hGG]}),qe})(),Gn=(()=>{var kt;class qe{constructor(ke){this._doc=ke}getTitle(){return this._doc.title}setTitle(ke){this._doc.title=ke||""}}return(kt=qe).\u0275fac=function(ke){return new(ke||kt)(p.LFG(se.K0))},kt.\u0275prov=p.Yz7({token:kt,factory:function(ke){let gt=null;return gt=ke?new ke:function li(){return new Gn((0,p.LFG)(se.K0))}(),gt},providedIn:"root"}),qe})();typeof window<"u"&&window},899:(Qn,Vt,re)=>{"use strict";re.d(Vt,{gz:()=>Li,y6:()=>yi,OD:()=>_n,eC:()=>Ut,wm:()=>fi,wN:()=>qs,F0:()=>_i,rH:()=>Ql,Bz:()=>Vu,Hx:()=>Br});var p=re(9212),se=re(5592),Ye=re(4674),ft=re(7715),Fe=re(2096),Be=re(5619),Dt=re(2572);const yt=(0,re(2306).d)(w=>function(){w(this),this.name="EmptyError",this.message="no elements in sequence"});var Le=re(1631),mt=re(2737);function ct(w=1/0){return(0,Le.z)(mt.y,w)}var je=re(4564);function Rt(...w){return function tt(){return ct(1)}()((0,ft.D)(w,(0,je.yG)(w)))}var Ze=re(4829);function Je(w){return new se.y(D=>{(0,Ze.Xf)(w()).subscribe(D)})}var et=re(8407);function $t(w,D){const L=(0,Ye.m)(w)?w:()=>w,S=B=>B.error(L());return new se.y(D?B=>D.schedule(S,0,B):S)}const st=new se.y(w=>w.complete());var $e=re(7394),me=re(9360),ve=re(8251);function Ue(){return(0,me.e)((w,D)=>{let L=null;w._refCount++;const S=(0,ve.x)(D,void 0,void 0,void 0,()=>{if(!w||w._refCount<=0||0<--w._refCount)return void(L=null);const B=w._connection,J=L;L=null,B&&(!J||B===J)&&B.unsubscribe(),D.unsubscribe()});w.subscribe(S),S.closed||(L=w.connect())})}class Ce extends se.y{constructor(D,L){super(),this.source=D,this.subjectFactory=L,this._subject=null,this._refCount=0,this._connection=null,(0,me.A)(D)&&(this.lift=D.lift)}_subscribe(D){return this.getSubject().subscribe(D)}getSubject(){const D=this._subject;return(!D||D.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:D}=this;this._subject=this._connection=null,null==D||D.unsubscribe()}connect(){let D=this._connection;if(!D){D=this._connection=new $e.w0;const L=this.getSubject();D.add(this.source.subscribe((0,ve.x)(L,void 0,()=>{this._teardown(),L.complete()},S=>{this._teardown(),L.error(S)},()=>this._teardown()))),D.closed&&(this._connection=null,D=$e.w0.EMPTY)}return D}refCount(){return Ue()(this)}}var at=re(8645),lt=re(6814),dt=re(7398),ln=re(4664);function $n(w){return w<=0?()=>st:(0,me.e)((D,L)=>{let S=0;D.subscribe((0,ve.x)(L,B=>{++S<=w&&(L.next(B),w<=S&&L.complete())}))})}var Lt=re(2181);function Oe(w){return(0,me.e)((D,L)=>{let S=!1;D.subscribe((0,ve.x)(L,B=>{S=!0,L.next(B)},()=>{S||L.next(w),L.complete()}))})}function ye(w=Ie){return(0,me.e)((D,L)=>{let S=!1;D.subscribe((0,ve.x)(L,B=>{S=!0,L.next(B)},()=>S?L.complete():L.error(w())))})}function Ie(){return new yt}function xe(w,D){const L=arguments.length>=2;return S=>S.pipe(w?(0,Lt.h)((B,J)=>w(B,J,S)):mt.y,$n(1),L?Oe(D):ye(()=>new yt))}function wt(w,D){return(0,Ye.m)(D)?(0,Le.z)(w,D,1):(0,Le.z)(w,1)}function ut(w,D,L){const S=(0,Ye.m)(w)||D||L?{next:w,error:D,complete:L}:w;return S?(0,me.e)((B,J)=>{var ce;null===(ce=S.subscribe)||void 0===ce||ce.call(S);let it=!0;B.subscribe((0,ve.x)(J,At=>{var vt;null===(vt=S.next)||void 0===vt||vt.call(S,At),J.next(At)},()=>{var At;it=!1,null===(At=S.complete)||void 0===At||At.call(S),J.complete()},At=>{var vt;it=!1,null===(vt=S.error)||void 0===vt||vt.call(S,At),J.error(At)},()=>{var At,vt;it&&(null===(At=S.unsubscribe)||void 0===At||At.call(S)),null===(vt=S.finalize)||void 0===vt||vt.call(S)}))}):mt.y}function un(w){return(0,me.e)((D,L)=>{let J,S=null,B=!1;S=D.subscribe((0,ve.x)(L,void 0,void 0,ce=>{J=(0,Ze.Xf)(w(ce,un(w)(D))),S?(S.unsubscribe(),S=null,J.subscribe(L)):B=!0})),B&&(S.unsubscribe(),S=null,J.subscribe(L))})}function Ln(w){return w<=0?()=>st:(0,me.e)((D,L)=>{let S=[];D.subscribe((0,ve.x)(L,B=>{S.push(B),w<S.length&&S.shift()},()=>{for(const B of S)L.next(B);L.complete()},void 0,()=>{S=null}))})}function Xt(w){return(0,me.e)((D,L)=>{try{D.subscribe(L)}finally{L.add(w)}})}var Ft=re(2420),tn=re(6593);const Ut="primary",ti=Symbol("RouteTitle");class li{constructor(D){this.params=D||{}}has(D){return Object.prototype.hasOwnProperty.call(this.params,D)}get(D){if(this.has(D)){const L=this.params[D];return Array.isArray(L)?L[0]:L}return null}getAll(D){if(this.has(D)){const L=this.params[D];return Array.isArray(L)?L:[L]}return[]}get keys(){return Object.keys(this.params)}}function Gn(w){return new li(w)}function ki(w,D,L){const S=L.path.split("/");if(S.length>w.length||"full"===L.pathMatch&&(D.hasChildren()||S.length<w.length))return null;const B={};for(let J=0;J<S.length;J++){const ce=S[J],it=w[J];if(ce.startsWith(":"))B[ce.substring(1)]=it;else if(ce!==it.path)return null}return{consumed:w.slice(0,S.length),posParams:B}}function ar(w,D){const L=w?Rn(w):void 0,S=D?Rn(D):void 0;if(!L||!S||L.length!=S.length)return!1;let B;for(let J=0;J<L.length;J++)if(B=L[J],!mi(w[B],D[B]))return!1;return!0}function Rn(w){return[...Object.keys(w),...Object.getOwnPropertySymbols(w)]}function mi(w,D){if(Array.isArray(w)&&Array.isArray(D)){if(w.length!==D.length)return!1;const L=[...w].sort(),S=[...D].sort();return L.every((B,J)=>S[J]===B)}return w===D}function hi(w){return w.length>0?w[w.length-1]:null}function Sr(w){return function Pe(w){return!!w&&(w instanceof se.y||(0,Ye.m)(w.lift)&&(0,Ye.m)(w.subscribe))}(w)?w:(0,p.QGY)(w)?(0,ft.D)(Promise.resolve(w)):(0,Fe.of)(w)}const Fr={exact:function jr(w,D,L){if(!ss(w.segments,D.segments)||!Ar(w.segments,D.segments,L)||w.numberOfChildren!==D.numberOfChildren)return!1;for(const S in D.children)if(!w.children[S]||!jr(w.children[S],D.children[S],L))return!1;return!0},subset:Zr},vn={exact:function fr(w,D){return ar(w,D)},subset:function Ei(w,D){return Object.keys(D).length<=Object.keys(w).length&&Object.keys(D).every(L=>mi(w[L],D[L]))},ignored:()=>!0};function Cr(w,D,L){return Fr[L.paths](w.root,D.root,L.matrixParams)&&vn[L.queryParams](w.queryParams,D.queryParams)&&!("exact"===L.fragment&&w.fragment!==D.fragment)}function Zr(w,D,L){return Jn(w,D,D.segments,L)}function Jn(w,D,L,S){if(w.segments.length>L.length){const B=w.segments.slice(0,L.length);return!(!ss(B,L)||D.hasChildren()||!Ar(B,L,S))}if(w.segments.length===L.length){if(!ss(w.segments,L)||!Ar(w.segments,L,S))return!1;for(const B in D.children)if(!w.children[B]||!Zr(w.children[B],D.children[B],S))return!1;return!0}{const B=L.slice(0,w.segments.length),J=L.slice(w.segments.length);return!!(ss(w.segments,B)&&Ar(w.segments,B,S)&&w.children[Ut])&&Jn(w.children[Ut],D,J,S)}}function Ar(w,D,L){return D.every((S,B)=>vn[L](w[B].parameters,S.parameters))}class fs{constructor(D=new xn([],{}),L={},S=null){this.root=D,this.queryParams=L,this.fragment=S}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Gn(this.queryParams)),this._queryParamMap}toString(){return kr.serialize(this)}}class xn{constructor(D,L){this.segments=D,this.children=L,this.parent=null,Object.values(L).forEach(S=>S.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yr(this)}}class wi{constructor(D,L){this.path=D,this.parameters=L}get parameterMap(){return this._parameterMap||(this._parameterMap=Gn(this.parameters)),this._parameterMap}toString(){return Sn(this)}}function ss(w,D){return w.length===D.length&&w.every((L,S)=>L.path===D[S].path)}let Br=(()=>{var w;class D{}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:()=>new ts,providedIn:"root"}),D})();class ts{parse(D){const L=new Hi(D);return new fs(L.parseRootSegment(),L.parseQueryParams(),L.parseFragment())}serialize(D){const L=`/${_s(D.root,!0)}`,S=function Ri(w){const D=Object.keys(w).map(L=>{const S=w[L];return Array.isArray(S)?S.map(B=>`${qe(L)}=${qe(B)}`).join("&"):`${qe(L)}=${qe(S)}`}).filter(L=>!!L);return D.length?`?${D.join("&")}`:""}(D.queryParams);return`${L}${S}${"string"==typeof D.fragment?`#${function _t(w){return encodeURI(w)}(D.fragment)}`:""}`}}const kr=new ts;function yr(w){return w.segments.map(D=>Sn(D)).join("/")}function _s(w,D){if(!w.hasChildren())return yr(w);if(D){const L=w.children[Ut]?_s(w.children[Ut],!1):"",S=[];return Object.entries(w.children).forEach(([B,J])=>{B!==Ut&&S.push(`${B}:${_s(J,!1)}`)}),S.length>0?`${L}(${S.join("//")})`:L}{const L=function no(w,D){let L=[];return Object.entries(w.children).forEach(([S,B])=>{S===Ut&&(L=L.concat(D(B,S)))}),Object.entries(w.children).forEach(([S,B])=>{S!==Ut&&(L=L.concat(D(B,S)))}),L}(w,(S,B)=>B===Ut?[_s(w.children[Ut],!1)]:[`${B}:${_s(S,!1)}`]);return 1===Object.keys(w.children).length&&null!=w.children[Ut]?`${yr(w)}/${L[0]}`:`${yr(w)}/(${L.join("//")})`}}function kt(w){return encodeURIComponent(w).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qe(w){return kt(w).replace(/%3B/gi,";")}function ke(w){return kt(w).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function gt(w){return decodeURIComponent(w)}function sn(w){return gt(w.replace(/\+/g,"%20"))}function Sn(w){return`${ke(w.path)}${function ni(w){return Object.keys(w).map(D=>`;${ke(D)}=${ke(w[D])}`).join("")}(w.parameters)}`}const Ui=/^[^\/()?;#]+/;function Yr(w){const D=w.match(Ui);return D?D[0]:""}const cr=/^[^\/()?;=#]+/,Ws=/^[^=?&#]+/,js=/^[^&#]+/;class Hi{constructor(D){this.url=D,this.remaining=D}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xn([],{}):new xn([],this.parseChildren())}parseQueryParams(){const D={};if(this.consumeOptional("?"))do{this.parseQueryParam(D)}while(this.consumeOptional("&"));return D}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const D=[];for(this.peekStartsWith("(")||D.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),D.push(this.parseSegment());let L={};this.peekStartsWith("/(")&&(this.capture("/"),L=this.parseParens(!0));let S={};return this.peekStartsWith("(")&&(S=this.parseParens(!1)),(D.length>0||Object.keys(L).length>0)&&(S[Ut]=new xn(D,L)),S}parseSegment(){const D=Yr(this.remaining);if(""===D&&this.peekStartsWith(";"))throw new p.vHH(4009,!1);return this.capture(D),new wi(gt(D),this.parseMatrixParams())}parseMatrixParams(){const D={};for(;this.consumeOptional(";");)this.parseParam(D);return D}parseParam(D){const L=function qn(w){const D=w.match(cr);return D?D[0]:""}(this.remaining);if(!L)return;this.capture(L);let S="";if(this.consumeOptional("=")){const B=Yr(this.remaining);B&&(S=B,this.capture(S))}D[gt(L)]=gt(S)}parseQueryParam(D){const L=function io(w){const D=w.match(Ws);return D?D[0]:""}(this.remaining);if(!L)return;this.capture(L);let S="";if(this.consumeOptional("=")){const ce=function go(w){const D=w.match(js);return D?D[0]:""}(this.remaining);ce&&(S=ce,this.capture(S))}const B=sn(L),J=sn(S);if(D.hasOwnProperty(B)){let ce=D[B];Array.isArray(ce)||(ce=[ce],D[B]=ce),ce.push(J)}else D[B]=J}parseParens(D){const L={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const S=Yr(this.remaining),B=this.remaining[S.length];if("/"!==B&&")"!==B&&";"!==B)throw new p.vHH(4010,!1);let J;S.indexOf(":")>-1?(J=S.slice(0,S.indexOf(":")),this.capture(J),this.capture(":")):D&&(J=Ut);const ce=this.parseChildren();L[J]=1===Object.keys(ce).length?ce[Ut]:new xn([],ce),this.consumeOptional("//")}return L}peekStartsWith(D){return this.remaining.startsWith(D)}consumeOptional(D){return!!this.peekStartsWith(D)&&(this.remaining=this.remaining.substring(D.length),!0)}capture(D){if(!this.consumeOptional(D))throw new p.vHH(4011,!1)}}function Ys(w){return w.segments.length>0?new xn([],{[Ut]:w}):w}function bs(w){const D={};for(const S of Object.keys(w.children)){const J=bs(w.children[S]);if(S===Ut&&0===J.segments.length&&J.hasChildren())for(const[ce,it]of Object.entries(J.children))D[ce]=it;else(J.segments.length>0||J.hasChildren())&&(D[S]=J)}return function Ts(w){if(1===w.numberOfChildren&&w.children[Ut]){const D=w.children[Ut];return new xn(w.segments.concat(D.segments),D.children)}return w}(new xn(w.segments,D))}function nr(w){return w instanceof fs}function vo(w){var D;let L;const J=Ys(function S(ce){const it={};for(const vt of ce.children){const Nn=S(vt);it[vt.outlet]=Nn}const At=new xn(ce.url,it);return ce===w&&(L=At),At}(w.root));return null!==(D=L)&&void 0!==D?D:J}function Ds(w,D,L,S){let B=w;for(;B.parent;)B=B.parent;if(0===D.length)return Is(B,B,B,L,S);const J=function os(w){if("string"==typeof w[0]&&1===w.length&&"/"===w[0])return new Di(!0,0,w);let D=0,L=!1;const S=w.reduce((B,J,ce)=>{if("object"==typeof J&&null!=J){if(J.outlets){const it={};return Object.entries(J.outlets).forEach(([At,vt])=>{it[At]="string"==typeof vt?vt.split("/"):vt}),[...B,{outlets:it}]}if(J.segmentPath)return[...B,J.segmentPath]}return"string"!=typeof J?[...B,J]:0===ce?(J.split("/").forEach((it,At)=>{0==At&&"."===it||(0==At&&""===it?L=!0:".."===it?D++:""!=it&&B.push(it))}),B):[...B,J]},[]);return new Di(L,D,S)}(D);if(J.toRoot())return Is(B,B,new xn([],{}),L,S);const ce=function ci(w,D,L){if(w.isAbsolute)return new ir(D,!0,0);if(!L)return new ir(D,!1,NaN);if(null===L.parent)return new ir(L,!0,0);const S=Tr(w.commands[0])?0:1;return function Co(w,D,L){let S=w,B=D,J=L;for(;J>B;){if(J-=B,S=S.parent,!S)throw new p.vHH(4005,!1);B=S.segments.length}return new ir(S,!1,B-J)}(L,L.segments.length-1+S,w.numberOfDoubleDots)}(J,B,w),it=ce.processChildren?Os(ce.segmentGroup,ce.index,J.commands):_r(ce.segmentGroup,ce.index,J.commands);return Is(B,ce.segmentGroup,it,L,S)}function Tr(w){return"object"==typeof w&&null!=w&&!w.outlets&&!w.segmentPath}function ms(w){return"object"==typeof w&&null!=w&&w.outlets}function Is(w,D,L,S,B){let ce,J={};S&&Object.entries(S).forEach(([At,vt])=>{J[At]=Array.isArray(vt)?vt.map(Nn=>`${Nn}`):`${vt}`}),ce=w===D?L:Or(w,D,L);const it=Ys(bs(ce));return new fs(it,J,B)}function Or(w,D,L){const S={};return Object.entries(w.children).forEach(([B,J])=>{S[B]=J===D?L:Or(J,D,L)}),new xn(w.segments,S)}class Di{constructor(D,L,S){if(this.isAbsolute=D,this.numberOfDoubleDots=L,this.commands=S,D&&S.length>0&&Tr(S[0]))throw new p.vHH(4003,!1);const B=S.find(ms);if(B&&B!==hi(S))throw new p.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ir{constructor(D,L,S){this.segmentGroup=D,this.processChildren=L,this.index=S}}function _r(w,D,L){if(w||(w=new xn([],{})),0===w.segments.length&&w.hasChildren())return Os(w,D,L);const S=function ro(w,D,L){let S=0,B=D;const J={match:!1,pathIndex:0,commandIndex:0};for(;B<w.segments.length;){if(S>=L.length)return J;const ce=w.segments[B],it=L[S];if(ms(it))break;const At=`${it}`,vt=S<L.length-1?L[S+1]:null;if(B>0&&void 0===At)break;if(At&&vt&&"object"==typeof vt&&void 0===vt.outlets){if(!ge(At,vt,ce))return J;S+=2}else{if(!ge(At,{},ce))return J;S++}B++}return{match:!0,pathIndex:B,commandIndex:S}}(w,D,L),B=L.slice(S.commandIndex);if(S.match&&S.pathIndex<w.segments.length){const J=new xn(w.segments.slice(0,S.pathIndex),{});return J.children[Ut]=new xn(w.segments.slice(S.pathIndex),w.children),Os(J,0,B)}return S.match&&0===B.length?new xn(w.segments,{}):S.match&&!w.hasChildren()?de(w,D,L):S.match?Os(w,0,B):de(w,D,L)}function Os(w,D,L){if(0===L.length)return new xn(w.segments,{});{const S=function xs(w){return ms(w[0])?w[0].outlets:{[Ut]:w}}(L),B={};if(Object.keys(S).some(J=>J!==Ut)&&w.children[Ut]&&1===w.numberOfChildren&&0===w.children[Ut].segments.length){const J=Os(w.children[Ut],D,L);return new xn(w.segments,J.children)}return Object.entries(S).forEach(([J,ce])=>{"string"==typeof ce&&(ce=[ce]),null!==ce&&(B[J]=_r(w.children[J],D,ce))}),Object.entries(w.children).forEach(([J,ce])=>{void 0===S[J]&&(B[J]=ce)}),new xn(w.segments,B)}}function de(w,D,L){const S=w.segments.slice(0,D);let B=0;for(;B<L.length;){const J=L[B];if(ms(J)){const At=be(J.outlets);return new xn(S,At)}if(0===B&&Tr(L[0])){S.push(new wi(w.segments[D].path,K(L[0]))),B++;continue}const ce=ms(J)?J.outlets[Ut]:`${J}`,it=B<L.length-1?L[B+1]:null;ce&&it&&Tr(it)?(S.push(new wi(ce,K(it))),B+=2):(S.push(new wi(ce,{})),B++)}return new xn(S,{})}function be(w){const D={};return Object.entries(w).forEach(([L,S])=>{"string"==typeof S&&(S=[S]),null!==S&&(D[L]=de(new xn([],{}),0,S))}),D}function K(w){const D={};return Object.entries(w).forEach(([L,S])=>D[L]=`${S}`),D}function ge(w,D,L){return w==L.path&&ar(D,L.parameters)}const Qe="imperative";class Gt{constructor(D,L){this.id=D,this.url=L}}class _n extends Gt{constructor(D,L,S="imperative",B=null){super(D,L),this.type=0,this.navigationTrigger=S,this.restoredState=B}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class U extends Gt{constructor(D,L,S){super(D,L),this.urlAfterRedirects=S,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class q extends Gt{constructor(D,L,S,B){super(D,L),this.reason=S,this.code=B,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class pe extends Gt{constructor(D,L,S,B){super(D,L),this.reason=S,this.code=B,this.type=16}}class Ne extends Gt{constructor(D,L,S,B){super(D,L),this.error=S,this.target=B,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Et extends Gt{constructor(D,L,S,B){super(D,L),this.urlAfterRedirects=S,this.state=B,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xe extends Gt{constructor(D,L,S,B){super(D,L),this.urlAfterRedirects=S,this.state=B,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wt extends Gt{constructor(D,L,S,B,J){super(D,L),this.urlAfterRedirects=S,this.state=B,this.shouldActivate=J,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Yt extends Gt{constructor(D,L,S,B){super(D,L),this.urlAfterRedirects=S,this.state=B,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cn extends Gt{constructor(D,L,S,B){super(D,L),this.urlAfterRedirects=S,this.state=B,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zt{constructor(D){this.route=D,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class En{constructor(D){this.route=D,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Wn{constructor(D){this.snapshot=D,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class On{constructor(D){this.snapshot=D,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $i{constructor(D){this.snapshot=D,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pr{constructor(D){this.snapshot=D,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class I{constructor(D,L,S){this.routerEvent=D,this.position=L,this.anchor=S,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ie{}class k{constructor(D){this.url=D}}class Ke{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new yi,this.attachRef=null}}let yi=(()=>{var w;class D{constructor(){this.contexts=new Map}onChildOutletCreated(S,B){const J=this.getOrCreateContext(S);J.outlet=B,this.contexts.set(S,J)}onChildOutletDestroyed(S){const B=this.getContext(S);B&&(B.outlet=null,B.attachRef=null)}onOutletDeactivated(){const S=this.contexts;return this.contexts=new Map,S}onOutletReAttached(S){this.contexts=S}getOrCreateContext(S){let B=this.getContext(S);return B||(B=new Ke,this.contexts.set(S,B)),B}getContext(S){return this.contexts.get(S)||null}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();class Nr{constructor(D){this._root=D}get root(){return this._root.value}parent(D){const L=this.pathFromRoot(D);return L.length>1?L[L.length-2]:null}children(D){const L=as(D,this._root);return L?L.children.map(S=>S.value):[]}firstChild(D){const L=as(D,this._root);return L&&L.children.length>0?L.children[0].value:null}siblings(D){const L=Po(D,this._root);return L.length<2?[]:L[L.length-2].children.map(B=>B.value).filter(B=>B!==D)}pathFromRoot(D){return Po(D,this._root).map(L=>L.value)}}function as(w,D){if(w===D.value)return D;for(const L of D.children){const S=as(w,L);if(S)return S}return null}function Po(w,D){if(w===D.value)return[D];for(const L of D.children){const S=Po(w,L);if(S.length)return S.unshift(D),S}return[]}class ns{constructor(D,L){this.value=D,this.children=L}toString(){return`TreeNode(${this.value})`}}function Ns(w){const D={};return w&&w.children.forEach(L=>D[L.value.outlet]=L),D}class yo extends Nr{constructor(D,L){super(D),this.snapshot=L,Wl(this,D)}toString(){return this.snapshot.toString()}}function Gi(w,D){const L=function Dr(w,D){const ce=new Qo([],{},{},"",{},Ut,D,null,{});return new za("",new ns(ce,[]))}(0,D),S=new Be.X([new wi("",{})]),B=new Be.X({}),J=new Be.X({}),ce=new Be.X({}),it=new Be.X(""),At=new Li(S,B,ce,it,J,Ut,D,L.root);return At.snapshot=L.root,new yo(new ns(At,[]),L)}class Li{constructor(D,L,S,B,J,ce,it,At){var vt,Nn;this.urlSubject=D,this.paramsSubject=L,this.queryParamsSubject=S,this.fragmentSubject=B,this.dataSubject=J,this.outlet=ce,this.component=it,this._futureSnapshot=At,this.title=null!==(vt=null===(Nn=this.dataSubject)||void 0===Nn?void 0:Nn.pipe((0,dt.U)(Pi=>Pi[ti])))&&void 0!==vt?vt:(0,Fe.of)(void 0),this.url=D,this.params=L,this.queryParams=S,this.fragment=B,this.data=J}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,dt.U)(D=>Gn(D)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,dt.U)(D=>Gn(D)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Va(w,D,L="emptyOnly"){var S;let B;const{routeConfig:J}=w;var ce;return B=null===D||"always"!==L&&""!==(null==J?void 0:J.path)&&(D.component||null!==(S=D.routeConfig)&&void 0!==S&&S.loadComponent)?{params:{...w.params},data:{...w.data},resolve:{...w.data,...null!==(ce=w._resolvedData)&&void 0!==ce?ce:{}}}:{params:{...D.params,...w.params},data:{...D.data,...w.data},resolve:{...w.data,...D.data,...null==J?void 0:J.data,...w._resolvedData}},J&&Sc(J)&&(B.resolve[ti]=J.title),B}class Qo{get title(){var D;return null===(D=this.data)||void 0===D?void 0:D[ti]}constructor(D,L,S,B,J,ce,it,At,vt){this.url=D,this.params=L,this.queryParams=S,this.fragment=B,this.data=J,this.outlet=ce,this.component=it,this.routeConfig=At,this._resolve=vt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Gn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Gn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(S=>S.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class za extends Nr{constructor(D,L){super(L),this.url=D,Wl(this,L)}toString(){return Ma(this._root)}}function Wl(w,D){D.value._routerState=w,D.children.forEach(L=>Wl(w,L))}function Ma(w){const D=w.children.length>0?` { ${w.children.map(Ma).join(", ")} } `:"";return`${w.value}${D}`}function nl(w){if(w.snapshot){const D=w.snapshot,L=w._futureSnapshot;w.snapshot=L,ar(D.queryParams,L.queryParams)||w.queryParamsSubject.next(L.queryParams),D.fragment!==L.fragment&&w.fragmentSubject.next(L.fragment),ar(D.params,L.params)||w.paramsSubject.next(L.params),function Ci(w,D){if(w.length!==D.length)return!1;for(let L=0;L<w.length;++L)if(!ar(w[L],D[L]))return!1;return!0}(D.url,L.url)||w.urlSubject.next(L.url),ar(D.data,L.data)||w.dataSubject.next(L.data)}else w.snapshot=w._futureSnapshot,w.dataSubject.next(w._futureSnapshot.data)}function il(w,D){const L=ar(w.params,D.params)&&function lr(w,D){return ss(w,D)&&w.every((L,S)=>ar(L.parameters,D[S].parameters))}(w.url,D.url);return L&&!(!w.parent!=!D.parent)&&(!w.parent||il(w.parent,D.parent))}function Sc(w){return"string"==typeof w.title||null===w.title}let rl=(()=>{var w;class D{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ut,this.activateEvents=new p.vpe,this.deactivateEvents=new p.vpe,this.attachEvents=new p.vpe,this.detachEvents=new p.vpe,this.parentContexts=(0,p.f3M)(yi),this.location=(0,p.f3M)(p.s_b),this.changeDetector=(0,p.f3M)(p.sBO),this.environmentInjector=(0,p.f3M)(p.lqb),this.inputBinder=(0,p.f3M)(xl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(S){if(S.name){const{firstChange:B,previousValue:J}=S.name;if(B)return;this.isTrackedInParentContexts(J)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(J)),this.initializeOutletWithName()}}ngOnDestroy(){var S;this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),null===(S=this.inputBinder)||void 0===S||S.unsubscribeFromRouteData(this)}isTrackedInParentContexts(S){var B;return(null===(B=this.parentContexts.getContext(S))||void 0===B?void 0:B.outlet)===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const S=this.parentContexts.getContext(this.name);null!=S&&S.route&&(S.attachRef?this.attach(S.attachRef,S.route):this.activateWith(S.route,S.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new p.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new p.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new p.vHH(4012,!1);this.location.detach();const S=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(S.instance),S}attach(S,B){var J;this.activated=S,this._activatedRoute=B,this.location.insert(S.hostView),null===(J=this.inputBinder)||void 0===J||J.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(S.instance)}deactivate(){if(this.activated){const S=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(S)}}activateWith(S,B){var J;if(this.isActivated)throw new p.vHH(4013,!1);this._activatedRoute=S;const ce=this.location,At=S.snapshot.component,vt=this.parentContexts.getOrCreateContext(this.name).children,Nn=new rh(S,vt,ce.injector);this.activated=ce.createComponent(At,{index:ce.length,injector:Nn,environmentInjector:null!=B?B:this.environmentInjector}),this.changeDetector.markForCheck(),null===(J=this.inputBinder)||void 0===J||J.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275dir=p.lG2({type:w,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[p.TTD]}),D})();class rh{constructor(D,L,S){this.route=D,this.childContexts=L,this.parent=S}get(D,L){return D===Li?this.route:D===yi?this.childContexts:this.parent.get(D,L)}}const xl=new p.OlP("");let Ao=(()=>{var w;class D{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(S){this.unsubscribeFromRouteData(S),this.subscribeToRouteData(S)}unsubscribeFromRouteData(S){var B;null===(B=this.outletDataSubscriptions.get(S))||void 0===B||B.unsubscribe(),this.outletDataSubscriptions.delete(S)}subscribeToRouteData(S){const{activatedRoute:B}=S,J=(0,Dt.a)([B.queryParams,B.params,B.data]).pipe((0,ln.w)(([ce,it,At],vt)=>(At={...ce,...it,...At},0===vt?(0,Fe.of)(At):Promise.resolve(At)))).subscribe(ce=>{if(!S.isActivated||!S.activatedComponentRef||S.activatedRoute!==B||null===B.component)return void this.unsubscribeFromRouteData(S);const it=(0,p.qFp)(B.component);if(it)for(const{templateName:At}of it.inputs)S.activatedComponentRef.setInput(At,ce[At]);else this.unsubscribeFromRouteData(S)});this.outletDataSubscriptions.set(S,J)}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac}),D})();function El(w,D,L){if(L&&w.shouldReuseRoute(D.value,L.value.snapshot)){const S=L.value;S._futureSnapshot=D.value;const B=function jl(w,D,L){return D.children.map(S=>{for(const B of L.children)if(w.shouldReuseRoute(S.value,B.value.snapshot))return El(w,S,B);return El(w,S)})}(w,D,L);return new ns(S,B)}{if(w.shouldAttach(D.value)){const J=w.retrieve(D.value);if(null!==J){const ce=J.route;return ce.value._futureSnapshot=D.value,ce.children=D.children.map(it=>El(w,it)),ce}}const S=function Au(w){return new Li(new Be.X(w.url),new Be.X(w.params),new Be.X(w.queryParams),new Be.X(w.fragment),new Be.X(w.data),w.outlet,w.component,w)}(D.value),B=D.children.map(J=>El(w,J));return new ns(S,B)}}const sl="ngNavigationCancelingError";function Yl(w,D){const{redirectTo:L,navigationBehaviorOptions:S}=nr(D)?{redirectTo:D,navigationBehaviorOptions:void 0}:D,B=Uo(!1,0,D);return B.url=L,B.navigationBehaviorOptions=S,B}function Uo(w,D,L){const S=new Error("NavigationCancelingError: "+(w||""));return S[sl]=!0,S.cancellationCode=D,L&&(S.url=L),S}function Sa(w){return w&&w[sl]}let Cc=(()=>{var w;class D{}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275cmp=p.Xpm({type:w,selectors:[["ng-component"]],standalone:!0,features:[p.jDz],decls:1,vars:0,template:function(S,B){1&S&&p._UZ(0,"router-outlet")},dependencies:[rl],encapsulation:2}),D})();function Es(w){const D=w.children&&w.children.map(Es),L=D?{...w,children:D}:{...w};return!L.component&&!L.loadComponent&&(D||L.loadChildren)&&L.outlet&&L.outlet!==Ut&&(L.component=Cc),L}function ws(w){return w.outlet||Ut}function Ca(w){var D;if(!w)return null;if(null!==(D=w.routeConfig)&&void 0!==D&&D._injector)return w.routeConfig._injector;for(let L=w.parent;L;L=L.parent){const S=L.routeConfig;if(null!=S&&S._loadedInjector)return S._loadedInjector;if(null!=S&&S._injector)return S._injector}return null}class ea{constructor(D,L,S,B,J){this.routeReuseStrategy=D,this.futureState=L,this.currState=S,this.forwardEvent=B,this.inputBindingEnabled=J}activate(D){const L=this.futureState._root,S=this.currState?this.currState._root:null;this.deactivateChildRoutes(L,S,D),nl(this.futureState.root),this.activateChildRoutes(L,S,D)}deactivateChildRoutes(D,L,S){const B=Ns(L);D.children.forEach(J=>{const ce=J.value.outlet;this.deactivateRoutes(J,B[ce],S),delete B[ce]}),Object.values(B).forEach(J=>{this.deactivateRouteAndItsChildren(J,S)})}deactivateRoutes(D,L,S){const B=D.value,J=L?L.value:null;if(B===J)if(B.component){const ce=S.getContext(B.outlet);ce&&this.deactivateChildRoutes(D,L,ce.children)}else this.deactivateChildRoutes(D,L,S);else J&&this.deactivateRouteAndItsChildren(L,S)}deactivateRouteAndItsChildren(D,L){D.value.component&&this.routeReuseStrategy.shouldDetach(D.value.snapshot)?this.detachAndStoreRouteSubtree(D,L):this.deactivateRouteAndOutlet(D,L)}detachAndStoreRouteSubtree(D,L){const S=L.getContext(D.value.outlet),B=S&&D.value.component?S.children:L,J=Ns(D);for(const ce of Object.keys(J))this.deactivateRouteAndItsChildren(J[ce],B);if(S&&S.outlet){const ce=S.outlet.detach(),it=S.children.onOutletDeactivated();this.routeReuseStrategy.store(D.value.snapshot,{componentRef:ce,route:D,contexts:it})}}deactivateRouteAndOutlet(D,L){const S=L.getContext(D.value.outlet),B=S&&D.value.component?S.children:L,J=Ns(D);for(const ce of Object.keys(J))this.deactivateRouteAndItsChildren(J[ce],B);S&&(S.outlet&&(S.outlet.deactivate(),S.children.onOutletDeactivated()),S.attachRef=null,S.route=null)}activateChildRoutes(D,L,S){const B=Ns(L);D.children.forEach(J=>{this.activateRoutes(J,B[J.value.outlet],S),this.forwardEvent(new pr(J.value.snapshot))}),D.children.length&&this.forwardEvent(new On(D.value.snapshot))}activateRoutes(D,L,S){const B=D.value,J=L?L.value:null;if(nl(B),B===J)if(B.component){const ce=S.getOrCreateContext(B.outlet);this.activateChildRoutes(D,L,ce.children)}else this.activateChildRoutes(D,L,S);else if(B.component){const ce=S.getOrCreateContext(B.outlet);if(this.routeReuseStrategy.shouldAttach(B.snapshot)){const it=this.routeReuseStrategy.retrieve(B.snapshot);this.routeReuseStrategy.store(B.snapshot,null),ce.children.onOutletReAttached(it.contexts),ce.attachRef=it.componentRef,ce.route=it.route.value,ce.outlet&&ce.outlet.attach(it.componentRef,it.route.value),nl(it.route.value),this.activateChildRoutes(D,null,ce.children)}else{const it=Ca(B.snapshot);ce.attachRef=null,ce.route=B,ce.injector=it,ce.outlet&&ce.outlet.activateWith(B,ce.injector),this.activateChildRoutes(D,null,ce.children)}}else this.activateChildRoutes(D,null,S)}}class Ha{constructor(D){this.path=D,this.route=this.path[this.path.length-1]}}class mr{constructor(D,L){this.component=D,this.route=L}}function dn(w,D,L){const S=w._root;return ls(S,D?D._root:null,L,[S.value])}function rr(w,D){const L=Symbol(),S=D.get(w,L);return S===L?"function"!=typeof w||(0,p.Z0I)(w)?D.get(w):w:S}function ls(w,D,L,S,B={canDeactivateChecks:[],canActivateChecks:[]}){const J=Ns(D);return w.children.forEach(ce=>{(function Ir(w,D,L,S,B={canDeactivateChecks:[],canActivateChecks:[]}){const J=w.value,ce=D?D.value:null,it=L?L.getContext(w.value.outlet):null;if(ce&&J.routeConfig===ce.routeConfig){const At=function xr(w,D,L){if("function"==typeof L)return L(w,D);switch(L){case"pathParamsChange":return!ss(w.url,D.url);case"pathParamsOrQueryParamsChange":return!ss(w.url,D.url)||!ar(w.queryParams,D.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!il(w,D)||!ar(w.queryParams,D.queryParams);default:return!il(w,D)}}(ce,J,J.routeConfig.runGuardsAndResolvers);At?B.canActivateChecks.push(new Ha(S)):(J.data=ce.data,J._resolvedData=ce._resolvedData),ls(w,D,J.component?it?it.children:null:L,S,B),At&&it&&it.outlet&&it.outlet.isActivated&&B.canDeactivateChecks.push(new mr(it.outlet.component,ce))}else ce&&Oo(D,it,B),B.canActivateChecks.push(new Ha(S)),ls(w,null,J.component?it?it.children:null:L,S,B)})(ce,J[ce.value.outlet],L,S.concat([ce.value]),B),delete J[ce.value.outlet]}),Object.entries(J).forEach(([ce,it])=>Oo(it,L.getContext(ce),B)),B}function Oo(w,D,L){const S=Ns(w),B=w.value;Object.entries(S).forEach(([J,ce])=>{Oo(ce,B.component?D?D.children.getContext(J):null:D,L)}),L.canDeactivateChecks.push(new mr(B.component&&D&&D.outlet&&D.outlet.isActivated?D.outlet.component:null,B))}function xi(w){return"function"==typeof w}function Rr(w){return w instanceof yt||"EmptyError"===(null==w?void 0:w.name)}const $r=Symbol("INITIAL_VALUE");function Bs(){return(0,ln.w)(w=>(0,Dt.a)(w.map(D=>D.pipe($n(1),function Mi(...w){const D=(0,je.yG)(w);return(0,me.e)((L,S)=>{(D?Rt(w,L,D):Rt(w,L)).subscribe(S)})}($r)))).pipe((0,dt.U)(D=>{for(const L of D)if(!0!==L){if(L===$r)return $r;if(!1===L||L instanceof fs)return L}return!0}),(0,Lt.h)(D=>D!==$r),$n(1)))}function Fi(w){return(0,et.z)(ut(D=>{if(nr(D))throw Yl(0,D)}),(0,dt.U)(D=>!0===D))}class ha{constructor(D){this.segmentGroup=D||null}}class Rs extends Error{constructor(D){super(),this.urlTree=D}}function Ur(w){return $t(new ha(w))}class bo{constructor(D,L){this.urlSerializer=D,this.urlTree=L}lineralizeSegments(D,L){let S=[],B=L.root;for(;;){if(S=S.concat(B.segments),0===B.numberOfChildren)return(0,Fe.of)(S);if(B.numberOfChildren>1||!B.children[Ut])return $t(new p.vHH(4e3,!1));B=B.children[Ut]}}applyRedirectCommands(D,L,S){const B=this.applyRedirectCreateUrlTree(L,this.urlSerializer.parse(L),D,S);if(L.startsWith("/"))throw new Rs(B);return B}applyRedirectCreateUrlTree(D,L,S,B){const J=this.createSegmentGroup(D,L.root,S,B);return new fs(J,this.createQueryParams(L.queryParams,this.urlTree.queryParams),L.fragment)}createQueryParams(D,L){const S={};return Object.entries(D).forEach(([B,J])=>{if("string"==typeof J&&J.startsWith(":")){const it=J.substring(1);S[B]=L[it]}else S[B]=J}),S}createSegmentGroup(D,L,S,B){const J=this.createSegments(D,L.segments,S,B);let ce={};return Object.entries(L.children).forEach(([it,At])=>{ce[it]=this.createSegmentGroup(D,At,S,B)}),new xn(J,ce)}createSegments(D,L,S,B){return L.map(J=>J.path.startsWith(":")?this.findPosParam(D,J,B):this.findOrReturn(J,S))}findPosParam(D,L,S){const B=S[L.path.substring(1)];if(!B)throw new p.vHH(4001,!1);return B}findOrReturn(D,L){let S=0;for(const B of L){if(B.path===D.path)return L.splice(S),B;S++}return D}}const fa={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Dc(w,D,L,S,B){const J=Lu(w,D,L);return J.matched?(S=function ol(w,D){var L;return w.providers&&!w._injector&&(w._injector=(0,p.MMx)(w.providers,D,`Route: ${w.path}`)),null!==(L=w._injector)&&void 0!==L?L:D}(D,S),function is(w,D,L,S){const B=D.canMatch;if(!B||0===B.length)return(0,Fe.of)(!0);const J=B.map(ce=>{const it=rr(ce,w);return Sr(function _e(w){return w&&xi(w.canMatch)}(it)?it.canMatch(D,L):(0,p.r_H)(w,()=>it(D,L)))});return(0,Fe.of)(J).pipe(Bs(),Fi())}(S,D,L).pipe((0,dt.U)(ce=>!0===ce?J:{...fa}))):(0,Fe.of)(J)}function Lu(w,D,L){var S,B;if("**"===D.path)return function Ic(w){return{matched:!0,parameters:w.length>0?hi(w).parameters:{},consumedSegments:w,remainingSegments:[],positionalParamSegments:{}}}(L);if(""===D.path)return"full"===D.pathMatch&&(w.hasChildren()||L.length>0)?{...fa}:{matched:!0,consumedSegments:[],remainingSegments:L,parameters:{},positionalParamSegments:{}};const ce=(D.matcher||ki)(L,w,D);if(!ce)return{...fa};const it={};Object.entries(null!==(S=ce.posParams)&&void 0!==S?S:{}).forEach(([vt,Nn])=>{it[vt]=Nn.path});const At=ce.consumed.length>0?{...it,...ce.consumed[ce.consumed.length-1].parameters}:it;return{matched:!0,consumedSegments:ce.consumed,remainingSegments:L.slice(ce.consumed.length),parameters:At,positionalParamSegments:null!==(B=ce.posParams)&&void 0!==B?B:{}}}function Rc(w,D,L,S){return L.length>0&&function Pm(w,D,L){return L.some(S=>$a(w,D,S)&&ws(S)!==Ut)}(w,L,S)?{segmentGroup:new xn(D,Ou(S,new xn(L,w.children))),slicedSegments:[]}:0===L.length&&function Vo(w,D,L){return L.some(S=>$a(w,D,S))}(w,L,S)?{segmentGroup:new xn(w.segments,If(w,0,L,S,w.children)),slicedSegments:L}:{segmentGroup:new xn(w.segments,w.children),slicedSegments:L}}function If(w,D,L,S,B){const J={};for(const ce of S)if($a(w,L,ce)&&!B[ws(ce)]){const it=new xn([],{});J[ws(ce)]=it}return{...B,...J}}function Ou(w,D){const L={};L[Ut]=D;for(const S of w)if(""===S.path&&ws(S)!==Ut){const B=new xn([],{});L[ws(S)]=B}return L}function $a(w,D,L){return(!(w.hasChildren()||D.length>0)||"full"!==L.pathMatch)&&""===L.path}class Xl{}class To{constructor(D,L,S,B,J,ce,it){this.injector=D,this.configLoader=L,this.rootComponentType=S,this.config=B,this.urlTree=J,this.paramsInheritanceStrategy=ce,this.urlSerializer=it,this.applyRedirects=new bo(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(D){return new p.vHH(4002,`'${D.segmentGroup}'`)}recognize(){const D=Rc(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(D).pipe((0,dt.U)(L=>{const S=new Qo([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ut,this.rootComponentType,null,{}),B=new ns(S,L),J=new za("",B),ce=function ps(w,D,L=null,S=null){return Ds(vo(w),D,L,S)}(S,[],this.urlTree.queryParams,this.urlTree.fragment);return ce.queryParams=this.urlTree.queryParams,J.url=this.urlSerializer.serialize(ce),this.inheritParamsAndData(J._root,null),{state:J,tree:ce}}))}match(D){return this.processSegmentGroup(this.injector,this.config,D,Ut).pipe(un(S=>{if(S instanceof Rs)return this.urlTree=S.urlTree,this.match(S.urlTree.root);throw S instanceof ha?this.noMatchError(S):S}))}inheritParamsAndData(D,L){const S=D.value,B=Va(S,L,this.paramsInheritanceStrategy);S.params=Object.freeze(B.params),S.data=Object.freeze(B.data),D.children.forEach(J=>this.inheritParamsAndData(J,S))}processSegmentGroup(D,L,S,B){return 0===S.segments.length&&S.hasChildren()?this.processChildren(D,L,S):this.processSegment(D,L,S,S.segments,B,!0).pipe((0,dt.U)(J=>J instanceof ns?[J]:[]))}processChildren(D,L,S){const B=[];for(const J of Object.keys(S.children))"primary"===J?B.unshift(J):B.push(J);return(0,ft.D)(B).pipe(wt(J=>{const ce=S.children[J],it=function Fs(w,D){const L=w.filter(S=>ws(S)===D);return L.push(...w.filter(S=>ws(S)!==D)),L}(L,J);return this.processSegmentGroup(D,it,ce,J)}),function yn(w,D){return(0,me.e)(function Mn(w,D,L,S,B){return(J,ce)=>{let it=L,At=D,vt=0;J.subscribe((0,ve.x)(ce,Nn=>{const Pi=vt++;At=it?w(At,Nn,Pi):(it=!0,Nn),S&&ce.next(At)},B&&(()=>{it&&ce.next(At),ce.complete()})))}}(w,D,arguments.length>=2,!0))}((J,ce)=>(J.push(...ce),J)),Oe(null),function ai(w,D){const L=arguments.length>=2;return S=>S.pipe(w?(0,Lt.h)((B,J)=>w(B,J,S)):mt.y,Ln(1),L?Oe(D):ye(()=>new yt))}(),(0,Le.z)(J=>{if(null===J)return Ur(S);const ce=H(J);return function zr(w){w.sort((D,L)=>D.value.outlet===Ut?-1:L.value.outlet===Ut?1:D.value.outlet.localeCompare(L.value.outlet))}(ce),(0,Fe.of)(ce)}))}processSegment(D,L,S,B,J,ce){return(0,ft.D)(L).pipe(wt(it=>{var At;return this.processSegmentAgainstRoute(null!==(At=it._injector)&&void 0!==At?At:D,L,it,S,B,J,ce).pipe(un(vt=>{if(vt instanceof ha)return(0,Fe.of)(null);throw vt}))}),xe(it=>!!it),un(it=>{if(Rr(it))return function Lm(w,D,L){return 0===D.length&&!w.children[L]}(S,B,J)?(0,Fe.of)(new Xl):Ur(S);throw it}))}processSegmentAgainstRoute(D,L,S,B,J,ce,it){return function Rf(w,D,L,S){return!!(ws(w)===S||S!==Ut&&$a(D,L,w))&&Lu(D,w,L).matched}(S,B,J,ce)?void 0===S.redirectTo?this.matchSegmentAgainstRoute(D,B,S,J,ce):this.allowRedirects&&it?this.expandSegmentAgainstRouteUsingRedirect(D,B,L,S,J,ce):Ur(B):Ur(B)}expandSegmentAgainstRouteUsingRedirect(D,L,S,B,J,ce){const{matched:it,consumedSegments:At,positionalParamSegments:vt,remainingSegments:Nn}=Lu(L,B,J);if(!it)return Ur(L);B.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const Pi=this.applyRedirects.applyRedirectCommands(At,B.redirectTo,vt);return this.applyRedirects.lineralizeSegments(B,Pi).pipe((0,Le.z)(Jr=>this.processSegment(D,S,L,Jr.concat(Nn),ce,!1)))}matchSegmentAgainstRoute(D,L,S,B,J){const ce=Dc(L,S,B,D);return"**"===S.path&&(L.children={}),ce.pipe((0,ln.w)(it=>{var At;return it.matched?(D=null!==(At=S._injector)&&void 0!==At?At:D,this.getChildConfig(D,S,B).pipe((0,ln.w)(({routes:vt})=>{var Nn,Pi,Jr;const Lr=null!==(Nn=S._loadedInjector)&&void 0!==Nn?Nn:D,{consumedSegments:kn,remainingSegments:qa,parameters:oa}=it,Eo=new Qo(kn,oa,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function z(w){return w.data||{}}(S),ws(S),null!==(Pi=null!==(Jr=S.component)&&void 0!==Jr?Jr:S._loadedComponent)&&void 0!==Pi?Pi:null,S,function ue(w){return w.resolve||{}}(S)),{segmentGroup:Ia,slicedSegments:Wo}=Rc(L,kn,qa,vt);if(0===Wo.length&&Ia.hasChildren())return this.processChildren(Lr,vt,Ia).pipe((0,dt.U)(va=>null===va?null:new ns(Eo,va)));if(0===vt.length&&0===Wo.length)return(0,Fe.of)(new ns(Eo,[]));const wo=ws(S)===J;return this.processSegment(Lr,vt,Ia,Wo,wo?Ut:J,!0).pipe((0,dt.U)(va=>new ns(Eo,va instanceof ns?[va]:[])))}))):Ur(L)}))}getChildConfig(D,L,S){return L.children?(0,Fe.of)({routes:L.children,injector:D}):L.loadChildren?void 0!==L._loadedRoutes?(0,Fe.of)({routes:L._loadedRoutes,injector:L._loadedInjector}):function Jt(w,D,L,S){const B=D.canLoad;if(void 0===B||0===B.length)return(0,Fe.of)(!0);const J=B.map(ce=>{const it=rr(ce,w);return Sr(function $(w){return w&&xi(w.canLoad)}(it)?it.canLoad(D,L):(0,p.r_H)(w,()=>it(D,L)))});return(0,Fe.of)(J).pipe(Bs(),Fi())}(D,L,S).pipe((0,Le.z)(B=>B?this.configLoader.loadChildren(D,L).pipe(ut(J=>{L._loadedRoutes=J.routes,L._loadedInjector=J.injector})):function ql(w){return $t(Uo(!1,3))}())):(0,Fe.of)({routes:[],injector:D})}}function R(w){const D=w.value.routeConfig;return D&&""===D.path}function H(w){const D=[],L=new Set;for(const S of w){if(!R(S)){D.push(S);continue}const B=D.find(J=>S.value.routeConfig===J.value.routeConfig);void 0!==B?(B.children.push(...S.children),L.add(B)):D.push(S)}for(const S of L){const B=H(S.children);D.push(new ns(S.value,B))}return D.filter(S=>!L.has(S))}function on(w){const D=w.children.map(L=>on(L)).flat();return[w,...D]}function bi(w){return(0,ln.w)(D=>{const L=w(D);return L?(0,ft.D)(L).pipe((0,dt.U)(()=>D)):(0,Fe.of)(D)})}let dr=(()=>{var w;class D{buildTitle(S){let B,J=S.root;for(;void 0!==J;){var ce;B=null!==(ce=this.getResolvedTitleForRoute(J))&&void 0!==ce?ce:B,J=J.children.find(it=>it.outlet===Ut)}return B}getResolvedTitleForRoute(S){return S.data[ti]}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:()=>(0,p.f3M)(tr),providedIn:"root"}),D})(),tr=(()=>{var w;class D extends dr{constructor(S){super(),this.title=S}updateTitle(S){const B=this.buildTitle(S);void 0!==B&&this.title.setTitle(B)}}return(w=D).\u0275fac=function(S){return new(S||w)(p.LFG(tn.Dx))},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();const Pr=new p.OlP("",{providedIn:"root",factory:()=>({})}),Ms=new p.OlP("ROUTES");let ks=(()=>{var w;class D{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,p.f3M)(p.Sil)}loadComponent(S){if(this.componentLoaders.get(S))return this.componentLoaders.get(S);if(S._loadedComponent)return(0,Fe.of)(S._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(S);const B=Sr(S.loadComponent()).pipe((0,dt.U)(qr),ut(ce=>{this.onLoadEndListener&&this.onLoadEndListener(S),S._loadedComponent=ce}),Xt(()=>{this.componentLoaders.delete(S)})),J=new Ce(B,()=>new at.x).pipe(Ue());return this.componentLoaders.set(S,J),J}loadChildren(S,B){if(this.childrenLoaders.get(B))return this.childrenLoaders.get(B);if(B._loadedRoutes)return(0,Fe.of)({routes:B._loadedRoutes,injector:B._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(B);const ce=function Do(w,D,L,S){return Sr(w.loadChildren()).pipe((0,dt.U)(qr),(0,Le.z)(B=>B instanceof p.YKP||Array.isArray(B)?(0,Fe.of)(B):(0,ft.D)(D.compileModuleAsync(B))),(0,dt.U)(B=>{S&&S(w);let J,ce,it=!1;return Array.isArray(B)?(ce=B,!0):(J=B.create(L).injector,ce=J.get(Ms,[],{optional:!0,self:!0}).flat()),{routes:ce.map(Es),injector:J}}))}(B,this.compiler,S,this.onLoadEndListener).pipe(Xt(()=>{this.childrenLoaders.delete(B)})),it=new Ce(ce,()=>new at.x).pipe(Ue());return this.childrenLoaders.set(B,it),it}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();function qr(w){return function ao(w){return w&&"object"==typeof w&&"default"in w}(w)?w.default:w}let Us=(()=>{var w;class D{}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:()=>(0,p.f3M)(zo),providedIn:"root"}),D})(),zo=(()=>{var w;class D{shouldProcessUrl(S){return!0}extract(S){return S}merge(S,B){return S}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();const Ta=new p.OlP(""),Pc=new p.OlP("");function Kl(w,D,L){const S=w.get(Pc),B=w.get(lt.K0);return w.get(p.R0b).runOutsideAngular(()=>{if(!B.startViewTransition||S.skipNextTransition)return S.skipNextTransition=!1,Promise.resolve();let J;const ce=new Promise(vt=>{J=vt}),it=B.startViewTransition(()=>(J(),function Hr(w){return new Promise(D=>{(0,p.T8G)(D,{injector:w})})}(w))),{onViewTransitionCreated:At}=S;return At&&(0,p.r_H)(w,()=>At({transition:it,from:D,to:L})),ce})}let Zl=(()=>{var w;class D{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new at.x,this.transitionAbortSubject=new at.x,this.configLoader=(0,p.f3M)(ks),this.environmentInjector=(0,p.f3M)(p.lqb),this.urlSerializer=(0,p.f3M)(Br),this.rootContexts=(0,p.f3M)(yi),this.location=(0,p.f3M)(lt.Ye),this.inputBindingEnabled=null!==(0,p.f3M)(xl,{optional:!0}),this.titleStrategy=(0,p.f3M)(dr),this.options=(0,p.f3M)(Pr,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,p.f3M)(Us),this.createViewTransition=(0,p.f3M)(Ta,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Fe.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=J=>this.events.next(new En(J)),this.configLoader.onLoadStartListener=J=>this.events.next(new Zt(J))}complete(){var S;null===(S=this.transitions)||void 0===S||S.complete()}handleNavigationRequest(S){var B;const J=++this.navigationId;null===(B=this.transitions)||void 0===B||B.next({...this.transitions.value,...S,id:J})}setupNavigations(S,B,J){return this.transitions=new Be.X({id:0,currentUrlTree:B,currentRawUrl:B,extractedUrl:this.urlHandlingStrategy.extract(B),urlAfterRedirects:this.urlHandlingStrategy.extract(B),rawUrl:B,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Qe,restoredState:null,currentSnapshot:J.snapshot,targetSnapshot:null,currentRouterState:J,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Lt.h)(ce=>0!==ce.id),(0,dt.U)(ce=>({...ce,extractedUrl:this.urlHandlingStrategy.extract(ce.rawUrl)})),(0,ln.w)(ce=>{this.currentTransition=ce;let it=!1,At=!1;return(0,Fe.of)(ce).pipe(ut(vt=>{this.currentNavigation={id:vt.id,initialUrl:vt.rawUrl,extractedUrl:vt.extractedUrl,trigger:vt.source,extras:vt.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ln.w)(vt=>{var Nn;const Pi=!S.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),Jr=null!==(Nn=vt.extras.onSameUrlNavigation)&&void 0!==Nn?Nn:S.onSameUrlNavigation;if(!Pi&&"reload"!==Jr){const Lr="";return this.events.next(new pe(vt.id,this.urlSerializer.serialize(vt.rawUrl),Lr,0)),vt.resolve(null),st}if(this.urlHandlingStrategy.shouldProcessUrl(vt.rawUrl))return(0,Fe.of)(vt).pipe((0,ln.w)(Lr=>{var kn,qa;const oa=null===(kn=this.transitions)||void 0===kn?void 0:kn.getValue();return this.events.next(new _n(Lr.id,this.urlSerializer.serialize(Lr.extractedUrl),Lr.source,Lr.restoredState)),oa!==(null===(qa=this.transitions)||void 0===qa?void 0:qa.getValue())?st:Promise.resolve(Lr)}),function De(w,D,L,S,B,J){return(0,Le.z)(ce=>function oh(w,D,L,S,B,J,ce="emptyOnly"){return new To(w,D,L,S,B,ce,J).recognize()}(w,D,L,S,ce.extractedUrl,B,J).pipe((0,dt.U)(({state:it,tree:At})=>({...ce,targetSnapshot:it,urlAfterRedirects:At}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,S.config,this.urlSerializer,this.paramsInheritanceStrategy),ut(Lr=>{ce.targetSnapshot=Lr.targetSnapshot,ce.urlAfterRedirects=Lr.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Lr.urlAfterRedirects};const kn=new Et(Lr.id,this.urlSerializer.serialize(Lr.extractedUrl),this.urlSerializer.serialize(Lr.urlAfterRedirects),Lr.targetSnapshot);this.events.next(kn)}));if(Pi&&this.urlHandlingStrategy.shouldProcessUrl(vt.currentRawUrl)){const{id:Lr,extractedUrl:kn,source:qa,restoredState:oa,extras:Eo}=vt,Ia=new _n(Lr,this.urlSerializer.serialize(kn),qa,oa);this.events.next(Ia);const Wo=Gi(0,this.rootComponentType).snapshot;return this.currentTransition=ce={...vt,targetSnapshot:Wo,urlAfterRedirects:kn,extras:{...Eo,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=kn,(0,Fe.of)(ce)}{const Lr="";return this.events.next(new pe(vt.id,this.urlSerializer.serialize(vt.extractedUrl),Lr,1)),vt.resolve(null),st}}),ut(vt=>{const Nn=new Xe(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects),vt.targetSnapshot);this.events.next(Nn)}),(0,dt.U)(vt=>(this.currentTransition=ce={...vt,guards:dn(vt.targetSnapshot,vt.currentSnapshot,this.rootContexts)},ce)),function No(w,D){return(0,Le.z)(L=>{const{targetSnapshot:S,currentSnapshot:B,guards:{canActivateChecks:J,canDeactivateChecks:ce}}=L;return 0===ce.length&&0===J.length?(0,Fe.of)({...L,guardsResult:!0}):function _o(w,D,L,S){return(0,ft.D)(w).pipe((0,Le.z)(B=>function Bo(w,D,L,S,B){const J=D&&D.routeConfig?D.routeConfig.canDeactivate:null;if(!J||0===J.length)return(0,Fe.of)(!0);const ce=J.map(it=>{var At;const vt=null!==(At=Ca(D))&&void 0!==At?At:B,Nn=rr(it,vt);return Sr(function G(w){return w&&xi(w.canDeactivate)}(Nn)?Nn.canDeactivate(w,D,L,S):(0,p.r_H)(vt,()=>Nn(w,D,L,S))).pipe(xe())});return(0,Fe.of)(ce).pipe(Bs())}(B.component,B.route,L,D,S)),xe(B=>!0!==B,!0))}(ce,S,B,w).pipe((0,Le.z)(it=>it&&function so(w){return"boolean"==typeof w}(it)?function Aa(w,D,L,S){return(0,ft.D)(D).pipe(wt(B=>Rt(function Ai(w,D){return null!==w&&D&&D(new Wn(w)),(0,Fe.of)(!0)}(B.route.parent,S),function Fo(w,D){return null!==w&&D&&D(new $i(w)),(0,Fe.of)(!0)}(B.route,S),function Ni(w,D,L){const S=D[D.length-1],J=D.slice(0,D.length-1).reverse().map(ce=>function pi(w){const D=w.routeConfig?w.routeConfig.canActivateChild:null;return D&&0!==D.length?{node:w,guards:D}:null}(ce)).filter(ce=>null!==ce).map(ce=>Je(()=>{const it=ce.guards.map(At=>{var vt;const Nn=null!==(vt=Ca(ce.node))&&void 0!==vt?vt:L,Pi=rr(At,Nn);return Sr(function ae(w){return w&&xi(w.canActivateChild)}(Pi)?Pi.canActivateChild(S,w):(0,p.r_H)(Nn,()=>Pi(S,w))).pipe(xe())});return(0,Fe.of)(it).pipe(Bs())}));return(0,Fe.of)(J).pipe(Bs())}(w,B.path,L),function oo(w,D,L){const S=D.routeConfig?D.routeConfig.canActivate:null;if(!S||0===S.length)return(0,Fe.of)(!0);const B=S.map(J=>Je(()=>{var ce;const it=null!==(ce=Ca(D))&&void 0!==ce?ce:L,At=rr(J,it);return Sr(function O(w){return w&&xi(w.canActivate)}(At)?At.canActivate(D,w):(0,p.r_H)(it,()=>At(D,w))).pipe(xe())}));return(0,Fe.of)(B).pipe(Bs())}(w,B.route,L))),xe(B=>!0!==B,!0))}(S,J,w,D):(0,Fe.of)(it)),(0,dt.U)(it=>({...L,guardsResult:it})))})}(this.environmentInjector,vt=>this.events.next(vt)),ut(vt=>{if(ce.guardsResult=vt.guardsResult,nr(vt.guardsResult))throw Yl(0,vt.guardsResult);const Nn=new Wt(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects),vt.targetSnapshot,!!vt.guardsResult);this.events.next(Nn)}),(0,Lt.h)(vt=>!!vt.guardsResult||(this.cancelNavigationTransition(vt,"",3),!1)),bi(vt=>{if(vt.guards.canActivateChecks.length)return(0,Fe.of)(vt).pipe(ut(Nn=>{const Pi=new Yt(Nn.id,this.urlSerializer.serialize(Nn.extractedUrl),this.urlSerializer.serialize(Nn.urlAfterRedirects),Nn.targetSnapshot);this.events.next(Pi)}),(0,ln.w)(Nn=>{let Pi=!1;return(0,Fe.of)(Nn).pipe(function jt(w,D){return(0,Le.z)(L=>{const{targetSnapshot:S,guards:{canActivateChecks:B}}=L;if(!B.length)return(0,Fe.of)(L);const J=new Set(B.map(At=>At.route)),ce=new Set;for(const At of J)if(!ce.has(At))for(const vt of on(At))ce.add(vt);let it=0;return(0,ft.D)(ce).pipe(wt(At=>J.has(At)?function he(w,D,L,S){const B=w.routeConfig,J=w._resolve;return void 0!==(null==B?void 0:B.title)&&!Sc(B)&&(J[ti]=B.title),function er(w,D,L,S){const B=Rn(w);if(0===B.length)return(0,Fe.of)({});const J={};return(0,ft.D)(B).pipe((0,Le.z)(ce=>function ur(w,D,L,S){var B;const J=null!==(B=Ca(D))&&void 0!==B?B:S,ce=rr(w,J);return Sr(ce.resolve?ce.resolve(D,L):(0,p.r_H)(J,()=>ce(D,L)))}(w[ce],D,L,S).pipe(xe(),ut(it=>{J[ce]=it}))),Ln(1),function Si(w){return(0,dt.U)(()=>w)}(J),un(ce=>Rr(ce)?st:$t(ce)))}(J,w,D,S).pipe((0,dt.U)(ce=>(w._resolvedData=ce,w.data=Va(w,w.parent,L).resolve,null)))}(At,S,w,D):(At.data=Va(At,At.parent,w).resolve,(0,Fe.of)(void 0))),ut(()=>it++),Ln(1),(0,Le.z)(At=>it===ce.size?(0,Fe.of)(L):st))})}(this.paramsInheritanceStrategy,this.environmentInjector),ut({next:()=>Pi=!0,complete:()=>{Pi||this.cancelNavigationTransition(Nn,"",2)}}))}),ut(Nn=>{const Pi=new cn(Nn.id,this.urlSerializer.serialize(Nn.extractedUrl),this.urlSerializer.serialize(Nn.urlAfterRedirects),Nn.targetSnapshot);this.events.next(Pi)}))}),bi(vt=>{const Nn=Pi=>{var Jr;const Lr=[];null!==(Jr=Pi.routeConfig)&&void 0!==Jr&&Jr.loadComponent&&!Pi.routeConfig._loadedComponent&&Lr.push(this.configLoader.loadComponent(Pi.routeConfig).pipe(ut(kn=>{Pi.component=kn}),(0,dt.U)(()=>{})));for(const kn of Pi.children)Lr.push(...Nn(kn));return Lr};return(0,Dt.a)(Nn(vt.targetSnapshot.root)).pipe(Oe(null),$n(1))}),bi(()=>this.afterPreactivation()),(0,ln.w)(()=>{var vt;const{currentSnapshot:Nn,targetSnapshot:Pi}=ce,Jr=null===(vt=this.createViewTransition)||void 0===vt?void 0:vt.call(this,this.environmentInjector,Nn.root,Pi.root);return Jr?(0,ft.D)(Jr).pipe((0,dt.U)(()=>ce)):(0,Fe.of)(ce)}),(0,dt.U)(vt=>{const Nn=function sh(w,D,L){const S=El(w,D._root,L?L._root:void 0);return new yo(S,D)}(S.routeReuseStrategy,vt.targetSnapshot,vt.currentRouterState);return this.currentTransition=ce={...vt,targetRouterState:Nn},this.currentNavigation.targetRouterState=Nn,ce}),ut(()=>{this.events.next(new ie)}),((w,D,L,S)=>(0,dt.U)(B=>(new ea(D,B.targetRouterState,B.currentRouterState,L,S).activate(w),B)))(this.rootContexts,S.routeReuseStrategy,vt=>this.events.next(vt),this.inputBindingEnabled),$n(1),ut({next:vt=>{var Nn;it=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new U(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects))),null===(Nn=this.titleStrategy)||void 0===Nn||Nn.updateTitle(vt.targetRouterState.snapshot),vt.resolve(!0)},complete:()=>{it=!0}}),function It(w){return(0,me.e)((D,L)=>{(0,Ze.Xf)(w).subscribe((0,ve.x)(L,()=>L.complete(),Ft.Z)),!L.closed&&D.subscribe(L)})}(this.transitionAbortSubject.pipe(ut(vt=>{throw vt}))),Xt(()=>{var vt;it||At||this.cancelNavigationTransition(ce,"",1),(null===(vt=this.currentNavigation)||void 0===vt?void 0:vt.id)===ce.id&&(this.currentNavigation=null)}),un(vt=>{if(At=!0,Sa(vt))this.events.next(new q(ce.id,this.urlSerializer.serialize(ce.extractedUrl),vt.message,vt.cancellationCode)),function Tu(w){return Sa(w)&&nr(w.url)}(vt)?this.events.next(new k(vt.url)):ce.resolve(!1);else{var Nn;this.events.next(new Ne(ce.id,this.urlSerializer.serialize(ce.extractedUrl),vt,null!==(Nn=ce.targetSnapshot)&&void 0!==Nn?Nn:void 0));try{ce.resolve(S.errorHandler(vt))}catch(Pi){ce.reject(Pi)}}return st}))}))}cancelNavigationTransition(S,B,J){const ce=new q(S.id,this.urlSerializer.serialize(S.extractedUrl),B,J);this.events.next(ce),S.resolve(!1)}isUpdatingInternalState(){var S,B;return(null===(S=this.currentTransition)||void 0===S?void 0:S.extractedUrl.toString())!==(null===(B=this.currentTransition)||void 0===B?void 0:B.currentUrlTree.toString())}isUpdatedBrowserUrl(){var S,B;return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==(null===(S=this.currentTransition)||void 0===S?void 0:S.extractedUrl.toString())&&!(null!==(B=this.currentTransition)&&void 0!==B&&B.extras.skipLocationChange)}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();function Ga(w){return w!==Qe}let qs=(()=>{var w;class D{}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:()=>(0,p.f3M)(Ho),providedIn:"root"}),D})();class pa{shouldDetach(D){return!1}store(D,L){}shouldAttach(D){return!1}retrieve(D){return null}shouldReuseRoute(D,L){return D.routeConfig===L.routeConfig}}let Ho=(()=>{var w;class D extends pa{}return(w=D).\u0275fac=(()=>{let L;return function(B){return(L||(L=p.n5z(w)))(B||w)}})(),w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})(),Wa=(()=>{var w;class D{}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:()=>(0,p.f3M)(xo),providedIn:"root"}),D})(),xo=(()=>{var w;class D extends Wa{constructor(){super(...arguments),this.location=(0,p.f3M)(lt.Ye),this.urlSerializer=(0,p.f3M)(Br),this.options=(0,p.f3M)(Pr,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,p.f3M)(Us),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new fs,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Gi(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){var S,B;return"computed"!==this.canceledNavigationResolution?this.currentPageId:null!==(S=null===(B=this.restoredState())||void 0===B?void 0:B.\u0275routerPageId)&&void 0!==S?S:this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(S){return this.location.subscribe(B=>{"popstate"===B.type&&S(B.url,B.state)})}handleRouterEvent(S,B){if(S instanceof _n)this.stateMemento=this.createStateMemento();else if(S instanceof pe)this.rawUrlTree=B.initialUrl;else if(S instanceof Et){if("eager"===this.urlUpdateStrategy&&!B.extras.skipLocationChange){const J=this.urlHandlingStrategy.merge(B.finalUrl,B.initialUrl);this.setBrowserUrl(J,B)}}else S instanceof ie?(this.currentUrlTree=B.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(B.finalUrl,B.initialUrl),this.routerState=B.targetRouterState,"deferred"===this.urlUpdateStrategy&&(B.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,B))):S instanceof q&&(3===S.code||2===S.code)?this.restoreHistory(B):S instanceof Ne?this.restoreHistory(B,!0):S instanceof U&&(this.lastSuccessfulId=S.id,this.currentPageId=this.browserPageId)}setBrowserUrl(S,B){const J=this.urlSerializer.serialize(S);if(this.location.isCurrentPathEqualTo(J)||B.extras.replaceUrl){const it={...B.extras.state,...this.generateNgRouterState(B.id,this.browserPageId)};this.location.replaceState(J,"",it)}else{const ce={...B.extras.state,...this.generateNgRouterState(B.id,this.browserPageId+1)};this.location.go(J,"",ce)}}restoreHistory(S,B=!1){if("computed"===this.canceledNavigationResolution){const ce=this.currentPageId-this.browserPageId;0!==ce?this.location.historyGo(ce):this.currentUrlTree===S.finalUrl&&0===ce&&(this.resetState(S),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(B&&this.resetState(S),this.resetUrlToCurrentUrlTree())}resetState(S){var B;this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,null!==(B=S.finalUrl)&&void 0!==B?B:this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(S,B){return"computed"===this.canceledNavigationResolution?{navigationId:S,\u0275routerPageId:B}:{navigationId:S}}}return(w=D).\u0275fac=(()=>{let L;return function(B){return(L||(L=p.n5z(w)))(B||w)}})(),w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();var ta=function(w){return w[w.COMPLETE=0]="COMPLETE",w[w.FAILED=1]="FAILED",w[w.REDIRECTING=2]="REDIRECTING",w}(ta||{});function Jl(w,D){w.events.pipe((0,Lt.h)(L=>L instanceof U||L instanceof q||L instanceof Ne||L instanceof pe),(0,dt.U)(L=>L instanceof U||L instanceof pe?ta.COMPLETE:L instanceof q&&(0===L.code||1===L.code)?ta.REDIRECTING:ta.FAILED),(0,Lt.h)(L=>L!==ta.REDIRECTING),$n(1)).subscribe(()=>{D()})}function Nu(w){throw w}const na={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ml={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let _i=(()=>{var w;class D{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){var S,B;this.disposed=!1,this.isNgZoneEnabled=!1,this.console=(0,p.f3M)(p.c2e),this.stateManager=(0,p.f3M)(Wa),this.options=(0,p.f3M)(Pr,{optional:!0})||{},this.pendingTasks=(0,p.f3M)(p.I6F),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,p.f3M)(Zl),this.urlSerializer=(0,p.f3M)(Br),this.location=(0,p.f3M)(lt.Ye),this.urlHandlingStrategy=(0,p.f3M)(Us),this._events=new at.x,this.errorHandler=this.options.errorHandler||Nu,this.navigated=!1,this.routeReuseStrategy=(0,p.f3M)(qs),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=null!==(S=null===(B=(0,p.f3M)(Ms,{optional:!0}))||void 0===B?void 0:B.flat())&&void 0!==S?S:[],this.componentInputBindingEnabled=!!(0,p.f3M)(xl,{optional:!0}),this.eventsSubscription=new $e.w0,this.isNgZoneEnabled=(0,p.f3M)(p.R0b)instanceof p.R0b&&p.R0b.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:J=>{this.console.warn(J)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const S=this.navigationTransitions.events.subscribe(B=>{try{const J=this.navigationTransitions.currentTransition,ce=this.navigationTransitions.currentNavigation;if(null!==J&&null!==ce)if(this.stateManager.handleRouterEvent(B,ce),B instanceof q&&0!==B.code&&1!==B.code)this.navigated=!0;else if(B instanceof U)this.navigated=!0;else if(B instanceof k){const it=this.urlHandlingStrategy.merge(B.url,J.currentRawUrl),At={skipLocationChange:J.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ga(J.source)};this.scheduleNavigation(it,Qe,null,At,{resolve:J.resolve,reject:J.reject,promise:J.promise})}(function ia(w){return!(w instanceof ie||w instanceof k)})(B)&&this._events.next(B)}catch(J){this.navigationTransitions.transitionAbortSubject.next(J)}});this.eventsSubscription.add(S)}resetRootComponentType(S){this.routerState.root.component=S,this.navigationTransitions.rootComponentType=S}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qe,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((S,B)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(S,"popstate",B)},0)}))}navigateToSyncWithBrowser(S,B,J){const ce={replaceUrl:!0},it=null!=J&&J.navigationId?J:null;if(J){const vt={...J};delete vt.navigationId,delete vt.\u0275routerPageId,0!==Object.keys(vt).length&&(ce.state=vt)}const At=this.parseUrl(S);this.scheduleNavigation(At,B,it,ce)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(S){this.config=S.map(Es),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(S,B={}){const{relativeTo:J,queryParams:ce,fragment:it,queryParamsHandling:At,preserveFragment:vt}=B,Nn=vt?this.currentUrlTree.fragment:it;let Jr,Pi=null;switch(At){case"merge":Pi={...this.currentUrlTree.queryParams,...ce};break;case"preserve":Pi=this.currentUrlTree.queryParams;break;default:Pi=ce||null}null!==Pi&&(Pi=this.removeEmptyProps(Pi));try{Jr=vo(J?J.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof S[0]||!S[0].startsWith("/"))&&(S=[]),Jr=this.currentUrlTree.root}return Ds(Jr,S,Pi,null!=Nn?Nn:null)}navigateByUrl(S,B={skipLocationChange:!1}){const J=nr(S)?S:this.parseUrl(S),ce=this.urlHandlingStrategy.merge(J,this.rawUrlTree);return this.scheduleNavigation(ce,Qe,null,B)}navigate(S,B={skipLocationChange:!1}){return function Sl(w){for(let D=0;D<w.length;D++)if(null==w[D])throw new p.vHH(4008,!1)}(S),this.navigateByUrl(this.createUrlTree(S,B),B)}serializeUrl(S){return this.urlSerializer.serialize(S)}parseUrl(S){try{return this.urlSerializer.parse(S)}catch{return this.urlSerializer.parse("/")}}isActive(S,B){let J;if(J=!0===B?{...na}:!1===B?{...Ml}:B,nr(S))return Cr(this.currentUrlTree,S,J);const ce=this.parseUrl(S);return Cr(this.currentUrlTree,ce,J)}removeEmptyProps(S){return Object.keys(S).reduce((B,J)=>{const ce=S[J];return null!=ce&&(B[J]=ce),B},{})}scheduleNavigation(S,B,J,ce,it){if(this.disposed)return Promise.resolve(!1);let At,vt,Nn;it?(At=it.resolve,vt=it.reject,Nn=it.promise):Nn=new Promise((Jr,Lr)=>{At=Jr,vt=Lr});const Pi=this.pendingTasks.add();return Jl(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Pi))}),this.navigationTransitions.handleNavigationRequest({source:B,restoredState:J,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:S,extras:ce,resolve:At,reject:vt,promise:Nn,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Nn.catch(Jr=>Promise.reject(Jr))}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})(),Ql=(()=>{var w;class D{constructor(S,B,J,ce,it,At){var vt;this.router=S,this.route=B,this.tabIndexAttribute=J,this.renderer=ce,this.el=it,this.locationStrategy=At,this.href=null,this.commands=null,this.onChanges=new at.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const Nn=null===(vt=it.nativeElement.tagName)||void 0===vt?void 0:vt.toLowerCase();this.isAnchorElement="a"===Nn||"area"===Nn,this.isAnchorElement?this.subscription=S.events.subscribe(Pi=>{Pi instanceof U&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(S){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",S)}ngOnChanges(S){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(S){null!=S?(this.commands=Array.isArray(S)?S:[S],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(S,B,J,ce,it){return!!(null===this.urlTree||this.isAnchorElement&&(0!==S||B||J||ce||it||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){var S;null===(S=this.subscription)||void 0===S||S.unsubscribe()}updateHref(){var S;this.href=null!==this.urlTree&&this.locationStrategy?null===(S=this.locationStrategy)||void 0===S?void 0:S.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const B=null===this.href?null:(0,p.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",B)}applyAttributeValue(S,B){const J=this.renderer,ce=this.el.nativeElement;null!==B?J.setAttribute(ce,S,B):J.removeAttribute(ce,S)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(w=D).\u0275fac=function(S){return new(S||w)(p.Y36(_i),p.Y36(Li),p.$8M("tabindex"),p.Y36(p.Qsj),p.Y36(p.SBq),p.Y36(lt.S$))},w.\u0275dir=p.lG2({type:w,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(S,B){1&S&&p.NdJ("click",function(ce){return B.onClick(ce.button,ce.ctrlKey,ce.shiftKey,ce.altKey,ce.metaKey)}),2&S&&p.uIk("target",B.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",p.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",p.VuI],replaceUrl:["replaceUrl","replaceUrl",p.VuI],routerLink:"routerLink"},standalone:!0,features:[p.Xq5,p.TTD]}),D})();class Cl{}let fi=(()=>{var w;class D{preload(S,B){return B().pipe(un(()=>(0,Fe.of)(null)))}}return(w=D).\u0275fac=function(S){return new(S||w)},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})(),Nm=(()=>{var w;class D{constructor(S,B,J,ce,it){this.router=S,this.injector=J,this.preloadingStrategy=ce,this.loader=it}setUpPreloading(){this.subscription=this.router.events.pipe((0,Lt.h)(S=>S instanceof U),wt(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(S,B){const J=[];for(const vt of B){var ce,it;vt.providers&&!vt._injector&&(vt._injector=(0,p.MMx)(vt.providers,S,`Route: ${vt.path}`));const Nn=null!==(ce=vt._injector)&&void 0!==ce?ce:S,Pi=null!==(it=vt._loadedInjector)&&void 0!==it?it:Nn;var At;(vt.loadChildren&&!vt._loadedRoutes&&void 0===vt.canLoad||vt.loadComponent&&!vt._loadedComponent)&&J.push(this.preloadConfig(Nn,vt)),(vt.children||vt._loadedRoutes)&&J.push(this.processRoutes(Pi,null!==(At=vt.children)&&void 0!==At?At:vt._loadedRoutes))}return(0,ft.D)(J).pipe(ct())}preloadConfig(S,B){return this.preloadingStrategy.preload(B,()=>{let J;J=B.loadChildren&&void 0===B.canLoad?this.loader.loadChildren(S,B):(0,Fe.of)(null);const ce=J.pipe((0,Le.z)(it=>{var At;return null===it?(0,Fe.of)(void 0):(B._loadedRoutes=it.routes,B._loadedInjector=it.injector,this.processRoutes(null!==(At=it.injector)&&void 0!==At?At:S,it.routes))}));if(B.loadComponent&&!B._loadedComponent){const it=this.loader.loadComponent(B);return(0,ft.D)([ce,it]).pipe(ct())}return ce})}}return(w=D).\u0275fac=function(S){return new(S||w)(p.LFG(_i),p.LFG(p.Sil),p.LFG(p.lqb),p.LFG(Cl),p.LFG(ks))},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),D})();const ah=new p.OlP("");let Fu=(()=>{var w;class D{constructor(S,B,J,ce,it={}){this.urlSerializer=S,this.transitions=B,this.viewportScroller=J,this.zone=ce,this.options=it,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},it.scrollPositionRestoration=it.scrollPositionRestoration||"disabled",it.anchorScrolling=it.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof _n?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=S.navigationTrigger,this.restoredId=S.restoredState?S.restoredState.navigationId:0):S instanceof U?(this.lastId=S.id,this.scheduleScrollEvent(S,this.urlSerializer.parse(S.urlAfterRedirects).fragment)):S instanceof pe&&0===S.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(S,this.urlSerializer.parse(S.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof I&&(S.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(S.position):S.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(S.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(S,B){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new I(S,"popstate"===this.lastSource?this.store[this.restoredId]:null,B))})},0)})}ngOnDestroy(){var S,B;null===(S=this.routerEventsSubscription)||void 0===S||S.unsubscribe(),null===(B=this.scrollEventsSubscription)||void 0===B||B.unsubscribe()}}return(w=D).\u0275fac=function(S){p.$Z()},w.\u0275prov=p.Yz7({token:w,factory:w.\u0275fac}),D})();function Ps(w,D){return{\u0275kind:w,\u0275providers:D}}function Lf(){const w=(0,p.f3M)(p.zs3);return D=>{var L,S;const B=w.get(p.z2F);if(D!==B.components[0])return;const J=w.get(_i),ce=w.get(qt);1===w.get(sr)&&J.initialNavigation(),null===(L=w.get(Ls,null,p.XFs.Optional))||void 0===L||L.setUpPreloading(),null===(S=w.get(ah,null,p.XFs.Optional))||void 0===S||S.init(),J.resetRootComponentType(B.componentTypes[0]),ce.closed||(ce.next(),ce.complete(),ce.unsubscribe())}}const qt=new p.OlP("",{factory:()=>new at.x}),sr=new p.OlP("",{providedIn:"root",factory:()=>1}),Ls=new p.OlP("");function Io(w){return Ps(0,[{provide:Ls,useExisting:Nm},{provide:Cl,useExisting:w}])}function Oc(w){return Ps(9,[{provide:Ta,useValue:Kl},{provide:Pc,useValue:{skipNextTransition:!(null==w||!w.skipInitialTransition),...w}}])}const Xs=new p.OlP("ROUTER_FORROOT_GUARD"),ga=[lt.Ye,{provide:Br,useClass:ts},_i,yi,{provide:Li,useFactory:function Bu(w){return w.routerState.root},deps:[_i]},ks,[]];let Vu=(()=>{var w;class D{constructor(S){}static forRoot(S,B){return{ngModule:D,providers:[ga,[],{provide:Ms,multi:!0,useValue:S},{provide:Xs,useFactory:Go,deps:[[_i,new p.FiY,new p.tp0]]},{provide:Pr,useValue:B||{}},null!=B&&B.useHash?{provide:lt.S$,useClass:lt.Do}:{provide:lt.S$,useClass:lt.b0},{provide:ah,useFactory:()=>{const w=(0,p.f3M)(lt.EM),D=(0,p.f3M)(p.R0b),L=(0,p.f3M)(Pr),S=(0,p.f3M)(Zl),B=(0,p.f3M)(Br);return L.scrollOffset&&w.setOffset(L.scrollOffset),new Fu(B,S,w,D,L)}},null!=B&&B.preloadingStrategy?Io(B.preloadingStrategy).\u0275providers:[],null!=B&&B.initialNavigation?Ff(B):[],null!=B&&B.bindToComponentInputs?Ps(8,[Ao,{provide:xl,useExisting:Ao}]).\u0275providers:[],null!=B&&B.enableViewTransitions?Oc().\u0275providers:[],[{provide:ra,useFactory:Lf},{provide:p.tb,multi:!0,useExisting:ra}]]}}static forChild(S){return{ngModule:D,providers:[{provide:Ms,multi:!0,useValue:S}]}}}return(w=D).\u0275fac=function(S){return new(S||w)(p.LFG(Xs,8))},w.\u0275mod=p.oAB({type:w}),w.\u0275inj=p.cJS({}),D})();function Go(w){return"guarded"}function Ff(w){return["disabled"===w.initialNavigation?Ps(3,[{provide:p.ip1,multi:!0,useFactory:()=>{const D=(0,p.f3M)(_i);return()=>{D.setUpLocationChangeListener()}}},{provide:sr,useValue:2}]).\u0275providers:[],"enabledBlocking"===w.initialNavigation?Ps(2,[{provide:sr,useValue:0},{provide:p.ip1,multi:!0,deps:[p.zs3],useFactory:D=>{const L=D.get(lt.V_,Promise.resolve());return()=>L.then(()=>new Promise(S=>{const B=D.get(_i),J=D.get(qt);Jl(B,()=>{S(!0)}),D.get(Zl).afterPreactivation=()=>(S(!0),J.closed?(0,Fe.of)(void 0):J),B.initialNavigation()}))}}]).\u0275providers:[]]}const ra=new p.OlP("")},7346:(Qn,Vt,re)=>{"use strict";re.d(Vt,{y4:()=>Zr,De:()=>Cr,dy:()=>fr,oU:()=>vo,ki:()=>ke,O1:()=>Or,d8:()=>kt,jP:()=>go,UN:()=>Di,r4:()=>Os,SH:()=>hi,xs:()=>ro,j:()=>Ds,H:()=>Tr,bk:()=>ir,DN:()=>Ts,Wn:()=>os,vk:()=>ci});var p=re(5861),se=re(9212),Ye=re(899),Pe=re(6814);class ft{constructor(){this.m=new Map}reset(be){this.m=new Map(Object.entries(be))}get(be,K){const ge=this.m.get(be);return void 0!==ge?ge:K}getBoolean(be,K=!1){const ge=this.m.get(be);return void 0===ge?K:"string"==typeof ge?"true"===ge:!!ge}getNumber(be,K){const ge=parseFloat(this.m.get(be));return isNaN(ge)?void 0!==K?K:NaN:ge}set(be,K){this.m.set(be,K)}}const Fe=new ft,ct=de=>je(de),je=(de=window)=>{if(typeof de>"u")return[];de.Ionic=de.Ionic||{};let be=de.Ionic.platforms;return null==be&&(be=de.Ionic.platforms=Rt(de),be.forEach(K=>de.document.documentElement.classList.add(`plt-${K}`))),be},Rt=de=>{const be=Fe.get("platform");return Object.keys(Mi).filter(K=>{const ge=null==be?void 0:be[K];return"function"==typeof ge?ge(de):Mi[K](de)})},Je=de=>!!(ln(de,/iPad/i)||ln(de,/Macintosh/i)&&me(de)),st=de=>ln(de,/android|sink/i),me=de=>$n(de,"(any-pointer:coarse)"),Ue=de=>Ce(de)||at(de),Ce=de=>!!(de.cordova||de.phonegap||de.PhoneGap),at=de=>{const be=de.Capacitor;return!(null==be||!be.isNative)},ln=(de,be)=>be.test(de.navigator.userAgent),$n=(de,be)=>{var K;return null===(K=de.matchMedia)||void 0===K?void 0:K.call(de,be).matches},Mi={ipad:Je,iphone:de=>ln(de,/iPhone/i),ios:de=>ln(de,/iPhone|iPod/i)||Je(de),android:st,phablet:de=>{const be=de.innerWidth,K=de.innerHeight,ge=Math.min(be,K),Qe=Math.max(be,K);return ge>390&&ge<520&&Qe>620&&Qe<800},tablet:de=>{const be=de.innerWidth,K=de.innerHeight,ge=Math.min(be,K),Qe=Math.max(be,K);return Je(de)||(de=>st(de)&&!ln(de,/mobile/i))(de)||ge>460&&ge<820&&Qe>780&&Qe<1400},cordova:Ce,capacitor:at,electron:de=>ln(de,/electron/i),pwa:de=>{var be;return!!(null!==(be=de.matchMedia)&&void 0!==be&&be.call(de,"(display-mode: standalone)").matches||de.navigator.standalone)},mobile:me,mobileweb:de=>me(de)&&!Ue(de),desktop:de=>!me(de),hybrid:Ue};var Ie=re(191),xe=re(3630),wt=re(8645),ut=re(2438),un=re(5619),Mn=re(2572),yn=re(2096),Ln=re(7582),ai=re(2181),Si=re(4664),Xt=re(2737),Ft=re(9360),It=re(8251);function Ut(de,be){return de===be}var ti=re(95);const li=["tabsInner"];let ar=(()=>{class de{constructor(K,ge){this.doc=K,this.backButton=new wt.x,this.keyboardDidShow=new wt.x,this.keyboardDidHide=new wt.x,this.pause=new wt.x,this.resume=new wt.x,this.resize=new wt.x,ge.run(()=>{var Qe;let Gt;this.win=K.defaultView,this.backButton.subscribeWithPriority=function(_n,U){return this.subscribe(q=>q.register(_n,pe=>ge.run(()=>U(pe))))},mi(this.pause,K,"pause",ge),mi(this.resume,K,"resume",ge),mi(this.backButton,K,"ionBackButton",ge),mi(this.resize,this.win,"resize",ge),mi(this.keyboardDidShow,this.win,"ionKeyboardDidShow",ge),mi(this.keyboardDidHide,this.win,"ionKeyboardDidHide",ge),this._readyPromise=new Promise(_n=>{Gt=_n}),null!==(Qe=this.win)&&void 0!==Qe&&Qe.cordova?K.addEventListener("deviceready",()=>{Gt("cordova")},{once:!0}):Gt("dom")})}is(K){return((de,be)=>("string"==typeof de&&(be=de,de=void 0),ct(de).includes(be)))(this.win,K)}platforms(){return ct(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(K){return Rn(this.win.location.href,K)}isLandscape(){return!this.isPortrait()}isPortrait(){var K,ge;return null===(K=(ge=this.win).matchMedia)||void 0===K?void 0:K.call(ge,"(orientation: portrait)").matches}testUserAgent(K){const ge=this.win.navigator;return!!(null!=ge&&ge.userAgent&&ge.userAgent.indexOf(K)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return de.\u0275fac=function(K){return new(K||de)(se.LFG(Pe.K0),se.LFG(se.R0b))},de.\u0275prov=se.Yz7({token:de,factory:de.\u0275fac,providedIn:"root"}),de})();const Rn=(de,be)=>{be=be.replace(/[[\]\\]/g,"\\$&");const ge=new RegExp("[\\?&]"+be+"=([^&#]*)").exec(de);return ge?decodeURIComponent(ge[1].replace(/\+/g," ")):null},mi=(de,be,K,ge)=>{be&&be.addEventListener(K,Qe=>{ge.run(()=>{de.next(null!=Qe?Qe.detail:void 0)})})};let hi=(()=>{class de{constructor(K,ge,Qe,Gt){this.location=ge,this.serializer=Qe,this.router=Gt,this.direction=Fr,this.animated=vn,this.guessDirection="forward",this.lastNavId=-1,Gt&&Gt.events.subscribe(_n=>{if(_n instanceof Ye.OD){const U=_n.restoredState?_n.restoredState.navigationId:_n.id;this.guessDirection=U<this.lastNavId?"back":"forward",this.guessAnimation=_n.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?_n.id:U}}),K.backButton.subscribeWithPriority(0,_n=>{this.pop(),_n()})}navigateForward(K,ge={}){return this.setDirection("forward",ge.animated,ge.animationDirection,ge.animation),this.navigate(K,ge)}navigateBack(K,ge={}){return this.setDirection("back",ge.animated,ge.animationDirection,ge.animation),this.navigate(K,ge)}navigateRoot(K,ge={}){return this.setDirection("root",ge.animated,ge.animationDirection,ge.animation),this.navigate(K,ge)}back(K={animated:!0,animationDirection:"back"}){return this.setDirection("back",K.animated,K.animationDirection,K.animation),this.location.back()}pop(){var K=this;return(0,p.Z)(function*(){let ge=K.topOutlet;for(;ge;){if(yield ge.pop())return!0;ge=ge.parentOutlet}return!1})()}setDirection(K,ge,Qe,Gt){this.direction=K,this.animated=Sr(K,ge,Qe),this.animationBuilder=Gt}setTopOutlet(K){this.topOutlet=K}consumeTransition(){let ge,K="root";const Qe=this.animationBuilder;return"auto"===this.direction?(K=this.guessDirection,ge=this.guessAnimation):(ge=this.animated,K=this.direction),this.direction=Fr,this.animated=vn,this.animationBuilder=void 0,{direction:K,animation:ge,animationBuilder:Qe}}navigate(K,ge){if(Array.isArray(K))return this.router.navigate(K,ge);{const Qe=this.serializer.parse(K.toString());return void 0!==ge.queryParams&&(Qe.queryParams={...ge.queryParams}),void 0!==ge.fragment&&(Qe.fragment=ge.fragment),this.router.navigateByUrl(Qe,ge)}}}return de.\u0275fac=function(K){return new(K||de)(se.LFG(ar),se.LFG(Pe.Ye),se.LFG(Ye.Hx),se.LFG(Ye.F0,8))},de.\u0275prov=se.Yz7({token:de,factory:de.\u0275fac,providedIn:"root"}),de})();const Sr=(de,be,K)=>{if(!1!==be){if(void 0!==K)return K;if("forward"===de||"back"===de)return de;if("root"===de&&!0===be)return"forward"}},Fr="auto",vn=void 0;let Cr=(()=>{class de{get(K,ge){const Qe=jr();return Qe?Qe.get(K,ge):null}getBoolean(K,ge){const Qe=jr();return!!Qe&&Qe.getBoolean(K,ge)}getNumber(K,ge){const Qe=jr();return Qe?Qe.getNumber(K,ge):0}}return de.\u0275fac=function(K){return new(K||de)},de.\u0275prov=se.Yz7({token:de,factory:de.\u0275fac,providedIn:"root"}),de})();const fr=new se.OlP("USERCONFIG"),jr=()=>{if(typeof window<"u"){const de=window.Ionic;if(null!=de&&de.config)return de.config}return null};class Ei{constructor(be={}){this.data=be}get(be){return this.data[be]}}let Zr=(()=>{class de{constructor(){this.zone=(0,se.f3M)(se.R0b),this.applicationRef=(0,se.f3M)(se.z2F)}create(K,ge,Qe){return new Jn(K,ge,this.applicationRef,this.zone,Qe)}}return de.\u0275fac=function(K){return new(K||de)},de.\u0275prov=se.Yz7({token:de,factory:de.\u0275fac}),de})();class Jn{constructor(be,K,ge,Qe,Gt){this.environmentInjector=be,this.injector=K,this.applicationRef=ge,this.zone=Qe,this.elementReferenceKey=Gt,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(be,K,ge,Qe){return this.zone.run(()=>new Promise(Gt=>{const _n={...ge};void 0!==this.elementReferenceKey&&(_n[this.elementReferenceKey]=be),Gt(Ar(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,be,K,_n,Qe,this.elementReferenceKey))}))}removeViewFromDom(be,K){return this.zone.run(()=>new Promise(ge=>{const Qe=this.elRefMap.get(K);if(Qe){Qe.destroy(),this.elRefMap.delete(K);const Gt=this.elEventsMap.get(K);Gt&&(Gt(),this.elEventsMap.delete(K))}ge()}))}}const Ar=(de,be,K,ge,Qe,Gt,_n,U,q,pe,Ne)=>{const Et=se.zs3.create({providers:lr(q),parent:K}),Xe=(0,se.LMc)(U,{environmentInjector:be,elementInjector:Et}),Wt=Xe.instance,Yt=Xe.location.nativeElement;if(q&&(Ne&&void 0!==Wt[Ne]&&console.error(`[Ionic Error]: ${Ne} is a reserved property when using ${_n.tagName.toLowerCase()}. Rename or remove the "${Ne}" property from ${U.name}.`),Object.assign(Wt,q)),pe)for(const Zt of pe)Yt.classList.add(Zt);const cn=xn(de,Wt,Yt);return _n.appendChild(Yt),ge.attachView(Xe.hostView),Qe.set(Yt,Xe),Gt.set(Yt,cn),Yt},fs=[Ie.L,Ie.a,Ie.b,Ie.c,Ie.d],xn=(de,be,K)=>de.run(()=>{const ge=fs.filter(Qe=>"function"==typeof be[Qe]).map(Qe=>{const Gt=_n=>be[Qe](_n.detail);return K.addEventListener(Qe,Gt),()=>K.removeEventListener(Qe,Gt)});return()=>ge.forEach(Qe=>Qe())}),wi=new se.OlP("NavParamsToken"),lr=de=>[{provide:wi,useValue:de},{provide:Ei,useFactory:ss,deps:[wi]}],ss=de=>new Ei(de),no=(de,be)=>{const K=de.prototype;be.forEach(ge=>{Object.defineProperty(K,ge,{get(){return this.el[ge]},set(Qe){this.z.runOutsideAngular(()=>this.el[ge]=Qe)}})})},Br=(de,be)=>{const K=de.prototype;be.forEach(ge=>{K[ge]=function(){const Qe=arguments;return this.z.runOutsideAngular(()=>this.el[ge].apply(this.el,Qe))}})},ts=(de,be,K)=>{K.forEach(ge=>de[ge]=(0,ut.R)(be,ge))};function kr(de){return function(K){const{defineCustomElementFn:ge,inputs:Qe,methods:Gt}=de;return void 0!==ge&&ge(),Qe&&no(K,Qe),Gt&&Br(K,Gt),K}}const yr=["alignment","animated","arrow","keepContentsMounted","backdropDismiss","cssClass","dismissOnSelect","enterAnimation","event","isOpen","keyboardClose","leaveAnimation","mode","showBackdrop","translucent","trigger","triggerAction","reference","size","side"],_s=["present","dismiss","onDidDismiss","onWillDismiss"];let kt=(()=>{let de=class{constructor(K,ge,Qe){this.z=Qe,this.isCmpOpen=!1,this.el=ge.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,K.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,K.detectChanges()}),ts(this,this.el,["ionPopoverDidPresent","ionPopoverWillPresent","ionPopoverWillDismiss","ionPopoverDidDismiss","didPresent","willPresent","willDismiss","didDismiss"])}};return de.\u0275fac=function(K){return new(K||de)(se.Y36(se.sBO),se.Y36(se.SBq),se.Y36(se.R0b))},de.\u0275dir=se.lG2({type:de,selectors:[["ion-popover"]],contentQueries:function(K,ge,Qe){if(1&K&&se.Suo(Qe,se.Rgc,5),2&K){let Gt;se.iGM(Gt=se.CRH())&&(ge.template=Gt.first)}},inputs:{alignment:"alignment",animated:"animated",arrow:"arrow",keepContentsMounted:"keepContentsMounted",backdropDismiss:"backdropDismiss",cssClass:"cssClass",dismissOnSelect:"dismissOnSelect",enterAnimation:"enterAnimation",event:"event",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger",triggerAction:"triggerAction",reference:"reference",size:"size",side:"side"}}),de=(0,Ln.gn)([kr({inputs:yr,methods:_s})],de),de})();const qe=["animated","keepContentsMounted","backdropBreakpoint","backdropDismiss","breakpoints","canDismiss","cssClass","enterAnimation","event","handle","handleBehavior","initialBreakpoint","isOpen","keyboardClose","leaveAnimation","mode","presentingElement","showBackdrop","translucent","trigger"],_t=["present","dismiss","onDidDismiss","onWillDismiss","setCurrentBreakpoint","getCurrentBreakpoint"];let ke=(()=>{let de=class{constructor(K,ge,Qe){this.z=Qe,this.isCmpOpen=!1,this.el=ge.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,K.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,K.detectChanges()}),ts(this,this.el,["ionModalDidPresent","ionModalWillPresent","ionModalWillDismiss","ionModalDidDismiss","ionBreakpointDidChange","didPresent","willPresent","willDismiss","didDismiss"])}};return de.\u0275fac=function(K){return new(K||de)(se.Y36(se.sBO),se.Y36(se.SBq),se.Y36(se.R0b))},de.\u0275dir=se.lG2({type:de,selectors:[["ion-modal"]],contentQueries:function(K,ge,Qe){if(1&K&&se.Suo(Qe,se.Rgc,5),2&K){let Gt;se.iGM(Gt=se.CRH())&&(ge.template=Gt.first)}},inputs:{animated:"animated",keepContentsMounted:"keepContentsMounted",backdropBreakpoint:"backdropBreakpoint",backdropDismiss:"backdropDismiss",breakpoints:"breakpoints",canDismiss:"canDismiss",cssClass:"cssClass",enterAnimation:"enterAnimation",event:"event",handle:"handle",handleBehavior:"handleBehavior",initialBreakpoint:"initialBreakpoint",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",presentingElement:"presentingElement",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger"}}),de=(0,Ln.gn)([kr({inputs:qe,methods:_t})],de),de})();const sn=(de,be)=>((de=de.filter(K=>K.stackId!==be.stackId)).push(be),de),Ri=(de,be)=>{const K=de.createUrlTree(["."],{relativeTo:be});return de.serializeUrl(K)},Ui=(de,be)=>!be||de.stackId!==be.stackId,Yr=(de,be)=>{if(!de)return;const K=cr(be);for(let ge=0;ge<K.length;ge++){if(ge>=de.length)return K[ge];if(K[ge]!==de[ge])return}},cr=de=>de.split("/").map(be=>be.trim()).filter(be=>""!==be),qn=de=>{de&&(de.ref.destroy(),de.unlistenEvents())};class Ws{constructor(be,K,ge,Qe,Gt,_n){this.containerEl=K,this.router=ge,this.navCtrl=Qe,this.zone=Gt,this.location=_n,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==be?cr(be):void 0}createView(be,K){var ge;const Qe=Ri(this.router,K),Gt=null==be||null===(ge=be.location)||void 0===ge?void 0:ge.nativeElement,_n=xn(this.zone,be.instance,Gt);return{id:this.nextId++,stackId:Yr(this.tabsPrefix,Qe),unlistenEvents:_n,element:Gt,ref:be,url:Qe}}getExistingView(be){const K=Ri(this.router,be),ge=this.views.find(Qe=>Qe.url===K);return ge&&ge.ref.changeDetectorRef.reattach(),ge}setActive(be){var K,ge;const Qe=this.navCtrl.consumeTransition();let{direction:Gt,animation:_n,animationBuilder:U}=Qe;const q=this.activeView,pe=Ui(be,q);pe&&(Gt="back",_n=void 0);const Ne=this.views.slice();let Et;const Xe=this.router;Xe.getCurrentNavigation?Et=Xe.getCurrentNavigation():null!==(K=Xe.navigations)&&void 0!==K&&K.value&&(Et=Xe.navigations.value),null!==(ge=Et)&&void 0!==ge&&null!==(ge=ge.extras)&&void 0!==ge&&ge.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Wt=this.views.includes(be),Yt=this.insertView(be,Gt);Wt||be.ref.changeDetectorRef.detectChanges();const cn=be.animationBuilder;return void 0===U&&"back"===Gt&&!pe&&void 0!==cn&&(U=cn),q&&(q.animationBuilder=U),this.zone.runOutsideAngular(()=>this.wait(()=>(q&&q.ref.changeDetectorRef.detach(),be.ref.changeDetectorRef.reattach(),this.transition(be,q,_n,this.canGoBack(1),!1,U).then(()=>io(be,Yt,Ne,this.location,this.zone)).then(()=>({enteringView:be,direction:Gt,animation:_n,tabSwitch:pe})))))}canGoBack(be,K=this.getActiveStackId()){return this.getStack(K).length>be}pop(be,K=this.getActiveStackId()){return this.zone.run(()=>{const ge=this.getStack(K);if(ge.length<=be)return Promise.resolve(!1);const Qe=ge[ge.length-be-1];let Gt=Qe.url;const _n=Qe.savedData;if(_n){var U;const pe=_n.get("primary");null!=pe&&null!==(U=pe.route)&&void 0!==U&&null!==(U=U._routerState)&&void 0!==U&&U.snapshot.url&&(Gt=pe.route._routerState.snapshot.url)}const{animationBuilder:q}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Gt,{...Qe.savedExtras,animation:q}).then(()=>!0)})}startBackTransition(){const be=this.activeView;if(be){const K=this.getStack(be.stackId),ge=K[K.length-2],Qe=ge.animationBuilder;return this.wait(()=>this.transition(ge,be,"back",this.canGoBack(2),!0,Qe))}return Promise.resolve()}endBackTransition(be){be?(this.skipTransition=!0,this.pop(1)):this.activeView&&js(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(be){const K=this.getStack(be);return K.length>0?K[K.length-1]:void 0}getRootUrl(be){const K=this.getStack(be);return K.length>0?K[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}getActiveView(){return this.activeView}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(qn),this.activeView=void 0,this.views=[]}getStack(be){return this.views.filter(K=>K.stackId===be)}insertView(be,K){return this.activeView=be,this.views=((de,be,K)=>"root"===K?sn(de,be):"forward"===K?((de,be)=>(de.indexOf(be)>=0?de=de.filter(ge=>ge.stackId!==be.stackId||ge.id<=be.id):de.push(be),de))(de,be):((de,be)=>de.indexOf(be)>=0?de.filter(ge=>ge.stackId!==be.stackId||ge.id<=be.id):sn(de,be))(de,be))(this.views,be,K),this.views.slice()}transition(be,K,ge,Qe,Gt,_n){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(K===be)return Promise.resolve(!1);const U=be?be.element:void 0,q=K?K.element:void 0,pe=this.containerEl;return U&&U!==q&&(U.classList.add("ion-page"),U.classList.add("ion-page-invisible"),U.parentElement!==pe&&pe.appendChild(U),pe.commit)?pe.commit(U,q,{duration:void 0===ge?0:void 0,direction:ge,showGoBack:Qe,progressAnimation:Gt,animationBuilder:_n}):Promise.resolve(!1)}wait(be){var K=this;return(0,p.Z)(function*(){void 0!==K.runningTask&&(yield K.runningTask,K.runningTask=void 0);const ge=K.runningTask=be();return ge.finally(()=>K.runningTask=void 0),ge})()}}const io=(de,be,K,ge,Qe)=>"function"==typeof requestAnimationFrame?new Promise(Gt=>{requestAnimationFrame(()=>{js(de,be,K,ge,Qe),Gt()})}):Promise.resolve(),js=(de,be,K,ge,Qe)=>{Qe.run(()=>K.filter(Gt=>!be.includes(Gt)).forEach(qn)),be.forEach(Gt=>{const U=ge.path().split("?")[0].split("#")[0];if(Gt!==de&&Gt.url!==U){const q=Gt.element;q.setAttribute("aria-hidden","true"),q.classList.add("ion-page-hidden"),Gt.ref.changeDetectorRef.detach()}})};let go=(()=>{class de{constructor(K,ge,Qe,Gt,_n,U,q,pe){this.parentOutlet=pe,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new un.X(null),this.activated=null,this._activatedRoute=null,this.name=Ye.eC,this.stackWillChange=new se.vpe,this.stackDidChange=new se.vpe,this.activateEvents=new se.vpe,this.deactivateEvents=new se.vpe,this.parentContexts=(0,se.f3M)(Ye.y6),this.location=(0,se.f3M)(se.s_b),this.environmentInjector=(0,se.f3M)(se.lqb),this.inputBinder=(0,se.f3M)(Ys,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,se.f3M)(Cr),this.navCtrl=(0,se.f3M)(hi),this.nativeEl=Gt.nativeElement,this.name=K||Ye.eC,this.tabsPrefix="true"===ge?Ri(_n,q):void 0,this.stackCtrl=new Ws(this.tabsPrefix,this.nativeEl,_n,this.navCtrl,U,Qe),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(K){this.nativeEl.animation=K}set animated(K){this.nativeEl.animated=K}set swipeGesture(K){this._swipeGesture=K,this.nativeEl.swipeHandler=K?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ge=>this.stackCtrl.endBackTransition(ge)}:void 0}ngOnDestroy(){var K;this.stackCtrl.destroy(),null===(K=this.inputBinder)||void 0===K||K.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const K=this.getContext();null!=K&&K.route&&this.activateWith(K.route,K.injector)}new Promise(K=>(0,xe.c)(this.nativeEl,K)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(K,ge){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ge=this.getContext();this.activatedView.savedData=new Map(ge.children.contexts);const Qe=this.activatedView.savedData.get("primary");if(Qe&&ge.route&&(Qe.route={...ge.route}),this.activatedView.savedExtras={},ge.route){const Gt=ge.route.snapshot;this.activatedView.savedExtras.queryParams=Gt.queryParams,this.activatedView.savedExtras.fragment=Gt.fragment}}const K=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(K)}}activateWith(K,ge){var Qe;if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=K;let Gt,_n=this.stackCtrl.getExistingView(K);if(_n){Gt=this.activated=_n.ref;const pe=_n.savedData;pe&&(this.getContext().children.contexts=pe),this.updateActivatedRouteProxy(Gt.instance,K)}else{var U;const pe=K._futureSnapshot,Ne=this.parentContexts.getOrCreateContext(this.name).children,Et=new un.X(null),Xe=this.createActivatedRouteProxy(Et,K),Wt=new Hi(Xe,Ne,this.location.injector),Yt=null!==(U=pe.routeConfig.component)&&void 0!==U?U:pe.component;Gt=this.activated=this.location.createComponent(Yt,{index:this.location.length,injector:Wt,environmentInjector:null!=ge?ge:this.environmentInjector}),Et.next(Gt.instance),_n=this.stackCtrl.createView(this.activated,K),this.proxyMap.set(Gt.instance,Xe),this.currentActivatedRoute$.next({component:Gt.instance,activatedRoute:K})}null===(Qe=this.inputBinder)||void 0===Qe||Qe.bindActivatedRouteToOutletComponent(this),this.activatedView=_n,this.navCtrl.setTopOutlet(this);const q=this.stackCtrl.getActiveView();this.stackWillChange.emit({enteringView:_n,tabSwitch:Ui(_n,q)}),this.stackCtrl.setActive(_n).then(pe=>{this.activateEvents.emit(Gt.instance),this.stackDidChange.emit(pe)})}canGoBack(K=1,ge){return this.stackCtrl.canGoBack(K,ge)}pop(K=1,ge){return this.stackCtrl.pop(K,ge)}getLastUrl(K){const ge=this.stackCtrl.getLastUrl(K);return ge?ge.url:void 0}getLastRouteView(K){return this.stackCtrl.getLastUrl(K)}getRootView(K){return this.stackCtrl.getRootUrl(K)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(K,ge){const Qe=new Ye.gz;return Qe._futureSnapshot=ge._futureSnapshot,Qe._routerState=ge._routerState,Qe.snapshot=ge.snapshot,Qe.outlet=ge.outlet,Qe.component=ge.component,Qe._paramMap=this.proxyObservable(K,"paramMap"),Qe._queryParamMap=this.proxyObservable(K,"queryParamMap"),Qe.url=this.proxyObservable(K,"url"),Qe.params=this.proxyObservable(K,"params"),Qe.queryParams=this.proxyObservable(K,"queryParams"),Qe.fragment=this.proxyObservable(K,"fragment"),Qe.data=this.proxyObservable(K,"data"),Qe}proxyObservable(K,ge){return K.pipe((0,ai.h)(Qe=>!!Qe),(0,Si.w)(Qe=>this.currentActivatedRoute$.pipe((0,ai.h)(Gt=>null!==Gt&&Gt.component===Qe),(0,Si.w)(Gt=>Gt&&Gt.activatedRoute[ge]),function tn(de,be=Xt.y){return de=null!=de?de:Ut,(0,Ft.e)((K,ge)=>{let Qe,Gt=!0;K.subscribe((0,It.x)(ge,_n=>{const U=be(_n);(Gt||!de(Qe,U))&&(Gt=!1,Qe=U,ge.next(_n))}))})}())))}updateActivatedRouteProxy(K,ge){const Qe=this.proxyMap.get(K);if(!Qe)throw new Error("Could not find activated route proxy for view");Qe._futureSnapshot=ge._futureSnapshot,Qe._routerState=ge._routerState,Qe.snapshot=ge.snapshot,Qe.outlet=ge.outlet,Qe.component=ge.component,this.currentActivatedRoute$.next({component:K,activatedRoute:ge})}}return de.\u0275fac=function(K){return new(K||de)(se.$8M("name"),se.$8M("tabs"),se.Y36(Pe.Ye),se.Y36(se.SBq),se.Y36(Ye.F0),se.Y36(se.R0b),se.Y36(Ye.gz),se.Y36(de,12))},de.\u0275dir=se.lG2({type:de,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackWillChange:"stackWillChange",stackDidChange:"stackDidChange",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),de})();class Hi{constructor(be,K,ge){this.route=be,this.childContexts=K,this.parent=ge}get(be,K){return be===Ye.gz?this.route:be===Ye.y6?this.childContexts:this.parent.get(be,K)}}const Ys=new se.OlP("");let bs=(()=>{class de{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(K){this.unsubscribeFromRouteData(K),this.subscribeToRouteData(K)}unsubscribeFromRouteData(K){var ge;null===(ge=this.outletDataSubscriptions.get(K))||void 0===ge||ge.unsubscribe(),this.outletDataSubscriptions.delete(K)}subscribeToRouteData(K){const{activatedRoute:ge}=K,Qe=(0,Mn.a)([ge.queryParams,ge.params,ge.data]).pipe((0,Si.w)(([Gt,_n,U],q)=>(U={...Gt,..._n,...U},0===q?(0,yn.of)(U):Promise.resolve(U)))).subscribe(Gt=>{if(!K.isActivated||!K.activatedComponentRef||K.activatedRoute!==ge||null===ge.component)return void this.unsubscribeFromRouteData(K);const _n=(0,se.qFp)(ge.component);if(_n)for(const{templateName:U}of _n.inputs)K.activatedComponentRef.setInput(U,Gt[U]);else this.unsubscribeFromRouteData(K)});this.outletDataSubscriptions.set(K,Qe)}}return de.\u0275fac=function(K){return new(K||de)},de.\u0275prov=se.Yz7({token:de,factory:de.\u0275fac}),de})();const Ts=()=>({provide:Ys,useFactory:nr,deps:[Ye.F0]});function nr(de){return null!=de&&de.componentInputBindingEnabled?new bs:null}const ps=["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"];let vo=(()=>{let de=class{constructor(K,ge,Qe,Gt,_n,U){this.routerOutlet=K,this.navCtrl=ge,this.config=Qe,this.r=Gt,this.z=_n,U.detach(),this.el=this.r.nativeElement}onClick(K){var ge;const Qe=this.defaultHref||this.config.get("backButtonDefaultHref");null!==(ge=this.routerOutlet)&&void 0!==ge&&ge.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),K.preventDefault()):null!=Qe&&(this.navCtrl.navigateBack(Qe,{animation:this.routerAnimation}),K.preventDefault())}};return de.\u0275fac=function(K){return new(K||de)(se.Y36(go,8),se.Y36(hi),se.Y36(Cr),se.Y36(se.SBq),se.Y36(se.R0b),se.Y36(se.sBO))},de.\u0275dir=se.lG2({type:de,hostBindings:function(K,ge){1&K&&se.NdJ("click",function(Gt){return ge.onClick(Gt)})},inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"}}),de=(0,Ln.gn)([kr({inputs:ps})],de),de})(),Ds=(()=>{class de{constructor(K,ge,Qe,Gt,_n){this.locationStrategy=K,this.navCtrl=ge,this.elementRef=Qe,this.router=Gt,this.routerLink=_n,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var K;if(null!==(K=this.routerLink)&&void 0!==K&&K.urlTree){const ge=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=ge}}onClick(K){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),K.preventDefault()}}return de.\u0275fac=function(K){return new(K||de)(se.Y36(Pe.S$),se.Y36(hi),se.Y36(se.SBq),se.Y36(Ye.F0),se.Y36(Ye.rH,8))},de.\u0275dir=se.lG2({type:de,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(K,ge){1&K&&se.NdJ("click",function(Gt){return ge.onClick(Gt)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[se.TTD]}),de})(),Tr=(()=>{class de{constructor(K,ge,Qe,Gt,_n){this.locationStrategy=K,this.navCtrl=ge,this.elementRef=Qe,this.router=Gt,this.routerLink=_n,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var K;if(null!==(K=this.routerLink)&&void 0!==K&&K.urlTree){const ge=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=ge}}onClick(){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation)}}return de.\u0275fac=function(K){return new(K||de)(se.Y36(Pe.S$),se.Y36(hi),se.Y36(se.SBq),se.Y36(Ye.F0),se.Y36(Ye.rH,8))},de.\u0275dir=se.lG2({type:de,selectors:[["a","routerLink",""],["area","routerLink",""]],hostBindings:function(K,ge){1&K&&se.NdJ("click",function(){return ge.onClick()})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[se.TTD]}),de})();const ms=["animated","animation","root","rootParams","swipeGesture"],Is=["push","insert","insertPages","pop","popTo","popToRoot","removeIndex","setRoot","setPages","getActive","getByIndex","canGoBack","getPrevious"];let Or=(()=>{let de=class{constructor(K,ge,Qe,Gt,_n,U){this.z=_n,U.detach(),this.el=K.nativeElement,K.nativeElement.delegate=Gt.create(ge,Qe),ts(this,this.el,["ionNavDidChange","ionNavWillChange"])}};return de.\u0275fac=function(K){return new(K||de)(se.Y36(se.SBq),se.Y36(se.lqb),se.Y36(se.zs3),se.Y36(Zr),se.Y36(se.R0b),se.Y36(se.sBO))},de.\u0275dir=se.lG2({type:de,inputs:{animated:"animated",animation:"animation",root:"root",rootParams:"rootParams",swipeGesture:"swipeGesture"}}),de=(0,Ln.gn)([kr({inputs:ms,methods:Is})],de),de})(),Di=(()=>{class de{constructor(K){this.navCtrl=K,this.ionTabsWillChange=new se.vpe,this.ionTabsDidChange=new se.vpe,this.tabBarSlot="bottom"}ngAfterContentInit(){this.detectSlotChanges()}ngAfterContentChecked(){this.detectSlotChanges()}onStackWillChange({enteringView:K,tabSwitch:ge}){const Qe=K.stackId;ge&&void 0!==Qe&&this.ionTabsWillChange.emit({tab:Qe})}onStackDidChange({enteringView:K,tabSwitch:ge}){const Qe=K.stackId;ge&&void 0!==Qe&&(this.tabBar&&(this.tabBar.selectedTab=Qe),this.ionTabsDidChange.emit({tab:Qe}))}select(K){const ge="string"==typeof K,Qe=ge?K:K.detail.tab,Gt=this.outlet.getActiveStackId()===Qe,_n=`${this.outlet.tabsPrefix}/${Qe}`;if(ge||K.stopPropagation(),Gt){const U=this.outlet.getActiveStackId(),q=this.outlet.getLastRouteView(U);if((null==q?void 0:q.url)===_n)return;const pe=this.outlet.getRootView(Qe);return this.navCtrl.navigateRoot(_n,{...pe&&_n===pe.url&&pe.savedExtras,animated:!0,animationDirection:"back"})}{const U=this.outlet.getLastRouteView(Qe);return this.navCtrl.navigateRoot((null==U?void 0:U.url)||_n,{...null==U?void 0:U.savedExtras,animated:!0,animationDirection:"back"})}}getSelected(){return this.outlet.getActiveStackId()}detectSlotChanges(){this.tabBars.forEach(K=>{const ge=K.el.getAttribute("slot");ge!==this.tabBarSlot&&(this.tabBarSlot=ge,this.relocateTabBar())})}relocateTabBar(){const K=this.tabBar.el;"top"===this.tabBarSlot?this.tabsInner.nativeElement.before(K):this.tabsInner.nativeElement.after(K)}}return de.\u0275fac=function(K){return new(K||de)(se.Y36(hi))},de.\u0275dir=se.lG2({type:de,selectors:[["ion-tabs"]],viewQuery:function(K,ge){if(1&K&&se.Gf(li,7,se.SBq),2&K){let Qe;se.iGM(Qe=se.CRH())&&(ge.tabsInner=Qe.first)}},hostBindings:function(K,ge){1&K&&se.NdJ("ionTabButtonClick",function(Gt){return ge.select(Gt)})},outputs:{ionTabsWillChange:"ionTabsWillChange",ionTabsDidChange:"ionTabsDidChange"}}),de})();const os=de=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(de):"function"==typeof requestAnimationFrame?requestAnimationFrame(de):setTimeout(de);let ir=(()=>{class de{constructor(K,ge){this.injector=K,this.elementRef=ge,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(K){this.elementRef.nativeElement.value=this.lastValue=K,ci(this.elementRef)}handleValueChange(K,ge){K===this.elementRef.nativeElement&&(ge!==this.lastValue&&(this.lastValue=ge,this.onChange(ge)),ci(this.elementRef))}_handleBlurEvent(K){K===this.elementRef.nativeElement&&(this.onTouched(),ci(this.elementRef))}registerOnChange(K){this.onChange=K}registerOnTouched(K){this.onTouched=K}setDisabledState(K){this.elementRef.nativeElement.disabled=K}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let K;try{K=this.injector.get(ti.a5)}catch{}if(!K)return;K.statusChanges&&(this.statusChanges=K.statusChanges.subscribe(()=>ci(this.elementRef)));const ge=K.control;ge&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Gt=>{if(typeof ge[Gt]<"u"){const _n=ge[Gt].bind(ge);ge[Gt]=(...U)=>{_n(...U),ci(this.elementRef)}}})}}return de.\u0275fac=function(K){return new(K||de)(se.Y36(se.zs3),se.Y36(se.SBq))},de.\u0275dir=se.lG2({type:de,hostBindings:function(K,ge){1&K&&se.NdJ("ionBlur",function(Gt){return ge._handleBlurEvent(Gt.target)})}}),de})();const ci=de=>{os(()=>{const be=de.nativeElement,K=null!=be.value&&be.value.toString().length>0,ge=Co(be);xs(be,ge);const Qe=be.closest("ion-item");Qe&&xs(Qe,K?[...ge,"item-has-value"]:ge)})},Co=de=>{const be=de.classList,K=[];for(let ge=0;ge<be.length;ge++){const Qe=be.item(ge);null!==Qe&&_r(Qe,"ng-")&&K.push(`ion-${Qe.substring(3)}`)}return K},xs=(de,be)=>{const K=de.classList;K.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),K.add(...be)},_r=(de,be)=>de.substring(0,be.length)===be;class Os{shouldDetach(be){return!1}shouldAttach(be){return!1}store(be,K){}retrieve(be){return null}shouldReuseRoute(be,K){if(be.routeConfig!==K.routeConfig)return!1;const ge=be.params,Qe=K.params,Gt=Object.keys(ge),_n=Object.keys(Qe);if(Gt.length!==_n.length)return!1;for(const U of Gt)if(Qe[U]!==ge[U])return!1;return!0}}class ro{constructor(be){this.ctrl=be}create(be){return this.ctrl.create(be||{})}dismiss(be,K,ge){return this.ctrl.dismiss(be,K,ge)}getTop(){return this.ctrl.getTop()}}},1929:(Qn,Vt,re)=>{"use strict";re.d(Vt,{dr:()=>yn,W2:()=>mi,Gu:()=>Ei,wd:()=>os,sr:()=>Co,Pc:()=>pr});var p=re(9212),se=re(95),Ye=re(7346),Pe=re(7582),ft=re(2438),Fe=re(6814),ct=(re(899),re(4913),re(2325),re(3433),re(6615),re(6535),re(2905)),tt=re(8958),Rt=(re(5613),re(9207)),Je=(re(1848),re(771));re(2019);const ot=ct.i,$e=["*"],Lt=(I,ie)=>{const k=I.prototype;ie.forEach(oe=>{Object.defineProperty(k,oe,{get(){return this.el[oe]},set(Ke){this.z.runOutsideAngular(()=>this.el[oe]=Ke)},configurable:!0})})},Oe=(I,ie)=>{const k=I.prototype;ie.forEach(oe=>{k[oe]=function(){const Ke=arguments;return this.z.runOutsideAngular(()=>this.el[oe].apply(this.el,Ke))}})};function xe(I){return function(k){const{defineCustomElementFn:oe,inputs:Ke,methods:yi}=I;return void 0!==oe&&oe(),Ke&&Lt(k,Ke),yi&&Oe(k,yi),k}}let yn=(()=>{let I=class{constructor(k,oe,Ke){this.z=Ke,k.detach(),this.el=oe.nativeElement}};return I.\u0275fac=function(k){return new(k||I)(p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(p.R0b))},I.\u0275cmp=p.Xpm({type:I,selectors:[["ion-app"]],ngContentSelectors:$e,decls:1,vars:0,template:function(k,oe){1&k&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),I=(0,Pe.gn)([xe({})],I),I})(),mi=(()=>{let I=class{constructor(k,oe,Ke){this.z=Ke,k.detach(),this.el=oe.nativeElement,((I,ie,k)=>{k.forEach(oe=>I[oe]=(0,ft.R)(ie,oe))})(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return I.\u0275fac=function(k){return new(k||I)(p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(p.R0b))},I.\u0275cmp=p.Xpm({type:I,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:$e,decls:1,vars:0,template:function(k,oe){1&k&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),I=(0,Pe.gn)([xe({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],I),I})(),Ei=(()=>{let I=class{constructor(k,oe,Ke){this.z=Ke,k.detach(),this.el=oe.nativeElement}};return I.\u0275fac=function(k){return new(k||I)(p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(p.R0b))},I.\u0275cmp=p.Xpm({type:I,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:$e,decls:1,vars:0,template:function(k,oe){1&k&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),I=(0,Pe.gn)([xe({inputs:["collapse","mode","translucent"]})],I),I})(),os=(()=>{let I=class{constructor(k,oe,Ke){this.z=Ke,k.detach(),this.el=oe.nativeElement}};return I.\u0275fac=function(k){return new(k||I)(p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(p.R0b))},I.\u0275cmp=p.Xpm({type:I,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:$e,decls:1,vars:0,template:function(k,oe){1&k&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),I=(0,Pe.gn)([xe({inputs:["color","size"]})],I),I})(),Co=(()=>{let I=class{constructor(k,oe,Ke){this.z=Ke,k.detach(),this.el=oe.nativeElement}};return I.\u0275fac=function(k){return new(k||I)(p.Y36(p.sBO),p.Y36(p.SBq),p.Y36(p.R0b))},I.\u0275cmp=p.Xpm({type:I,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:$e,decls:1,vars:0,template:function(k,oe){1&k&&(p.F$t(),p.Hsn(0))},encapsulation:2,changeDetection:0}),I=(0,Pe.gn)([xe({inputs:["color","mode"]})],I),I})();const Qe={provide:se.Cf,useExisting:(0,p.Gpc)(()=>Gt),multi:!0};let Gt=(()=>{class I extends se.Fd{}return I.\u0275fac=(()=>{let ie;return function(oe){return(ie||(ie=p.n5z(I)))(oe||I)}})(),I.\u0275dir=p.lG2({type:I,selectors:[["ion-input","type","number","max","","formControlName",""],["ion-input","type","number","max","","formControl",""],["ion-input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(k,oe){2&k&&p.uIk("max",oe._enabled?oe.max:null)},features:[p._Bn([Qe]),p.qOj]}),I})();const _n={provide:se.Cf,useExisting:(0,p.Gpc)(()=>U),multi:!0};let U=(()=>{class I extends se.qQ{}return I.\u0275fac=(()=>{let ie;return function(oe){return(ie||(ie=p.n5z(I)))(oe||I)}})(),I.\u0275dir=p.lG2({type:I,selectors:[["ion-input","type","number","min","","formControlName",""],["ion-input","type","number","min","","formControl",""],["ion-input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(k,oe){2&k&&p.uIk("min",oe._enabled?oe.min:null)},features:[p._Bn([_n]),p.qOj]}),I})(),Yt=(()=>{class I extends Ye.xs{constructor(){super(Rt.m),this.angularDelegate=(0,p.f3M)(Ye.y4),this.injector=(0,p.f3M)(p.zs3),this.environmentInjector=(0,p.f3M)(p.lqb)}create(k){return super.create({...k,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return I.\u0275fac=function(k){return new(k||I)},I.\u0275prov=p.Yz7({token:I,factory:I.\u0275fac}),I})();class Zt extends Ye.xs{constructor(){super(Rt.c),this.angularDelegate=(0,p.f3M)(Ye.y4),this.injector=(0,p.f3M)(p.zs3),this.environmentInjector=(0,p.f3M)(p.lqb)}create(ie){return super.create({...ie,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}const Wn=(I,ie,k)=>()=>{if(ie.defaultView&&typeof window<"u"){(0,tt.s)({...I,_zoneGate:yi=>k.run(yi)});const Ke="__zone_symbol__addEventListener"in ie.body?"__zone_symbol__addEventListener":"addEventListener";return function st(){var I=[];if(typeof window<"u"){var ie=window;(!ie.customElements||ie.Element&&(!ie.Element.prototype.closest||!ie.Element.prototype.matches||!ie.Element.prototype.remove||!ie.Element.prototype.getRootNode))&&I.push(re.e(6748).then(re.t.bind(re,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||ie.NodeList&&!ie.NodeList.prototype.forEach||!ie.fetch||!function(){try{var oe=new URL("b","http://a");return oe.pathname="c%20d","http://a/c%20d"===oe.href&&oe.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&I.push(re.e(2214).then(re.t.bind(re,2668,23)))}return Promise.all(I)}().then(()=>((I,ie)=>{if(!(typeof window>"u"))return ot(),(0,Je.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]],{"type":["typeChanged"],"disabled":["disabledChanged"],"side":["sideChanged"],"swipeGesture":["swipeGestureChanged"]}],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]},null,{"activated":["activatedChanged"]}],[1,"ion-fab-list",{"activated":[4],"side":[1]},null,{"activated":["activatedChanged"]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"positionAnchor":[1,"position-anchor"],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"swipeGesture":[1,"swipe-gesture"],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"swipeGesture":["swipeGestureChanged"],"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]},null,{"value":["valueChanged"]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]],{"value":["valueChanged"],"disabled":["disabledChanged"],"readonly":["readonlyChanged"]}]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]},null,{"threshold":["thresholdChanged"],"disabled":["disabledChanged"]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]},null,{"value":["valueChanged"]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]],{"color":["colorChanged"],"swipeGesture":["swipeGestureChanged"],"value":["valueChanged"],"disabled":["disabledChanged"]}]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]},null,{"selectedTab":["selectedTabChanged"]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"placeholder":["placeholderChanged"],"value":["valueChanged"]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"value":["valueChanged"],"showCancelButton":["showCancelButtonChanged"]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"activated":[32]},null,{"disabled":["disabledChanged"]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]},null,{"swipeGesture":["swipeGestureChanged"],"root":["rootChanged"]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[514],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]],{"maxItems":["maxItemsChanged"],"itemsBeforeCollapse":["maxItemsChanged"],"itemsAfterCollapse":["maxItemsChanged"]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]},null,{"url":["onUpdate"],"component":["onUpdate"],"componentProps":["onComponentProps"]}],[0,"ion-route-redirect",{"from":[1],"to":[1]},null,{"from":["propDidChange"],"to":["propDidChange"]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]},null,{"active":["changeActive"]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]},null,{"src":["srcChanged"]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]},null,{"debounce":["debounceChanged"],"min":["minChanged"],"max":["maxChanged"],"activeBarStart":["activeBarStartChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]},null,{"visible":["visibleChanged"],"disabled":["updateState"],"when":["updateState"]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]],{"counterFormatter":["counterFormatterChanged"]}],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]},null,{"color":["colorChanged"],"position":["positionChanged"]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]},null,{"disabled":["styleChanged"],"isExpanded":["styleChanged"],"placeholder":["styleChanged"],"value":["styleChanged"]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"forceRenderDate":[32],"confirm":[64],"reset":[64],"cancel":[64]},null,{"disabled":["disabledChanged"],"min":["minChanged"],"max":["maxChanged"],"yearValues":["yearValuesChanged"],"monthValues":["monthValuesChanged"],"dayValues":["dayValuesChanged"],"hourValues":["hourValuesChanged"],"minuteValues":["minuteValuesChanged"],"value":["valueChanged"]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}],[32,"ion-picker-column",{"col":[16]},null,{"col":["colChanged"]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]},null,{"value":["valueChanged"],"checked":["styleChanged"],"color":["styleChanged"],"disabled":["styleChanged"]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"compareWith":[1,"compare-with"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]],{"value":["valueChanged"]}]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]},null,{"disabled":["disabledChanged"]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]},null,{"name":["loadIcon"],"src":["loadIcon"],"icon":["loadIcon"],"ios":["loadIcon"],"md":["loadIcon"]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]],{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"],"buttons":["buttonsChanged"],"inputs":["inputsChanged"]}]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]},null,{"swipeHandler":["swipeHandlerChanged"]}],[33,"ion-title",{"color":[513],"size":[1]},null,{"size":["sizeChanged"]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"disabled":[4],"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]},null,{"value":["valueChange"]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"trigger":["onTriggerChange"],"triggerAction":["onTriggerChange"],"isOpen":["onIsOpenChange"]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1],"legacy":[4]},null,{"checked":["styleChanged"],"disabled":["styleChanged"]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),ie)})(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Ye.Wn,jmp:yi=>k.runOutsideAngular(yi),ael(yi,Nr,as,Po){yi[Ke](Nr,as,Po)},rel(yi,Nr,as,Po){yi.removeEventListener(Nr,as,Po)}}))}};let pr=(()=>{class I{static forRoot(k){return{ngModule:I,providers:[{provide:Ye.dy,useValue:k},{provide:p.ip1,useFactory:Wn,multi:!0,deps:[Ye.dy,Fe.K0,p.R0b]},(0,Ye.DN)()]}}}return I.\u0275fac=function(k){return new(k||I)},I.\u0275mod=p.oAB({type:I}),I.\u0275inj=p.cJS({providers:[Ye.y4,Yt,Zt],imports:[Fe.ez]}),I})()},5861:(Qn,Vt,re)=>{"use strict";function p(Ye,Pe,ft,Fe,Be,Dt,Pt){try{var yt=Ye[Dt](Pt),Le=yt.value}catch(mt){return void ft(mt)}yt.done?Pe(Le):Promise.resolve(Le).then(Fe,Be)}function se(Ye){return function(){var Pe=this,ft=arguments;return new Promise(function(Fe,Be){var Dt=Ye.apply(Pe,ft);function Pt(Le){p(Dt,Fe,Be,Pt,yt,"next",Le)}function yt(Le){p(Dt,Fe,Be,Pt,yt,"throw",Le)}Pt(void 0)})}}re.d(Vt,{Z:()=>se})},7582:(Qn,Vt,re)=>{"use strict";function ft(Oe,ye,Ie,xe){var un,wt=arguments.length,ut=wt<3?ye:null===xe?xe=Object.getOwnPropertyDescriptor(ye,Ie):xe;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ut=Reflect.decorate(Oe,ye,Ie,xe);else for(var Mn=Oe.length-1;Mn>=0;Mn--)(un=Oe[Mn])&&(ut=(wt<3?un(ut):wt>3?un(ye,Ie,ut):un(ye,Ie))||ut);return wt>3&&ut&&Object.defineProperty(ye,Ie,ut),ut}function mt(Oe,ye,Ie,xe){return new(Ie||(Ie=Promise))(function(ut,un){function Mn(ai){try{Ln(xe.next(ai))}catch(Si){un(Si)}}function yn(ai){try{Ln(xe.throw(ai))}catch(Si){un(Si)}}function Ln(ai){ai.done?ut(ai.value):function wt(ut){return ut instanceof Ie?ut:new Ie(function(un){un(ut)})}(ai.value).then(Mn,yn)}Ln((xe=xe.apply(Oe,ye||[])).next())})}function st(Oe){return this instanceof st?(this.v=Oe,this):new st(Oe)}function ot(Oe,ye,Ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var wt,xe=Ie.apply(Oe,ye||[]),ut=[];return wt={},un("next"),un("throw"),un("return"),wt[Symbol.asyncIterator]=function(){return this},wt;function un(Xt){xe[Xt]&&(wt[Xt]=function(Ft){return new Promise(function(It,tn){ut.push([Xt,Ft,It,tn])>1||Mn(Xt,Ft)})})}function Mn(Xt,Ft){try{!function yn(Xt){Xt.value instanceof st?Promise.resolve(Xt.value.v).then(Ln,ai):Si(ut[0][2],Xt)}(xe[Xt](Ft))}catch(It){Si(ut[0][3],It)}}function Ln(Xt){Mn("next",Xt)}function ai(Xt){Mn("throw",Xt)}function Si(Xt,Ft){Xt(Ft),ut.shift(),ut.length&&Mn(ut[0][0],ut[0][1])}}function $e(Oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ie,ye=Oe[Symbol.asyncIterator];return ye?ye.call(Oe):(Oe=function Rt(Oe){var ye="function"==typeof Symbol&&Symbol.iterator,Ie=ye&&Oe[ye],xe=0;if(Ie)return Ie.call(Oe);if(Oe&&"number"==typeof Oe.length)return{next:function(){return Oe&&xe>=Oe.length&&(Oe=void 0),{value:Oe&&Oe[xe++],done:!Oe}}};throw new TypeError(ye?"Object is not iterable.":"Symbol.iterator is not defined.")}(Oe),Ie={},xe("next"),xe("throw"),xe("return"),Ie[Symbol.asyncIterator]=function(){return this},Ie);function xe(ut){Ie[ut]=Oe[ut]&&function(un){return new Promise(function(Mn,yn){!function wt(ut,un,Mn,yn){Promise.resolve(yn).then(function(Ln){ut({value:Ln,done:Mn})},un)}(Mn,yn,(un=Oe[ut](un)).done,un.value)})}}}re.d(Vt,{FC:()=>ot,KL:()=>$e,gn:()=>ft,mG:()=>mt,qq:()=>st}),"function"==typeof SuppressedError&&SuppressedError}},Qn=>{Qn(Qn.s=4926)}]);
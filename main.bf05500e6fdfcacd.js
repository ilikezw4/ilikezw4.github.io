(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{3630:(Kn,zt,te)=>{"use strict";te.d(zt,{c:()=>Ye,r:()=>Oe});const Ye=(pe,ge)=>{pe.componentOnReady?pe.componentOnReady().then(Ue=>ge(Ue)):Oe(()=>ge(pe))},Oe=pe=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(pe):"function"==typeof requestAnimationFrame?requestAnimationFrame(pe):setTimeout(pe)},191:(Kn,zt,te)=>{"use strict";te.d(zt,{L:()=>f,a:()=>ie,b:()=>Ye,c:()=>Ie,d:()=>ht,g:()=>pe});const f="ionViewWillEnter",ie="ionViewDidEnter",Ye="ionViewWillLeave",Ie="ionViewDidLeave",ht="ionViewWillUnload",pe=ge=>ge.classList.contains("ion-page")?ge:ge.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||ge},4913:(Kn,zt,te)=>{"use strict";te.d(zt,{c:()=>Rt});var f=te(1848),ie=te(512);let Ye;const ht=Ke=>Ke.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fe=Ke=>(void 0===Ye&&(Ye=void 0===Ke.style.animationName&&void 0!==Ke.style.webkitAnimationName?"-webkit-":""),Ye),Be=(Ke,Je,et)=>{const $t=Je.startsWith("animation")?Fe(Ke):"";Ke.style.setProperty($t+Je,et)},Tt=(Ke,Je)=>{const et=Je.startsWith("animation")?Fe(Ke):"";Ke.style.removeProperty(et+Je)},Oe=[],We=(Ke=[],Je)=>{if(void 0!==Je){const et=Array.isArray(Je)?Je:[Je];return[...Ke,...et]}return Ke},Rt=Ke=>{let Je,et,$t,rt,st,bt,Ae,Le,ve,De,xe,En,vn,He=[],pe=[],ge=[],Ue=!1,ot={},at=[],ut=[],an={},zn=0,wi=!1,Ot=!1,Mt=!0,ct=!1,un=!0,Pn=!1;const oi=Ke,Si=[],Xt=[],Nt=[],Dt=[],nn=[],kt=[],Qn=[],ai=[],$n=[],ki=[],Ci=[],or="function"==typeof AnimationEffect||void 0!==f.w&&"function"==typeof f.w.AnimationEffect,Rn="function"==typeof Element&&"function"==typeof Element.prototype.animate&&or,di=()=>Ci,ur=(B,Y)=>{const fe=Y.findIndex(Ne=>Ne.c===B);fe>-1&&Y.splice(fe,1)},xi=(B,Y)=>((null!=Y&&Y.oneTimeCallback?Xt:Si).push({c:B,o:Y}),vn),Jn=()=>{if(Rn)Ci.forEach(B=>{B.cancel()}),Ci.length=0;else{const B=Dt.slice();(0,ie.r)(()=>{B.forEach(Y=>{Tt(Y,"animation-name"),Tt(Y,"animation-duration"),Tt(Y,"animation-timing-function"),Tt(Y,"animation-iteration-count"),Tt(Y,"animation-delay"),Tt(Y,"animation-play-state"),Tt(Y,"animation-fill-mode"),Tt(Y,"animation-direction")})})}},Cr=()=>{kt.forEach(B=>{null!=B&&B.parentNode&&B.parentNode.removeChild(B)}),kt.length=0},qe=()=>void 0!==st?st:Ae?Ae.getFill():"both",_t=()=>void 0!==ve?ve:void 0!==bt?bt:Ae?Ae.getDirection():"normal",ke=()=>wi?"linear":void 0!==$t?$t:Ae?Ae.getEasing():"linear",mt=()=>Ot?0:void 0!==De?De:void 0!==et?et:Ae?Ae.getDuration():0,sn=()=>void 0!==rt?rt:Ae?Ae.getIterations():1,wn=()=>void 0!==xe?xe:void 0!==Je?Je:Ae?Ae.getDelay():0,er=()=>{0!==zn&&(zn--,0===zn&&((()=>{gr(),$n.forEach(Et=>Et()),ki.forEach(Et=>Et());const B=Mt?1:0,Y=at,fe=ut,Ne=an;Dt.forEach(Et=>{const Xe=Et.classList;Y.forEach(Wt=>Xe.add(Wt)),fe.forEach(Wt=>Xe.remove(Wt));for(const Wt in Ne)Ne.hasOwnProperty(Wt)&&Be(Et,Wt,Ne[Wt])}),De=void 0,ve=void 0,xe=void 0,Si.forEach(Et=>Et.c(B,vn)),Xt.forEach(Et=>Et.c(B,vn)),Xt.length=0,un=!0,Mt&&(ct=!0),Mt=!0})(),Ae&&Ae.animationFinish()))},hs=(B=!0)=>{Cr();const Y=(Ke=>(Ke.forEach(Je=>{for(const et in Je)if(Je.hasOwnProperty(et)){const $t=Je[et];if("easing"===et)Je["animation-timing-function"]=$t,delete Je[et];else{const rt=ht(et);rt!==et&&(Je[rt]=$t,delete Je[et])}}}),Ke))(He);Dt.forEach(fe=>{if(Y.length>0){const Ne=((Ke=[])=>Ke.map(Je=>{const et=Je.offset,$t=[];for(const rt in Je)Je.hasOwnProperty(rt)&&"offset"!==rt&&$t.push(`${rt}: ${Je[rt]};`);return`${100*et}% { ${$t.join(" ")} }`}).join(" "))(Y);En=void 0!==Ke?Ke:(Ke=>{let Je=Oe.indexOf(Ke);return Je<0&&(Je=Oe.push(Ke)-1),`ion-animation-${Je}`})(Ne);const Et=((Ke,Je,et)=>{var $t;const rt=(Ke=>{const Je=void 0!==Ke.getRootNode?Ke.getRootNode():Ke;return Je.head||Je})(et),st=Fe(et),bt=rt.querySelector("#"+Ke);if(bt)return bt;const He=(null!==($t=et.ownerDocument)&&void 0!==$t?$t:document).createElement("style");return He.id=Ke,He.textContent=`@${st}keyframes ${Ke} { ${Je} } @${st}keyframes ${Ke}-alt { ${Je} }`,rt.appendChild(He),He})(En,Ne,fe);kt.push(Et),Be(fe,"animation-duration",`${mt()}ms`),Be(fe,"animation-timing-function",ke()),Be(fe,"animation-delay",`${wn()}ms`),Be(fe,"animation-fill-mode",qe()),Be(fe,"animation-direction",_t());const Xe=sn()===1/0?"infinite":sn().toString();Be(fe,"animation-iteration-count",Xe),Be(fe,"animation-play-state","paused"),B&&Be(fe,"animation-name",`${Et.id}-alt`),(0,ie.r)(()=>{Be(fe,"animation-name",Et.id||null)})}})},As=(B=!0)=>{(()=>{Qn.forEach(Ne=>Ne()),ai.forEach(Ne=>Ne());const B=pe,Y=ge,fe=ot;Dt.forEach(Ne=>{const Et=Ne.classList;B.forEach(Xe=>Et.add(Xe)),Y.forEach(Xe=>Et.remove(Xe));for(const Xe in fe)fe.hasOwnProperty(Xe)&&Be(Ne,Xe,fe[Xe])})})(),He.length>0&&(Rn?(Dt.forEach(B=>{const Y=B.animate(He,{id:oi,delay:wn(),duration:mt(),easing:ke(),iterations:sn(),fill:qe(),direction:_t()});Y.pause(),Ci.push(Y)}),Ci.length>0&&(Ci[0].onfinish=()=>{er()})):hs(B)),Ue=!0},Sr=B=>{if(B=Math.min(Math.max(B,0),.9999),Rn)Ci.forEach(Y=>{Y.currentTime=Y.effect.getComputedTiming().delay+mt()*B,Y.pause()});else{const Y=`-${mt()*B}ms`;Dt.forEach(fe=>{He.length>0&&(Be(fe,"animation-delay",Y),Be(fe,"animation-play-state","paused"))})}},fs=B=>{Ci.forEach(Y=>{Y.effect.updateTiming({delay:wn(),duration:mt(),easing:ke(),iterations:sn(),fill:qe(),direction:_t()})}),void 0!==B&&Sr(B)},Ts=(B=!0,Y)=>{(0,ie.r)(()=>{Dt.forEach(fe=>{Be(fe,"animation-name",En||null),Be(fe,"animation-duration",`${mt()}ms`),Be(fe,"animation-timing-function",ke()),Be(fe,"animation-delay",void 0!==Y?`-${Y*mt()}ms`:`${wn()}ms`),Be(fe,"animation-fill-mode",qe()||null),Be(fe,"animation-direction",_t()||null);const Ne=sn()===1/0?"infinite":sn().toString();Be(fe,"animation-iteration-count",Ne),B&&Be(fe,"animation-name",`${En}-alt`),(0,ie.r)(()=>{Be(fe,"animation-name",En||null)})})})},Rr=(B=!1,Y=!0,fe)=>(B&&nn.forEach(Ne=>{Ne.update(B,Y,fe)}),Rn?fs(fe):Ts(Y,fe),vn),li=()=>{Ue&&(Rn?Ci.forEach(B=>{B.pause()}):Dt.forEach(B=>{Be(B,"animation-play-state","paused")}),Pn=!0)},bs=()=>{Le=void 0,er()},gr=()=>{Le&&clearTimeout(Le)},Z=B=>new Promise(Y=>{null!=B&&B.sync&&(Ot=!0,xi(()=>Ot=!1,{oneTimeCallback:!0})),Ue||As(),ct&&(Rn?(Sr(0),fs()):Ts(),ct=!1),un&&(zn=nn.length+1,un=!1);const fe=()=>{ur(Ne,Xt),Y()},Ne=()=>{ur(fe,Nt),Y()};xi(Ne,{oneTimeCallback:!0}),((B,Y)=>{Nt.push({c:B,o:{oneTimeCallback:!0}})})(fe),nn.forEach(Et=>{Et.play()}),Rn?(Ci.forEach(B=>{B.play()}),(0===He.length||0===Dt.length)&&er()):(()=>{if(gr(),(0,ie.r)(()=>{Dt.forEach(B=>{He.length>0&&Be(B,"animation-play-state","running")})}),0===He.length||0===Dt.length)er();else{const B=wn()||0,Y=mt()||0,fe=sn()||1;isFinite(fe)&&(Le=setTimeout(bs,B+Y*fe+100)),((Ke,Je)=>{let et;const $t={passive:!0},st=bt=>{Ke===bt.target&&(et&&et(),gr(),(0,ie.r)(()=>{Dt.forEach(B=>{Tt(B,"animation-duration"),Tt(B,"animation-delay"),Tt(B,"animation-play-state")}),(0,ie.r)(er)}))};Ke&&(Ke.addEventListener("webkitAnimationEnd",st,$t),Ke.addEventListener("animationend",st,$t),et=()=>{Ke.removeEventListener("webkitAnimationEnd",st,$t),Ke.removeEventListener("animationend",st,$t)})})(Dt[0])}})(),Pn=!1}),Qe=(B,Y)=>{const fe=He[0];return void 0===fe||void 0!==fe.offset&&0!==fe.offset?He=[{offset:0,[B]:Y},...He]:fe[B]=Y,vn};return vn={parentAnimation:Ae,elements:Dt,childAnimations:nn,id:oi,animationFinish:er,from:Qe,to:(B,Y)=>{const fe=He[He.length-1];return void 0===fe||void 0!==fe.offset&&1!==fe.offset?He=[...He,{offset:1,[B]:Y}]:fe[B]=Y,vn},fromTo:(B,Y,fe)=>Qe(B,Y).to(B,fe),parent:B=>(Ae=B,vn),play:Z,pause:()=>(nn.forEach(B=>{B.pause()}),li(),vn),stop:()=>{nn.forEach(B=>{B.stop()}),Ue&&(Jn(),Ue=!1),wi=!1,Ot=!1,un=!0,ve=void 0,De=void 0,xe=void 0,zn=0,ct=!1,Mt=!0,Pn=!1,Nt.forEach(B=>B.c(0,vn)),Nt.length=0},destroy:B=>(nn.forEach(Y=>{Y.destroy(B)}),(B=>{Jn(),B&&Cr()})(B),Dt.length=0,nn.length=0,He.length=0,Si.length=0,Xt.length=0,Ue=!1,un=!0,vn),keyframes:B=>{const Y=He!==B;return He=B,Y&&(B=>{Rn?di().forEach(Y=>{const fe=Y.effect;if(fe.setKeyframes)fe.setKeyframes(B);else{const Ne=new KeyframeEffect(fe.target,B,fe.getTiming());Y.effect=Ne}}):hs()})(He),vn},addAnimation:B=>{if(null!=B)if(Array.isArray(B))for(const Y of B)Y.parent(vn),nn.push(Y);else B.parent(vn),nn.push(B);return vn},addElement:B=>{if(null!=B)if(1===B.nodeType)Dt.push(B);else if(B.length>=0)for(let Y=0;Y<B.length;Y++)Dt.push(B[Y]);else console.error("Invalid addElement value");return vn},update:Rr,fill:B=>(st=B,Rr(!0),vn),direction:B=>(bt=B,Rr(!0),vn),iterations:B=>(rt=B,Rr(!0),vn),duration:B=>(!Rn&&0===B&&(B=1),et=B,Rr(!0),vn),easing:B=>($t=B,Rr(!0),vn),delay:B=>(Je=B,Rr(!0),vn),getWebAnimations:di,getKeyframes:()=>He,getFill:qe,getDirection:_t,getDelay:wn,getIterations:sn,getEasing:ke,getDuration:mt,afterAddRead:B=>($n.push(B),vn),afterAddWrite:B=>(ki.push(B),vn),afterClearStyles:(B=[])=>{for(const Y of B)an[Y]="";return vn},afterStyles:(B={})=>(an=B,vn),afterRemoveClass:B=>(ut=We(ut,B),vn),afterAddClass:B=>(at=We(at,B),vn),beforeAddRead:B=>(Qn.push(B),vn),beforeAddWrite:B=>(ai.push(B),vn),beforeClearStyles:(B=[])=>{for(const Y of B)ot[Y]="";return vn},beforeStyles:(B={})=>(ot=B,vn),beforeRemoveClass:B=>(ge=We(ge,B),vn),beforeAddClass:B=>(pe=We(pe,B),vn),onFinish:xi,isRunning:()=>0!==zn&&!Pn,progressStart:(B=!1,Y)=>(nn.forEach(fe=>{fe.progressStart(B,Y)}),li(),wi=B,Ue||As(),Rr(!1,!0,Y),vn),progressStep:B=>(nn.forEach(Y=>{Y.progressStep(B)}),Sr(B),vn),progressEnd:(B,Y,fe)=>(wi=!1,nn.forEach(Ne=>{Ne.progressEnd(B,Y,fe)}),void 0!==fe&&(De=fe),ct=!1,Mt=!0,0===B?(ve="reverse"===_t()?"normal":"reverse","reverse"===ve&&(Mt=!1),Rn?(Rr(),Sr(1-Y)):(xe=(1-Y)*mt()*-1,Rr(!1,!1))):1===B&&(Rn?(Rr(),Sr(Y)):(xe=Y*mt()*-1,Rr(!1,!1))),void 0!==B&&!Ae&&Z(),vn)}}},8958:(Kn,zt,te)=>{"use strict";te.d(zt,{E:()=>yt,a:()=>f,s:()=>Tt});const f=Oe=>{try{if(Oe instanceof Be)return Oe.value;if(!Ie()||"string"!=typeof Oe||""===Oe)return Oe;if(Oe.includes("onload="))return"";const ft=document.createDocumentFragment(),lt=document.createElement("div");ft.appendChild(lt),lt.innerHTML=Oe,Fe.forEach(Ke=>{const Je=ft.querySelectorAll(Ke);for(let et=Je.length-1;et>=0;et--){const $t=Je[et];$t.parentNode?$t.parentNode.removeChild($t):ft.removeChild($t);const rt=Ye($t);for(let st=0;st<rt.length;st++)ie(rt[st])}});const tt=Ye(ft);for(let Ke=0;Ke<tt.length;Ke++)ie(tt[Ke]);const We=document.createElement("div");We.appendChild(ft);const Rt=We.querySelector("div");return null!==Rt?Rt.innerHTML:We.innerHTML}catch(ft){return console.error(ft),""}},ie=Oe=>{if(Oe.nodeType&&1!==Oe.nodeType)return;if(typeof NamedNodeMap<"u"&&!(Oe.attributes instanceof NamedNodeMap))return void Oe.remove();for(let lt=Oe.attributes.length-1;lt>=0;lt--){const tt=Oe.attributes.item(lt),We=tt.name;if(!ht.includes(We.toLowerCase())){Oe.removeAttribute(We);continue}const Rt=tt.value,Ke=Oe[We];(null!=Rt&&Rt.toLowerCase().includes("javascript:")||null!=Ke&&Ke.toLowerCase().includes("javascript:"))&&Oe.removeAttribute(We)}const ft=Ye(Oe);for(let lt=0;lt<ft.length;lt++)ie(ft[lt])},Ye=Oe=>null!=Oe.children?Oe.children:Oe.childNodes,Ie=()=>{var Oe;const ft=window,lt=null===(Oe=null==ft?void 0:ft.Ionic)||void 0===Oe?void 0:Oe.config;return!lt||(lt.get?lt.get("sanitizerEnabled",!0):!0===lt.sanitizerEnabled||void 0===lt.sanitizerEnabled)},ht=["class","id","href","src","name","slot"],Fe=["script","style","iframe","meta","link","object","embed"];class Be{constructor(ft){this.value=ft}}const Tt=Oe=>{const ft=window,lt=ft.Ionic;if(!lt||!lt.config||"Object"===lt.config.constructor.name)return ft.Ionic=ft.Ionic||{},ft.Ionic.config=Object.assign(Object.assign({},ft.Ionic.config),Oe),ft.Ionic.config},yt=!1},3254:(Kn,zt,te)=>{"use strict";te.d(zt,{C:()=>ht,a:()=>Ye,d:()=>Ie});var f=te(5861),ie=te(512);const Ye=function(){var Fe=(0,f.Z)(function*(Be,Tt,Pt,yt,Oe,ft){var lt;if(Be)return Be.attachViewToDom(Tt,Pt,Oe,yt);if(!(ft||"string"==typeof Pt||Pt instanceof HTMLElement))throw new Error("framework delegate is missing");const tt="string"==typeof Pt?null===(lt=Tt.ownerDocument)||void 0===lt?void 0:lt.createElement(Pt):Pt;return yt&&yt.forEach(We=>tt.classList.add(We)),Oe&&Object.assign(tt,Oe),Tt.appendChild(tt),yield new Promise(We=>(0,ie.c)(tt,We)),tt});return function(Tt,Pt,yt,Oe,ft,lt){return Fe.apply(this,arguments)}}(),Ie=(Fe,Be)=>{if(Be){if(Fe)return Fe.removeViewFromDom(Be.parentElement,Be);Be.remove()}return Promise.resolve()},ht=()=>{let Fe,Be;return{attachViewToDom:function(){var yt=(0,f.Z)(function*(Oe,ft,lt={},tt=[]){var We,Rt;let Ke;if(Fe=Oe,ft){const et="string"==typeof ft?null===(We=Fe.ownerDocument)||void 0===We?void 0:We.createElement(ft):ft;tt.forEach($t=>et.classList.add($t)),Object.assign(et,lt),Fe.appendChild(et),Ke=et,yield new Promise($t=>(0,ie.c)(et,$t))}else if(Fe.children.length>0&&("ION-MODAL"===Fe.tagName||"ION-POPOVER"===Fe.tagName)&&!(Ke=Fe.children[0]).classList.contains("ion-delegate-host")){const $t=null===(Rt=Fe.ownerDocument)||void 0===Rt?void 0:Rt.createElement("div");$t.classList.add("ion-delegate-host"),tt.forEach(rt=>$t.classList.add(rt)),$t.append(...Fe.children),Fe.appendChild($t),Ke=$t}const Je=document.querySelector("ion-app")||document.body;return Be=document.createComment("ionic teleport"),Fe.parentNode.insertBefore(Be,Fe),Je.appendChild(Fe),null!=Ke?Ke:Fe});return function(ft,lt){return yt.apply(this,arguments)}}(),removeViewFromDom:()=>(Fe&&Be&&(Be.parentNode.insertBefore(Fe,Be),Be.remove()),Promise.resolve())}}},2019:(Kn,zt,te)=>{"use strict";te.d(zt,{G:()=>ht});class ie{constructor(Be,Tt,Pt,yt,Oe){this.id=Tt,this.name=Pt,this.disableScroll=Oe,this.priority=1e6*yt+Tt,this.ctrl=Be}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const Be=this.ctrl.capture(this.name,this.id,this.priority);return Be&&this.disableScroll&&this.ctrl.disableScroll(this.id),Be}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Ye{constructor(Be,Tt,Pt,yt){this.id=Tt,this.disable=Pt,this.disableScroll=yt,this.ctrl=Be}block(){if(this.ctrl){if(this.disable)for(const Be of this.disable)this.ctrl.disableGesture(Be,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const Be of this.disable)this.ctrl.enableGesture(Be,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const Ie="backdrop-no-scroll",ht=new class f{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(Be){var Tt;return new ie(this,this.newID(),Be.name,null!==(Tt=Be.priority)&&void 0!==Tt?Tt:0,!!Be.disableScroll)}createBlocker(Be={}){return new Ye(this,this.newID(),Be.disable,!!Be.disableScroll)}start(Be,Tt,Pt){return this.canStart(Be)?(this.requestedStart.set(Tt,Pt),!0):(this.requestedStart.delete(Tt),!1)}capture(Be,Tt,Pt){if(!this.start(Be,Tt,Pt))return!1;const yt=this.requestedStart;let Oe=-1e4;if(yt.forEach(ft=>{Oe=Math.max(Oe,ft)}),Oe===Pt){this.capturedId=Tt,yt.clear();const ft=new CustomEvent("ionGestureCaptured",{detail:{gestureName:Be}});return document.dispatchEvent(ft),!0}return yt.delete(Tt),!1}release(Be){this.requestedStart.delete(Be),this.capturedId===Be&&(this.capturedId=void 0)}disableGesture(Be,Tt){let Pt=this.disabledGestures.get(Be);void 0===Pt&&(Pt=new Set,this.disabledGestures.set(Be,Pt)),Pt.add(Tt)}enableGesture(Be,Tt){const Pt=this.disabledGestures.get(Be);void 0!==Pt&&Pt.delete(Tt)}disableScroll(Be){this.disabledScroll.add(Be),1===this.disabledScroll.size&&document.body.classList.add(Ie)}enableScroll(Be){this.disabledScroll.delete(Be),0===this.disabledScroll.size&&document.body.classList.remove(Ie)}canStart(Be){return!(void 0!==this.capturedId||this.isDisabled(Be))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(Be){const Tt=this.disabledGestures.get(Be);return!!(Tt&&Tt.size>0)}newID(){return this.gestureId++,this.gestureId}}},4393:(Kn,zt,te)=>{"use strict";te.r(zt),te.d(zt,{MENU_BACK_BUTTON_PRIORITY:()=>ht,OVERLAY_BACK_BUTTON_PRIORITY:()=>Ie,blockHardwareBackButton:()=>ie,startHardwareBackButton:()=>Ye});var f=te(5861);const ie=()=>{document.addEventListener("backbutton",()=>{})},Ye=()=>{const Fe=document;let Be=!1;Fe.addEventListener("backbutton",()=>{if(Be)return;let Tt=0,Pt=[];const yt=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(lt,tt){Pt.push({priority:lt,handler:tt,id:Tt++})}}});Fe.dispatchEvent(yt);const Oe=function(){var lt=(0,f.Z)(function*(tt){try{if(null!=tt&&tt.handler){const We=tt.handler(ft);null!=We&&(yield We)}}catch(We){console.error(We)}});return function(We){return lt.apply(this,arguments)}}(),ft=()=>{if(Pt.length>0){let lt={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Pt.forEach(tt=>{tt.priority>=lt.priority&&(lt=tt)}),Be=!0,Pt=Pt.filter(tt=>tt.id!==lt.id),Oe(lt).then(()=>Be=!1)}};ft()})},Ie=100,ht=99},512:(Kn,zt,te)=>{"use strict";te.d(zt,{a:()=>Tt,b:()=>Pt,c:()=>Ye,d:()=>Rt,e:()=>We,f:()=>tt,g:()=>yt,h:()=>lt,i:()=>Be,j:()=>st,k:()=>ht,l:()=>Ke,m:()=>Ie,n:()=>ft,o:()=>Je,p:()=>rt,q:()=>bt,r:()=>Oe,s:()=>He,t:()=>f,u:()=>et,v:()=>$t});const f=(pe,ge=0)=>new Promise(Ue=>{ie(pe,ge,Ue)}),ie=(pe,ge=0,Ue)=>{let Ae,ot;const at={passive:!0},an=()=>{Ae&&Ae()},zn=wi=>{(void 0===wi||pe===wi.target)&&(an(),Ue(wi))};return pe&&(pe.addEventListener("webkitTransitionEnd",zn,at),pe.addEventListener("transitionend",zn,at),ot=setTimeout(zn,ge+500),Ae=()=>{ot&&(clearTimeout(ot),ot=void 0),pe.removeEventListener("webkitTransitionEnd",zn,at),pe.removeEventListener("transitionend",zn,at)}),an},Ye=(pe,ge)=>{pe.componentOnReady?pe.componentOnReady().then(Ue=>ge(Ue)):Oe(()=>ge(pe))},Ie=pe=>void 0!==pe.componentOnReady,ht=(pe,ge=[])=>{const Ue={};return ge.forEach(Ae=>{pe.hasAttribute(Ae)&&(null!==pe.getAttribute(Ae)&&(Ue[Ae]=pe.getAttribute(Ae)),pe.removeAttribute(Ae))}),Ue},Fe=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],Be=(pe,ge)=>{let Ue=Fe;return ge&&ge.length>0&&(Ue=Ue.filter(Ae=>!ge.includes(Ae))),ht(pe,Ue)},Tt=(pe,ge,Ue,Ae)=>{var ot;if(typeof window<"u"){const at=window,ut=null===(ot=null==at?void 0:at.Ionic)||void 0===ot?void 0:ot.config;if(ut){const an=ut.get("_ael");if(an)return an(pe,ge,Ue,Ae);if(ut._ael)return ut._ael(pe,ge,Ue,Ae)}}return pe.addEventListener(ge,Ue,Ae)},Pt=(pe,ge,Ue,Ae)=>{var ot;if(typeof window<"u"){const at=window,ut=null===(ot=null==at?void 0:at.Ionic)||void 0===ot?void 0:ot.config;if(ut){const an=ut.get("_rel");if(an)return an(pe,ge,Ue,Ae);if(ut._rel)return ut._rel(pe,ge,Ue,Ae)}}return pe.removeEventListener(ge,Ue,Ae)},yt=(pe,ge=pe)=>pe.shadowRoot||ge,Oe=pe=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(pe):"function"==typeof requestAnimationFrame?requestAnimationFrame(pe):setTimeout(pe),ft=pe=>!!pe.shadowRoot&&!!pe.attachShadow,lt=pe=>{const ge=pe.closest("ion-item");return ge?ge.querySelector("ion-label"):null},tt=pe=>{if(pe.focus(),pe.classList.contains("ion-focusable")){const ge=pe.closest("ion-app");ge&&ge.setFocus([pe])}},We=(pe,ge)=>{let Ue;const Ae=pe.getAttribute("aria-labelledby"),ot=pe.id;let at=null!==Ae&&""!==Ae.trim()?Ae:ge+"-lbl",ut=null!==Ae&&""!==Ae.trim()?document.getElementById(Ae):lt(pe);return ut?(null===Ae&&(ut.id=at),Ue=ut.textContent,ut.setAttribute("aria-hidden","true")):""!==ot.trim()&&(ut=document.querySelector(`label[for="${ot}"]`),ut&&(""!==ut.id?at=ut.id:ut.id=at=`${ot}-lbl`,Ue=ut.textContent)),{label:ut,labelId:at,labelText:Ue}},Rt=(pe,ge,Ue,Ae,ot)=>{if(pe||ft(ge)){let at=ge.querySelector("input.aux-input");at||(at=ge.ownerDocument.createElement("input"),at.type="hidden",at.classList.add("aux-input"),ge.appendChild(at)),at.disabled=ot,at.name=Ue,at.value=Ae||""}},Ke=(pe,ge,Ue)=>Math.max(pe,Math.min(ge,Ue)),Je=(pe,ge)=>{if(!pe){const Ue="ASSERT: "+ge;throw console.error(Ue),new Error(Ue)}},et=pe=>pe.timeStamp||Date.now(),$t=pe=>{if(pe){const ge=pe.changedTouches;if(ge&&ge.length>0){const Ue=ge[0];return{x:Ue.clientX,y:Ue.clientY}}if(void 0!==pe.pageX)return{x:pe.pageX,y:pe.pageY}}return{x:0,y:0}},rt=pe=>{const ge="rtl"===document.dir;switch(pe){case"start":return ge;case"end":return!ge;default:throw new Error(`"${pe}" is not a valid value for [side]. Use "start" or "end" instead.`)}},st=(pe,ge)=>{const Ue=pe._original||pe;return{_original:pe,emit:bt(Ue.emit.bind(Ue),ge)}},bt=(pe,ge=0)=>{let Ue;return(...Ae)=>{clearTimeout(Ue),Ue=setTimeout(pe,ge,...Ae)}},He=(pe,ge)=>{if(null!=pe||(pe={}),null!=ge||(ge={}),pe===ge)return!0;const Ue=Object.keys(pe);if(Ue.length!==Object.keys(ge).length)return!1;for(const Ae of Ue)if(!(Ae in ge)||pe[Ae]!==ge[Ae])return!1;return!0}},5613:(Kn,zt,te)=>{"use strict";te.d(zt,{m:()=>lt});var f=te(5861),ie=te(1848),Ye=te(4393),Ie=te(2400),ht=te(512),Fe=te(2905),Be=te(4913);const Tt=tt=>(0,Be.c)().duration(tt?400:300),Pt=tt=>{let We,Rt;const Ke=tt.width+8,Je=(0,Be.c)(),et=(0,Be.c)();tt.isEndSide?(We=Ke+"px",Rt="0px"):(We=-Ke+"px",Rt="0px"),Je.addElement(tt.menuInnerEl).fromTo("transform",`translateX(${We})`,`translateX(${Rt})`);const rt="ios"===(0,Fe.b)(tt),st=rt?.2:.25;return et.addElement(tt.backdropEl).fromTo("opacity",.01,st),Tt(rt).addAnimation([Je,et])},yt=tt=>{let We,Rt;const Ke=(0,Fe.b)(tt),Je=tt.width;tt.isEndSide?(We=-Je+"px",Rt=Je+"px"):(We=Je+"px",Rt=-Je+"px");const et=(0,Be.c)().addElement(tt.menuInnerEl).fromTo("transform",`translateX(${Rt})`,"translateX(0px)"),$t=(0,Be.c)().addElement(tt.contentEl).fromTo("transform","translateX(0px)",`translateX(${We})`),rt=(0,Be.c)().addElement(tt.backdropEl).fromTo("opacity",.01,.32);return Tt("ios"===Ke).addAnimation([et,$t,rt])},Oe=tt=>{const We=(0,Fe.b)(tt),Rt=tt.width*(tt.isEndSide?-1:1)+"px",Ke=(0,Be.c)().addElement(tt.contentEl).fromTo("transform","translateX(0px)",`translateX(${Rt})`);return Tt("ios"===We).addAnimation(Ke)},lt=(()=>{const tt=new Map,We=[],Rt=function(){var ve=(0,f.Z)(function*(De){const xe=yield bt(De,!0);return!!xe&&xe.open()});return function(xe){return ve.apply(this,arguments)}}(),Ke=function(){var ve=(0,f.Z)(function*(De){const xe=yield void 0!==De?bt(De,!0):He();return void 0!==xe&&xe.close()});return function(xe){return ve.apply(this,arguments)}}(),Je=function(){var ve=(0,f.Z)(function*(De){const xe=yield bt(De,!0);return!!xe&&xe.toggle()});return function(xe){return ve.apply(this,arguments)}}(),et=function(){var ve=(0,f.Z)(function*(De,xe){const Mt=yield bt(xe);return Mt&&(Mt.disabled=!De),Mt});return function(xe,Mt){return ve.apply(this,arguments)}}(),$t=function(){var ve=(0,f.Z)(function*(De,xe){const Mt=yield bt(xe);return Mt&&(Mt.swipeGesture=De),Mt});return function(xe,Mt){return ve.apply(this,arguments)}}(),rt=function(){var ve=(0,f.Z)(function*(De){if(null!=De){const xe=yield bt(De);return void 0!==xe&&xe.isOpen()}return void 0!==(yield He())});return function(xe){return ve.apply(this,arguments)}}(),st=function(){var ve=(0,f.Z)(function*(De){const xe=yield bt(De);return!!xe&&!xe.disabled});return function(xe){return ve.apply(this,arguments)}}(),bt=function(){var ve=(0,f.Z)(function*(De,xe=!1){if(yield Le(),"start"===De||"end"===De){const ct=We.filter(En=>En.side===De&&!En.disabled);if(ct.length>=1)return ct.length>1&&xe&&(0,Ie.p)(`menuController queried for a menu on the "${De}" side, but ${ct.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,ct.map(En=>En.el)),ct[0].el;const un=We.filter(En=>En.side===De);if(un.length>=1)return un.length>1&&xe&&(0,Ie.p)(`menuController queried for a menu on the "${De}" side, but ${un.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,un.map(En=>En.el)),un[0].el}else if(null!=De)return Ot(ct=>ct.menuId===De);return Ot(ct=>!ct.disabled)||(We.length>0?We[0].el:void 0)});return function(xe){return ve.apply(this,arguments)}}(),He=function(){var ve=(0,f.Z)(function*(){return yield Le(),an()});return function(){return ve.apply(this,arguments)}}(),pe=function(){var ve=(0,f.Z)(function*(){return yield Le(),zn()});return function(){return ve.apply(this,arguments)}}(),ge=function(){var ve=(0,f.Z)(function*(){return yield Le(),wi()});return function(){return ve.apply(this,arguments)}}(),Ue=(ve,De)=>{tt.set(ve,De)},at=function(){var ve=(0,f.Z)(function*(De,xe,Mt){if(wi())return!1;if(xe){const ct=yield He();ct&&De.el!==ct&&(yield ct.setOpen(!1,!1))}return De._setOpen(xe,Mt)});return function(xe,Mt,ct){return ve.apply(this,arguments)}}(),an=()=>Ot(ve=>ve._isOpen),zn=()=>We.map(ve=>ve.el),wi=()=>We.some(ve=>ve.isAnimating),Ot=ve=>{const De=We.find(ve);if(void 0!==De)return De.el},Le=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(ve=>new Promise(De=>(0,ht.c)(ve,De))));return Ue("reveal",Oe),Ue("push",yt),Ue("overlay",Pt),null==ie.d||ie.d.addEventListener("ionBackButton",ve=>{const De=an();De&&ve.detail.register(Ye.MENU_BACK_BUTTON_PRIORITY,()=>De.close())}),{registerAnimation:Ue,get:bt,getMenus:pe,getOpen:He,isEnabled:st,swipeGesture:$t,isAnimating:ge,isOpen:rt,enable:et,toggle:Je,close:Ke,open:Rt,_getOpenSync:an,_createAnimation:(ve,De)=>{const xe=tt.get(ve);if(!xe)throw new Error("animation not registered");return xe(De)},_register:ve=>{We.indexOf(ve)<0&&We.push(ve)},_unregister:ve=>{const De=We.indexOf(ve);De>-1&&We.splice(De,1)},_setOpen:at}})()},6535:(Kn,zt,te)=>{"use strict";te.r(zt),te.d(zt,{GESTURE_CONTROLLER:()=>f.G,createGesture:()=>Pt});var f=te(2019);const ie=(lt,tt,We,Rt)=>{const Ke=Ye(lt)?{capture:!!Rt.capture,passive:!!Rt.passive}:!!Rt.capture;let Je,et;return lt.__zone_symbol__addEventListener?(Je="__zone_symbol__addEventListener",et="__zone_symbol__removeEventListener"):(Je="addEventListener",et="removeEventListener"),lt[Je](tt,We,Ke),()=>{lt[et](tt,We,Ke)}},Ye=lt=>{if(void 0===Ie)try{const tt=Object.defineProperty({},"passive",{get:()=>{Ie=!0}});lt.addEventListener("optsTest",()=>{},tt)}catch{Ie=!1}return!!Ie};let Ie;const Be=lt=>lt instanceof Document?lt:lt.ownerDocument,Pt=lt=>{let tt=!1,We=!1,Rt=!0,Ke=!1;const Je=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},lt),et=Je.canStart,$t=Je.onWillStart,rt=Je.onStart,st=Je.onEnd,bt=Je.notCaptured,He=Je.onMove,pe=Je.threshold,ge=Je.passive,Ue=Je.blurOnStart,Ae={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},ot=((lt,tt,We)=>{const Rt=We*(Math.PI/180),Ke="x"===lt,Je=Math.cos(Rt),et=tt*tt;let $t=0,rt=0,st=!1,bt=0;return{start(He,pe){$t=He,rt=pe,bt=0,st=!0},detect(He,pe){if(!st)return!1;const ge=He-$t,Ue=pe-rt,Ae=ge*ge+Ue*Ue;if(Ae<et)return!1;const ot=Math.sqrt(Ae),at=(Ke?ge:Ue)/ot;return bt=at>Je?1:at<-Je?-1:0,st=!1,!0},isGesture:()=>0!==bt,getDirection:()=>bt}})(Je.direction,Je.threshold,Je.maxAngle),at=f.G.createGesture({name:lt.gestureName,priority:lt.gesturePriority,disableScroll:lt.disableScroll}),zn=()=>{tt&&(Ke=!1,He&&He(Ae))},wi=()=>!!at.capture()&&(tt=!0,Rt=!1,Ae.startX=Ae.currentX,Ae.startY=Ae.currentY,Ae.startTime=Ae.currentTime,$t?$t(Ae).then(Le):Le(),!0),Le=()=>{Ue&&(()=>{if(typeof document<"u"){const ct=document.activeElement;null!=ct&&ct.blur&&ct.blur()}})(),rt&&rt(Ae),Rt=!0},ve=()=>{tt=!1,We=!1,Ke=!1,Rt=!0,at.release()},De=ct=>{const un=tt,En=Rt;if(ve(),En){if(yt(Ae,ct),un)return void(st&&st(Ae));bt&&bt(Ae)}},xe=((lt,tt,We,Rt,Ke)=>{let Je,et,$t,rt,st,bt,He,pe=0;const ge=Ot=>{pe=Date.now()+2e3,tt(Ot)&&(!et&&We&&(et=ie(lt,"touchmove",We,Ke)),$t||($t=ie(Ot.target,"touchend",Ae,Ke)),rt||(rt=ie(Ot.target,"touchcancel",Ae,Ke)))},Ue=Ot=>{pe>Date.now()||tt(Ot)&&(!bt&&We&&(bt=ie(Be(lt),"mousemove",We,Ke)),He||(He=ie(Be(lt),"mouseup",ot,Ke)))},Ae=Ot=>{at(),Rt&&Rt(Ot)},ot=Ot=>{ut(),Rt&&Rt(Ot)},at=()=>{et&&et(),$t&&$t(),rt&&rt(),et=$t=rt=void 0},ut=()=>{bt&&bt(),He&&He(),bt=He=void 0},an=()=>{at(),ut()},zn=(Ot=!0)=>{Ot?(Je||(Je=ie(lt,"touchstart",ge,Ke)),st||(st=ie(lt,"mousedown",Ue,Ke))):(Je&&Je(),st&&st(),Je=st=void 0,an())};return{enable:zn,stop:an,destroy:()=>{zn(!1),Rt=We=tt=void 0}}})(Je.el,ct=>{const un=ft(ct);return!(We||!Rt||(Oe(ct,Ae),Ae.startX=Ae.currentX,Ae.startY=Ae.currentY,Ae.startTime=Ae.currentTime=un,Ae.velocityX=Ae.velocityY=Ae.deltaX=Ae.deltaY=0,Ae.event=ct,et&&!1===et(Ae))||(at.release(),!at.start()))&&(We=!0,0===pe?wi():(ot.start(Ae.startX,Ae.startY),!0))},ct=>{tt?!Ke&&Rt&&(Ke=!0,yt(Ae,ct),requestAnimationFrame(zn)):(yt(Ae,ct),ot.detect(Ae.currentX,Ae.currentY)&&(!ot.isGesture()||!wi())&&Mt())},De,{capture:!1,passive:ge}),Mt=()=>{ve(),xe.stop(),bt&&bt(Ae)};return{enable(ct=!0){ct||(tt&&De(void 0),ve()),xe.enable(ct)},destroy(){at.destroy(),xe.destroy()}}},yt=(lt,tt)=>{if(!tt)return;const We=lt.currentX,Rt=lt.currentY,Ke=lt.currentTime;Oe(tt,lt);const Je=lt.currentX,et=lt.currentY,rt=(lt.currentTime=ft(tt))-Ke;if(rt>0&&rt<100){const bt=(et-Rt)/rt;lt.velocityX=(Je-We)/rt*.7+.3*lt.velocityX,lt.velocityY=.7*bt+.3*lt.velocityY}lt.deltaX=Je-lt.startX,lt.deltaY=et-lt.startY,lt.event=tt},Oe=(lt,tt)=>{let We=0,Rt=0;if(lt){const Ke=lt.changedTouches;if(Ke&&Ke.length>0){const Je=Ke[0];We=Je.clientX,Rt=Je.clientY}else void 0!==lt.pageX&&(We=lt.pageX,Rt=lt.pageY)}tt.currentX=We,tt.currentY=Rt},ft=lt=>lt.timeStamp||Date.now()},2325:(Kn,zt,te)=>{"use strict";te.d(zt,{b:()=>Fe,c:()=>Be,d:()=>Tt,e:()=>pe,g:()=>Ae,l:()=>bt,s:()=>ge,t:()=>Oe,w:()=>He});var f=te(5861),ie=te(771),Ye=te(512);const Fe="ionViewWillLeave",Be="ionViewDidLeave",Tt="ionViewWillUnload",Oe=ot=>new Promise((at,ut)=>{(0,ie.w)(()=>{ft(ot),lt(ot).then(an=>{an.animation&&an.animation.destroy(),tt(ot),at(an)},an=>{tt(ot),ut(an)})})}),ft=ot=>{const at=ot.enteringEl,ut=ot.leavingEl;Ue(at,ut,ot.direction),ot.showGoBack?at.classList.add("can-go-back"):at.classList.remove("can-go-back"),ge(at,!1),at.style.setProperty("pointer-events","none"),ut&&(ge(ut,!1),ut.style.setProperty("pointer-events","none"))},lt=function(){var ot=(0,f.Z)(function*(at){const ut=yield We(at);return ut&&ie.B.isBrowser?Rt(ut,at):Ke(at)});return function(ut){return ot.apply(this,arguments)}}(),tt=ot=>{const at=ot.enteringEl,ut=ot.leavingEl;at.classList.remove("ion-page-invisible"),at.style.removeProperty("pointer-events"),void 0!==ut&&(ut.classList.remove("ion-page-invisible"),ut.style.removeProperty("pointer-events"))},We=function(){var ot=(0,f.Z)(function*(at){return at.leavingEl&&at.animated&&0!==at.duration?at.animationBuilder?at.animationBuilder:"ios"===at.mode?(yield Promise.resolve().then(te.bind(te,3433))).iosTransitionAnimation:(yield Promise.resolve().then(te.bind(te,6615))).mdTransitionAnimation:void 0});return function(ut){return ot.apply(this,arguments)}}(),Rt=function(){var ot=(0,f.Z)(function*(at,ut){yield Je(ut,!0);const an=at(ut.baseEl,ut);rt(ut.enteringEl,ut.leavingEl);const zn=yield $t(an,ut);return ut.progressCallback&&ut.progressCallback(void 0),zn&&st(ut.enteringEl,ut.leavingEl),{hasCompleted:zn,animation:an}});return function(ut,an){return ot.apply(this,arguments)}}(),Ke=function(){var ot=(0,f.Z)(function*(at){const ut=at.enteringEl,an=at.leavingEl;return yield Je(at,!1),rt(ut,an),st(ut,an),{hasCompleted:!0}});return function(ut){return ot.apply(this,arguments)}}(),Je=function(){var ot=(0,f.Z)(function*(at,ut){(void 0!==at.deepWait?at.deepWait:ut)&&(yield Promise.all([pe(at.enteringEl),pe(at.leavingEl)])),yield et(at.viewIsReady,at.enteringEl)});return function(ut,an){return ot.apply(this,arguments)}}(),et=function(){var ot=(0,f.Z)(function*(at,ut){at&&(yield at(ut))});return function(ut,an){return ot.apply(this,arguments)}}(),$t=(ot,at)=>{const ut=at.progressCallback,an=new Promise(zn=>{ot.onFinish(wi=>zn(1===wi))});return ut?(ot.progressStart(!0),ut(ot)):ot.play(),an},rt=(ot,at)=>{bt(at,Fe),bt(ot,"ionViewWillEnter")},st=(ot,at)=>{bt(ot,"ionViewDidEnter"),bt(at,Be)},bt=(ot,at)=>{if(ot){const ut=new CustomEvent(at,{bubbles:!1,cancelable:!1});ot.dispatchEvent(ut)}},He=()=>new Promise(ot=>(0,Ye.r)(()=>(0,Ye.r)(()=>ot()))),pe=function(){var ot=(0,f.Z)(function*(at){const ut=at;if(ut){if(null!=ut.componentOnReady){if(null!=(yield ut.componentOnReady()))return}else if(null!=ut.__registerHost)return void(yield new Promise(zn=>(0,Ye.r)(zn)));yield Promise.all(Array.from(ut.children).map(pe))}});return function(ut){return ot.apply(this,arguments)}}(),ge=(ot,at)=>{at?(ot.setAttribute("aria-hidden","true"),ot.classList.add("ion-page-hidden")):(ot.hidden=!1,ot.removeAttribute("aria-hidden"),ot.classList.remove("ion-page-hidden"))},Ue=(ot,at,ut)=>{void 0!==ot&&(ot.style.zIndex="back"===ut?"99":"101"),void 0!==at&&(at.style.zIndex="100")},Ae=ot=>ot.classList.contains("ion-page")?ot:ot.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||ot},2400:(Kn,zt,te)=>{"use strict";te.d(zt,{a:()=>ie,b:()=>Ye,p:()=>f});const f=(Ie,...ht)=>console.warn(`[Ionic Warning]: ${Ie}`,...ht),ie=(Ie,...ht)=>console.error(`[Ionic Error]: ${Ie}`,...ht),Ye=(Ie,...ht)=>console.error(`<${Ie.tagName.toLowerCase()}> must be used inside ${ht.join(" or ")}.`)},1848:(Kn,zt,te)=>{"use strict";te.d(zt,{d:()=>ie,w:()=>f});const f=typeof window<"u"?window:void 0,ie=typeof document<"u"?document:void 0},771:(Kn,zt,te)=>{"use strict";te.d(zt,{B:()=>ft,H:()=>wi,a:()=>Mo,b:()=>eo,c:()=>En,d:()=>Si,e:()=>Gt,f:()=>oi,g:()=>vn,h:()=>an,i:()=>qe,j:()=>lt,r:()=>hs,w:()=>yn});var f=te(5861);let Ie,ht,Fe,Be=!1,Tt=!1,Pt=!1,yt=!1,Oe=!1;const ft={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},lt=B=>{const Y=new URL(B,li.$resourcesUrl$);return Y.origin!==ts.location.origin?Y.href:Y.pathname},$t="s-id",rt="sty-id",He="slot-fb{display:contents}slot-fb[hidden]{display:none}",pe="http://www.w3.org/1999/xlink",ge={},at=B=>"object"==(B=typeof B)||"function"===B;function ut(B){var Y,fe,Ne;return null!==(Ne=null===(fe=null===(Y=B.head)||void 0===Y?void 0:Y.querySelector('meta[name="csp-nonce"]'))||void 0===fe?void 0:fe.getAttribute("content"))&&void 0!==Ne?Ne:void 0}const an=(B,Y,...fe)=>{let Ne=null,Et=null,Xe=null,Wt=!1,Yt=!1;const cn=[],Zt=Gn=>{for(let On=0;On<Gn.length;On++)Ne=Gn[On],Array.isArray(Ne)?Zt(Ne):null!=Ne&&"boolean"!=typeof Ne&&((Wt="function"!=typeof B&&!at(Ne))&&(Ne=String(Ne)),Wt&&Yt?cn[cn.length-1].$text$+=Ne:cn.push(Wt?zn(null,Ne):Ne),Yt=Wt)};if(Zt(fe),Y){Y.key&&(Et=Y.key),Y.name&&(Xe=Y.name);{const Gn=Y.className||Y.class;Gn&&(Y.class="object"!=typeof Gn?Gn:Object.keys(Gn).filter(On=>Gn[On]).join(" "))}}if("function"==typeof B)return B(null===Y?{}:Y,cn,Le);const Cn=zn(B,null);return Cn.$attrs$=Y,cn.length>0&&(Cn.$children$=cn),Cn.$key$=Et,Cn.$name$=Xe,Cn},zn=(B,Y)=>({$flags$:0,$tag$:B,$text$:Y,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),wi={},Le={forEach:(B,Y)=>B.map(ve).forEach(Y),map:(B,Y)=>B.map(ve).map(Y).map(De)},ve=B=>({vattrs:B.$attrs$,vchildren:B.$children$,vkey:B.$key$,vname:B.$name$,vtag:B.$tag$,vtext:B.$text$}),De=B=>{if("function"==typeof B.vtag){const fe=Object.assign({},B.vattrs);return B.vkey&&(fe.key=B.vkey),B.vname&&(fe.name=B.vname),an(B.vtag,fe,...B.vchildren||[])}const Y=zn(B.vtag,B.vtext);return Y.$attrs$=B.vattrs,Y.$children$=B.vchildren,Y.$key$=B.vkey,Y.$name$=B.vname,Y},Mt=(B,Y,fe,Ne,Et,Xe,Wt)=>{let Yt,cn,Zt,Cn;if(1===Xe.nodeType){for(Yt=Xe.getAttribute("c-id"),Yt&&(cn=Yt.split("."),(cn[0]===Wt||"0"===cn[0])&&(Zt={$flags$:0,$hostId$:cn[0],$nodeId$:cn[1],$depth$:cn[2],$index$:cn[3],$tag$:Xe.tagName.toLowerCase(),$elm$:Xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},Y.push(Zt),Xe.removeAttribute("c-id"),B.$children$||(B.$children$=[]),B.$children$[Zt.$index$]=Zt,B=Zt,Ne&&"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$))),Cn=Xe.childNodes.length-1;Cn>=0;Cn--)Mt(B,Y,fe,Ne,Et,Xe.childNodes[Cn],Wt);if(Xe.shadowRoot)for(Cn=Xe.shadowRoot.childNodes.length-1;Cn>=0;Cn--)Mt(B,Y,fe,Ne,Et,Xe.shadowRoot.childNodes[Cn],Wt)}else if(8===Xe.nodeType)cn=Xe.nodeValue.split("."),(cn[1]===Wt||"0"===cn[1])&&(Yt=cn[0],Zt={$flags$:0,$hostId$:cn[1],$nodeId$:cn[2],$depth$:cn[3],$index$:cn[4],$elm$:Xe,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Yt?(Zt.$elm$=Xe.nextSibling,Zt.$elm$&&3===Zt.$elm$.nodeType&&(Zt.$text$=Zt.$elm$.textContent,Y.push(Zt),Xe.remove(),B.$children$||(B.$children$=[]),B.$children$[Zt.$index$]=Zt,Ne&&"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$))):Zt.$hostId$===Wt&&("s"===Yt?(Zt.$tag$="slot",Xe["s-sn"]=cn[5]?Zt.$name$=cn[5]:"",Xe["s-sr"]=!0,Ne&&(Zt.$elm$=ir.createElement(Zt.$tag$),Zt.$name$&&Zt.$elm$.setAttribute("name",Zt.$name$),Xe.parentNode.insertBefore(Zt.$elm$,Xe),Xe.remove(),"0"===Zt.$depth$&&(Ne[Zt.$index$]=Zt.$elm$)),fe.push(Zt),B.$children$||(B.$children$=[]),B.$children$[Zt.$index$]=Zt):"r"===Yt&&(Ne?Xe.remove():(Et["s-cr"]=Xe,Xe["s-cn"]=!0))));else if(B&&"style"===B.$tag$){const Gn=zn(null,Xe.textContent);Gn.$elm$=Xe,Gn.$index$="0",B.$children$=[Gn]}},ct=(B,Y)=>{if(1===B.nodeType){let fe=0;for(;fe<B.childNodes.length;fe++)ct(B.childNodes[fe],Y);if(B.shadowRoot)for(fe=0;fe<B.shadowRoot.childNodes.length;fe++)ct(B.shadowRoot.childNodes[fe],Y)}else if(8===B.nodeType){const fe=B.nodeValue.split(".");"o"===fe[0]&&(Y.set(fe[1]+"."+fe[2],B),B.nodeValue="",B["s-en"]=fe[3])}},En=B=>Ti.push(B),vn=B=>er(B).$modeName$,oi=B=>er(B).$hostElement$,Si=(B,Y,fe)=>{const Ne=oi(B);return{emit:Et=>Xt(Ne,Y,{bubbles:!!(4&fe),composed:!!(2&fe),cancelable:!!(1&fe),detail:Et})}},Xt=(B,Y,fe)=>{const Ne=li.ce(Y,fe);return B.dispatchEvent(Ne),Ne},Nt=new WeakMap,Dt=(B,Y,fe)=>{let Ne=Rr.get(B);Rs&&fe?(Ne=Ne||new CSSStyleSheet,"string"==typeof Ne?Ne=Y:Ne.replaceSync(Y)):Ne=Y,Rr.set(B,Ne)},nn=(B,Y,fe)=>{var Ne;const Et=Qn(Y,fe),Xe=Rr.get(Et);if(B=11===B.nodeType?B:ir,Xe)if("string"==typeof Xe){let Yt,Wt=Nt.get(B=B.head||B);if(Wt||Nt.set(B,Wt=new Set),!Wt.has(Et)){if(B.host&&(Yt=B.querySelector(`[${rt}="${Et}"]`)))Yt.innerHTML=Xe;else{Yt=ir.createElement("style"),Yt.innerHTML=Xe;const cn=null!==(Ne=li.$nonce$)&&void 0!==Ne?Ne:ut(ir);null!=cn&&Yt.setAttribute("nonce",cn),B.insertBefore(Yt,B.querySelector("link"))}4&Y.$flags$&&(Yt.innerHTML+=He),Wt&&Wt.add(Et)}}else B.adoptedStyleSheets.includes(Xe)||(B.adoptedStyleSheets=[...B.adoptedStyleSheets,Xe]);return Et},Qn=(B,Y)=>"sc-"+(Y&&32&B.$flags$?B.$tagName$+"-"+Y:B.$tagName$),ai=B=>B.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),$n=(B,Y,fe,Ne,Et,Xe)=>{if(fe!==Ne){let Wt=As(B,Y),Yt=Y.toLowerCase();if("class"===Y){const cn=B.classList,Zt=Ci(fe),Cn=Ci(Ne);cn.remove(...Zt.filter(Gn=>Gn&&!Cn.includes(Gn))),cn.add(...Cn.filter(Gn=>Gn&&!Zt.includes(Gn)))}else if("style"===Y){for(const cn in fe)(!Ne||null==Ne[cn])&&(cn.includes("-")?B.style.removeProperty(cn):B.style[cn]="");for(const cn in Ne)(!fe||Ne[cn]!==fe[cn])&&(cn.includes("-")?B.style.setProperty(cn,Ne[cn]):B.style[cn]=Ne[cn])}else if("key"!==Y)if("ref"===Y)Ne&&Ne(B);else if(Wt||"o"!==Y[0]||"n"!==Y[1]){const cn=at(Ne);if((Wt||cn&&null!==Ne)&&!Et)try{if(B.tagName.includes("-"))B[Y]=Ne;else{const Cn=null==Ne?"":Ne;"list"===Y?Wt=!1:(null==fe||B[Y]!=Cn)&&(B[Y]=Cn)}}catch{}let Zt=!1;Yt!==(Yt=Yt.replace(/^xlink\:?/,""))&&(Y=Yt,Zt=!0),null==Ne||!1===Ne?(!1!==Ne||""===B.getAttribute(Y))&&(Zt?B.removeAttributeNS(pe,Y):B.removeAttribute(Y)):(!Wt||4&Xe||Et)&&!cn&&(Ne=!0===Ne?"":Ne,Zt?B.setAttributeNS(pe,Y,Ne):B.setAttribute(Y,Ne))}else if(Y="-"===Y[2]?Y.slice(3):As(ts,Yt)?Yt.slice(2):Yt[2]+Y.slice(3),fe||Ne){const cn=Y.endsWith(or);Y=Y.replace(Rn,""),fe&&li.rel(B,Y,fe,cn),Ne&&li.ael(B,Y,Ne,cn)}}},ki=/\s/,Ci=B=>B?B.split(ki):[],or="Capture",Rn=new RegExp(or+"$"),mi=(B,Y,fe,Ne)=>{const Et=11===Y.$elm$.nodeType&&Y.$elm$.host?Y.$elm$.host:Y.$elm$,Xe=B&&B.$attrs$||ge,Wt=Y.$attrs$||ge;for(Ne in Xe)Ne in Wt||$n(Et,Ne,Xe[Ne],void 0,fe,Y.$flags$);for(Ne in Wt)$n(Et,Ne,Xe[Ne],Wt[Ne],fe,Y.$flags$)},di=(B,Y,fe,Ne)=>{var Et;const Xe=Y.$children$[fe];let Yt,cn,Zt,Wt=0;if(Be||(Pt=!0,"slot"===Xe.$tag$&&(Ie&&Ne.classList.add(Ie+"-s"),Xe.$flags$|=Xe.$children$?2:1)),null!==Xe.$text$)Yt=Xe.$elm$=ir.createTextNode(Xe.$text$);else if(1&Xe.$flags$)Yt=Xe.$elm$=ir.createTextNode("");else{if(yt||(yt="svg"===Xe.$tag$),Yt=Xe.$elm$=ir.createElementNS(yt?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Xe.$flags$?"slot-fb":Xe.$tag$),yt&&"foreignObject"===Xe.$tag$&&(yt=!1),mi(null,Xe,yt),(B=>null!=B)(Ie)&&Yt["s-si"]!==Ie&&Yt.classList.add(Yt["s-si"]=Ie),Xe.$children$)for(Wt=0;Wt<Xe.$children$.length;++Wt)cn=di(B,Xe,Wt,Yt),cn&&Yt.appendChild(cn);"svg"===Xe.$tag$?yt=!1:"foreignObject"===Yt.tagName&&(yt=!0)}return Yt["s-hn"]=Fe,3&Xe.$flags$&&(Yt["s-sr"]=!0,Yt["s-fs"]=null===(Et=Xe.$attrs$)||void 0===Et?void 0:Et.slot,Yt["s-cr"]=ht,Yt["s-sn"]=Xe.$name$||"",Zt=B&&B.$children$&&B.$children$[fe],Zt&&Zt.$tag$===Xe.$tag$&&B.$elm$&&Mr(B.$elm$,!1)),Yt},Mr=(B,Y)=>{var fe;li.$flags$|=1;const Ne=B.childNodes;for(let Et=Ne.length-1;Et>=0;Et--){const Xe=Ne[Et];Xe["s-hn"]!==Fe&&Xe["s-ol"]&&(xi(Xe).insertBefore(Xe,es(Xe)),Xe["s-ol"].remove(),Xe["s-ol"]=void 0,Xe["s-sh"]=void 0,1===Xe.nodeType&&Xe.setAttribute("slot",null!==(fe=Xe["s-sn"])&&void 0!==fe?fe:""),Pt=!0),Y&&Mr(Xe,Y)}li.$flags$&=-2},Or=(B,Y,fe,Ne,Et,Xe)=>{let Yt,Wt=B["s-cr"]&&B["s-cr"].parentNode||B;for(Wt.shadowRoot&&Wt.tagName===Fe&&(Wt=Wt.shadowRoot);Et<=Xe;++Et)Ne[Et]&&(Yt=di(null,fe,Et,B),Yt&&(Ne[Et].$elm$=Yt,Wt.insertBefore(Yt,es(Y))))},gn=(B,Y,fe)=>{for(let Ne=Y;Ne<=fe;++Ne){const Et=B[Ne];if(Et){const Xe=Et.$elm$;Ei(Et),Xe&&(Tt=!0,Xe["s-ol"]?Xe["s-ol"].remove():Mr(Xe,!0),Xe.remove())}}},ur=(B,Y)=>B.$tag$===Y.$tag$&&("slot"===B.$tag$?B.$name$===Y.$name$:B.$key$===Y.$key$),es=B=>B&&B["s-ol"]||B,xi=B=>(B["s-ol"]?B["s-ol"]:B).parentNode,qr=(B,Y)=>{const fe=Y.$elm$=B.$elm$,Ne=B.$children$,Et=Y.$children$,Xe=Y.$tag$,Wt=Y.$text$;let Yt;null===Wt?(yt="svg"===Xe||"foreignObject"!==Xe&&yt,"slot"===Xe||mi(B,Y,yt),null!==Ne&&null!==Et?((B,Y,fe,Ne)=>{let dr,T,Et=0,Xe=0,Wt=0,Yt=0,cn=Y.length-1,Zt=Y[0],Cn=Y[cn],Gn=Ne.length-1,On=Ne[0],$i=Ne[Gn];for(;Et<=cn&&Xe<=Gn;)if(null==Zt)Zt=Y[++Et];else if(null==Cn)Cn=Y[--cn];else if(null==On)On=Ne[++Xe];else if(null==$i)$i=Ne[--Gn];else if(ur(Zt,On))qr(Zt,On),Zt=Y[++Et],On=Ne[++Xe];else if(ur(Cn,$i))qr(Cn,$i),Cn=Y[--cn],$i=Ne[--Gn];else if(ur(Zt,$i))("slot"===Zt.$tag$||"slot"===$i.$tag$)&&Mr(Zt.$elm$.parentNode,!1),qr(Zt,$i),B.insertBefore(Zt.$elm$,Cn.$elm$.nextSibling),Zt=Y[++Et],$i=Ne[--Gn];else if(ur(Cn,On))("slot"===Zt.$tag$||"slot"===$i.$tag$)&&Mr(Cn.$elm$.parentNode,!1),qr(Cn,On),B.insertBefore(Cn.$elm$,Zt.$elm$),Cn=Y[--cn],On=Ne[++Xe];else{for(Wt=-1,Yt=Et;Yt<=cn;++Yt)if(Y[Yt]&&null!==Y[Yt].$key$&&Y[Yt].$key$===On.$key$){Wt=Yt;break}Wt>=0?(T=Y[Wt],T.$tag$!==On.$tag$?dr=di(Y&&Y[Xe],fe,Wt,B):(qr(T,On),Y[Wt]=void 0,dr=T.$elm$),On=Ne[++Xe]):(dr=di(Y&&Y[Xe],fe,Xe,B),On=Ne[++Xe]),dr&&xi(Zt.$elm$).insertBefore(dr,es(Zt.$elm$))}Et>cn?Or(B,null==Ne[Gn+1]?null:Ne[Gn+1].$elm$,fe,Ne,Xe,Gn):Xe>Gn&&gn(Y,Et,cn)})(fe,Ne,Y,Et):null!==Et?(null!==B.$text$&&(fe.textContent=""),Or(fe,null,Y,Et,0,Et.length-1)):null!==Ne&&gn(Ne,0,Ne.length-1),yt&&"svg"===Xe&&(yt=!1)):(Yt=fe["s-cr"])?Yt.parentNode.textContent=Wt:B.$text$!==Wt&&(fe.data=Wt)},Jn=B=>{const Y=B.childNodes;for(const fe of Y)if(1===fe.nodeType){if(fe["s-sr"]){const Ne=fe["s-sn"];fe.hidden=!1;for(const Et of Y)if(Et!==fe)if(Et["s-hn"]!==fe["s-hn"]||""!==Ne){if(1===Et.nodeType&&(Ne===Et.getAttribute("slot")||Ne===Et["s-sn"])){fe.hidden=!0;break}}else if(1===Et.nodeType||3===Et.nodeType&&""!==Et.textContent.trim()){fe.hidden=!0;break}}Jn(fe)}},Cr=[],us=B=>{let Y,fe,Ne;for(const Et of B.childNodes){if(Et["s-sr"]&&(Y=Et["s-cr"])&&Y.parentNode){fe=Y.parentNode.childNodes;const Xe=Et["s-sn"];for(Ne=fe.length-1;Ne>=0;Ne--)if(Y=fe[Ne],!Y["s-cn"]&&!Y["s-nr"]&&Y["s-hn"]!==Et["s-hn"])if(Mn(Y,Xe)){let Wt=Cr.find(Yt=>Yt.$nodeToRelocate$===Y);Tt=!0,Y["s-sn"]=Y["s-sn"]||Xe,Wt?(Wt.$nodeToRelocate$["s-sh"]=Et["s-hn"],Wt.$slotRefNode$=Et):(Y["s-sh"]=Et["s-hn"],Cr.push({$slotRefNode$:Et,$nodeToRelocate$:Y})),Y["s-sr"]&&Cr.map(Yt=>{Mn(Yt.$nodeToRelocate$,Y["s-sn"])&&(Wt=Cr.find(cn=>cn.$nodeToRelocate$===Y),Wt&&!Yt.$slotRefNode$&&(Yt.$slotRefNode$=Wt.$slotRefNode$))})}else Cr.some(Wt=>Wt.$nodeToRelocate$===Y)||Cr.push({$nodeToRelocate$:Y})}1===Et.nodeType&&us(Et)}},Mn=(B,Y)=>1===B.nodeType?null===B.getAttribute("slot")&&""===Y||B.getAttribute("slot")===Y:B["s-sn"]===Y||""===Y,Ei=B=>{B.$attrs$&&B.$attrs$.ref&&B.$attrs$.ref(null),B.$children$&&B.$children$.map(Ei)},ds=(B,Y)=>{Y&&!B.$onRenderResolve$&&Y["s-p"]&&Y["s-p"].push(new Promise(fe=>B.$onRenderResolve$=fe))},Qs=(B,Y)=>{if(B.$flags$|=16,!(4&B.$flags$))return ds(B,B.$ancestorComponent$),yn(()=>Ur(B,Y));B.$flags$|=512},Ur=(B,Y)=>{const Ne=B.$lazyInstance$;let Et;return Y&&(B.$flags$|=256,B.$queuedListeners$&&(B.$queuedListeners$.map(([Xe,Wt])=>ke(Ne,Xe,Wt)),B.$queuedListeners$=void 0),Et=ke(Ne,"componentWillLoad")),Et=Xr(Et,()=>ke(Ne,"componentWillRender")),Xr(Et,()=>mr(B,Ne,Y))},Xr=(B,Y)=>Lr(B)?B.then(Y):Y(),Lr=B=>B instanceof Promise||B&&B.then&&"function"==typeof B.then,mr=function(){var B=(0,f.Z)(function*(Y,fe,Ne){var Et;const Xe=Y.$hostElement$,Yt=Xe["s-rc"];Ne&&(B=>{const Y=B.$cmpMeta$,fe=B.$hostElement$,Ne=Y.$flags$,Xe=nn(fe.shadowRoot?fe.shadowRoot:fe.getRootNode(),Y,B.$modeName$);10&Ne&&(fe["s-sc"]=Xe,fe.classList.add(Xe+"-h"),2&Ne&&fe.classList.add(Xe+"-s"))})(Y);ys(Y,fe,Xe,Ne),Yt&&(Yt.map(Zt=>Zt()),Xe["s-rc"]=void 0);{const Zt=null!==(Et=Xe["s-p"])&&void 0!==Et?Et:[],Cn=()=>Bt(Y);0===Zt.length?Cn():(Promise.all(Zt).then(Cn),Y.$flags$|=4,Zt.length=0)}});return function(fe,Ne,Et){return B.apply(this,arguments)}}(),ys=(B,Y,fe,Ne)=>{try{Y=Y.render&&Y.render(),B.$flags$&=-17,B.$flags$|=2,((B,Y,fe=!1)=>{var Ne,Et,Xe,Wt;const Yt=B.$hostElement$,cn=B.$cmpMeta$,Zt=B.$vnode$||zn(null,null),Cn=(B=>B&&B.$tag$===wi)(Y)?Y:an(null,null,Y);if(Fe=Yt.tagName,cn.$attrsToReflect$&&(Cn.$attrs$=Cn.$attrs$||{},cn.$attrsToReflect$.map(([Gn,On])=>Cn.$attrs$[On]=Yt[Gn])),fe&&Cn.$attrs$)for(const Gn of Object.keys(Cn.$attrs$))Yt.hasAttribute(Gn)&&!["key","ref","style","class"].includes(Gn)&&(Cn.$attrs$[Gn]=Yt[Gn]);if(Cn.$tag$=null,Cn.$flags$|=4,B.$vnode$=Cn,Cn.$elm$=Zt.$elm$=Yt.shadowRoot||Yt,Ie=Yt["s-sc"],ht=Yt["s-cr"],Be=0!=(1&cn.$flags$),Tt=!1,qr(Zt,Cn),li.$flags$|=1,Pt){us(Cn.$elm$);for(const Gn of Cr){const On=Gn.$nodeToRelocate$;if(!On["s-ol"]){const $i=ir.createTextNode("");$i["s-nr"]=On,On.parentNode.insertBefore(On["s-ol"]=$i,On)}}for(const Gn of Cr){const On=Gn.$nodeToRelocate$,$i=Gn.$slotRefNode$;if($i){const dr=$i.parentNode;let T=$i.nextSibling;{let ee=null===(Ne=On["s-ol"])||void 0===Ne?void 0:Ne.previousSibling;for(;ee;){let F=null!==(Et=ee["s-nr"])&&void 0!==Et?Et:null;if(F&&F["s-sn"]===On["s-sn"]&&dr===F.parentNode&&(F=F.nextSibling,!F||!F["s-nr"])){T=F;break}ee=ee.previousSibling}}(!T&&dr!==On.parentNode||On.nextSibling!==T)&&On!==T&&(!On["s-hn"]&&On["s-ol"]&&(On["s-hn"]=On["s-ol"].parentNode.nodeName),dr.insertBefore(On,T),1===On.nodeType&&(On.hidden=null!==(Xe=On["s-ih"])&&void 0!==Xe&&Xe))}else 1===On.nodeType&&(fe&&(On["s-ih"]=null!==(Wt=On.hidden)&&void 0!==Wt&&Wt),On.hidden=!0)}}Tt&&Jn(Cn.$elm$),li.$flags$&=-2,Cr.length=0})(B,Y,Ne)}catch(Et){Sr(Et,B.$hostElement$)}return null},Bt=B=>{const fe=B.$hostElement$,Et=B.$lazyInstance$,Xe=B.$ancestorComponent$;ke(Et,"componentDidRender"),64&B.$flags$?ke(Et,"componentDidUpdate"):(B.$flags$|=64,mt(fe),ke(Et,"componentDidLoad"),B.$onReadyResolve$(fe),Xe||_t()),B.$onInstanceResolve$(fe),B.$onRenderResolve$&&(B.$onRenderResolve$(),B.$onRenderResolve$=void 0),512&B.$flags$&&Qe(()=>Qs(B,!1)),B.$flags$&=-517},qe=B=>{{const Y=er(B),fe=Y.$hostElement$.isConnected;return fe&&2==(18&Y.$flags$)&&Qs(Y,!1),fe}},_t=B=>{mt(ir.documentElement),Qe(()=>Xt(ts,"appload",{detail:{namespace:"ionic"}}))},ke=(B,Y,fe)=>{if(B&&B[Y])try{return B[Y](fe)}catch(Ne){Sr(Ne)}},mt=B=>B.classList.add("hydrated"),ti=(B,Y,fe)=>{var Ne;const Et=B.prototype;if(Y.$members$){B.watchers&&(Y.$watchers$=B.watchers);const Xe=Object.entries(Y.$members$);if(Xe.map(([Wt,[Yt]])=>{31&Yt||2&fe&&32&Yt?Object.defineProperty(Et,Wt,{get(){return((B,Y)=>er(this).$instanceValues$.get(Y))(0,Wt)},set(cn){((B,Y,fe,Ne)=>{const Et=er(B),Xe=Et.$hostElement$,Wt=Et.$instanceValues$.get(Y),Yt=Et.$flags$,cn=Et.$lazyInstance$;fe=((B,Y)=>null==B||at(B)?B:4&Y?"false"!==B&&(""===B||!!B):2&Y?parseFloat(B):1&Y?String(B):B)(fe,Ne.$members$[Y][0]);const Zt=Number.isNaN(Wt)&&Number.isNaN(fe);if((!(8&Yt)||void 0===Wt)&&fe!==Wt&&!Zt&&(Et.$instanceValues$.set(Y,fe),cn)){if(Ne.$watchers$&&128&Yt){const Gn=Ne.$watchers$[Y];Gn&&Gn.map(On=>{try{cn[On](fe,Wt,Y)}catch($i){Sr($i,Xe)}})}2==(18&Yt)&&Qs(Et,!1)}})(this,Wt,cn,Y)},configurable:!0,enumerable:!0}):1&fe&&64&Yt&&Object.defineProperty(Et,Wt,{value(...cn){var Zt;const Cn=er(this);return null===(Zt=null==Cn?void 0:Cn.$onInstancePromise$)||void 0===Zt?void 0:Zt.then(()=>{var Gn;return null===(Gn=Cn.$lazyInstance$)||void 0===Gn?void 0:Gn[Wt](...cn)})}})}),1&fe){const Wt=new Map;Et.attributeChangedCallback=function(Yt,cn,Zt){li.jmp(()=>{var Cn;const Gn=Wt.get(Yt);if(this.hasOwnProperty(Gn))Zt=this[Gn],delete this[Gn];else{if(Et.hasOwnProperty(Gn)&&"number"==typeof this[Gn]&&this[Gn]==Zt)return;if(null==Gn){const On=er(this),$i=null==On?void 0:On.$flags$;if($i&&!(8&$i)&&128&$i&&Zt!==cn){const dr=On.$lazyInstance$,T=null===(Cn=Y.$watchers$)||void 0===Cn?void 0:Cn[Yt];null==T||T.forEach(ee=>{null!=dr[ee]&&dr[ee].call(dr,Zt,cn,Yt)})}return}}this[Gn]=(null!==Zt||"boolean"!=typeof this[Gn])&&Zt})},B.observedAttributes=Array.from(new Set([...Object.keys(null!==(Ne=Y.$watchers$)&&void 0!==Ne?Ne:{}),...Xe.filter(([Yt,cn])=>15&cn[0]).map(([Yt,cn])=>{var Zt;const Cn=cn[1]||Yt;return Wt.set(Cn,Yt),512&cn[0]&&(null===(Zt=Y.$attrsToReflect$)||void 0===Zt||Zt.push([Yt,Cn])),Cn})]))}}return B},Ii=function(){var B=(0,f.Z)(function*(Y,fe,Ne,Et){let Xe;if(!(32&fe.$flags$)){fe.$flags$|=32;{if(Xe=Ts(Ne),Xe.then){const Zt=()=>{};Xe=yield Xe,Zt()}Xe.isProxied||(Ne.$watchers$=Xe.watchers,ti(Xe,Ne,2),Xe.isProxied=!0);const cn=()=>{};fe.$flags$|=8;try{new Xe(fe)}catch(Zt){Sr(Zt)}fe.$flags$&=-9,fe.$flags$|=128,cn(),Ui(fe.$lazyInstance$)}if(Xe.style){let cn=Xe.style;"string"!=typeof cn&&(cn=cn[fe.$modeName$=(B=>Ti.map(Y=>Y(B)).find(Y=>!!Y))(Y)]);const Zt=Qn(Ne,fe.$modeName$);if(!Rr.has(Zt)){const Cn=()=>{};Dt(Zt,cn,!!(1&Ne.$flags$)),Cn()}}}const Wt=fe.$ancestorComponent$,Yt=()=>Qs(fe,!0);Wt&&Wt["s-rc"]?Wt["s-rc"].push(Yt):Yt()});return function(fe,Ne,Et,Xe){return B.apply(this,arguments)}}(),Ui=B=>{ke(B,"connectedCallback")},ar=B=>{const Y=B["s-cr"]=ir.createComment("");Y["s-cn"]=!0,B.insertBefore(Y,B.firstChild)},Yn=B=>{ke(B,"disconnectedCallback")},Hs=function(){var B=(0,f.Z)(function*(Y){if(!(1&li.$flags$)){const fe=er(Y);fe.$rmListeners$&&(fe.$rmListeners$.map(Ne=>Ne()),fe.$rmListeners$=void 0),null!=fe&&fe.$lazyInstance$?Yn(fe.$lazyInstance$):null!=fe&&fe.$onReadyPromise$&&fe.$onReadyPromise$.then(()=>Yn(fe.$lazyInstance$))}});return function(fe){return B.apply(this,arguments)}}(),eo=(B,Y={})=>{var fe;const Et=[],Xe=Y.exclude||[],Wt=ts.customElements,Yt=ir.head,cn=Yt.querySelector("meta[charset]"),Zt=ir.createElement("style"),Cn=[],Gn=ir.querySelectorAll(`[${rt}]`);let On,$i=!0,dr=0;for(Object.assign(li,Y),li.$resourcesUrl$=new URL(Y.resourcesUrl||"./",ir.baseURI).href,li.$flags$|=2;dr<Gn.length;dr++)Dt(Gn[dr].getAttribute(rt),ai(Gn[dr].innerHTML),!0);let T=!1;if(B.map(ee=>{ee[1].map(F=>{var re;const Ze={$flags$:F[0],$tagName$:F[1],$members$:F[2],$listeners$:F[3]};4&Ze.$flags$&&(T=!0),Ze.$members$=F[2],Ze.$listeners$=F[3],Ze.$attrsToReflect$=[],Ze.$watchers$=null!==(re=F[4])&&void 0!==re?re:{};const gi=Ze.$tagName$,Pr=class extends HTMLElement{constructor(ns){super(ns),po(ns=this,Ze),1&Ze.$flags$&&ns.attachShadow({mode:"open",delegatesFocus:!!(16&Ze.$flags$)})}connectedCallback(){On&&(clearTimeout(On),On=null),$i?Cn.push(this):li.jmp(()=>(B=>{if(!(1&li.$flags$)){const Y=er(B),fe=Y.$cmpMeta$,Ne=()=>{};if(1&Y.$flags$)$s(B,Y,fe.$listeners$),null!=Y&&Y.$lazyInstance$?Ui(Y.$lazyInstance$):null!=Y&&Y.$onReadyPromise$&&Y.$onReadyPromise$.then(()=>Ui(Y.$lazyInstance$));else{let Et;if(Y.$flags$|=1,Et=B.getAttribute($t),Et){if(1&fe.$flags$){const Xe=nn(B.shadowRoot,fe,B.getAttribute("s-mode"));B.classList.remove(Xe+"-h",Xe+"-s")}((B,Y,fe,Ne)=>{const Xe=B.shadowRoot,Wt=[],cn=Xe?[]:null,Zt=Ne.$vnode$=zn(Y,null);li.$orgLocNodes$||ct(ir.body,li.$orgLocNodes$=new Map),B[$t]=fe,B.removeAttribute($t),Mt(Zt,Wt,[],cn,B,B,fe),Wt.map(Cn=>{const Gn=Cn.$hostId$+"."+Cn.$nodeId$,On=li.$orgLocNodes$.get(Gn),$i=Cn.$elm$;On&&bs&&""===On["s-en"]&&On.parentNode.insertBefore($i,On.nextSibling),Xe||($i["s-hn"]=Y,On&&($i["s-ol"]=On,$i["s-ol"]["s-nr"]=$i)),li.$orgLocNodes$.delete(Gn)}),Xe&&cn.map(Cn=>{Cn&&Xe.appendChild(Cn)})})(B,fe.$tagName$,Et,Y)}Et||12&fe.$flags$&&ar(B);{let Xe=B;for(;Xe=Xe.parentNode||Xe.host;)if(1===Xe.nodeType&&Xe.hasAttribute("s-id")&&Xe["s-p"]||Xe["s-p"]){ds(Y,Y.$ancestorComponent$=Xe);break}}fe.$members$&&Object.entries(fe.$members$).map(([Xe,[Wt]])=>{if(31&Wt&&B.hasOwnProperty(Xe)){const Yt=B[Xe];delete B[Xe],B[Xe]=Yt}}),Ii(B,Y,fe)}Ne()}})(this))}disconnectedCallback(){li.jmp(()=>Hs(this))}componentOnReady(){return er(this).$onReadyPromise$}};Ze.$lazyBundleId$=ee[0],!Xe.includes(gi)&&!Wt.get(gi)&&(Et.push(gi),Wt.define(gi,ti(Pr,Ze,1)))})}),T&&(Zt.innerHTML+=He),Zt.innerHTML+=Et+"{visibility:hidden}.hydrated{visibility:inherit}",Zt.innerHTML.length){Zt.setAttribute("data-styles","");const ee=null!==(fe=li.$nonce$)&&void 0!==fe?fe:ut(ir);null!=ee&&Zt.setAttribute("nonce",ee),Yt.insertBefore(Zt,cn?cn.nextSibling:Yt.firstChild)}$i=!1,Cn.length?Cn.map(ee=>ee.connectedCallback()):li.jmp(()=>On=setTimeout(_t,30))},$s=(B,Y,fe,Ne)=>{fe&&fe.map(([Et,Xe,Wt])=>{const Yt=Hi(B,Et),cn=fo(Y,Wt),Zt=Gs(Et);li.ael(Yt,Xe,cn,Zt),(Y.$rmListeners$=Y.$rmListeners$||[]).push(()=>li.rel(Yt,Xe,cn,Zt))})},fo=(B,Y)=>fe=>{try{256&B.$flags$?B.$lazyInstance$[Y](fe):(B.$queuedListeners$=B.$queuedListeners$||[]).push([Y,fe])}catch(Ne){Sr(Ne)}},Hi=(B,Y)=>4&Y?ir:8&Y?ts:16&Y?ir.body:B,Gs=B=>0!=(2&B),Cs=new WeakMap,er=B=>Cs.get(B),hs=(B,Y)=>Cs.set(Y.$lazyInstance$=B,Y),po=(B,Y)=>{const fe={$flags$:0,$hostElement$:B,$cmpMeta$:Y,$instanceValues$:new Map};return fe.$onInstancePromise$=new Promise(Ne=>fe.$onInstanceResolve$=Ne),fe.$onReadyPromise$=new Promise(Ne=>fe.$onReadyResolve$=Ne),B["s-p"]=[],B["s-rc"]=[],$s(B,fe,Y.$listeners$),Cs.set(B,fe)},As=(B,Y)=>Y in B,Sr=(B,Y)=>(0,console.error)(B,Y),fs=new Map,Ts=(B,Y,fe)=>{const Ne=B.$tagName$.replace(/-/g,"_"),Et=B.$lazyBundleId$,Xe=fs.get(Et);return Xe?Xe[Ne]:te(863)(`./${Et}.entry.js`).then(Wt=>(fs.set(Et,Wt),Wt[Ne]),Sr)},Rr=new Map,Ti=[],ts=typeof window<"u"?window:{},ir=ts.document||{head:{}},li={$flags$:0,$resourcesUrl$:"",jmp:B=>B(),raf:B=>requestAnimationFrame(B),ael:(B,Y,fe,Ne)=>B.addEventListener(Y,fe,Ne),rel:(B,Y,fe,Ne)=>B.removeEventListener(Y,fe,Ne),ce:(B,Y)=>new CustomEvent(B,Y)},Mo=B=>{Object.assign(li,B)},bs=!0,Rs=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),to=[],ue=[],be=(B,Y)=>fe=>{B.push(fe),Oe||(Oe=!0,Y&&4&li.$flags$?Qe(me):li.raf(me))},Z=B=>{for(let Y=0;Y<B.length;Y++)try{B[Y](performance.now())}catch(fe){Sr(fe)}B.length=0},me=()=>{Z(to),Z(ue),(Oe=to.length>0)&&li.raf(me)},Qe=B=>Promise.resolve(void 0).then(B),Gt=be(to,!1),yn=be(ue,!0)},2905:(Kn,zt,te)=>{"use strict";te.d(zt,{a:()=>Oe,b:()=>zn,c:()=>Ye,i:()=>wi});var f=te(771);class ie{constructor(){this.m=new Map}reset(Le){this.m=new Map(Object.entries(Le))}get(Le,ve){const De=this.m.get(Le);return void 0!==De?De:ve}getBoolean(Le,ve=!1){const De=this.m.get(Le);return void 0===De?ve:"string"==typeof De?"true"===De:!!De}getNumber(Le,ve){const De=parseFloat(this.m.get(Le));return isNaN(De)?void 0!==ve?ve:NaN:De}set(Le,ve){this.m.set(Le,ve)}}const Ye=new ie,Pt="ionic-persist-config",Oe=(Ot,Le)=>("string"==typeof Ot&&(Le=Ot,Ot=void 0),(Ot=>ft(Ot))(Ot).includes(Le)),ft=(Ot=window)=>{if(typeof Ot>"u")return[];Ot.Ionic=Ot.Ionic||{};let Le=Ot.Ionic.platforms;return null==Le&&(Le=Ot.Ionic.platforms=lt(Ot),Le.forEach(ve=>Ot.document.documentElement.classList.add(`plt-${ve}`))),Le},lt=Ot=>{const Le=Ye.get("platform");return Object.keys(ut).filter(ve=>{const De=null==Le?void 0:Le[ve];return"function"==typeof De?De(Ot):ut[ve](Ot)})},We=Ot=>!!(ot(Ot,/iPad/i)||ot(Ot,/Macintosh/i)&&st(Ot)),Je=Ot=>ot(Ot,/android|sink/i),st=Ot=>at(Ot,"(any-pointer:coarse)"),He=Ot=>pe(Ot)||ge(Ot),pe=Ot=>!!(Ot.cordova||Ot.phonegap||Ot.PhoneGap),ge=Ot=>{const Le=Ot.Capacitor;return!(null==Le||!Le.isNative)},ot=(Ot,Le)=>Le.test(Ot.navigator.userAgent),at=(Ot,Le)=>{var ve;return null===(ve=Ot.matchMedia)||void 0===ve?void 0:ve.call(Ot,Le).matches},ut={ipad:We,iphone:Ot=>ot(Ot,/iPhone/i),ios:Ot=>ot(Ot,/iPhone|iPod/i)||We(Ot),android:Je,phablet:Ot=>{const Le=Ot.innerWidth,ve=Ot.innerHeight,De=Math.min(Le,ve),xe=Math.max(Le,ve);return De>390&&De<520&&xe>620&&xe<800},tablet:Ot=>{const Le=Ot.innerWidth,ve=Ot.innerHeight,De=Math.min(Le,ve),xe=Math.max(Le,ve);return We(Ot)||(Ot=>Je(Ot)&&!ot(Ot,/mobile/i))(Ot)||De>460&&De<820&&xe>780&&xe<1400},cordova:pe,capacitor:ge,electron:Ot=>ot(Ot,/electron/i),pwa:Ot=>{var Le;return!!(null!==(Le=Ot.matchMedia)&&void 0!==Le&&Le.call(Ot,"(display-mode: standalone)").matches||Ot.navigator.standalone)},mobile:st,mobileweb:Ot=>st(Ot)&&!He(Ot),desktop:Ot=>!st(Ot),hybrid:He};let an;const zn=Ot=>Ot&&(0,f.g)(Ot)||an,wi=(Ot={})=>{if(typeof window>"u")return;const Le=window.document,ve=window,De=ve.Ionic=ve.Ionic||{},xe={};Ot._ael&&(xe.ael=Ot._ael),Ot._rel&&(xe.rel=Ot._rel),Ot._ce&&(xe.ce=Ot._ce),(0,f.a)(xe);const Mt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Ot=>{try{const Le=Ot.sessionStorage.getItem(Pt);return null!==Le?JSON.parse(Le):{}}catch{return{}}})(ve)),{persistConfig:!1}),De.config),(Ot=>{const Le={};return Ot.location.search.slice(1).split("&").map(ve=>ve.split("=")).map(([ve,De])=>[decodeURIComponent(ve),decodeURIComponent(De)]).filter(([ve])=>((Ot,Le)=>Ot.substr(0,Le.length)===Le)(ve,"ionic:")).map(([ve,De])=>[ve.slice(6),De]).forEach(([ve,De])=>{Le[ve]=De}),Le})(ve)),Ot);Ye.reset(Mt),Ye.getBoolean("persistConfig")&&((Ot,Le)=>{try{Ot.sessionStorage.setItem(Pt,JSON.stringify(Le))}catch{return}})(ve,Mt),ft(ve),De.config=Ye,De.mode=an=Ye.get("mode",Le.documentElement.getAttribute("mode")||(Oe(ve,"ios")?"ios":"md")),Ye.set("mode",an),Le.documentElement.setAttribute("mode",an),Le.documentElement.classList.add(an),Ye.getBoolean("_testing")&&Ye.set("animated",!1);const ct=En=>{var vn;return null===(vn=En.tagName)||void 0===vn?void 0:vn.startsWith("ION-")},un=En=>["ios","md"].includes(En);(0,f.c)(En=>{for(;En;){const vn=En.mode||En.getAttribute("mode");if(vn){if(un(vn))return vn;ct(En)&&console.warn('Invalid ionic mode: "'+vn+'", expected: "ios" or "md"')}En=En.parentElement}return an})}},3433:(Kn,zt,te)=>{"use strict";te.r(zt),te.d(zt,{iosTransitionAnimation:()=>lt,shadow:()=>Be});var f=te(4913),ie=te(2325);te(1848),te(771);const Fe=We=>document.querySelector(`${We}.ion-cloned-element`),Be=We=>We.shadowRoot||We,Tt=We=>{const Rt="ION-TABS"===We.tagName?We:We.querySelector("ion-tabs"),Ke="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=Rt){const Je=Rt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Je?Je.querySelector(Ke):null}return We.querySelector(Ke)},Pt=(We,Rt)=>{const Ke="ION-TABS"===We.tagName?We:We.querySelector("ion-tabs");let Je=[];if(null!=Ke){const et=Ke.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=et&&(Je=et.querySelectorAll("ion-buttons"))}else Je=We.querySelectorAll("ion-buttons");for(const et of Je){const $t=et.closest("ion-header"),rt=$t&&!$t.classList.contains("header-collapse-condense-inactive"),st=et.querySelector("ion-back-button"),bt=et.classList.contains("buttons-collapse");if(null!==st&&("start"===et.slot||""===et.slot)&&(bt&&rt&&Rt||!bt))return st}return null},Oe=(We,Rt,Ke,Je,et,$t,rt,st,bt)=>{var He,pe;const ge=Rt?`calc(100% - ${et.right+4}px)`:et.left-4+"px",Ue=Rt?"right":"left",Ae=Rt?"left":"right",ot=Rt?"right":"left",at=(null===(He=$t.textContent)||void 0===He?void 0:He.trim())===(null===(pe=st.textContent)||void 0===pe?void 0:pe.trim()),an=(bt.height-tt)/rt.height,zn=at?`scale(${bt.width/rt.width}, ${an})`:`scale(${an})`,wi="scale(1)",Le=Be(Je).querySelector("ion-icon").getBoundingClientRect(),ve=Rt?Le.width/2-(Le.right-et.right)+"px":et.left-Le.width/2+"px",De=Rt?`-${window.innerWidth-et.right}px`:`${et.left}px`,xe=`${bt.top}px`,Mt=`${et.top}px`,En=Ke?[{offset:0,transform:`translate3d(${De}, ${Mt}, 0)`},{offset:1,transform:`translate3d(${ve}, ${xe}, 0)`}]:[{offset:0,transform:`translate3d(${ve}, ${xe}, 0)`},{offset:1,transform:`translate3d(${De}, ${Mt}, 0)`}],oi=Ke?[{offset:0,opacity:1,transform:wi},{offset:1,opacity:0,transform:zn}]:[{offset:0,opacity:0,transform:zn},{offset:1,opacity:1,transform:wi}],Nt=Ke?[{offset:0,opacity:1,transform:"scale(1)"},{offset:.2,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:0,transform:"scale(0.6)"}]:[{offset:0,opacity:0,transform:"scale(0.6)"},{offset:.6,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:1,transform:"scale(1)"}],Dt=(0,f.c)(),nn=(0,f.c)(),kt=(0,f.c)(),Qn=Fe("ion-back-button"),ai=Be(Qn).querySelector(".button-text"),$n=Be(Qn).querySelector("ion-icon");Qn.text=Je.text,Qn.mode=Je.mode,Qn.icon=Je.icon,Qn.color=Je.color,Qn.disabled=Je.disabled,Qn.style.setProperty("display","block"),Qn.style.setProperty("position","fixed"),nn.addElement($n),Dt.addElement(ai),kt.addElement(Qn),kt.beforeStyles({position:"absolute",top:"0px",[ot]:"0px"}).keyframes(En),Dt.beforeStyles({"transform-origin":`${Ue} top`}).beforeAddWrite(()=>{Je.style.setProperty("display","none"),Qn.style.setProperty(Ue,ge)}).afterAddWrite(()=>{Je.style.setProperty("display",""),Qn.style.setProperty("display","none"),Qn.style.removeProperty(Ue)}).keyframes(oi),nn.beforeStyles({"transform-origin":`${Ae} center`}).keyframes(Nt),We.addAnimation([Dt,nn,kt])},ft=(We,Rt,Ke,Je,et,$t,rt,st)=>{var bt,He;const pe=Rt?"right":"left",ge=Rt?`calc(100% - ${et.right}px)`:`${et.left}px`,Ae=`${et.top}px`,at=Rt?`-${window.innerWidth-st.right-8}px`:st.x-8+"px",an=st.y-2+"px",zn=(null===(bt=rt.textContent)||void 0===bt?void 0:bt.trim())===(null===(He=Je.textContent)||void 0===He?void 0:He.trim()),Ot=st.height/($t.height-tt),Le="scale(1)",ve=zn?`scale(${st.width/$t.width}, ${Ot})`:`scale(${Ot})`,Mt=Ke?[{offset:0,opacity:0,transform:`translate3d(${at}, ${an}, 0) ${ve}`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0px, ${Ae}, 0) ${Le}`}]:[{offset:0,opacity:.99,transform:`translate3d(0px, ${Ae}, 0) ${Le}`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${at}, ${an}, 0) ${ve}`}],ct=Fe("ion-title"),un=(0,f.c)();ct.innerText=Je.innerText,ct.size=Je.size,ct.color=Je.color,un.addElement(ct),un.beforeStyles({"transform-origin":`${pe} top`,height:`${et.height}px`,display:"",position:"relative",[pe]:ge}).beforeAddWrite(()=>{Je.style.setProperty("opacity","0")}).afterAddWrite(()=>{Je.style.setProperty("opacity",""),ct.style.setProperty("display","none")}).keyframes(Mt),We.addAnimation(un)},lt=(We,Rt)=>{var Ke;try{const Je="cubic-bezier(0.32,0.72,0,1)",et="opacity",$t="transform",rt="0%",bt="rtl"===We.ownerDocument.dir,He=bt?"-99.5%":"99.5%",pe=bt?"33%":"-33%",ge=Rt.enteringEl,Ue=Rt.leavingEl,Ae="back"===Rt.direction,ot=ge.querySelector(":scope > ion-content"),at=ge.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),ut=ge.querySelectorAll(":scope > ion-header > ion-toolbar"),an=(0,f.c)(),zn=(0,f.c)();if(an.addElement(ge).duration((null!==(Ke=Rt.duration)&&void 0!==Ke?Ke:0)||540).easing(Rt.easing||Je).fill("both").beforeRemoveClass("ion-page-invisible"),Ue&&null!=We){const ve=(0,f.c)();ve.addElement(We),an.addAnimation(ve)}if(ot||0!==ut.length||0!==at.length?(zn.addElement(ot),zn.addElement(at)):zn.addElement(ge.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),an.addAnimation(zn),Ae?zn.beforeClearStyles([et]).fromTo("transform",`translateX(${pe})`,`translateX(${rt})`).fromTo(et,.8,1):zn.beforeClearStyles([et]).fromTo("transform",`translateX(${He})`,`translateX(${rt})`),ot){const ve=Be(ot).querySelector(".transition-effect");if(ve){const De=ve.querySelector(".transition-cover"),xe=ve.querySelector(".transition-shadow"),Mt=(0,f.c)(),ct=(0,f.c)(),un=(0,f.c)();Mt.addElement(ve).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),ct.addElement(De).beforeClearStyles([et]).fromTo(et,0,.1),un.addElement(xe).beforeClearStyles([et]).fromTo(et,.03,.7),Mt.addAnimation([ct,un]),zn.addAnimation([Mt])}}const wi=ge.querySelector("ion-header.header-collapse-condense"),{forward:Ot,backward:Le}=((We,Rt,Ke,Je,et)=>{const $t=Pt(Je,Ke),rt=Tt(et),st=Tt(Je),bt=Pt(et,Ke),He=null!==$t&&null!==rt&&!Ke,pe=null!==st&&null!==bt&&Ke;if(He){const ge=rt.getBoundingClientRect(),Ue=$t.getBoundingClientRect(),Ae=Be($t).querySelector(".button-text"),ot=Ae.getBoundingClientRect(),ut=Be(rt).querySelector(".toolbar-title").getBoundingClientRect();ft(We,Rt,Ke,rt,ge,ut,Ae,ot),Oe(We,Rt,Ke,$t,Ue,Ae,ot,rt,ut)}else if(pe){const ge=st.getBoundingClientRect(),Ue=bt.getBoundingClientRect(),Ae=Be(bt).querySelector(".button-text"),ot=Ae.getBoundingClientRect(),ut=Be(st).querySelector(".toolbar-title").getBoundingClientRect();ft(We,Rt,Ke,st,ge,ut,Ae,ot),Oe(We,Rt,Ke,bt,Ue,Ae,ot,st,ut)}return{forward:He,backward:pe}})(an,bt,Ae,ge,Ue);if(ut.forEach(ve=>{const De=(0,f.c)();De.addElement(ve),an.addAnimation(De);const xe=(0,f.c)();xe.addElement(ve.querySelector("ion-title"));const Mt=(0,f.c)(),ct=Array.from(ve.querySelectorAll("ion-buttons,[menuToggle]")),un=ve.closest("ion-header"),En=null==un?void 0:un.classList.contains("header-collapse-condense-inactive");let vn;vn=ct.filter(Ae?Nt=>{const Dt=Nt.classList.contains("buttons-collapse");return Dt&&!En||!Dt}:Nt=>!Nt.classList.contains("buttons-collapse")),Mt.addElement(vn);const Pn=(0,f.c)();Pn.addElement(ve.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const oi=(0,f.c)();oi.addElement(Be(ve).querySelector(".toolbar-background"));const Si=(0,f.c)(),Xt=ve.querySelector("ion-back-button");if(Xt&&Si.addElement(Xt),De.addAnimation([xe,Mt,Pn,oi,Si]),Mt.fromTo(et,.01,1),Pn.fromTo(et,.01,1),Ae)En||xe.fromTo("transform",`translateX(${pe})`,`translateX(${rt})`).fromTo(et,.01,1),Pn.fromTo("transform",`translateX(${pe})`,`translateX(${rt})`),Si.fromTo(et,.01,1);else if(wi||xe.fromTo("transform",`translateX(${He})`,`translateX(${rt})`).fromTo(et,.01,1),Pn.fromTo("transform",`translateX(${He})`,`translateX(${rt})`),oi.beforeClearStyles([et,"transform"]),(null==un?void 0:un.translucent)?oi.fromTo("transform",bt?"translateX(-100%)":"translateX(100%)","translateX(0px)"):oi.fromTo(et,.01,"var(--opacity)"),Ot||Si.fromTo(et,.01,1),Xt&&!Ot){const Dt=(0,f.c)();Dt.addElement(Be(Xt).querySelector(".button-text")).fromTo("transform",bt?"translateX(-100px)":"translateX(100px)","translateX(0px)"),De.addAnimation(Dt)}}),Ue){const ve=(0,f.c)(),De=Ue.querySelector(":scope > ion-content"),xe=Ue.querySelectorAll(":scope > ion-header > ion-toolbar"),Mt=Ue.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(De||0!==xe.length||0!==Mt.length?(ve.addElement(De),ve.addElement(Mt)):ve.addElement(Ue.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),an.addAnimation(ve),Ae){ve.beforeClearStyles([et]).fromTo("transform",`translateX(${rt})`,bt?"translateX(-100%)":"translateX(100%)");const ct=(0,ie.g)(Ue);an.afterAddWrite(()=>{"normal"===an.getDirection()&&ct.style.setProperty("display","none")})}else ve.fromTo("transform",`translateX(${rt})`,`translateX(${pe})`).fromTo(et,1,.8);if(De){const ct=Be(De).querySelector(".transition-effect");if(ct){const un=ct.querySelector(".transition-cover"),En=ct.querySelector(".transition-shadow"),vn=(0,f.c)(),Pn=(0,f.c)(),oi=(0,f.c)();vn.addElement(ct).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Pn.addElement(un).beforeClearStyles([et]).fromTo(et,.1,0),oi.addElement(En).beforeClearStyles([et]).fromTo(et,.7,.03),vn.addAnimation([Pn,oi]),ve.addAnimation([vn])}}xe.forEach(ct=>{const un=(0,f.c)();un.addElement(ct);const En=(0,f.c)();En.addElement(ct.querySelector("ion-title"));const vn=(0,f.c)(),Pn=ct.querySelectorAll("ion-buttons,[menuToggle]"),oi=ct.closest("ion-header"),Si=null==oi?void 0:oi.classList.contains("header-collapse-condense-inactive"),Xt=Array.from(Pn).filter(ai=>{const $n=ai.classList.contains("buttons-collapse");return $n&&!Si||!$n});vn.addElement(Xt);const Nt=(0,f.c)(),Dt=ct.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");Dt.length>0&&Nt.addElement(Dt);const nn=(0,f.c)();nn.addElement(Be(ct).querySelector(".toolbar-background"));const kt=(0,f.c)(),Qn=ct.querySelector("ion-back-button");if(Qn&&kt.addElement(Qn),un.addAnimation([En,vn,Nt,kt,nn]),an.addAnimation(un),kt.fromTo(et,.99,0),vn.fromTo(et,.99,0),Nt.fromTo(et,.99,0),Ae){if(Si||En.fromTo("transform",`translateX(${rt})`,bt?"translateX(-100%)":"translateX(100%)").fromTo(et,.99,0),Nt.fromTo("transform",`translateX(${rt})`,bt?"translateX(-100%)":"translateX(100%)"),nn.beforeClearStyles([et,"transform"]),(null==oi?void 0:oi.translucent)?nn.fromTo("transform","translateX(0px)",bt?"translateX(-100%)":"translateX(100%)"):nn.fromTo(et,"var(--opacity)",0),Qn&&!Le){const $n=(0,f.c)();$n.addElement(Be(Qn).querySelector(".button-text")).fromTo("transform",`translateX(${rt})`,`translateX(${(bt?-124:124)+"px"})`),un.addAnimation($n)}}else Si||En.fromTo("transform",`translateX(${rt})`,`translateX(${pe})`).fromTo(et,.99,0).afterClearStyles([$t,et]),Nt.fromTo("transform",`translateX(${rt})`,`translateX(${pe})`).afterClearStyles([$t,et]),kt.afterClearStyles([et]),En.afterClearStyles([et]),vn.afterClearStyles([et])})}return an}catch(Je){throw Je}},tt=10},6615:(Kn,zt,te)=>{"use strict";te.r(zt),te.d(zt,{mdTransitionAnimation:()=>ht});var f=te(4913),ie=te(2325);te(1848),te(771);const ht=(Fe,Be)=>{var Tt,Pt,yt;const lt="back"===Be.direction,We=Be.leavingEl,Rt=(0,ie.g)(Be.enteringEl),Ke=Rt.querySelector("ion-toolbar"),Je=(0,f.c)();if(Je.addElement(Rt).fill("both").beforeRemoveClass("ion-page-invisible"),lt?Je.duration((null!==(Tt=Be.duration)&&void 0!==Tt?Tt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):Je.duration((null!==(Pt=Be.duration)&&void 0!==Pt?Pt:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Ke){const et=(0,f.c)();et.addElement(Ke),Je.addAnimation(et)}if(We&&lt){Je.duration((null!==(yt=Be.duration)&&void 0!==yt?yt:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const et=(0,f.c)();et.addElement((0,ie.g)(We)).onFinish($t=>{1===$t&&et.elements.length>0&&et.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),Je.addAnimation(et)}return Je}},9207:(Kn,zt,te)=>{"use strict";te.d(zt,{B:()=>En,G:()=>vn,O:()=>Pn,a:()=>ft,b:()=>lt,c:()=>Ke,d:()=>oi,e:()=>Si,f:()=>zn,g:()=>Ot,h:()=>De,i:()=>Mt,j:()=>et,k:()=>$t,m:()=>We,n:()=>yt,o:()=>bt,q:()=>ut,s:()=>un});var f=te(5861),ie=te(1848),Ye=te(2905),Ie=te(3254),ht=te(4393),Fe=te(512),Be=te(2400);let Tt=0,Pt=0;const yt=new WeakMap,Oe=Xt=>({create:Nt=>rt(Xt,Nt),dismiss:(Nt,Dt,nn)=>Ae(document,Nt,Dt,Xt,nn),getTop:()=>(0,f.Z)(function*(){return ut(document,Xt)})()}),ft=Oe("ion-alert"),lt=Oe("ion-action-sheet"),We=Oe("ion-modal"),Ke=Oe("ion-popover"),et=Xt=>{typeof document<"u"&&Ue(document);const Nt=Tt++;Xt.overlayIndex=Nt},$t=Xt=>(Xt.hasAttribute("id")||(Xt.id="ion-overlay-"+ ++Pt),Xt.id),rt=(Xt,Nt)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(Xt).then(()=>{const Dt=document.createElement(Xt);return Dt.classList.add("overlay-hidden"),Object.assign(Dt,Object.assign(Object.assign({},Nt),{hasController:!0})),Le(document).appendChild(Dt),new Promise(nn=>(0,Fe.c)(Dt,nn))}):Promise.resolve(),st='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',bt=(Xt,Nt)=>{let Dt=Xt.querySelector(st);const nn=null==Dt?void 0:Dt.shadowRoot;nn&&(Dt=nn.querySelector(st)||Dt),Dt?(0,Fe.f)(Dt):Nt.focus()},pe=(Xt,Nt)=>{const Dt=Array.from(Xt.querySelectorAll(st));let nn=Dt.length>0?Dt[Dt.length-1]:null;const kt=null==nn?void 0:nn.shadowRoot;kt&&(nn=kt.querySelector(st)||nn),nn?nn.focus():Nt.focus()},Ue=Xt=>{0===Tt&&(Tt=1,Xt.addEventListener("focus",Nt=>{((Xt,Nt)=>{const Dt=ut(Nt,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),nn=Xt.target;Dt&&nn&&!Dt.classList.contains("ion-disable-focus-trap")&&(Dt.shadowRoot?(()=>{if(Dt.contains(nn))Dt.lastFocus=nn;else{const ai=Dt.lastFocus;bt(Dt,Dt),ai===Nt.activeElement&&pe(Dt,Dt),Dt.lastFocus=Nt.activeElement}})():(()=>{if(Dt===nn)Dt.lastFocus=void 0;else{const ai=(0,Fe.g)(Dt);if(!ai.contains(nn))return;const $n=ai.querySelector(".ion-overlay-wrapper");if(!$n)return;if($n.contains(nn)||nn===ai.querySelector("ion-backdrop"))Dt.lastFocus=nn;else{const ki=Dt.lastFocus;bt($n,Dt),ki===Nt.activeElement&&pe($n,Dt),Dt.lastFocus=Nt.activeElement}}})())})(Nt,Xt)},!0),Xt.addEventListener("ionBackButton",Nt=>{const Dt=ut(Xt);null!=Dt&&Dt.backdropDismiss&&Nt.detail.register(ht.OVERLAY_BACK_BUTTON_PRIORITY,()=>Dt.dismiss(void 0,En))}),Xt.addEventListener("keydown",Nt=>{if("Escape"===Nt.key){const Dt=ut(Xt);null!=Dt&&Dt.backdropDismiss&&Dt.dismiss(void 0,En)}}))},Ae=(Xt,Nt,Dt,nn,kt)=>{const Qn=ut(Xt,nn,kt);return Qn?Qn.dismiss(Nt,Dt):Promise.reject("overlay does not exist")},at=(Xt,Nt)=>((Xt,Nt)=>(void 0===Nt&&(Nt="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(Xt.querySelectorAll(Nt)).filter(Dt=>Dt.overlayIndex>0)))(Xt,Nt).filter(Dt=>!(Xt=>Xt.classList.contains("overlay-hidden"))(Dt)),ut=(Xt,Nt,Dt)=>{const nn=at(Xt,Nt);return void 0===Dt?nn[nn.length-1]:nn.find(kt=>kt.id===Dt)},an=(Xt=!1)=>{const Dt=Le(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");Dt&&(Xt?Dt.setAttribute("aria-hidden","true"):Dt.removeAttribute("aria-hidden"))},zn=function(){var Xt=(0,f.Z)(function*(Nt,Dt,nn,kt,Qn){var ai,$n;if(Nt.presented)return;an(!0),Nt.presented=!0,Nt.willPresent.emit(),null===(ai=Nt.willPresentShorthand)||void 0===ai||ai.emit();const ki=(0,Ye.b)(Nt),Ci=Nt.enterAnimation?Nt.enterAnimation:Ye.c.get(Dt,"ios"===ki?nn:kt);(yield ve(Nt,Ci,Nt.el,Qn))&&(Nt.didPresent.emit(),null===($n=Nt.didPresentShorthand)||void 0===$n||$n.emit()),"ION-TOAST"!==Nt.el.tagName&&wi(Nt.el),Nt.keyboardClose&&(null===document.activeElement||!Nt.el.contains(document.activeElement))&&Nt.el.focus()});return function(Dt,nn,kt,Qn,ai){return Xt.apply(this,arguments)}}(),wi=function(){var Xt=(0,f.Z)(function*(Nt){let Dt=document.activeElement;if(!Dt)return;const nn=null==Dt?void 0:Dt.shadowRoot;nn&&(Dt=nn.querySelector(st)||Dt),yield Nt.onDidDismiss(),Dt.focus()});return function(Dt){return Xt.apply(this,arguments)}}(),Ot=function(){var Xt=(0,f.Z)(function*(Nt,Dt,nn,kt,Qn,ai,$n){var ki,Ci;if(!Nt.presented)return!1;void 0!==ie.d&&1===at(ie.d).length&&an(!1),Nt.presented=!1;try{Nt.el.style.setProperty("pointer-events","none"),Nt.willDismiss.emit({data:Dt,role:nn}),null===(ki=Nt.willDismissShorthand)||void 0===ki||ki.emit({data:Dt,role:nn});const or=(0,Ye.b)(Nt),Rn=Nt.leaveAnimation?Nt.leaveAnimation:Ye.c.get(kt,"ios"===or?Qn:ai);nn!==vn&&(yield ve(Nt,Rn,Nt.el,$n)),Nt.didDismiss.emit({data:Dt,role:nn}),null===(Ci=Nt.didDismissShorthand)||void 0===Ci||Ci.emit({data:Dt,role:nn}),yt.delete(Nt),Nt.el.classList.add("overlay-hidden"),Nt.el.style.removeProperty("pointer-events"),void 0!==Nt.el.lastFocus&&(Nt.el.lastFocus=void 0)}catch(or){console.error(or)}return Nt.el.remove(),!0});return function(Dt,nn,kt,Qn,ai,$n,ki){return Xt.apply(this,arguments)}}(),Le=Xt=>Xt.querySelector("ion-app")||Xt.body,ve=function(){var Xt=(0,f.Z)(function*(Nt,Dt,nn,kt){nn.classList.remove("overlay-hidden");const ai=Dt(Nt.el,kt);(!Nt.animated||!Ye.c.getBoolean("animated",!0))&&ai.duration(0),Nt.keyboardClose&&ai.beforeAddWrite(()=>{const ki=nn.ownerDocument.activeElement;null!=ki&&ki.matches("input,ion-input, ion-textarea")&&ki.blur()});const $n=yt.get(Nt)||[];return yt.set(Nt,[...$n,ai]),yield ai.play(),!0});return function(Dt,nn,kt,Qn){return Xt.apply(this,arguments)}}(),De=(Xt,Nt)=>{let Dt;const nn=new Promise(kt=>Dt=kt);return xe(Xt,Nt,kt=>{Dt(kt.detail)}),nn},xe=(Xt,Nt,Dt)=>{const nn=kt=>{(0,Fe.b)(Xt,Nt,nn),Dt(kt)};(0,Fe.a)(Xt,Nt,nn)},Mt=Xt=>"cancel"===Xt||Xt===En,ct=Xt=>Xt(),un=(Xt,Nt)=>{if("function"==typeof Xt)return Ye.c.get("_zoneGate",ct)(()=>{try{return Xt(Nt)}catch(nn){throw nn}})},En="backdrop",vn="gesture",Pn=39,oi=Xt=>{let Dt,Nt=!1;const nn=(0,Ie.C)(),kt=($n=!1)=>{if(Dt&&!$n)return{delegate:Dt,inline:Nt};const{el:ki,hasController:Ci,delegate:or}=Xt;return Nt=null!==ki.parentNode&&!Ci,Dt=Nt?or||nn:or,{inline:Nt,delegate:Dt}};return{attachViewToDom:function(){var $n=(0,f.Z)(function*(ki){const{delegate:Ci}=kt(!0);if(Ci)return yield Ci.attachViewToDom(Xt.el,ki);const{hasController:or}=Xt;if(or&&void 0!==ki)throw new Error("framework delegate is missing");return null});return function(Ci){return $n.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:$n}=kt();$n&&void 0!==Xt.el&&$n.removeViewFromDom(Xt.el.parentElement,Xt.el)}}},Si=()=>{let Xt;const Nt=()=>{Xt&&(Xt(),Xt=void 0)};return{addClickListener:(nn,kt)=>{Nt();const Qn=void 0!==kt?document.getElementById(kt):null;Qn?Xt=(($n,ki)=>{const Ci=()=>{ki.present()};return $n.addEventListener("click",Ci),()=>{$n.removeEventListener("click",Ci)}})(Qn,nn):(0,Be.p)(`A trigger element with the ID "${kt}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,nn)},removeClickListener:Nt}}},6058:(Kn,zt,te)=>{"use strict";var f=te(6593),ie=te(9212),Ye=te(899),Ie=te(7346),ht=te(1929),Fe=te(5861);const We=1,Rt=2,Ke=3,kt=0,Qn=1,ai=2,$n=0,ki=1,Ci=2,or=3,Rn=4,mi=5,Mr=301,Or=302,ur=306,xi=1001,Jn=1003,pr=1006,Ur=1008,Lr=1009,_t=1014,ke=1015,mt=1016,ti=1020,Ui=1023,Yn=1026,Hs=1027,Pr=3001,tr="srgb",is="srgb-linear",Oi="display-p3",Mu="300 es",Xo=2e3;class vr{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const s=this._listeners[e];if(void 0!==s){const a=s.indexOf(t);-1!==a&&s.splice(a,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const r=this._listeners[e.type];if(void 0!==r){e.target=this;const s=r.slice(0);for(let a=0,c=s.length;a<c;a++)s[a].call(this,e);e.target=null}}}const hn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],rr=Math.PI/180,rs=180/Math.PI;function Ar(){const h=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(hn[255&h]+hn[h>>8&255]+hn[h>>16&255]+hn[h>>24&255]+"-"+hn[255&e]+hn[e>>8&255]+"-"+hn[e>>16&15|64]+hn[e>>24&255]+"-"+hn[63&t|128]+hn[t>>8&255]+"-"+hn[t>>16&255]+hn[t>>24&255]+hn[255&r]+hn[r>>8&255]+hn[r>>16&255]+hn[r>>24&255]).toLowerCase()}function xr(h,e,t){return Math.max(e,Math.min(t,h))}function $(h,e,t){return(1-t)*h+t*e}function go(h){return 0==(h&h-1)&&0!==h}function No(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}function io(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return h/4294967295;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int32Array:return Math.max(h/2147483647,-1);case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}function Ni(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return Math.round(4294967295*h);case Uint16Array:return Math.round(65535*h);case Uint8Array:return Math.round(255*h);case Int32Array:return Math.round(2147483647*h);case Int16Array:return Math.round(32767*h);case Int8Array:return Math.round(127*h);default:throw new Error("Invalid component type.")}}const ko_DEG2RAD=rr;class en{constructor(e=0,t=0){en.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6],this.y=s[1]*t+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(xr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),s=Math.sin(t),a=this.x-e.x,c=this.y-e.y;return this.x=a*r-c*s+e.x,this.y=a*s+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Fi{constructor(e,t,r,s,a,c,d,p,g){Fi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,s,a,c,d,p,g)}set(e,t,r,s,a,c,d,p,g){const v=this.elements;return v[0]=e,v[1]=s,v[2]=d,v[3]=t,v[4]=a,v[5]=p,v[6]=r,v[7]=c,v[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,a=this.elements,c=r[0],d=r[3],p=r[6],g=r[1],v=r[4],b=r[7],_=r[2],M=r[5],w=r[8],P=s[0],R=s[3],I=s[6],V=s[1],k=s[4],j=s[7],Q=s[2],se=s[5],oe=s[8];return a[0]=c*P+d*V+p*Q,a[3]=c*R+d*k+p*se,a[6]=c*I+d*j+p*oe,a[1]=g*P+v*V+b*Q,a[4]=g*R+v*k+b*se,a[7]=g*I+v*j+b*oe,a[2]=_*P+M*V+w*Q,a[5]=_*R+M*k+w*se,a[8]=_*I+M*j+w*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],c=e[4],d=e[5],p=e[6],g=e[7],v=e[8];return t*c*v-t*d*g-r*a*v+r*d*p+s*a*g-s*c*p}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],c=e[4],d=e[5],p=e[6],g=e[7],v=e[8],b=v*c-d*g,_=d*p-v*a,M=g*a-c*p,w=t*b+r*_+s*M;if(0===w)return this.set(0,0,0,0,0,0,0,0,0);const P=1/w;return e[0]=b*P,e[1]=(s*g-v*r)*P,e[2]=(d*r-s*c)*P,e[3]=_*P,e[4]=(v*t-s*p)*P,e[5]=(s*a-d*t)*P,e[6]=M*P,e[7]=(r*p-g*t)*P,e[8]=(c*t-r*a)*P,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,s,a,c,d){const p=Math.cos(a),g=Math.sin(a);return this.set(r*p,r*g,-r*(p*c+g*d)+c+e,-s*g,s*p,-s*(-g*c+p*d)+d+t,0,0,1),this}scale(e,t){return this.premultiply(Kr.makeScale(e,t)),this}rotate(e){return this.premultiply(Kr.makeRotation(-e)),this}translate(e,t){return this.premultiply(Kr.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<9;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Kr=new Fi;function oa(h){for(let e=h.length-1;e>=0;--e)if(h[e]>=65535)return!0;return!1}function xl(h){return document.createElementNS("http://www.w3.org/1999/xhtml",h)}function ol(){const h=xl("canvas");return h.style.display="block",h}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const $l={};function vo(h){h in $l||($l[h]=!0,console.warn(h))}function aa(h){return h<.04045?.0773993808*h:Math.pow(.9478672986*h+.0521327014,2.4)}function bc(h){return h<.0031308?12.92*h:1.055*Math.pow(h,.41666)-.055}const wu=(new Fi).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),xc=(new Fi).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Su={[is]:h=>h,[tr]:h=>h.convertSRGBToLinear(),[Oi]:function Ec(h){return h.convertSRGBToLinear().applyMatrix3(xc)}},dm={[is]:h=>h,[tr]:h=>h.convertLinearToSRGB(),[Oi]:function ff(h){return h.applyMatrix3(wu).convertLinearToSRGB()}},la={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(h){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!h},get workingColorSpace(){return is},set workingColorSpace(h){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(h,e,t){if(!1===this.enabled||e===t||!e||!t)return h;const r=Su[e],s=dm[t];if(void 0===r||void 0===s)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return s(r(h))},fromWorkingColorSpace:function(h,e){return this.convert(h,this.workingColorSpace,e)},toWorkingColorSpace:function(h,e){return this.convert(h,e,this.workingColorSpace)}};let Va;class pf{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Va&&(Va=xl("canvas")),Va.width=e.width,Va.height=e.height;const r=Va.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Va}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=xl("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),a=s.data;for(let c=0;c<a.length;c++)a[c]=255*aa(a[c]/255);return r.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t[r]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*aa(t[r]/255)):aa(t[r]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let hm=0;class Gl{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:hm++}),this.uuid=Ar(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(null!==s){let a;if(Array.isArray(s)){a=[];for(let c=0,d=s.length;c<d;c++)a.push($d(s[c].isDataTexture?s[c].image:s[c]))}else a=$d(s);r.url=a}return t||(e.images[this.uuid]=r),r}}function $d(h){return typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&h instanceof ImageBitmap?pf.getDataURL(h):h.data?{data:Array.from(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let fm=0,Zo=(()=>{class h extends vr{constructor(t=h.DEFAULT_IMAGE,r=h.DEFAULT_MAPPING,s=xi,a=xi,c=pr,d=Ur,p=Ui,g=Lr,v=h.DEFAULT_ANISOTROPY,b=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fm++}),this.uuid=Ar(),this.name="",this.source=new Gl(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=s,this.wrapT=a,this.magFilter=c,this.minFilter=d,this.anisotropy=v,this.format=p,this.internalFormat=null,this.type=g,this.offset=new en(0,0),this.repeat=new en(1,1),this.center=new en(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Fi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof b?this.colorSpace=b:(vo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=b===Pr?tr:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=void 0===t||"string"==typeof t;if(!r&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),r||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case xi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case xi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return vo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===tr?Pr:3e3}set encoding(t){vo("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Pr?tr:""}}return h.DEFAULT_IMAGE=null,h.DEFAULT_MAPPING=300,h.DEFAULT_ANISOTROPY=1,h})();class Br{constructor(e=0,t=0,r=0,s=1){Br.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,s){return this.x=e,this.y=t,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,a=this.w,c=e.elements;return this.x=c[0]*t+c[4]*r+c[8]*s+c[12]*a,this.y=c[1]*t+c[5]*r+c[9]*s+c[13]*a,this.z=c[2]*t+c[6]*r+c[10]*s+c[14]*a,this.w=c[3]*t+c[7]*r+c[11]*s+c[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,s,a;const p=e.elements,g=p[0],v=p[4],b=p[8],_=p[1],M=p[5],w=p[9],P=p[2],R=p[6],I=p[10];if(Math.abs(v-_)<.01&&Math.abs(b-P)<.01&&Math.abs(w-R)<.01){if(Math.abs(v+_)<.1&&Math.abs(b+P)<.1&&Math.abs(w+R)<.1&&Math.abs(g+M+I-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(g+1)/2,j=(M+1)/2,Q=(I+1)/2,se=(v+_)/4,oe=(b+P)/4,_e=(w+R)/4;return k>j&&k>Q?k<.01?(r=0,s=.707106781,a=.707106781):(r=Math.sqrt(k),s=se/r,a=oe/r):j>Q?j<.01?(r=.707106781,s=0,a=.707106781):(s=Math.sqrt(j),r=se/s,a=_e/s):Q<.01?(r=.707106781,s=.707106781,a=0):(a=Math.sqrt(Q),r=oe/a,s=_e/a),this.set(r,s,a,t),this}let V=Math.sqrt((R-w)*(R-w)+(b-P)*(b-P)+(_-v)*(_-v));return Math.abs(V)<.001&&(V=1),this.x=(R-w)/V,this.y=(b-P)/V,this.z=(_-v)/V,this.w=Math.acos((g+M+I-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class D extends vr{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Br(0,0,e,t),this.scissorTest=!1,this.viewport=new Br(0,0,e,t);const s={width:e,height:t,depth:1};void 0!==r.encoding&&(vo("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Pr?tr:""),this.texture=new Zo(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:pr,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Gl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class H extends D{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class Ee extends Zo{constructor(e=null,t=1,r=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ce extends Zo{constructor(e=null,t=1,r=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:s},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ln{constructor(e=0,t=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=s}static slerpFlat(e,t,r,s,a,c,d){let p=r[s+0],g=r[s+1],v=r[s+2],b=r[s+3];const _=a[c+0],M=a[c+1],w=a[c+2],P=a[c+3];if(0===d)return e[t+0]=p,e[t+1]=g,e[t+2]=v,void(e[t+3]=b);if(1===d)return e[t+0]=_,e[t+1]=M,e[t+2]=w,void(e[t+3]=P);if(b!==P||p!==_||g!==M||v!==w){let R=1-d;const I=p*_+g*M+v*w+b*P,V=I>=0?1:-1,k=1-I*I;if(k>Number.EPSILON){const Q=Math.sqrt(k),se=Math.atan2(Q,I*V);R=Math.sin(R*se)/Q,d=Math.sin(d*se)/Q}const j=d*V;if(p=p*R+_*j,g=g*R+M*j,v=v*R+w*j,b=b*R+P*j,R===1-d){const Q=1/Math.sqrt(p*p+g*g+v*v+b*b);p*=Q,g*=Q,v*=Q,b*=Q}}e[t]=p,e[t+1]=g,e[t+2]=v,e[t+3]=b}static multiplyQuaternionsFlat(e,t,r,s,a,c){const d=r[s],p=r[s+1],g=r[s+2],v=r[s+3],b=a[c],_=a[c+1],M=a[c+2],w=a[c+3];return e[t]=d*w+v*b+p*M-g*_,e[t+1]=p*w+v*_+g*b-d*M,e[t+2]=g*w+v*M+d*_-p*b,e[t+3]=v*w-d*b-p*_-g*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,s){return this._x=e,this._y=t,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,s=e._y,a=e._z,c=e._order,d=Math.cos,p=Math.sin,g=d(r/2),v=d(s/2),b=d(a/2),_=p(r/2),M=p(s/2),w=p(a/2);switch(c){case"XYZ":this._x=_*v*b+g*M*w,this._y=g*M*b-_*v*w,this._z=g*v*w+_*M*b,this._w=g*v*b-_*M*w;break;case"YXZ":this._x=_*v*b+g*M*w,this._y=g*M*b-_*v*w,this._z=g*v*w-_*M*b,this._w=g*v*b+_*M*w;break;case"ZXY":this._x=_*v*b-g*M*w,this._y=g*M*b+_*v*w,this._z=g*v*w+_*M*b,this._w=g*v*b-_*M*w;break;case"ZYX":this._x=_*v*b-g*M*w,this._y=g*M*b+_*v*w,this._z=g*v*w-_*M*b,this._w=g*v*b+_*M*w;break;case"YZX":this._x=_*v*b+g*M*w,this._y=g*M*b+_*v*w,this._z=g*v*w-_*M*b,this._w=g*v*b-_*M*w;break;case"XZY":this._x=_*v*b-g*M*w,this._y=g*M*b-_*v*w,this._z=g*v*w+_*M*b,this._w=g*v*b+_*M*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],s=t[4],a=t[8],c=t[1],d=t[5],p=t[9],g=t[2],v=t[6],b=t[10],_=r+d+b;if(_>0){const M=.5/Math.sqrt(_+1);this._w=.25/M,this._x=(v-p)*M,this._y=(a-g)*M,this._z=(c-s)*M}else if(r>d&&r>b){const M=2*Math.sqrt(1+r-d-b);this._w=(v-p)/M,this._x=.25*M,this._y=(s+c)/M,this._z=(a+g)/M}else if(d>b){const M=2*Math.sqrt(1+d-r-b);this._w=(a-g)/M,this._x=(s+c)/M,this._y=.25*M,this._z=(p+v)/M}else{const M=2*Math.sqrt(1+b-r-d);this._w=(c-s)/M,this._x=(a+g)/M,this._y=(p+v)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const s=Math.min(1,t/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,s=e._y,a=e._z,c=e._w,d=t._x,p=t._y,g=t._z,v=t._w;return this._x=r*v+c*d+s*g-a*p,this._y=s*v+c*p+a*d-r*g,this._z=a*v+c*g+r*p-s*d,this._w=c*v-r*d-s*p-a*g,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,s=this._y,a=this._z,c=this._w;let d=c*e._w+r*e._x+s*e._y+a*e._z;if(d<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,d=-d):this.copy(e),d>=1)return this._w=c,this._x=r,this._y=s,this._z=a,this;const p=1-d*d;if(p<=Number.EPSILON){const M=1-t;return this._w=M*c+t*this._w,this._x=M*r+t*this._x,this._y=M*s+t*this._y,this._z=M*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const g=Math.sqrt(p),v=Math.atan2(g,d),b=Math.sin((1-t)*v)/g,_=Math.sin(t*v)/g;return this._w=c*b+this._w*_,this._x=r*b+this._x*_,this._y=s*b+this._y*_,this._z=a*b+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),s=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(s),r*Math.sin(a),r*Math.cos(a),t*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class de{constructor(e=0,t=0,r=0){de.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(lr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(lr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*s,this.y=a[1]*t+a[4]*r+a[7]*s,this.z=a[2]*t+a[5]*r+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,s=this.z,a=e.elements,c=1/(a[3]*t+a[7]*r+a[11]*s+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*s+a[12])*c,this.y=(a[1]*t+a[5]*r+a[9]*s+a[13])*c,this.z=(a[2]*t+a[6]*r+a[10]*s+a[14])*c,this}applyQuaternion(e){const t=this.x,r=this.y,s=this.z,a=e.x,c=e.y,d=e.z,p=e.w,g=p*t+c*s-d*r,v=p*r+d*t-a*s,b=p*s+a*r-c*t,_=-a*t-c*r-d*s;return this.x=g*p+_*-a+v*-d-b*-c,this.y=v*p+_*-c+b*-a-g*-d,this.z=b*p+_*-d+g*-c-v*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*s,this.y=a[1]*t+a[5]*r+a[9]*s,this.z=a[2]*t+a[6]*r+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,s=e.y,a=e.z,c=t.x,d=t.y,p=t.z;return this.x=s*p-a*d,this.y=a*c-r*p,this.z=r*d-s*c,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Ki.copy(this).projectOnVector(e),this.sub(Ki)}reflect(e){return this.sub(Ki.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(xr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return t*t+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const s=Math.sin(t)*e;return this.x=s*Math.sin(r),this.y=Math.cos(t)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ki=new de,lr=new ln;class bi{constructor(e=new de(1/0,1/0,1/0),t=new de(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Ji.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Ji.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ji.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Dr.copy(e.boundingBox),Dr.applyMatrix4(e.matrixWorld),this.union(Dr);else{const s=e.geometry;if(void 0!==s)if(t&&void 0!==s.attributes&&void 0!==s.attributes.position){const a=s.attributes.position;for(let c=0,d=a.count;c<d;c++)Ji.fromBufferAttribute(a,c).applyMatrix4(e.matrixWorld),this.expandByPoint(Ji)}else null===s.boundingBox&&s.computeBoundingBox(),Dr.copy(s.boundingBox),Dr.applyMatrix4(e.matrixWorld),this.union(Dr)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ji),Ji.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Uo),wa.subVectors(this.max,Uo),Ms.subVectors(e.a,Uo),Ns.subVectors(e.b,Uo),So.subVectors(e.c,Uo),ro.subVectors(Ns,Ms),Gr.subVectors(So,Ns),Fs.subVectors(Ms,So);let t=[0,-ro.z,ro.y,0,-Gr.z,Gr.y,0,-Fs.z,Fs.y,ro.z,0,-ro.x,Gr.z,0,-Gr.x,Fs.z,0,-Fs.x,-ro.y,ro.x,0,-Gr.y,Gr.x,0,-Fs.y,Fs.x,0];return!(!kr(t,Ms,Ns,So,wa)||(t=[1,0,0,0,1,0,0,0,1],!kr(t,Ms,Ns,So,wa)))&&(Mc.crossVectors(ro,Gr),t=[Mc.x,Mc.y,Mc.z],kr(t,Ms,Ns,So,wa))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ji).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Ji).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(cr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),cr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),cr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),cr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),cr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),cr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),cr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),cr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(cr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const cr=[new de,new de,new de,new de,new de,new de,new de,new de],Ji=new de,Dr=new bi,Ms=new de,Ns=new de,So=new de,ro=new de,Gr=new de,Fs=new de,Uo=new de,wa=new de,Mc=new de,Wl=new de;function kr(h,e,t,r,s){for(let a=0,c=h.length-3;a<=c;a+=3){Wl.fromArray(h,a);const d=s.x*Math.abs(Wl.x)+s.y*Math.abs(Wl.y)+s.z*Math.abs(Wl.z),p=e.dot(Wl),g=t.dot(Wl),v=r.dot(Wl);if(Math.max(-Math.max(p,g,v),Math.min(p,g,v))>d)return!1}return!0}const jl=new bi,za=new de,Ws=new de;class Sa{constructor(e=new de,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):jl.setFromPoints(e).getCenter(r);let s=0;for(let a=0,c=e.length;a<c;a++)s=Math.max(s,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;za.subVectors(e,this.center);const t=za.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),s=.5*(r-this.radius);this.center.addScaledVector(za,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Ws.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(za.copy(e.center).add(Ws)),this.expandByPoint(za.copy(e.center).sub(Ws))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Vo=new de,Ha=new de,yo=new de,Ko=new de,Yl=new de,Cu=new de,Jo=new de;class El{constructor(e=new de,t=new de(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vo.copy(this.origin).addScaledVector(this.direction,t),Vo.distanceToSquared(e))}distanceSqToSegment(e,t,r,s){Ha.copy(e).add(t).multiplyScalar(.5),yo.copy(t).sub(e).normalize(),Ko.copy(this.origin).sub(Ha);const a=.5*e.distanceTo(t),c=-this.direction.dot(yo),d=Ko.dot(this.direction),p=-Ko.dot(yo),g=Ko.lengthSq(),v=Math.abs(1-c*c);let b,_,M,w;if(v>0)if(b=c*p-d,_=c*d-p,w=a*v,b>=0)if(_>=-w)if(_<=w){const P=1/v;b*=P,_*=P,M=b*(b+c*_+2*d)+_*(c*b+_+2*p)+g}else _=a,b=Math.max(0,-(c*_+d)),M=-b*b+_*(_+2*p)+g;else _=-a,b=Math.max(0,-(c*_+d)),M=-b*b+_*(_+2*p)+g;else _<=-w?(b=Math.max(0,-(-c*a+d)),_=b>0?-a:Math.min(Math.max(-a,-p),a),M=-b*b+_*(_+2*p)+g):_<=w?(b=0,_=Math.min(Math.max(-a,-p),a),M=_*(_+2*p)+g):(b=Math.max(0,-(c*a+d)),_=b>0?a:Math.min(Math.max(-a,-p),a),M=-b*b+_*(_+2*p)+g);else _=c>0?-a:a,b=Math.max(0,-(c*_+d)),M=-b*b+_*(_+2*p)+g;return r&&r.copy(this.origin).addScaledVector(this.direction,b),s&&s.copy(Ha).addScaledVector(yo,_),M}intersectSphere(e,t){Vo.subVectors(e.center,this.origin);const r=Vo.dot(this.direction),s=Vo.dot(Vo)-r*r,a=e.radius*e.radius;if(s>a)return null;const c=Math.sqrt(a-s),d=r-c,p=r+c;return p<0?null:this.at(d<0?p:d,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,s,a,c,d,p;const g=1/this.direction.x,v=1/this.direction.y,b=1/this.direction.z,_=this.origin;return g>=0?(r=(e.min.x-_.x)*g,s=(e.max.x-_.x)*g):(r=(e.max.x-_.x)*g,s=(e.min.x-_.x)*g),v>=0?(a=(e.min.y-_.y)*v,c=(e.max.y-_.y)*v):(a=(e.max.y-_.y)*v,c=(e.min.y-_.y)*v),r>c||a>s||((a>r||isNaN(r))&&(r=a),(c<s||isNaN(s))&&(s=c),b>=0?(d=(e.min.z-_.z)*b,p=(e.max.z-_.z)*b):(d=(e.max.z-_.z)*b,p=(e.min.z-_.z)*b),r>p||d>s)||((d>r||r!=r)&&(r=d),(p<s||s!=s)&&(s=p),s<0)?null:this.at(r>=0?r:s,t)}intersectsBox(e){return null!==this.intersectBox(e,Vo)}intersectTriangle(e,t,r,s,a){Yl.subVectors(t,e),Cu.subVectors(r,e),Jo.crossVectors(Yl,Cu);let d,c=this.direction.dot(Jo);if(c>0){if(s)return null;d=1}else{if(!(c<0))return null;d=-1,c=-c}Ko.subVectors(this.origin,e);const p=d*this.direction.dot(Cu.crossVectors(Ko,Cu));if(p<0)return null;const g=d*this.direction.dot(Yl.cross(Ko));if(g<0||p+g>c)return null;const v=-d*Ko.dot(Jo);return v<0?null:this.at(v/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Mi{constructor(e,t,r,s,a,c,d,p,g,v,b,_,M,w,P,R){Mi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,s,a,c,d,p,g,v,b,_,M,w,P,R)}set(e,t,r,s,a,c,d,p,g,v,b,_,M,w,P,R){const I=this.elements;return I[0]=e,I[4]=t,I[8]=r,I[12]=s,I[1]=a,I[5]=c,I[9]=d,I[13]=p,I[2]=g,I[6]=v,I[10]=b,I[14]=_,I[3]=M,I[7]=w,I[11]=P,I[15]=R,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Mi).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,s=1/Ml.setFromMatrixColumn(e,0).length(),a=1/Ml.setFromMatrixColumn(e,1).length(),c=1/Ml.setFromMatrixColumn(e,2).length();return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,s=e.y,a=e.z,c=Math.cos(r),d=Math.sin(r),p=Math.cos(s),g=Math.sin(s),v=Math.cos(a),b=Math.sin(a);if("XYZ"===e.order){const _=c*v,M=c*b,w=d*v,P=d*b;t[0]=p*v,t[4]=-p*b,t[8]=g,t[1]=M+w*g,t[5]=_-P*g,t[9]=-d*p,t[2]=P-_*g,t[6]=w+M*g,t[10]=c*p}else if("YXZ"===e.order){const _=p*v,M=p*b,w=g*v,P=g*b;t[0]=_+P*d,t[4]=w*d-M,t[8]=c*g,t[1]=c*b,t[5]=c*v,t[9]=-d,t[2]=M*d-w,t[6]=P+_*d,t[10]=c*p}else if("ZXY"===e.order){const _=p*v,M=p*b,w=g*v,P=g*b;t[0]=_-P*d,t[4]=-c*b,t[8]=w+M*d,t[1]=M+w*d,t[5]=c*v,t[9]=P-_*d,t[2]=-c*g,t[6]=d,t[10]=c*p}else if("ZYX"===e.order){const _=c*v,M=c*b,w=d*v,P=d*b;t[0]=p*v,t[4]=w*g-M,t[8]=_*g+P,t[1]=p*b,t[5]=P*g+_,t[9]=M*g-w,t[2]=-g,t[6]=d*p,t[10]=c*p}else if("YZX"===e.order){const _=c*p,M=c*g,w=d*p,P=d*g;t[0]=p*v,t[4]=P-_*b,t[8]=w*b+M,t[1]=b,t[5]=c*v,t[9]=-d*v,t[2]=-g*v,t[6]=M*b+w,t[10]=_-P*b}else if("XZY"===e.order){const _=c*p,M=c*g,w=d*p,P=d*g;t[0]=p*v,t[4]=-b,t[8]=g*v,t[1]=_*b+P,t[5]=c*v,t[9]=M*b-w,t[2]=w*b-M,t[6]=d*v,t[10]=P*b+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ql,e,wc)}lookAt(e,t,r){const s=this.elements;return hi.subVectors(e,t),0===hi.lengthSq()&&(hi.z=1),hi.normalize(),ca.crossVectors(r,hi),0===ca.lengthSq()&&(1===Math.abs(r.z)?hi.x+=1e-4:hi.z+=1e-4,hi.normalize(),ca.crossVectors(r,hi)),ca.normalize(),wl.crossVectors(hi,ca),s[0]=ca.x,s[4]=wl.x,s[8]=hi.x,s[1]=ca.y,s[5]=wl.y,s[9]=hi.y,s[2]=ca.z,s[6]=wl.z,s[10]=hi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,s=t.elements,a=this.elements,c=r[0],d=r[4],p=r[8],g=r[12],v=r[1],b=r[5],_=r[9],M=r[13],w=r[2],P=r[6],R=r[10],I=r[14],V=r[3],k=r[7],j=r[11],Q=r[15],se=s[0],oe=s[4],_e=s[8],q=s[12],ne=s[1],je=s[5],dt=s[9],we=s[13],Re=s[2],Pe=s[6],$e=s[10],xt=s[14],wt=s[3],At=s[7],Ut=s[11],pt=s[15];return a[0]=c*se+d*ne+p*Re+g*wt,a[4]=c*oe+d*je+p*Pe+g*At,a[8]=c*_e+d*dt+p*$e+g*Ut,a[12]=c*q+d*we+p*xt+g*pt,a[1]=v*se+b*ne+_*Re+M*wt,a[5]=v*oe+b*je+_*Pe+M*At,a[9]=v*_e+b*dt+_*$e+M*Ut,a[13]=v*q+b*we+_*xt+M*pt,a[2]=w*se+P*ne+R*Re+I*wt,a[6]=w*oe+P*je+R*Pe+I*At,a[10]=w*_e+P*dt+R*$e+I*Ut,a[14]=w*q+P*we+R*xt+I*pt,a[3]=V*se+k*ne+j*Re+Q*wt,a[7]=V*oe+k*je+j*Pe+Q*At,a[11]=V*_e+k*dt+j*$e+Q*Ut,a[15]=V*q+k*we+j*xt+Q*pt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],s=e[8],a=e[12],c=e[1],d=e[5],p=e[9],g=e[13],v=e[2],b=e[6],_=e[10],M=e[14];return e[3]*(+a*p*b-s*g*b-a*d*_+r*g*_+s*d*M-r*p*M)+e[7]*(+t*p*M-t*g*_+a*c*_-s*c*M+s*g*v-a*p*v)+e[11]*(+t*g*b-t*d*M-a*c*b+r*c*M+a*d*v-r*g*v)+e[15]*(-s*d*v-t*p*b+t*d*_+s*c*b-r*c*_+r*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],s=e[2],a=e[3],c=e[4],d=e[5],p=e[6],g=e[7],v=e[8],b=e[9],_=e[10],M=e[11],w=e[12],P=e[13],R=e[14],I=e[15],V=b*R*g-P*_*g+P*p*M-d*R*M-b*p*I+d*_*I,k=w*_*g-v*R*g-w*p*M+c*R*M+v*p*I-c*_*I,j=v*P*g-w*b*g+w*d*M-c*P*M-v*d*I+c*b*I,Q=w*b*p-v*P*p-w*d*_+c*P*_+v*d*R-c*b*R,se=t*V+r*k+s*j+a*Q;if(0===se)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const oe=1/se;return e[0]=V*oe,e[1]=(P*_*a-b*R*a-P*s*M+r*R*M+b*s*I-r*_*I)*oe,e[2]=(d*R*a-P*p*a+P*s*g-r*R*g-d*s*I+r*p*I)*oe,e[3]=(b*p*a-d*_*a-b*s*g+r*_*g+d*s*M-r*p*M)*oe,e[4]=k*oe,e[5]=(v*R*a-w*_*a+w*s*M-t*R*M-v*s*I+t*_*I)*oe,e[6]=(w*p*a-c*R*a-w*s*g+t*R*g+c*s*I-t*p*I)*oe,e[7]=(c*_*a-v*p*a+v*s*g-t*_*g-c*s*M+t*p*M)*oe,e[8]=j*oe,e[9]=(w*b*a-v*P*a-w*r*M+t*P*M+v*r*I-t*b*I)*oe,e[10]=(c*P*a-w*d*a+w*r*g-t*P*g-c*r*I+t*d*I)*oe,e[11]=(v*d*a-c*b*a-v*r*g+t*b*g+c*r*M-t*d*M)*oe,e[12]=Q*oe,e[13]=(v*P*s-w*b*s+w*r*_-t*P*_-v*r*R+t*b*R)*oe,e[14]=(w*d*s-c*P*s-w*r*p+t*P*p+c*r*R-t*d*R)*oe,e[15]=(c*b*s-v*d*s+v*r*p-t*b*p-c*r*_+t*d*_)*oe,this}scale(e){const t=this.elements,r=e.x,s=e.y,a=e.z;return t[0]*=r,t[4]*=s,t[8]*=a,t[1]*=r,t[5]*=s,t[9]*=a,t[2]*=r,t[6]*=s,t[10]*=a,t[3]*=r,t[7]*=s,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),s=Math.sin(t),a=1-r,c=e.x,d=e.y,p=e.z,g=a*c,v=a*d;return this.set(g*c+r,g*d-s*p,g*p+s*d,0,g*d+s*p,v*d+r,v*p-s*c,0,g*p-s*d,v*p+s*c,a*p*p+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,s,a,c){return this.set(1,r,a,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,r){const s=this.elements,a=t._x,c=t._y,d=t._z,p=t._w,g=a+a,v=c+c,b=d+d,_=a*g,M=a*v,w=a*b,P=c*v,R=c*b,I=d*b,V=p*g,k=p*v,j=p*b,Q=r.x,se=r.y,oe=r.z;return s[0]=(1-(P+I))*Q,s[1]=(M+j)*Q,s[2]=(w-k)*Q,s[3]=0,s[4]=(M-j)*se,s[5]=(1-(_+I))*se,s[6]=(R+V)*se,s[7]=0,s[8]=(w+k)*oe,s[9]=(R-V)*oe,s[10]=(1-(_+P))*oe,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,r){const s=this.elements;let a=Ml.set(s[0],s[1],s[2]).length();const c=Ml.set(s[4],s[5],s[6]).length(),d=Ml.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],Qo.copy(this);const g=1/a,v=1/c,b=1/d;return Qo.elements[0]*=g,Qo.elements[1]*=g,Qo.elements[2]*=g,Qo.elements[4]*=v,Qo.elements[5]*=v,Qo.elements[6]*=v,Qo.elements[8]*=b,Qo.elements[9]*=b,Qo.elements[10]*=b,t.setFromRotationMatrix(Qo),r.x=a,r.y=c,r.z=d,this}makePerspective(e,t,r,s,a,c,d=Xo){const p=this.elements,g=2*a/(t-e),v=2*a/(r-s),b=(t+e)/(t-e),_=(r+s)/(r-s);let M,w;if(d===Xo)M=-(c+a)/(c-a),w=-2*c*a/(c-a);else{if(2001!==d)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+d);M=-c/(c-a),w=-c*a/(c-a)}return p[0]=g,p[4]=0,p[8]=b,p[12]=0,p[1]=0,p[5]=v,p[9]=_,p[13]=0,p[2]=0,p[6]=0,p[10]=M,p[14]=w,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,r,s,a,c,d=Xo){const p=this.elements,g=1/(t-e),v=1/(r-s),b=1/(c-a),_=(t+e)*g,M=(r+s)*v;let w,P;if(d===Xo)w=(c+a)*b,P=-2*b;else{if(2001!==d)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+d);w=a*b,P=-1*b}return p[0]=2*g,p[4]=0,p[8]=0,p[12]=-_,p[1]=0,p[5]=2*v,p[9]=0,p[13]=-M,p[2]=0,p[6]=0,p[10]=P,p[14]=-w,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let s=0;s<16;s++)if(t[s]!==r[s])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Ml=new de,Qo=new Mi,ql=new de(0,0,0),wc=new de(1,1,1),ca=new de,wl=new de,hi=new de,mf=new Mi,pm=new ln;let Gd=(()=>{class h{constructor(t=0,r=0,s=0,a=h.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=s,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,s,a=this._order){return this._x=t,this._y=r,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,s=!0){const a=t.elements,c=a[0],d=a[4],p=a[8],g=a[1],v=a[5],b=a[9],_=a[2],M=a[6],w=a[10];switch(r){case"XYZ":this._y=Math.asin(xr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-b,w),this._z=Math.atan2(-d,c)):(this._x=Math.atan2(M,v),this._z=0);break;case"YXZ":this._x=Math.asin(-xr(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(p,w),this._z=Math.atan2(g,v)):(this._y=Math.atan2(-_,c),this._z=0);break;case"ZXY":this._x=Math.asin(xr(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-_,w),this._z=Math.atan2(-d,v)):(this._y=0,this._z=Math.atan2(g,c));break;case"ZYX":this._y=Math.asin(-xr(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(M,w),this._z=Math.atan2(g,c)):(this._x=0,this._z=Math.atan2(-d,v));break;case"YZX":this._z=Math.asin(xr(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(-b,v),this._y=Math.atan2(-_,c)):(this._x=0,this._y=Math.atan2(p,w));break;case"XZY":this._z=Math.asin(-xr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(M,v),this._y=Math.atan2(p,c)):(this._x=Math.atan2(-b,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,r,s){return mf.makeRotationFromQuaternion(t),this.setFromRotationMatrix(mf,r,s)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return pm.setFromEuler(this),this.setFromQuaternion(pm,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return h.DEFAULT_ORDER="XYZ",h})();class Au{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let $v=0;const Tu=new de,Is=new ln,$a=new Mi,Wd=new de,Du=new de,Gv=new de,gf=new ln,qt=new de(1,0,0),sr=new de(0,1,0),vf=new de(0,0,1),mm={type:"added"},zr={type:"removed"};let Co=(()=>{class h extends vr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:$v++}),this.uuid=Ar(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=h.DEFAULT_UP.clone();const t=new de,r=new Gd,s=new ln,a=new de(1,1,1);r._onChange(function c(){s.setFromEuler(r,!1)}),s._onChange(function d(){r.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Mi},normalMatrix:{value:new Fi}}),this.matrix=new Mi,this.matrixWorld=new Mi,this.matrixAutoUpdate=h.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=h.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Au,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return Is.setFromAxisAngle(t,r),this.quaternion.multiply(Is),this}rotateOnWorldAxis(t,r){return Is.setFromAxisAngle(t,r),this.quaternion.premultiply(Is),this}rotateX(t){return this.rotateOnAxis(qt,t)}rotateY(t){return this.rotateOnAxis(sr,t)}rotateZ(t){return this.rotateOnAxis(vf,t)}translateOnAxis(t,r){return Tu.copy(t).applyQuaternion(this.quaternion),this.position.add(Tu.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(qt,t)}translateY(t){return this.translateOnAxis(sr,t)}translateZ(t){return this.translateOnAxis(vf,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4($a.copy(this.matrixWorld).invert())}lookAt(t,r,s){t.isVector3?Wd.copy(t):Wd.set(t,r,s);const a=this.parent;this.updateWorldMatrix(!0,!1),Du.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$a.lookAt(Du,Wd,this.up):$a.lookAt(Wd,Du,this.up),this.quaternion.setFromRotationMatrix($a),a&&($a.extractRotation(a.matrixWorld),Is.setFromRotationMatrix($a),this.quaternion.premultiply(Is.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(mm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const r=this.children.indexOf(t);return-1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(zr)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),$a.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),$a.multiply(t.parent.matrixWorld)),t.applyMatrix4($a),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let s=0,a=this.children.length;s<a;s++){const d=this.children[s].getObjectByProperty(t,r);if(void 0!==d)return d}}getObjectsByProperty(t,r){let s=[];this[t]===r&&s.push(this);for(let a=0,c=this.children.length;a<c;a++){const d=this.children[a].getObjectsByProperty(t,r);d.length>0&&(s=s.concat(d))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Du,t,Gv),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Du,gf,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].traverseVisible(t)}traverseAncestors(t){const r=this.parent;null!==r&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let s=0,a=r.length;s<a;s++){const c=r[s];(!0===c.matrixWorldAutoUpdate||!0===t)&&c.updateMatrixWorld(t)}}updateWorldMatrix(t,r){const s=this.parent;if(!0===t&&null!==s&&!0===s.matrixWorldAutoUpdate&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===r){const a=this.children;for(let c=0,d=a.length;c<d;c++){const p=a[c];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const r=void 0===t||"string"==typeof t,s={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};function c(p,g){return void 0===p[g.uuid]&&(p[g.uuid]=g.toJSON(t)),g.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const g=p.shapes;if(Array.isArray(g))for(let v=0,b=g.length;v<b;v++)c(t.shapes,g[v]);else c(t.shapes,g)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(c(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let g=0,v=this.material.length;g<v;g++)p.push(c(t.materials,this.material[g]));a.material=p}else a.material=c(t.materials,this.material);if(this.children.length>0){a.children=[];for(let p=0;p<this.children.length;p++)a.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let p=0;p<this.animations.length;p++)a.animations.push(c(t.animations,this.animations[p]))}if(r){const p=d(t.geometries),g=d(t.materials),v=d(t.textures),b=d(t.images),_=d(t.shapes),M=d(t.skeletons),w=d(t.animations),P=d(t.nodes);p.length>0&&(s.geometries=p),g.length>0&&(s.materials=g),v.length>0&&(s.textures=v),b.length>0&&(s.images=b),_.length>0&&(s.shapes=_),M.length>0&&(s.skeletons=M),w.length>0&&(s.animations=w),P.length>0&&(s.nodes=P)}return s.object=a,s;function d(p){const g=[];for(const v in p){const b=p[v];delete b.metadata,g.push(b)}return g}}clone(t){return(new this.constructor).copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===r)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return h.DEFAULT_UP=new de(0,1,0),h.DEFAULT_MATRIX_AUTO_UPDATE=!0,h.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,h})();const Ao=new de,so=new de,Iu=new de,Ca=new de,Xl=new de,Sc=new de,yf=new de,js=new de,ua=new de,Ru=new de;let zo=!1;class ws{constructor(e=new de,t=new de,r=new de){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,s){s.subVectors(r,t),Ao.subVectors(e,t),s.cross(Ao);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,t,r,s,a){Ao.subVectors(s,t),so.subVectors(r,t),Iu.subVectors(e,t);const c=Ao.dot(Ao),d=Ao.dot(so),p=Ao.dot(Iu),g=so.dot(so),v=so.dot(Iu),b=c*g-d*d;if(0===b)return a.set(-2,-1,-1);const _=1/b,M=(g*p-d*v)*_,w=(c*v-d*p)*_;return a.set(1-M-w,w,M)}static containsPoint(e,t,r,s){return this.getBarycoord(e,t,r,s,Ca),Ca.x>=0&&Ca.y>=0&&Ca.x+Ca.y<=1}static getUV(e,t,r,s,a,c,d,p){return!1===zo&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),zo=!0),this.getInterpolation(e,t,r,s,a,c,d,p)}static getInterpolation(e,t,r,s,a,c,d,p){return this.getBarycoord(e,t,r,s,Ca),p.setScalar(0),p.addScaledVector(a,Ca.x),p.addScaledVector(c,Ca.y),p.addScaledVector(d,Ca.z),p}static isFrontFacing(e,t,r,s){return Ao.subVectors(r,t),so.subVectors(e,t),Ao.cross(so).dot(s)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,s){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,r,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ao.subVectors(this.c,this.b),so.subVectors(this.a,this.b),.5*Ao.cross(so).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ws.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ws.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,s,a){return!1===zo&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),zo=!0),ws.getInterpolation(e,this.a,this.b,this.c,t,r,s,a)}getInterpolation(e,t,r,s,a){return ws.getInterpolation(e,this.a,this.b,this.c,t,r,s,a)}containsPoint(e){return ws.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ws.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,s=this.b,a=this.c;let c,d;Xl.subVectors(s,r),Sc.subVectors(a,r),js.subVectors(e,r);const p=Xl.dot(js),g=Sc.dot(js);if(p<=0&&g<=0)return t.copy(r);ua.subVectors(e,s);const v=Xl.dot(ua),b=Sc.dot(ua);if(v>=0&&b<=v)return t.copy(s);const _=p*b-v*g;if(_<=0&&p>=0&&v<=0)return c=p/(p-v),t.copy(r).addScaledVector(Xl,c);Ru.subVectors(e,a);const M=Xl.dot(Ru),w=Sc.dot(Ru);if(w>=0&&M<=w)return t.copy(a);const P=M*g-p*w;if(P<=0&&g>=0&&w<=0)return d=g/(g-w),t.copy(r).addScaledVector(Sc,d);const R=v*w-M*b;if(R<=0&&b-v>=0&&M-w>=0)return yf.subVectors(a,s),d=(b-v)/(b-v+(M-w)),t.copy(s).addScaledVector(yf,d);const I=1/(R+P+_);return c=P*I,d=_*I,t.copy(r).addScaledVector(Xl,c).addScaledVector(Sc,d)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let gm=0;class al extends vr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gm++}),this.uuid=Ar(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[t]=r:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function s(a){const c=[];for(const d in a){const p=a[d];delete p.metadata,c.push(p)}return c}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const a=s(e.textures),c=s(e.images);a.length>0&&(r.textures=a),c.length>0&&(r.images=c)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const s=t.length;r=new Array(s);for(let a=0;a!==s;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const _f={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ea={h:0,s:0,l:0},Zl={h:0,s:0,l:0};function Pu(h,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?h+6*(e-h)*t:t<.5?e:t<2/3?h+6*(e-h)*(2/3-t):h}class ei{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(void 0===t&&void 0===r){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=tr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,la.toWorkingColorSpace(this,t),this}setRGB(e,t,r,s=la.workingColorSpace){return this.r=e,this.g=t,this.b=r,la.toWorkingColorSpace(this,s),this}setHSL(e,t,r,s=la.workingColorSpace){if(e=function Oo(h,e){return(h%e+e)%e}(e,1),t=xr(t,0,1),r=xr(r,0,1),0===t)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,c=2*r-a;this.r=Pu(c,a,e+1/3),this.g=Pu(c,a,e),this.b=Pu(c,a,e-1/3)}return la.toWorkingColorSpace(this,s),this}setStyle(e,t=tr){function r(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const d=s[2];switch(s[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],c=a.length;if(3===c)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===c)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=tr){const r=_f[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=aa(e.r),this.g=aa(e.g),this.b=aa(e.b),this}copyLinearToSRGB(e){return this.r=bc(e.r),this.g=bc(e.g),this.b=bc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=tr){return la.fromWorkingColorSpace(oo.copy(this),e),65536*Math.round(xr(255*oo.r,0,255))+256*Math.round(xr(255*oo.g,0,255))+Math.round(xr(255*oo.b,0,255))}getHexString(e=tr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=la.workingColorSpace){la.fromWorkingColorSpace(oo.copy(this),t);const r=oo.r,s=oo.g,a=oo.b,c=Math.max(r,s,a),d=Math.min(r,s,a);let p,g;const v=(d+c)/2;if(d===c)p=0,g=0;else{const b=c-d;switch(g=v<=.5?b/(c+d):b/(2-c-d),c){case r:p=(s-a)/b+(s<a?6:0);break;case s:p=(a-r)/b+2;break;case a:p=(r-s)/b+4}p/=6}return e.h=p,e.s=g,e.l=v,e}getRGB(e,t=la.workingColorSpace){return la.fromWorkingColorSpace(oo.copy(this),t),e.r=oo.r,e.g=oo.g,e.b=oo.b,e}getStyle(e=tr){la.fromWorkingColorSpace(oo.copy(this),e);const t=oo.r,r=oo.g,s=oo.b;return e!==tr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*r)},${Math.round(255*s)})`}offsetHSL(e,t,r){return this.getHSL(ea),ea.h+=e,ea.s+=t,ea.l+=r,this.setHSL(ea.h,ea.s,ea.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ea),e.getHSL(Zl);const r=$(ea.h,Zl.h,t),s=$(ea.s,Zl.s,t),a=$(ea.l,Zl.l,t);return this.setHSL(r,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,s=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*s,this.g=a[1]*t+a[4]*r+a[7]*s,this.b=a[2]*t+a[5]*r+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const oo=new ei;ei.NAMES=_f;class Sl extends al{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ei(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const S=new de,N=new en;class K{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=ke,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=t.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)N.fromBufferAttribute(this,t),N.applyMatrix3(e),this.setXY(t,N.x,N.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)S.fromBufferAttribute(this,t),S.applyMatrix3(e),this.setXYZ(t,S.x,S.y,S.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)S.fromBufferAttribute(this,t),S.applyMatrix4(e),this.setXYZ(t,S.x,S.y,S.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)S.fromBufferAttribute(this,t),S.applyNormalMatrix(e),this.setXYZ(t,S.x,S.y,S.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)S.fromBufferAttribute(this,t),S.transformDirection(e),this.setXYZ(t,S.x,S.y,S.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=io(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Ni(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=io(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=io(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=io(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=io(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ni(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),r=Ni(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,s){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),r=Ni(r,this.array),s=Ni(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,t,r,s,a){return e*=this.itemSize,this.normalized&&(t=Ni(t,this.array),r=Ni(r,this.array),s=Ni(s,this.array),a=Ni(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Ln extends K{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class jr extends K{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Bn extends K{constructor(e,t,r){super(new Float32Array(e),t,r)}}let ta=0;const _o=new Mi,Aa=new Co,Ho=new de,bo=new bi,da=new bi,ao=new de;class Qi extends vr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ta++}),this.uuid=Ar(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(oa(e)?jr:Ln)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const a=(new Fi).getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return _o.makeRotationFromQuaternion(e),this.applyMatrix4(_o),this}rotateX(e){return _o.makeRotationX(e),this.applyMatrix4(_o),this}rotateY(e){return _o.makeRotationY(e),this.applyMatrix4(_o),this}rotateZ(e){return _o.makeRotationZ(e),this.applyMatrix4(_o),this}translate(e,t,r){return _o.makeTranslation(e,t,r),this.applyMatrix4(_o),this}scale(e,t,r){return _o.makeScale(e,t,r),this.applyMatrix4(_o),this}lookAt(e){return Aa.lookAt(e),Aa.updateMatrix(),this.applyMatrix4(Aa.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ho).negate(),this.translate(Ho.x,Ho.y,Ho.z),this}setFromPoints(e){const t=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Bn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new de(-1/0,-1/0,-1/0),new de(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++)bo.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(ao.addVectors(this.boundingBox.min,bo.min),this.boundingBox.expandByPoint(ao),ao.addVectors(this.boundingBox.max,bo.max),this.boundingBox.expandByPoint(ao)):(this.boundingBox.expandByPoint(bo.min),this.boundingBox.expandByPoint(bo.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new de,1/0);if(e){const r=this.boundingSphere.center;if(bo.setFromBufferAttribute(e),t)for(let a=0,c=t.length;a<c;a++)da.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(ao.addVectors(bo.min,da.min),bo.expandByPoint(ao),ao.addVectors(bo.max,da.max),bo.expandByPoint(ao)):(bo.expandByPoint(da.min),bo.expandByPoint(da.max));bo.getCenter(r);let s=0;for(let a=0,c=e.count;a<c;a++)ao.fromBufferAttribute(e,a),s=Math.max(s,r.distanceToSquared(ao));if(t)for(let a=0,c=t.length;a<c;a++){const d=t[a],p=this.morphTargetsRelative;for(let g=0,v=d.count;g<v;g++)ao.fromBufferAttribute(d,g),p&&(Ho.fromBufferAttribute(e,g),ao.add(Ho)),s=Math.max(s,r.distanceToSquared(ao))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=e.array,s=t.position.array,a=t.normal.array,c=t.uv.array,d=s.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new K(new Float32Array(4*d),4));const p=this.getAttribute("tangent").array,g=[],v=[];for(let ne=0;ne<d;ne++)g[ne]=new de,v[ne]=new de;const b=new de,_=new de,M=new de,w=new en,P=new en,R=new en,I=new de,V=new de;function k(ne,je,dt){b.fromArray(s,3*ne),_.fromArray(s,3*je),M.fromArray(s,3*dt),w.fromArray(c,2*ne),P.fromArray(c,2*je),R.fromArray(c,2*dt),_.sub(b),M.sub(b),P.sub(w),R.sub(w);const we=1/(P.x*R.y-R.x*P.y);isFinite(we)&&(I.copy(_).multiplyScalar(R.y).addScaledVector(M,-P.y).multiplyScalar(we),V.copy(M).multiplyScalar(P.x).addScaledVector(_,-R.x).multiplyScalar(we),g[ne].add(I),g[je].add(I),g[dt].add(I),v[ne].add(V),v[je].add(V),v[dt].add(V))}let j=this.groups;0===j.length&&(j=[{start:0,count:r.length}]);for(let ne=0,je=j.length;ne<je;++ne){const dt=j[ne],we=dt.start;for(let Pe=we,$e=we+dt.count;Pe<$e;Pe+=3)k(r[Pe+0],r[Pe+1],r[Pe+2])}const Q=new de,se=new de,oe=new de,_e=new de;function q(ne){oe.fromArray(a,3*ne),_e.copy(oe);const je=g[ne];Q.copy(je),Q.sub(oe.multiplyScalar(oe.dot(je))).normalize(),se.crossVectors(_e,je);const we=se.dot(v[ne])<0?-1:1;p[4*ne]=Q.x,p[4*ne+1]=Q.y,p[4*ne+2]=Q.z,p[4*ne+3]=we}for(let ne=0,je=j.length;ne<je;++ne){const dt=j[ne],we=dt.start;for(let Pe=we,$e=we+dt.count;Pe<$e;Pe+=3)q(r[Pe+0]),q(r[Pe+1]),q(r[Pe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new K(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let _=0,M=r.count;_<M;_++)r.setXYZ(_,0,0,0);const s=new de,a=new de,c=new de,d=new de,p=new de,g=new de,v=new de,b=new de;if(e)for(let _=0,M=e.count;_<M;_+=3){const w=e.getX(_+0),P=e.getX(_+1),R=e.getX(_+2);s.fromBufferAttribute(t,w),a.fromBufferAttribute(t,P),c.fromBufferAttribute(t,R),v.subVectors(c,a),b.subVectors(s,a),v.cross(b),d.fromBufferAttribute(r,w),p.fromBufferAttribute(r,P),g.fromBufferAttribute(r,R),d.add(v),p.add(v),g.add(v),r.setXYZ(w,d.x,d.y,d.z),r.setXYZ(P,p.x,p.y,p.z),r.setXYZ(R,g.x,g.y,g.z)}else for(let _=0,M=t.count;_<M;_+=3)s.fromBufferAttribute(t,_+0),a.fromBufferAttribute(t,_+1),c.fromBufferAttribute(t,_+2),v.subVectors(c,a),b.subVectors(s,a),v.cross(b),r.setXYZ(_+0,v.x,v.y,v.z),r.setXYZ(_+1,v.x,v.y,v.z),r.setXYZ(_+2,v.x,v.y,v.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)ao.fromBufferAttribute(e,t),ao.normalize(),e.setXYZ(t,ao.x,ao.y,ao.z)}toNonIndexed(){function e(d,p){const g=d.array,v=d.itemSize,b=d.normalized,_=new g.constructor(p.length*v);let M=0,w=0;for(let P=0,R=p.length;P<R;P++){M=d.isInterleavedBufferAttribute?p[P]*d.data.stride+d.offset:p[P]*v;for(let I=0;I<v;I++)_[w++]=g[M++]}return new K(_,v,b)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Qi,r=this.index.array,s=this.attributes;for(const d in s){const g=e(s[d],r);t.setAttribute(d,g)}const a=this.morphAttributes;for(const d in a){const p=[],g=a[d];for(let v=0,b=g.length;v<b;v++){const M=e(g[v],r);p.push(M)}t.morphAttributes[d]=p}t.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let d=0,p=c.length;d<p;d++){const g=c[d];t.addGroup(g.start,g.count,g.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const g in p)void 0!==p[g]&&(e[g]=p[g]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const p in r)e.data.attributes[p]=r[p].toJSON(e.data);const s={};let a=!1;for(const p in this.morphAttributes){const g=this.morphAttributes[p],v=[];for(let b=0,_=g.length;b<_;b++)v.push(g[b].toJSON(e.data));v.length>0&&(s[p]=v,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const d=this.boundingSphere;return null!==d&&(e.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const s=e.attributes;for(const g in s)this.setAttribute(g,s[g].clone(t));const a=e.morphAttributes;for(const g in a){const v=[],b=a[g];for(let _=0,M=b.length;_<M;_++)v.push(b[_].clone(t));this.morphAttributes[g]=v}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let g=0,v=c.length;g<v;g++){const b=c[g];this.addGroup(b.start,b.count,b.materialIndex)}const d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Wv=new Mi,Ta=new El,Kl=new Sa,jv=new de,Jl=new de,Ou=new de,Lu=new de,vm=new de,ym=new de,_m=new en,Nu=new en,Ql=new en,Yv=new de,Fu=new de,xf=new de,Cc=new de,bm=new de;class ms extends Co{constructor(e=new Qi,t=new Sl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const s=t[r[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const d=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a}}}}getVertexPosition(e,t){const r=this.geometry,a=r.morphAttributes.position,c=r.morphTargetsRelative;t.fromBufferAttribute(r.attributes.position,e);const d=this.morphTargetInfluences;if(a&&d){ym.set(0,0,0);for(let p=0,g=a.length;p<g;p++){const v=d[p];0!==v&&(vm.fromBufferAttribute(a[p],e),ym.addScaledVector(c?vm:vm.sub(t),v))}t.add(ym)}return t}raycast(e,t){const r=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===r.boundingSphere&&r.computeBoundingSphere(),Kl.copy(r.boundingSphere),Kl.applyMatrix4(a),Ta.copy(e.ray).recast(e.near),(!1!==Kl.containsPoint(Ta.origin)||!(null===Ta.intersectSphere(Kl,jv)||Ta.origin.distanceToSquared(jv)>(e.far-e.near)**2))&&(Wv.copy(a).invert(),Ta.copy(e.ray).applyMatrix4(Wv),(null===r.boundingBox||!1!==Ta.intersectsBox(r.boundingBox))&&this._computeIntersections(e,t,Ta)))}_computeIntersections(e,t,r){let s;const a=this.geometry,c=this.material,d=a.index,p=a.attributes.position,g=a.attributes.uv,v=a.attributes.uv1,b=a.attributes.normal,_=a.groups,M=a.drawRange;if(null!==d)if(Array.isArray(c))for(let w=0,P=_.length;w<P;w++){const R=_[w],I=c[R.materialIndex];for(let j=Math.max(R.start,M.start),Q=Math.min(d.count,Math.min(R.start+R.count,M.start+M.count));j<Q;j+=3)s=Ef(this,I,e,r,g,v,b,d.getX(j),d.getX(j+1),d.getX(j+2)),s&&(s.faceIndex=Math.floor(j/3),s.face.materialIndex=R.materialIndex,t.push(s))}else for(let R=Math.max(0,M.start),I=Math.min(d.count,M.start+M.count);R<I;R+=3)s=Ef(this,c,e,r,g,v,b,d.getX(R),d.getX(R+1),d.getX(R+2)),s&&(s.faceIndex=Math.floor(R/3),t.push(s));else if(void 0!==p)if(Array.isArray(c))for(let w=0,P=_.length;w<P;w++){const R=_[w],I=c[R.materialIndex];for(let j=Math.max(R.start,M.start),Q=Math.min(p.count,Math.min(R.start+R.count,M.start+M.count));j<Q;j+=3)s=Ef(this,I,e,r,g,v,b,j,j+1,j+2),s&&(s.faceIndex=Math.floor(j/3),s.face.materialIndex=R.materialIndex,t.push(s))}else for(let R=Math.max(0,M.start),I=Math.min(p.count,M.start+M.count);R<I;R+=3)s=Ef(this,c,e,r,g,v,b,R,R+1,R+2),s&&(s.faceIndex=Math.floor(R/3),t.push(s))}}function Ef(h,e,t,r,s,a,c,d,p,g){h.getVertexPosition(d,Jl),h.getVertexPosition(p,Ou),h.getVertexPosition(g,Lu);const v=function qv(h,e,t,r,s,a,c,d){let p;if(p=1===e.side?r.intersectTriangle(c,a,s,!0,d):r.intersectTriangle(s,a,c,0===e.side,d),null===p)return null;bm.copy(d),bm.applyMatrix4(h.matrixWorld);const g=t.ray.origin.distanceTo(bm);return g<t.near||g>t.far?null:{distance:g,point:bm.clone(),object:h}}(h,e,t,r,Jl,Ou,Lu,Cc);if(v){s&&(_m.fromBufferAttribute(s,d),Nu.fromBufferAttribute(s,p),Ql.fromBufferAttribute(s,g),v.uv=ws.getInterpolation(Cc,Jl,Ou,Lu,_m,Nu,Ql,new en)),a&&(_m.fromBufferAttribute(a,d),Nu.fromBufferAttribute(a,p),Ql.fromBufferAttribute(a,g),v.uv1=ws.getInterpolation(Cc,Jl,Ou,Lu,_m,Nu,Ql,new en),v.uv2=v.uv1),c&&(Yv.fromBufferAttribute(c,d),Fu.fromBufferAttribute(c,p),xf.fromBufferAttribute(c,g),v.normal=ws.getInterpolation(Cc,Jl,Ou,Lu,Yv,Fu,xf,new de),v.normal.dot(r.direction)>0&&v.normal.multiplyScalar(-1));const b={a:d,b:p,c:g,normal:new de,materialIndex:0};ws.getNormal(Jl,Ou,Lu,b.normal),v.face=b}return v}class To extends Qi{constructor(e=1,t=1,r=1,s=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:s,heightSegments:a,depthSegments:c};const d=this;s=Math.floor(s),a=Math.floor(a),c=Math.floor(c);const p=[],g=[],v=[],b=[];let _=0,M=0;function w(P,R,I,V,k,j,Q,se,oe,_e,q){const ne=j/oe,je=Q/_e,dt=j/2,we=Q/2,Re=se/2,Pe=oe+1,$e=_e+1;let xt=0,wt=0;const At=new de;for(let Ut=0;Ut<$e;Ut++){const pt=Ut*je-we;for(let gt=0;gt<Pe;gt++)At[P]=(gt*ne-dt)*V,At[R]=pt*k,At[I]=Re,g.push(At.x,At.y,At.z),At[P]=0,At[R]=0,At[I]=se>0?1:-1,v.push(At.x,At.y,At.z),b.push(gt/oe),b.push(1-Ut/_e),xt+=1}for(let Ut=0;Ut<_e;Ut++)for(let pt=0;pt<oe;pt++){const _n=_+pt+Pe*(Ut+1),Tn=_+(pt+1)+Pe*(Ut+1),Fn=_+(pt+1)+Pe*Ut;p.push(_+pt+Pe*Ut,_n,Fn),p.push(_n,Tn,Fn),wt+=6}d.addGroup(M,wt,q),M+=wt,_+=xt}w("z","y","x",-1,-1,r,t,e,c,a,0),w("z","y","x",1,-1,r,t,-e,c,a,1),w("x","z","y",1,1,e,r,t,s,c,2),w("x","z","y",1,-1,e,r,-t,s,c,3),w("x","y","z",1,-1,e,t,r,s,a,4),w("x","y","z",-1,-1,e,t,-r,s,a,5),this.setIndex(p),this.setAttribute("position",new Bn(g,3)),this.setAttribute("normal",new Bn(v,3)),this.setAttribute("uv",new Bn(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new To(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Bu(h){const e={};for(const t in h){e[t]={};for(const r in h[t]){const s=h[t][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=s.clone():e[t][r]=Array.isArray(s)?s.slice():s}}return e}function xo(h){const e={};for(let t=0;t<h.length;t++){const r=Bu(h[t]);for(const s in r)e[s]=r[s]}return e}function Em(h){return null===h.getRenderTarget()?h.outputColorSpace:is}const Mf={clone:Bu,merge:xo};class Cl extends al{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Bu(e.uniforms),this.uniformsGroups=function xm(h){const e=[];for(let t=0;t<h.length;t++)e.push(h[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const c=this.uniforms[s].value;t.uniforms[s]=c&&c.isTexture?{type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?{type:"c",value:c.getHex()}:c&&c.isVector2?{type:"v2",value:c.toArray()}:c&&c.isVector3?{type:"v3",value:c.toArray()}:c&&c.isVector4?{type:"v4",value:c.toArray()}:c&&c.isMatrix3?{type:"m3",value:c.toArray()}:c&&c.isMatrix4?{type:"m4",value:c.toArray()}:{value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const s in this.extensions)!0===this.extensions[s]&&(r[s]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class wf extends Co{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Mi,this.projectionMatrix=new Mi,this.projectionMatrixInverse=new Mi,this.coordinateSystem=Xo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Eo extends wf{constructor(e=50,t=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*rs*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*rr*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*rs*Math.atan(Math.tan(.5*rr*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,s,a,c){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*rr*this.fov)/this.zoom,r=2*t,s=this.aspect*r,a=-.5*s;const c=this.view;if(null!==this.view&&this.view.enabled){const p=c.fullWidth,g=c.fullHeight;a+=c.offsetX*s/p,t-=c.offsetY*r/g,s*=c.width/p,r*=c.height/g}const d=this.filmOffset;0!==d&&(a+=e*d/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Sf extends Co{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null;const s=new Eo(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new Eo(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new Eo(-90,1,e,t);c.layers=this.layers,this.add(c);const d=new Eo(-90,1,e,t);d.layers=this.layers,this.add(d);const p=new Eo(-90,1,e,t);p.layers=this.layers,this.add(p);const g=new Eo(-90,1,e,t);g.layers=this.layers,this.add(g)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,s,a,c,d,p]=t;for(const g of t)this.remove(g);if(e===Xo)r.up.set(0,1,0),r.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),d.up.set(0,1,0),d.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);r.up.set(0,-1,0),r.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),d.up.set(0,-1,0),d.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const g of t)this.add(g),g.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,c,d,p,g]=this.children,v=e.getRenderTarget(),b=e.xr.enabled;e.xr.enabled=!1;const _=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,s),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,c),e.setRenderTarget(r,3),e.render(t,d),e.setRenderTarget(r,4),e.render(t,p),r.texture.generateMipmaps=_,e.setRenderTarget(r,5),e.render(t,g),e.setRenderTarget(v),e.xr.enabled=b,r.texture.needsPMREMUpdate=!0}}class ll extends Zo{constructor(e,t,r,s,a,c,d,p,g,v){super(e=void 0!==e?e:[],t=void 0!==t?t:Mr,r,s,a,c,d,p,g,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class kb extends H{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},s=[r,r,r,r,r,r];void 0!==t.encoding&&(vo("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Pr?tr:""),this.texture=new ll(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:pr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r_uniforms={tEquirect:{value:null}},r_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new To(5,5,5),a=new Cl({name:"CubemapFromEquirect",uniforms:Bu(r_uniforms),vertexShader:r_vertexShader,fragmentShader:r_fragmentShader,side:1,blending:0});a.uniforms.tEquirect.value=t;const c=new ms(s,a),d=t.minFilter;return t.minFilter===Ur&&(t.minFilter=pr),new Sf(1,10,this).update(e,c),t.minFilter=d,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,r,s){const a=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,r,s);e.setRenderTarget(a)}}const Cf=new de,Xv=new de,Uu=new Fi;class ha{constructor(e=new de(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,s){return this.normal.set(e,t,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const s=Cf.subVectors(r,t).cross(Xv.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(Cf),s=this.normal.dot(r);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:t.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Uu.getNormalMatrix(e),s=this.coplanarPoint(Cf).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ss=new Sa,Af=new de;class Tf{constructor(e=new ha,t=new ha,r=new ha,s=new ha,a=new ha,c=new ha){this.planes=[e,t,r,s,a,c]}set(e,t,r,s,a,c){const d=this.planes;return d[0].copy(e),d[1].copy(t),d[2].copy(r),d[3].copy(s),d[4].copy(a),d[5].copy(c),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Xo){const r=this.planes,s=e.elements,a=s[0],c=s[1],d=s[2],p=s[3],g=s[4],v=s[5],b=s[6],_=s[7],M=s[8],w=s[9],P=s[10],R=s[11],I=s[12],V=s[13],k=s[14],j=s[15];if(r[0].setComponents(p-a,_-g,R-M,j-I).normalize(),r[1].setComponents(p+a,_+g,R+M,j+I).normalize(),r[2].setComponents(p+c,_+v,R+w,j+V).normalize(),r[3].setComponents(p-c,_-v,R-w,j-V).normalize(),r[4].setComponents(p-d,_-b,R-P,j-k).normalize(),t===Xo)r[5].setComponents(p+d,_+b,R+P,j+k).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(d,b,P,k).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),ss.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),ss.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ss)}intersectsSprite(e){return ss.center.set(0,0,0),ss.radius=.7071067811865476,ss.applyMatrix4(e.matrixWorld),this.intersectsSphere(ss)}intersectsSphere(e){const t=this.planes,r=e.center,s=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const s=t[r];if(Af.x=s.normal.x>0?e.max.x:e.min.x,Af.y=s.normal.y>0?e.max.y:e.min.y,Af.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Af)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Df(){let h=null,e=!1,t=null,r=null;function s(a,c){t(a,c),r=h.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(r=h.requestAnimationFrame(s),e=!0)},stop:function(){h.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){h=a}}}function Ub(h,e){const t=e.isWebGL2,r=new WeakMap;return{get:function c(g){return g.isInterleavedBufferAttribute&&(g=g.data),r.get(g)},remove:function d(g){g.isInterleavedBufferAttribute&&(g=g.data);const v=r.get(g);v&&(h.deleteBuffer(v.buffer),r.delete(g))},update:function p(g,v){if(g.isGLBufferAttribute){const _=r.get(g);return void((!_||_.version<g.version)&&r.set(g,{buffer:g.buffer,type:g.type,bytesPerElement:g.elementSize,version:g.version}))}g.isInterleavedBufferAttribute&&(g=g.data);const b=r.get(g);void 0===b?r.set(g,function s(g,v){const b=g.array,_=g.usage,M=h.createBuffer();let w;if(h.bindBuffer(v,M),h.bufferData(v,b,_),g.onUploadCallback(),b instanceof Float32Array)w=h.FLOAT;else if(b instanceof Uint16Array)if(g.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");w=h.HALF_FLOAT}else w=h.UNSIGNED_SHORT;else if(b instanceof Int16Array)w=h.SHORT;else if(b instanceof Uint32Array)w=h.UNSIGNED_INT;else if(b instanceof Int32Array)w=h.INT;else if(b instanceof Int8Array)w=h.BYTE;else if(b instanceof Uint8Array)w=h.UNSIGNED_BYTE;else{if(!(b instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+b);w=h.UNSIGNED_BYTE}return{buffer:M,type:w,bytesPerElement:b.BYTES_PER_ELEMENT,version:g.version}}(g,v)):b.version<g.version&&(function a(g,v,b){const _=v.array,M=v.updateRange;h.bindBuffer(b,g),-1===M.count?h.bufferSubData(b,0,_):(t?h.bufferSubData(b,M.offset*_.BYTES_PER_ELEMENT,_,M.offset,M.count):h.bufferSubData(b,M.offset*_.BYTES_PER_ELEMENT,_.subarray(M.offset,M.offset+M.count)),M.count=-1),v.onUploadCallback()}(b.buffer,g,v),b.version=g.version)}}}class Tc extends Qi{constructor(e=1,t=1,r=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:s};const a=e/2,c=t/2,d=Math.floor(r),p=Math.floor(s),g=d+1,v=p+1,b=e/d,_=t/p,M=[],w=[],P=[],R=[];for(let I=0;I<v;I++){const V=I*_-c;for(let k=0;k<g;k++)w.push(k*b-a,-V,0),P.push(0,0,1),R.push(k/d),R.push(1-I/p)}for(let I=0;I<p;I++)for(let V=0;V<d;V++){const j=V+g*(I+1),Q=V+1+g*(I+1),se=V+1+g*I;M.push(V+g*I,j,se),M.push(j,Q,se)}this.setIndex(M),this.setAttribute("position",new Bn(w,3)),this.setAttribute("normal",new Bn(P,3)),this.setAttribute("uv",new Bn(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tc(e.width,e.height,e.widthSegments,e.heightSegments)}}const Vi={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},kn={common:{diffuse:{value:new ei(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Fi},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Fi}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Fi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Fi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Fi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Fi},normalScale:{value:new en(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Fi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Fi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Fi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Fi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ei(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ei(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0},uvTransform:{value:new Fi}},sprite:{diffuse:{value:new ei(16777215)},opacity:{value:1},center:{value:new en(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Fi},alphaMap:{value:null},alphaMapTransform:{value:new Fi},alphaTest:{value:0}}},Al={basic:{uniforms:xo([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.fog]),vertexShader:Vi.meshbasic_vert,fragmentShader:Vi.meshbasic_frag},lambert:{uniforms:xo([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,kn.lights,{emissive:{value:new ei(0)}}]),vertexShader:Vi.meshlambert_vert,fragmentShader:Vi.meshlambert_frag},phong:{uniforms:xo([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,kn.lights,{emissive:{value:new ei(0)},specular:{value:new ei(1118481)},shininess:{value:30}}]),vertexShader:Vi.meshphong_vert,fragmentShader:Vi.meshphong_frag},standard:{uniforms:xo([kn.common,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.roughnessmap,kn.metalnessmap,kn.fog,kn.lights,{emissive:{value:new ei(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag},toon:{uniforms:xo([kn.common,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.gradientmap,kn.fog,kn.lights,{emissive:{value:new ei(0)}}]),vertexShader:Vi.meshtoon_vert,fragmentShader:Vi.meshtoon_frag},matcap:{uniforms:xo([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,{matcap:{value:null}}]),vertexShader:Vi.meshmatcap_vert,fragmentShader:Vi.meshmatcap_frag},points:{uniforms:xo([kn.points,kn.fog]),vertexShader:Vi.points_vert,fragmentShader:Vi.points_frag},dashed:{uniforms:xo([kn.common,kn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vi.linedashed_vert,fragmentShader:Vi.linedashed_frag},depth:{uniforms:xo([kn.common,kn.displacementmap]),vertexShader:Vi.depth_vert,fragmentShader:Vi.depth_frag},normal:{uniforms:xo([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,{opacity:{value:1}}]),vertexShader:Vi.meshnormal_vert,fragmentShader:Vi.meshnormal_frag},sprite:{uniforms:xo([kn.sprite,kn.fog]),vertexShader:Vi.sprite_vert,fragmentShader:Vi.sprite_frag},background:{uniforms:{uvTransform:{value:new Fi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Vi.background_vert,fragmentShader:Vi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Vi.backgroundCube_vert,fragmentShader:Vi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Vi.cube_vert,fragmentShader:Vi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vi.equirect_vert,fragmentShader:Vi.equirect_frag},distanceRGBA:{uniforms:xo([kn.common,kn.displacementmap,{referencePosition:{value:new de},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vi.distanceRGBA_vert,fragmentShader:Vi.distanceRGBA_frag},shadow:{uniforms:xo([kn.lights,kn.fog,{color:{value:new ei(0)},opacity:{value:1}}]),vertexShader:Vi.shadow_vert,fragmentShader:Vi.shadow_frag}};Al.physical={uniforms:xo([Al.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Fi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Fi},clearcoatNormalScale:{value:new en(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Fi},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Fi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Fi},sheen:{value:0},sheenColor:{value:new ei(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Fi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Fi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Fi},transmissionSamplerSize:{value:new en},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Fi},attenuationDistance:{value:0},attenuationColor:{value:new ei(0)},specularColor:{value:new ei(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Fi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Fi},anisotropyVector:{value:new en},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Fi}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag};const Lc={r:0,b:0,g:0};function gy(h,e,t,r,s,a,c){const d=new ei(0);let g,v,p=!0===a?0:1,b=null,_=0,M=null;function P(R,I){R.getRGB(Lc,Em(h)),r.buffers.color.setClear(Lc.r,Lc.g,Lc.b,I,c)}return{getClearColor:function(){return d},setClearColor:function(R,I=1){d.set(R),p=I,P(d,p)},getClearAlpha:function(){return p},setClearAlpha:function(R){p=R,P(d,p)},render:function w(R,I){let V=!1,k=!0===I.isScene?I.background:null;k&&k.isTexture&&(k=(I.backgroundBlurriness>0?t:e).get(k)),null===k?P(d,p):k&&k.isColor&&(P(k,1),V=!0);const j=h.xr.getEnvironmentBlendMode();"additive"===j?r.buffers.color.setClear(0,0,0,1,c):"alpha-blend"===j&&r.buffers.color.setClear(0,0,0,0,c),(h.autoClear||V)&&h.clear(h.autoClearColor,h.autoClearDepth,h.autoClearStencil),k&&(k.isCubeTexture||k.mapping===ur)?(void 0===v&&(v=new ms(new To(1,1,1),new Cl({name:"BackgroundCubeMaterial",uniforms:Bu(Al.backgroundCube.uniforms),vertexShader:Al.backgroundCube.vertexShader,fragmentShader:Al.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(Q,se,oe){this.matrixWorld.copyPosition(oe.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(v)),v.material.uniforms.envMap.value=k,v.material.uniforms.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=I.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,v.material.toneMapped=k.colorSpace!==tr,(b!==k||_!==k.version||M!==h.toneMapping)&&(v.material.needsUpdate=!0,b=k,_=k.version,M=h.toneMapping),v.layers.enableAll(),R.unshift(v,v.geometry,v.material,0,0,null)):k&&k.isTexture&&(void 0===g&&(g=new ms(new Tc(2,2),new Cl({name:"BackgroundMaterial",uniforms:Bu(Al.background.uniforms),vertexShader:Al.background.vertexShader,fragmentShader:Al.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(g)),g.material.uniforms.t2D.value=k,g.material.uniforms.backgroundIntensity.value=I.backgroundIntensity,g.material.toneMapped=k.colorSpace!==tr,!0===k.matrixAutoUpdate&&k.updateMatrix(),g.material.uniforms.uvTransform.value.copy(k.matrix),(b!==k||_!==k.version||M!==h.toneMapping)&&(g.material.needsUpdate=!0,b=k,_=k.version,M=h.toneMapping),g.layers.enableAll(),R.unshift(g,g.geometry,g.material,0,0,null))}}}function Tx(h,e,t,r){const s=h.getParameter(h.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),c=r.isWebGL2||null!==a,d={},p=R(null);let g=p,v=!1;function M(Re){return r.isWebGL2?h.bindVertexArray(Re):a.bindVertexArrayOES(Re)}function w(Re){return r.isWebGL2?h.deleteVertexArray(Re):a.deleteVertexArrayOES(Re)}function R(Re){const Pe=[],$e=[],xt=[];for(let wt=0;wt<s;wt++)Pe[wt]=0,$e[wt]=0,xt[wt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Pe,enabledAttributes:$e,attributeDivisors:xt,object:Re,attributes:{},index:null}}function k(){const Re=g.newAttributes;for(let Pe=0,$e=Re.length;Pe<$e;Pe++)Re[Pe]=0}function j(Re){Q(Re,0)}function Q(Re,Pe){const xt=g.enabledAttributes,wt=g.attributeDivisors;g.newAttributes[Re]=1,0===xt[Re]&&(h.enableVertexAttribArray(Re),xt[Re]=1),wt[Re]!==Pe&&((r.isWebGL2?h:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Re,Pe),wt[Re]=Pe)}function se(){const Re=g.newAttributes,Pe=g.enabledAttributes;for(let $e=0,xt=Pe.length;$e<xt;$e++)Pe[$e]!==Re[$e]&&(h.disableVertexAttribArray($e),Pe[$e]=0)}function oe(Re,Pe,$e,xt,wt,At,Ut){!0===Ut?h.vertexAttribIPointer(Re,Pe,$e,wt,At):h.vertexAttribPointer(Re,Pe,$e,xt,wt,At)}function dt(){we(),v=!0,g!==p&&(g=p,M(g.object))}function we(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function b(Re,Pe,$e,xt,wt){let At=!1;if(c){const Ut=function P(Re,Pe,$e){const xt=!0===$e.wireframe;let wt=d[Re.id];void 0===wt&&(wt={},d[Re.id]=wt);let At=wt[Pe.id];void 0===At&&(At={},wt[Pe.id]=At);let Ut=At[xt];return void 0===Ut&&(Ut=R(function _(){return r.isWebGL2?h.createVertexArray():a.createVertexArrayOES()}()),At[xt]=Ut),Ut}(xt,$e,Pe);g!==Ut&&(g=Ut,M(g.object)),At=function I(Re,Pe,$e,xt){const wt=g.attributes,At=Pe.attributes;let Ut=0;const pt=$e.getAttributes();for(const gt in pt)if(pt[gt].location>=0){const Tn=wt[gt];let Fn=At[gt];if(void 0===Fn&&("instanceMatrix"===gt&&Re.instanceMatrix&&(Fn=Re.instanceMatrix),"instanceColor"===gt&&Re.instanceColor&&(Fn=Re.instanceColor)),void 0===Tn||Tn.attribute!==Fn||Fn&&Tn.data!==Fn.data)return!0;Ut++}return g.attributesNum!==Ut||g.index!==xt}(Re,xt,$e,wt),At&&function V(Re,Pe,$e,xt){const wt={},At=Pe.attributes;let Ut=0;const pt=$e.getAttributes();for(const gt in pt)if(pt[gt].location>=0){let Tn=At[gt];void 0===Tn&&("instanceMatrix"===gt&&Re.instanceMatrix&&(Tn=Re.instanceMatrix),"instanceColor"===gt&&Re.instanceColor&&(Tn=Re.instanceColor));const Fn={};Fn.attribute=Tn,Tn&&Tn.data&&(Fn.data=Tn.data),wt[gt]=Fn,Ut++}g.attributes=wt,g.attributesNum=Ut,g.index=xt}(Re,xt,$e,wt)}else{const Ut=!0===Pe.wireframe;(g.geometry!==xt.id||g.program!==$e.id||g.wireframe!==Ut)&&(g.geometry=xt.id,g.program=$e.id,g.wireframe=Ut,At=!0)}null!==wt&&t.update(wt,h.ELEMENT_ARRAY_BUFFER),(At||v)&&(v=!1,function _e(Re,Pe,$e,xt){if(!1===r.isWebGL2&&(Re.isInstancedMesh||xt.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;k();const wt=xt.attributes,At=$e.getAttributes(),Ut=Pe.defaultAttributeValues;for(const pt in At){const gt=At[pt];if(gt.location>=0){let _n=wt[pt];if(void 0===_n&&("instanceMatrix"===pt&&Re.instanceMatrix&&(_n=Re.instanceMatrix),"instanceColor"===pt&&Re.instanceColor&&(_n=Re.instanceColor)),void 0!==_n){const Tn=_n.normalized,Fn=_n.itemSize,Xn=t.get(_n);if(void 0===Xn)continue;const qn=Xn.buffer,ri=Xn.type,Gi=Xn.bytesPerElement,hr=!0===r.isWebGL2&&(ri===h.INT||ri===h.UNSIGNED_INT||1013===_n.gpuType);if(_n.isInterleavedBufferAttribute){const pi=_n.data,Ve=pi.stride,Sn=_n.offset;if(pi.isInstancedInterleavedBuffer){for(let tn=0;tn<gt.locationSize;tn++)Q(gt.location+tn,pi.meshPerAttribute);!0!==Re.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=pi.meshPerAttribute*pi.count)}else for(let tn=0;tn<gt.locationSize;tn++)j(gt.location+tn);h.bindBuffer(h.ARRAY_BUFFER,qn);for(let tn=0;tn<gt.locationSize;tn++)oe(gt.location+tn,Fn/gt.locationSize,ri,Tn,Ve*Gi,(Sn+Fn/gt.locationSize*tn)*Gi,hr)}else{if(_n.isInstancedBufferAttribute){for(let pi=0;pi<gt.locationSize;pi++)Q(gt.location+pi,_n.meshPerAttribute);!0!==Re.isInstancedMesh&&void 0===xt._maxInstanceCount&&(xt._maxInstanceCount=_n.meshPerAttribute*_n.count)}else for(let pi=0;pi<gt.locationSize;pi++)j(gt.location+pi);h.bindBuffer(h.ARRAY_BUFFER,qn);for(let pi=0;pi<gt.locationSize;pi++)oe(gt.location+pi,Fn/gt.locationSize,ri,Tn,Fn*Gi,Fn/gt.locationSize*pi*Gi,hr)}}else if(void 0!==Ut){const Tn=Ut[pt];if(void 0!==Tn)switch(Tn.length){case 2:h.vertexAttrib2fv(gt.location,Tn);break;case 3:h.vertexAttrib3fv(gt.location,Tn);break;case 4:h.vertexAttrib4fv(gt.location,Tn);break;default:h.vertexAttrib1fv(gt.location,Tn)}}}}se()}(Re,Pe,$e,xt),null!==wt&&h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,t.get(wt).buffer))},reset:dt,resetDefaultState:we,dispose:function q(){dt();for(const Re in d){const Pe=d[Re];for(const $e in Pe){const xt=Pe[$e];for(const wt in xt)w(xt[wt].object),delete xt[wt];delete Pe[$e]}delete d[Re]}},releaseStatesOfGeometry:function ne(Re){if(void 0===d[Re.id])return;const Pe=d[Re.id];for(const $e in Pe){const xt=Pe[$e];for(const wt in xt)w(xt[wt].object),delete xt[wt];delete Pe[$e]}delete d[Re.id]},releaseStatesOfProgram:function je(Re){for(const Pe in d){const $e=d[Pe];if(void 0===$e[Re.id])continue;const xt=$e[Re.id];for(const wt in xt)w(xt[wt].object),delete xt[wt];delete $e[Re.id]}},initAttributes:k,enableAttribute:j,disableUnusedAttributes:se}}function vy(h,e,t,r){const s=r.isWebGL2;let a;this.setMode=function c(g){a=g},this.render=function d(g,v){h.drawArrays(a,g,v),t.update(v,a,1)},this.renderInstances=function p(g,v,b){if(0===b)return;let _,M;if(s)_=h,M="drawArraysInstanced";else if(_=e.get("ANGLE_instanced_arrays"),M="drawArraysInstancedANGLE",null===_)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[M](a,g,v,b),t.update(v,a,b)}}function MC(h,e,t){let r;function a(oe){if("highp"===oe){if(h.getShaderPrecisionFormat(h.VERTEX_SHADER,h.HIGH_FLOAT).precision>0&&h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT).precision>0)return"highp";oe="mediump"}return"mediump"===oe&&h.getShaderPrecisionFormat(h.VERTEX_SHADER,h.MEDIUM_FLOAT).precision>0&&h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const c=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===h.constructor.name;let d=void 0!==t.precision?t.precision:"highp";const p=a(d);p!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",p,"instead."),d=p);const g=c||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,b=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS),_=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS),M=h.getParameter(h.MAX_TEXTURE_SIZE),w=h.getParameter(h.MAX_CUBE_MAP_TEXTURE_SIZE),P=h.getParameter(h.MAX_VERTEX_ATTRIBS),R=h.getParameter(h.MAX_VERTEX_UNIFORM_VECTORS),I=h.getParameter(h.MAX_VARYING_VECTORS),V=h.getParameter(h.MAX_FRAGMENT_UNIFORM_VECTORS),k=_>0,j=c||e.has("OES_texture_float");return{isWebGL2:c,drawBuffers:g,getMaxAnisotropy:function s(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const oe=e.get("EXT_texture_filter_anisotropic");r=h.getParameter(oe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:d,logarithmicDepthBuffer:v,maxTextures:b,maxVertexTextures:_,maxTextureSize:M,maxCubemapSize:w,maxAttributes:P,maxVertexUniforms:R,maxVaryings:I,maxFragmentUniforms:V,vertexTextures:k,floatFragmentTextures:j,floatVertexTextures:k&&j,maxSamples:c?h.getParameter(h.MAX_SAMPLES):0}}function yy(h){const e=this;let t=null,r=0,s=!1,a=!1;const c=new ha,d=new Fi,p={value:null,needsUpdate:!1};function v(b,_,M,w){const P=null!==b?b.length:0;let R=null;if(0!==P){if(R=p.value,!0!==w||null===R){const I=M+4*P,V=_.matrixWorldInverse;d.getNormalMatrix(V),(null===R||R.length<I)&&(R=new Float32Array(I));for(let k=0,j=M;k!==P;++k,j+=4)c.copy(b[k]).applyMatrix4(V,d),c.normal.toArray(R,j),R[j+3]=c.constant}p.value=R,p.needsUpdate=!0}return e.numPlanes=P,e.numIntersection=0,R}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(b,_){const M=0!==b.length||_||0!==r||s;return s=_,r=b.length,M},this.beginShadows=function(){a=!0,v(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(b,_){t=v(b,_,0)},this.setState=function(b,_,M){const w=b.clippingPlanes,P=b.clipIntersection,R=b.clipShadows,I=h.get(b);if(!s||null===w||0===w.length||a&&!R)a?v(null):function g(){p.value!==t&&(p.value=t,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}();else{const V=a?0:r,k=4*V;let j=I.clippingState||null;p.value=j,j=v(w,_,k,M);for(let Q=0;Q!==k;++Q)j[Q]=t[Q];I.clippingState=j,this.numIntersection=P?this.numPlanes:0,this.numPlanes+=V}}}function wC(h){let e=new WeakMap;function t(c,d){return 303===d?c.mapping=Mr:304===d&&(c.mapping=Or),c}function s(c){const d=c.target;d.removeEventListener("dispose",s);const p=e.get(d);void 0!==p&&(e.delete(d),p.dispose())}return{get:function r(c){if(c&&c.isTexture&&!1===c.isRenderTargetTexture){const d=c.mapping;if(303===d||304===d){if(e.has(c))return t(e.get(c).texture,c.mapping);{const p=c.image;if(p&&p.height>0){const g=new kb(p.height/2);return g.fromEquirectangularTexture(h,c),e.set(c,g),c.addEventListener("dispose",s),t(g.texture,c.mapping)}return null}}}return c},dispose:function a(){e=new WeakMap}}}class Um extends wf{constructor(e=-1,t=1,r=1,s=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=s,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,s,a,c){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=r-e,c=r+e,d=s+t,p=s-t;if(null!==this.view&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=g*this.view.offsetX,c=a+g*this.view.width,d-=v*this.view.offsetY,p=d-v*this.view.height}this.projectionMatrix.makeOrthographic(a,c,d,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Vf=[.125,.215,.35,.446,.526,.582],_y=new Um,zf=new ei;let by=null;const Ju=(1+Math.sqrt(5))/2,Zd=1/Ju,Dx=[new de(1,1,1),new de(-1,1,1),new de(1,1,-1),new de(-1,1,-1),new de(0,Ju,Zd),new de(0,Ju,-Zd),new de(Zd,0,Ju),new de(-Zd,0,Ju),new de(Ju,Zd,0),new de(-Ju,Zd,0)];class Ix{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,s=100){by=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,s,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Hm(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=zm(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(by),e.scissorTest=!1,Nc(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Mr||e.mapping===Or?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),by=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:pr,minFilter:pr,generateMipmaps:!1,type:mt,format:Ui,colorSpace:is,depthBuffer:!1},s=Kd(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Kd(e,t,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Rx(h){const e=[],t=[],r=[];let s=h;const a=h-4+1+Vf.length;for(let c=0;c<a;c++){const d=Math.pow(2,s);t.push(d);let p=1/d;c>h-4?p=Vf[c-h+4-1]:0===c&&(p=0),r.push(p);const g=1/(d-2),v=-g,b=1+g,_=[v,v,b,v,b,b,v,v,b,b,v,b],M=6,w=6,P=3,R=2,I=1,V=new Float32Array(P*w*M),k=new Float32Array(R*w*M),j=new Float32Array(I*w*M);for(let se=0;se<M;se++){const oe=se%3*2/3-1,_e=se>2?0:-1;V.set([oe,_e,0,oe+2/3,_e,0,oe+2/3,_e+1,0,oe,_e,0,oe+2/3,_e+1,0,oe,_e+1,0],P*w*se),k.set(_,R*w*se),j.set([se,se,se,se,se,se],I*w*se)}const Q=new Qi;Q.setAttribute("position",new K(V,P)),Q.setAttribute("uv",new K(k,R)),Q.setAttribute("faceIndex",new K(j,I)),e.push(Q),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:r}}(a)),this._blurMaterial=function Vm(h,e,t){const r=new Float32Array(20),s=new de(0,1,0);return new Cl({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${h}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return s}_compileMaterial(e){const t=new ms(this._lodPlanes[0],e);this._renderer.compile(t,_y)}_sceneToCubeUV(e,t,r,s){const d=new Eo(90,1,t,r),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,b=v.autoClear,_=v.toneMapping;v.getClearColor(zf),v.toneMapping=$n,v.autoClear=!1;const M=new Sl({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),w=new ms(new To,M);let P=!1;const R=e.background;R?R.isColor&&(M.color.copy(R),e.background=null,P=!0):(M.color.copy(zf),P=!0);for(let I=0;I<6;I++){const V=I%3;0===V?(d.up.set(0,p[I],0),d.lookAt(g[I],0,0)):1===V?(d.up.set(0,0,p[I]),d.lookAt(0,g[I],0)):(d.up.set(0,p[I],0),d.lookAt(0,0,g[I]));const k=this._cubeSize;Nc(s,V*k,I>2?k:0,k,k),v.setRenderTarget(s),P&&v.render(w,d),v.render(e,d)}w.geometry.dispose(),w.material.dispose(),v.toneMapping=_,v.autoClear=b,e.background=R}_textureToCubeUV(e,t){const r=this._renderer,s=e.mapping===Mr||e.mapping===Or;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=Hm()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=zm());const a=s?this._cubemapMaterial:this._equirectMaterial,c=new ms(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const p=this._cubeSize;Nc(t,0,0,3*p,2*p),r.setRenderTarget(t),r.render(c,_y)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,a,Dx[(s-1)%Dx.length])}t.autoClear=r}_blur(e,t,r,s,a){const c=this._pingPongRenderTarget;this._halfBlur(e,c,t,r,s,"latitudinal",a),this._halfBlur(c,e,r,r,s,"longitudinal",a)}_halfBlur(e,t,r,s,a,c,d){const p=this._renderer,g=this._blurMaterial;"latitudinal"!==c&&"longitudinal"!==c&&console.error("blur direction must be either latitudinal or longitudinal!");const b=new ms(this._lodPlanes[s],g),_=g.uniforms,M=this._sizeLods[r]-1,w=isFinite(a)?Math.PI/(2*M):2*Math.PI/39,P=a/w,R=isFinite(a)?1+Math.floor(3*P):20;R>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${R} samples when the maximum is set to 20`);const I=[];let V=0;for(let oe=0;oe<20;++oe){const _e=oe/P,q=Math.exp(-_e*_e/2);I.push(q),0===oe?V+=q:oe<R&&(V+=2*q)}for(let oe=0;oe<I.length;oe++)I[oe]=I[oe]/V;_.envMap.value=e.texture,_.samples.value=R,_.weights.value=I,_.latitudinal.value="latitudinal"===c,d&&(_.poleAxis.value=d);const{_lodMax:k}=this;_.dTheta.value=w,_.mipInt.value=k-r;const j=this._sizeLods[s];Nc(t,3*j*(s>k-4?s-k+4:0),4*(this._cubeSize-j),3*j,2*j),p.setRenderTarget(t),p.render(b,_y)}}function Kd(h,e,t){const r=new H(h,e,t);return r.texture.mapping=ur,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Nc(h,e,t,r,s){h.viewport.set(e,t,r,s),h.scissor.set(e,t,r,s)}function zm(){return new Cl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Hm(){return new Cl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Px(h){let e=new WeakMap,t=null;function a(d){const p=d.target;p.removeEventListener("dispose",a);const g=e.get(p);void 0!==g&&(e.delete(p),g.dispose())}return{get:function r(d){if(d&&d.isTexture){const p=d.mapping,g=303===p||304===p,v=p===Mr||p===Or;if(g||v){if(d.isRenderTargetTexture&&!0===d.needsPMREMUpdate){d.needsPMREMUpdate=!1;let b=e.get(d);return null===t&&(t=new Ix(h)),b=g?t.fromEquirectangular(d,b):t.fromCubemap(d,b),e.set(d,b),b.texture}if(e.has(d))return e.get(d).texture;{const b=d.image;if(g&&b&&b.height>0||v&&b&&function s(d){let p=0;for(let v=0;v<6;v++)void 0!==d[v]&&p++;return 6===p}(b)){null===t&&(t=new Ix(h));const _=g?t.fromEquirectangular(d):t.fromCubemap(d);return e.set(d,_),d.addEventListener("dispose",a),_.texture}return null}}}return d},dispose:function c(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function xy(h){const e={};function t(r){if(void 0!==e[r])return e[r];let s;switch(r){case"WEBGL_depth_texture":s=h.getExtension("WEBGL_depth_texture")||h.getExtension("MOZ_WEBGL_depth_texture")||h.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=h.getExtension("WEBGL_compressed_texture_s3tc")||h.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=h.getExtension("WEBGL_compressed_texture_pvrtc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=h.getExtension(r)}return e[r]=s,s}return{has:function(r){return null!==t(r)},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const s=t(r);return null===s&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),s}}}function Ey(h,e,t,r){const s={},a=new WeakMap;function c(b){const _=b.target;null!==_.index&&e.remove(_.index);for(const w in _.attributes)e.remove(_.attributes[w]);for(const w in _.morphAttributes){const P=_.morphAttributes[w];for(let R=0,I=P.length;R<I;R++)e.remove(P[R])}_.removeEventListener("dispose",c),delete s[_.id];const M=a.get(_);M&&(e.remove(M),a.delete(_)),r.releaseStatesOfGeometry(_),!0===_.isInstancedBufferGeometry&&delete _._maxInstanceCount,t.memory.geometries--}function g(b){const _=[],M=b.index,w=b.attributes.position;let P=0;if(null!==M){const V=M.array;P=M.version;for(let k=0,j=V.length;k<j;k+=3){const Q=V[k+0],se=V[k+1],oe=V[k+2];_.push(Q,se,se,oe,oe,Q)}}else{if(void 0===w)return;P=w.version;for(let k=0,j=w.array.length/3-1;k<j;k+=3){const Q=k+0,se=k+1,oe=k+2;_.push(Q,se,se,oe,oe,Q)}}const R=new(oa(_)?jr:Ln)(_,1);R.version=P;const I=a.get(b);I&&e.remove(I),a.set(b,R)}return{get:function d(b,_){return!0===s[_.id]||(_.addEventListener("dispose",c),s[_.id]=!0,t.memory.geometries++),_},update:function p(b){const _=b.attributes;for(const w in _)e.update(_[w],h.ARRAY_BUFFER);const M=b.morphAttributes;for(const w in M){const P=M[w];for(let R=0,I=P.length;R<I;R++)e.update(P[R],h.ARRAY_BUFFER)}},getWireframeAttribute:function v(b){const _=a.get(b);if(_){const M=b.index;null!==M&&_.version<M.version&&g(b)}else g(b);return a.get(b)}}}function Hf(h,e,t,r){const s=r.isWebGL2;let a,d,p;this.setMode=function c(_){a=_},this.setIndex=function g(_){d=_.type,p=_.bytesPerElement},this.render=function v(_,M){h.drawElements(a,M,d,_*p),t.update(M,a,1)},this.renderInstances=function b(_,M,w){if(0===w)return;let P,R;if(s)P=h,R="drawElementsInstanced";else if(P=e.get("ANGLE_instanced_arrays"),R="drawElementsInstancedANGLE",null===P)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");P[R](a,M,d,_*p,w),t.update(M,a,w)}}function $f(h){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function r(a,c,d){switch(t.calls++,c){case h.TRIANGLES:t.triangles+=d*(a/3);break;case h.LINES:t.lines+=d*(a/2);break;case h.LINE_STRIP:t.lines+=d*(a-1);break;case h.LINE_LOOP:t.lines+=d*a;break;case h.POINTS:t.points+=d*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c)}}}}function Gf(h,e){return h[0]-e[0]}function Ox(h,e){return Math.abs(e[1])-Math.abs(h[1])}function Lx(h,e,t){const r={},s=new Float32Array(8),a=new WeakMap,c=new Br,d=[];for(let g=0;g<8;g++)d[g]=[g,0];return{update:function p(g,v,b){const _=g.morphTargetInfluences;if(!0===e.isWebGL2){const M=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,w=void 0!==M?M.length:0;let P=a.get(v);if(void 0===P||P.count!==w){let Re=function(){dt.dispose(),a.delete(v),v.removeEventListener("dispose",Re)};void 0!==P&&P.texture.dispose();const V=void 0!==v.morphAttributes.position,k=void 0!==v.morphAttributes.normal,j=void 0!==v.morphAttributes.color,Q=v.morphAttributes.position||[],se=v.morphAttributes.normal||[],oe=v.morphAttributes.color||[];let _e=0;!0===V&&(_e=1),!0===k&&(_e=2),!0===j&&(_e=3);let q=v.attributes.position.count*_e,ne=1;q>e.maxTextureSize&&(ne=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const je=new Float32Array(q*ne*4*w),dt=new Ee(je,q,ne,w);dt.type=ke,dt.needsUpdate=!0;const we=4*_e;for(let Pe=0;Pe<w;Pe++){const $e=Q[Pe],xt=se[Pe],wt=oe[Pe],At=q*ne*4*Pe;for(let Ut=0;Ut<$e.count;Ut++){const pt=Ut*we;!0===V&&(c.fromBufferAttribute($e,Ut),je[At+pt+0]=c.x,je[At+pt+1]=c.y,je[At+pt+2]=c.z,je[At+pt+3]=0),!0===k&&(c.fromBufferAttribute(xt,Ut),je[At+pt+4]=c.x,je[At+pt+5]=c.y,je[At+pt+6]=c.z,je[At+pt+7]=0),!0===j&&(c.fromBufferAttribute(wt,Ut),je[At+pt+8]=c.x,je[At+pt+9]=c.y,je[At+pt+10]=c.z,je[At+pt+11]=4===wt.itemSize?c.w:1)}}P={count:w,texture:dt,size:new en(q,ne)},a.set(v,P),v.addEventListener("dispose",Re)}let R=0;for(let V=0;V<_.length;V++)R+=_[V];const I=v.morphTargetsRelative?1:1-R;b.getUniforms().setValue(h,"morphTargetBaseInfluence",I),b.getUniforms().setValue(h,"morphTargetInfluences",_),b.getUniforms().setValue(h,"morphTargetsTexture",P.texture,t),b.getUniforms().setValue(h,"morphTargetsTextureSize",P.size)}else{const M=void 0===_?0:_.length;let w=r[v.id];if(void 0===w||w.length!==M){w=[];for(let k=0;k<M;k++)w[k]=[k,0];r[v.id]=w}for(let k=0;k<M;k++){const j=w[k];j[0]=k,j[1]=_[k]}w.sort(Ox);for(let k=0;k<8;k++)k<M&&w[k][1]?(d[k][0]=w[k][0],d[k][1]=w[k][1]):(d[k][0]=Number.MAX_SAFE_INTEGER,d[k][1]=0);d.sort(Gf);const P=v.morphAttributes.position,R=v.morphAttributes.normal;let I=0;for(let k=0;k<8;k++){const j=d[k],Q=j[0],se=j[1];Q!==Number.MAX_SAFE_INTEGER&&se?(P&&v.getAttribute("morphTarget"+k)!==P[Q]&&v.setAttribute("morphTarget"+k,P[Q]),R&&v.getAttribute("morphNormal"+k)!==R[Q]&&v.setAttribute("morphNormal"+k,R[Q]),s[k]=se,I+=se):(P&&!0===v.hasAttribute("morphTarget"+k)&&v.deleteAttribute("morphTarget"+k),R&&!0===v.hasAttribute("morphNormal"+k)&&v.deleteAttribute("morphNormal"+k),s[k]=0)}const V=v.morphTargetsRelative?1:1-I;b.getUniforms().setValue(h,"morphTargetBaseInfluence",V),b.getUniforms().setValue(h,"morphTargetInfluences",s)}}}}function Nx(h,e,t,r){let s=new WeakMap;function d(p){const g=p.target;g.removeEventListener("dispose",d),t.remove(g.instanceMatrix),null!==g.instanceColor&&t.remove(g.instanceColor)}return{update:function a(p){const g=r.render.frame,b=e.get(p,p.geometry);if(s.get(b)!==g&&(e.update(b),s.set(b,g)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",d)&&p.addEventListener("dispose",d),s.get(p)!==g&&(t.update(p.instanceMatrix,h.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,h.ARRAY_BUFFER),s.set(p,g))),p.isSkinnedMesh){const _=p.skeleton;s.get(_)!==g&&(_.update(),s.set(_,g))}return b},dispose:function c(){s=new WeakMap}}}const $m=new Zo,Wf=new Ee,My=new ce,wy=new ll,Sy=[],Gm=[],Cy=new Float32Array(16),Ay=new Float32Array(9),$o=new Float32Array(4);function ec(h,e,t){const r=h[0];if(r<=0||r>0)return h;const s=e*t;let a=Sy[s];if(void 0===a&&(a=new Float32Array(s),Sy[s]=a),0!==e){r.toArray(a,0);for(let c=1,d=0;c!==e;++c)d+=t,h[c].toArray(a,d)}return a}function Ys(h,e){if(h.length!==e.length)return!1;for(let t=0,r=h.length;t<r;t++)if(h[t]!==e[t])return!1;return!0}function Bs(h,e){for(let t=0,r=e.length;t<r;t++)h[t]=e[t]}function co(h,e){let t=Gm[e];void 0===t&&(t=new Int32Array(e),Gm[e]=t);for(let r=0;r!==e;++r)t[r]=h.allocateTextureUnit();return t}function Jd(h,e){const t=this.cache;t[0]!==e&&(h.uniform1f(this.addr,e),t[0]=e)}function Ty(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(h.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ys(t,e))return;h.uniform2fv(this.addr,e),Bs(t,e)}}function Dy(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(h.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(h.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ys(t,e))return;h.uniform3fv(this.addr,e),Bs(t,e)}}function Fx(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(h.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ys(t,e))return;h.uniform4fv(this.addr,e),Bs(t,e)}}function Iy(h,e){const t=this.cache,r=e.elements;if(void 0===r){if(Ys(t,e))return;h.uniformMatrix2fv(this.addr,!1,e),Bs(t,e)}else{if(Ys(t,r))return;$o.set(r),h.uniformMatrix2fv(this.addr,!1,$o),Bs(t,r)}}function Bx(h,e){const t=this.cache,r=e.elements;if(void 0===r){if(Ys(t,e))return;h.uniformMatrix3fv(this.addr,!1,e),Bs(t,e)}else{if(Ys(t,r))return;Ay.set(r),h.uniformMatrix3fv(this.addr,!1,Ay),Bs(t,r)}}function Ry(h,e){const t=this.cache,r=e.elements;if(void 0===r){if(Ys(t,e))return;h.uniformMatrix4fv(this.addr,!1,e),Bs(t,e)}else{if(Ys(t,r))return;Cy.set(r),h.uniformMatrix4fv(this.addr,!1,Cy),Bs(t,r)}}function kx(h,e){const t=this.cache;t[0]!==e&&(h.uniform1i(this.addr,e),t[0]=e)}function Py(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(h.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ys(t,e))return;h.uniform2iv(this.addr,e),Bs(t,e)}}function Ux(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(h.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ys(t,e))return;h.uniform3iv(this.addr,e),Bs(t,e)}}function Vx(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(h.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ys(t,e))return;h.uniform4iv(this.addr,e),Bs(t,e)}}function Wm(h,e){const t=this.cache;t[0]!==e&&(h.uniform1ui(this.addr,e),t[0]=e)}function jm(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(h.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ys(t,e))return;h.uniform2uiv(this.addr,e),Bs(t,e)}}function zx(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(h.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ys(t,e))return;h.uniform3uiv(this.addr,e),Bs(t,e)}}function Qd(h,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(h.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ys(t,e))return;h.uniform4uiv(this.addr,e),Bs(t,e)}}function Hx(h,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(h.uniform1i(this.addr,s),r[0]=s),t.setTexture2D(e||$m,s)}function $x(h,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(h.uniform1i(this.addr,s),r[0]=s),t.setTexture3D(e||My,s)}function Oy(h,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(h.uniform1i(this.addr,s),r[0]=s),t.setTextureCube(e||wy,s)}function Ly(h,e,t){const r=this.cache,s=t.allocateTextureUnit();r[0]!==s&&(h.uniform1i(this.addr,s),r[0]=s),t.setTexture2DArray(e||Wf,s)}function Qu(h,e){h.uniform1fv(this.addr,e)}function jf(h,e){const t=ec(e,this.size,2);h.uniform2fv(this.addr,t)}function Fy(h,e){const t=ec(e,this.size,3);h.uniform3fv(this.addr,t)}function Ym(h,e){const t=ec(e,this.size,4);h.uniform4fv(this.addr,t)}function Yf(h,e){const t=ec(e,this.size,4);h.uniformMatrix2fv(this.addr,!1,t)}function Gx(h,e){const t=ec(e,this.size,9);h.uniformMatrix3fv(this.addr,!1,t)}function Wx(h,e){const t=ec(e,this.size,16);h.uniformMatrix4fv(this.addr,!1,t)}function jx(h,e){h.uniform1iv(this.addr,e)}function Yx(h,e){h.uniform2iv(this.addr,e)}function qx(h,e){h.uniform3iv(this.addr,e)}function Xx(h,e){h.uniform4iv(this.addr,e)}function By(h,e){h.uniform1uiv(this.addr,e)}function eh(h,e){h.uniform2uiv(this.addr,e)}function qf(h,e){h.uniform3uiv(this.addr,e)}function qm(h,e){h.uniform4uiv(this.addr,e)}function Zx(h,e,t){const r=this.cache,s=e.length,a=co(t,s);Ys(r,a)||(h.uniform1iv(this.addr,a),Bs(r,a));for(let c=0;c!==s;++c)t.setTexture2D(e[c]||$m,a[c])}function Kx(h,e,t){const r=this.cache,s=e.length,a=co(t,s);Ys(r,a)||(h.uniform1iv(this.addr,a),Bs(r,a));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||My,a[c])}function Xm(h,e,t){const r=this.cache,s=e.length,a=co(t,s);Ys(r,a)||(h.uniform1iv(this.addr,a),Bs(r,a));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||wy,a[c])}function ky(h,e,t){const r=this.cache,s=e.length,a=co(t,s);Ys(r,a)||(h.uniform1iv(this.addr,a),Bs(r,a));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||Wf,a[c])}class Uy{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function Ny(h){switch(h){case 5126:return Jd;case 35664:return Ty;case 35665:return Dy;case 35666:return Fx;case 35674:return Iy;case 35675:return Bx;case 35676:return Ry;case 5124:case 35670:return kx;case 35667:case 35671:return Py;case 35668:case 35672:return Ux;case 35669:case 35673:return Vx;case 5125:return Wm;case 36294:return jm;case 36295:return zx;case 36296:return Qd;case 35678:case 36198:case 36298:case 36306:case 35682:return Hx;case 35679:case 36299:case 36307:return $x;case 35680:case 36300:case 36308:case 36293:return Oy;case 36289:case 36303:case 36311:case 36292:return Ly}}(t.type)}}class Vy{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function Bc(h){switch(h){case 5126:return Qu;case 35664:return jf;case 35665:return Fy;case 35666:return Ym;case 35674:return Yf;case 35675:return Gx;case 35676:return Wx;case 5124:case 35670:return jx;case 35667:case 35671:return Yx;case 35668:case 35672:return qx;case 35669:case 35673:return Xx;case 5125:return By;case 36294:return eh;case 36295:return qf;case 36296:return qm;case 35678:case 36198:case 36298:case 36306:case 35682:return Zx;case 35679:case 36299:case 36307:return Kx;case 35680:case 36300:case 36308:case 36293:return Xm;case 36289:case 36303:case 36311:case 36292:return ky}}(t.type)}}class Jx{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const s=this.seq;for(let a=0,c=s.length;a!==c;++a){const d=s[a];d.setValue(e,t[d.id],r)}}}const zy=/(\w+)(\])?(\[|\.)?/g;function th(h,e){h.seq.push(e),h.map[e.id]=e}function Qx(h,e,t){const r=h.name,s=r.length;for(zy.lastIndex=0;;){const a=zy.exec(r);let d=a[1];const g=a[3];if("]"===a[2]&&(d|=0),void 0===g||"["===g&&zy.lastIndex+2===s){th(t,void 0===g?new Uy(d,h,e):new Vy(d,h,e));break}{let b=t.map[d];void 0===b&&(b=new Jx(d),th(t,b)),t=b}}}class nh{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){const a=e.getActiveUniform(t,s);Qx(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,r,s){const a=this.map[t];void 0!==a&&a.setValue(e,r,s)}setOptional(e,t,r){const s=t[r];void 0!==s&&this.setValue(e,r,s)}static upload(e,t,r,s){for(let a=0,c=t.length;a!==c;++a){const d=t[a],p=r[d.id];!1!==p.needsUpdate&&d.setValue(e,p.value,s)}}static seqWithValue(e,t){const r=[];for(let s=0,a=e.length;s!==a;++s){const c=e[s];c.id in t&&r.push(c)}return r}}function Zm(h,e,t){const r=h.createShader(e);return h.shaderSource(r,t),h.compileShader(r),r}let Hy=0;function ih(h,e,t){const r=h.getShaderParameter(e,h.COMPILE_STATUS),s=h.getShaderInfoLog(e).trim();if(r&&""===s)return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const c=parseInt(a[1]);return t.toUpperCase()+"\n\n"+s+"\n\n"+function Km(h,e){const t=h.split("\n"),r=[],s=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let c=s;c<a;c++){const d=c+1;r.push(`${d===e?">":" "} ${d}: ${t[c]}`)}return r.join("\n")}(h.getShaderSource(e),c)}return s}function rh(h,e){const t=function $y(h){switch(h){case is:return["Linear","( value )"];case tr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",h),["Linear","( value )"]}}(e);return"vec4 "+h+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Gy(h,e){let t;switch(e){case ki:t="Linear";break;case Ci:t="Reinhard";break;case or:t="OptimizedCineon";break;case Rn:t="ACESFilmic";break;case mi:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+h+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function kc(h){return""!==h}function ed(h,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return h.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function jy(h,e){return h.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Yy=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qm(h){return h.replace(Yy,tE)}const eE=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function tE(h,e){let t=Vi[e];if(void 0===t){const r=eE.get(e);if(void 0===r)throw new Error("Can not resolve #include <"+e+">");t=Vi[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r)}return Qm(t)}const qy=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function eg(h){return h.replace(qy,Zf)}function Zf(h,e,t,r){let s="";for(let a=parseInt(e);a<parseInt(t);a++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function Kf(h){let e="precision "+h.precision+" float;\nprecision "+h.precision+" int;";return"highp"===h.precision?e+="\n#define HIGH_PRECISION":"mediump"===h.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===h.precision&&(e+="\n#define LOW_PRECISION"),e}function Jf(h,e,t,r){const s=h.getContext(),a=t.defines;let c=t.vertexShader,d=t.fragmentShader;const p=function td(h){let e="SHADOWMAP_TYPE_BASIC";return h.shadowMapType===We?e="SHADOWMAP_TYPE_PCF":h.shadowMapType===Rt?e="SHADOWMAP_TYPE_PCF_SOFT":h.shadowMapType===Ke&&(e="SHADOWMAP_TYPE_VSM"),e}(t),g=function nE(h){let e="ENVMAP_TYPE_CUBE";if(h.envMap)switch(h.envMapMode){case Mr:case Or:e="ENVMAP_TYPE_CUBE";break;case ur:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function iE(h){let e="ENVMAP_MODE_REFLECTION";return h.envMap&&h.envMapMode===Or&&(e="ENVMAP_MODE_REFRACTION"),e}(t),b=function SC(h){let e="ENVMAP_BLENDING_NONE";if(h.envMap)switch(h.combine){case kt:e="ENVMAP_BLENDING_MULTIPLY";break;case Qn:e="ENVMAP_BLENDING_MIX";break;case ai:e="ENVMAP_BLENDING_ADD"}return e}(t),_=function rE(h){const e=h.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(t),M=t.isWebGL2?"":function Jm(h){return[h.extensionDerivatives||h.envMapCubeUVHeight||h.bumpMap||h.normalMapTangentSpace||h.clearcoatNormalMap||h.flatShading||"physical"===h.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap||h.transmission)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kc).join("\n")}(t),w=function Xf(h){const e=[];for(const t in h){const r=h[t];!1!==r&&e.push("#define "+t+" "+r)}return e.join("\n")}(a),P=s.createProgram();let R,I,V=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(R=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w].filter(kc).join("\n"),R.length>0&&(R+="\n"),I=[M,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w].filter(kc).join("\n"),I.length>0&&(I+="\n")):(R=[Kf(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kc).join("\n"),I=[M,Kf(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",t.envMap?"#define "+b:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==$n?"#define TONE_MAPPING":"",t.toneMapping!==$n?Vi.tonemapping_pars_fragment:"",t.toneMapping!==$n?Gy("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Vi.colorspace_pars_fragment,rh("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(kc).join("\n")),c=Qm(c),c=ed(c,t),c=jy(c,t),d=Qm(d),d=ed(d,t),d=jy(d,t),c=eg(c),d=eg(d),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(V="#version 300 es\n",R=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+R,I=["#define varying in",t.glslVersion===Mu?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Mu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+I);const j=V+I+d,Q=Zm(s,s.VERTEX_SHADER,V+R+c),se=Zm(s,s.FRAGMENT_SHADER,j);if(s.attachShader(P,Q),s.attachShader(P,se),void 0!==t.index0AttributeName?s.bindAttribLocation(P,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(P,0,"position"),s.linkProgram(P),h.debug.checkShaderErrors){const q=s.getProgramInfoLog(P).trim(),ne=s.getShaderInfoLog(Q).trim(),je=s.getShaderInfoLog(se).trim();let dt=!0,we=!0;if(!1===s.getProgramParameter(P,s.LINK_STATUS))if(dt=!1,"function"==typeof h.debug.onShaderError)h.debug.onShaderError(s,P,Q,se);else{const Re=ih(s,Q,"vertex"),Pe=ih(s,se,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(P,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+q+"\n"+Re+"\n"+Pe)}else""!==q?console.warn("THREE.WebGLProgram: Program Info Log:",q):(""===ne||""===je)&&(we=!1);we&&(this.diagnostics={runnable:dt,programLog:q,vertexShader:{log:ne,prefix:R},fragmentShader:{log:je,prefix:I}})}let oe,_e;return s.deleteShader(Q),s.deleteShader(se),this.getUniforms=function(){return void 0===oe&&(oe=new nh(s,P)),oe},this.getAttributes=function(){return void 0===_e&&(_e=function Wy(h,e){const t={},r=h.getProgramParameter(e,h.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const a=h.getActiveAttrib(e,s),c=a.name;let d=1;a.type===h.FLOAT_MAT2&&(d=2),a.type===h.FLOAT_MAT3&&(d=3),a.type===h.FLOAT_MAT4&&(d=4),t[c]={type:a.type,location:h.getAttribLocation(e,c),locationSize:d}}return t}(s,P)),_e},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram(P),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Hy++,this.cacheKey=e,this.usedTimes=1,this.program=P,this.vertexShader=Q,this.fragmentShader=se,this}let tg=0;class Xy{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const r=e.fragmentShader,s=this._getShaderStage(e.vertexShader),a=this._getShaderStage(r),c=this._getShaderCacheForMaterial(e);return!1===c.has(s)&&(c.add(s),s.usedTimes++),!1===c.has(a)&&(c.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new Zy(e),t.set(e,r)),r}}class Zy{constructor(e){this.id=tg++,this.code=e,this.usedTimes=0}}function Ky(h,e,t,r,s,a,c){const d=new Au,p=new Xy,g=[],v=s.isWebGL2,b=s.logarithmicDepthBuffer,_=s.vertexTextures;let M=s.precision;const w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function P(q){return 0===q?"uv":`uv${q}`}return{getParameters:function R(q,ne,je,dt,we){const Re=dt.fog,Pe=we.geometry,xt=(q.isMeshStandardMaterial?t:e).get(q.envMap||(q.isMeshStandardMaterial?dt.environment:null)),wt=xt&&xt.mapping===ur?xt.image.height:null,At=w[q.type];null!==q.precision&&(M=s.getMaxPrecision(q.precision),M!==q.precision&&console.warn("THREE.WebGLProgram.getParameters:",q.precision,"not supported, using",M,"instead."));const Ut=Pe.morphAttributes.position||Pe.morphAttributes.normal||Pe.morphAttributes.color,pt=void 0!==Ut?Ut.length:0;let _n,Tn,Fn,Xn,gt=0;if(void 0!==Pe.morphAttributes.position&&(gt=1),void 0!==Pe.morphAttributes.normal&&(gt=2),void 0!==Pe.morphAttributes.color&&(gt=3),At){const vs=Al[At];_n=vs.vertexShader,Tn=vs.fragmentShader}else _n=q.vertexShader,Tn=q.fragmentShader,p.update(q),Fn=p.getVertexShaderID(q),Xn=p.getFragmentShaderID(q);const qn=h.getRenderTarget(),ri=!0===we.isInstancedMesh,Gi=!!q.map,pi=!!xt,Ve=!!q.aoMap,Sn=!!q.lightMap,tn=!!q.bumpMap,bn=!!q.normalMap,fn=!!q.displacementMap,vi=!!q.emissiveMap,ni=!!q.metalnessMap,si=!!q.roughnessMap,Di=q.anisotropy>0,yr=q.clearcoat>0,cs=q.iridescence>0,Ce=q.sheen>0,he=q.transmission>0,Ft=Di&&!!q.anisotropyMap,Dn=yr&&!!q.clearcoatMap,pn=yr&&!!q.clearcoatNormalMap,An=yr&&!!q.clearcoatRoughnessMap,yi=cs&&!!q.iridescenceMap,In=cs&&!!q.iridescenceThicknessMap,Vt=Ce&&!!q.sheenColorMap,Ge=Ce&&!!q.sheenRoughnessMap,dn=!!q.specularMap,Zn=!!q.specularColorMap,Hn=!!q.specularIntensityMap,Wn=he&&!!q.transmissionMap,ji=he&&!!q.thicknessMap,nt=!!q.alphaMap,xn=!!q.extensions,Un=!!Pe.attributes.uv1,br=!!Pe.attributes.uv2,Hr=!!Pe.attributes.uv3;let Qr=$n;return q.toneMapped&&(null===qn||!0===qn.isXRRenderTarget)&&(Qr=h.toneMapping),{isWebGL2:v,shaderID:At,shaderType:q.type,shaderName:q.name,vertexShader:_n,fragmentShader:Tn,defines:q.defines,customVertexShaderID:Fn,customFragmentShaderID:Xn,isRawShaderMaterial:!0===q.isRawShaderMaterial,glslVersion:q.glslVersion,precision:M,instancing:ri,instancingColor:ri&&null!==we.instanceColor,supportsVertexTextures:_,outputColorSpace:null===qn?h.outputColorSpace:!0===qn.isXRRenderTarget?qn.texture.colorSpace:is,map:Gi,matcap:!!q.matcap,envMap:pi,envMapMode:pi&&xt.mapping,envMapCubeUVHeight:wt,aoMap:Ve,lightMap:Sn,bumpMap:tn,normalMap:bn,displacementMap:_&&fn,emissiveMap:vi,normalMapObjectSpace:bn&&1===q.normalMapType,normalMapTangentSpace:bn&&0===q.normalMapType,metalnessMap:ni,roughnessMap:si,anisotropy:Di,anisotropyMap:Ft,clearcoat:yr,clearcoatMap:Dn,clearcoatNormalMap:pn,clearcoatRoughnessMap:An,iridescence:cs,iridescenceMap:yi,iridescenceThicknessMap:In,sheen:Ce,sheenColorMap:Vt,sheenRoughnessMap:Ge,specularMap:dn,specularColorMap:Zn,specularIntensityMap:Hn,transmission:he,transmissionMap:Wn,thicknessMap:ji,gradientMap:!!q.gradientMap,opaque:!1===q.transparent&&1===q.blending,alphaMap:nt,alphaTest:q.alphaTest>0,alphaHash:!!q.alphaHash,combine:q.combine,mapUv:Gi&&P(q.map.channel),aoMapUv:Ve&&P(q.aoMap.channel),lightMapUv:Sn&&P(q.lightMap.channel),bumpMapUv:tn&&P(q.bumpMap.channel),normalMapUv:bn&&P(q.normalMap.channel),displacementMapUv:fn&&P(q.displacementMap.channel),emissiveMapUv:vi&&P(q.emissiveMap.channel),metalnessMapUv:ni&&P(q.metalnessMap.channel),roughnessMapUv:si&&P(q.roughnessMap.channel),anisotropyMapUv:Ft&&P(q.anisotropyMap.channel),clearcoatMapUv:Dn&&P(q.clearcoatMap.channel),clearcoatNormalMapUv:pn&&P(q.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:An&&P(q.clearcoatRoughnessMap.channel),iridescenceMapUv:yi&&P(q.iridescenceMap.channel),iridescenceThicknessMapUv:In&&P(q.iridescenceThicknessMap.channel),sheenColorMapUv:Vt&&P(q.sheenColorMap.channel),sheenRoughnessMapUv:Ge&&P(q.sheenRoughnessMap.channel),specularMapUv:dn&&P(q.specularMap.channel),specularColorMapUv:Zn&&P(q.specularColorMap.channel),specularIntensityMapUv:Hn&&P(q.specularIntensityMap.channel),transmissionMapUv:Wn&&P(q.transmissionMap.channel),thicknessMapUv:ji&&P(q.thicknessMap.channel),alphaMapUv:nt&&P(q.alphaMap.channel),vertexTangents:!!Pe.attributes.tangent&&(bn||Di),vertexColors:q.vertexColors,vertexAlphas:!0===q.vertexColors&&!!Pe.attributes.color&&4===Pe.attributes.color.itemSize,vertexUv1s:Un,vertexUv2s:br,vertexUv3s:Hr,pointsUvs:!0===we.isPoints&&!!Pe.attributes.uv&&(Gi||nt),fog:!!Re,useFog:!0===q.fog,fogExp2:Re&&Re.isFogExp2,flatShading:!0===q.flatShading,sizeAttenuation:!0===q.sizeAttenuation,logarithmicDepthBuffer:b,skinning:!0===we.isSkinnedMesh,morphTargets:void 0!==Pe.morphAttributes.position,morphNormals:void 0!==Pe.morphAttributes.normal,morphColors:void 0!==Pe.morphAttributes.color,morphTargetsCount:pt,morphTextureStride:gt,numDirLights:ne.directional.length,numPointLights:ne.point.length,numSpotLights:ne.spot.length,numSpotLightMaps:ne.spotLightMap.length,numRectAreaLights:ne.rectArea.length,numHemiLights:ne.hemi.length,numDirLightShadows:ne.directionalShadowMap.length,numPointLightShadows:ne.pointShadowMap.length,numSpotLightShadows:ne.spotShadowMap.length,numSpotLightShadowsWithMaps:ne.numSpotLightShadowsWithMaps,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:q.dithering,shadowMapEnabled:h.shadowMap.enabled&&je.length>0,shadowMapType:h.shadowMap.type,toneMapping:Qr,useLegacyLights:h._useLegacyLights,decodeVideoTexture:Gi&&!0===q.map.isVideoTexture&&q.map.colorSpace===tr,premultipliedAlpha:q.premultipliedAlpha,doubleSided:2===q.side,flipSided:1===q.side,useDepthPacking:q.depthPacking>=0,depthPacking:q.depthPacking||0,index0AttributeName:q.index0AttributeName,extensionDerivatives:xn&&!0===q.extensions.derivatives,extensionFragDepth:xn&&!0===q.extensions.fragDepth,extensionDrawBuffers:xn&&!0===q.extensions.drawBuffers,extensionShaderTextureLOD:xn&&!0===q.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||r.has("EXT_shader_texture_lod"),customProgramCacheKey:q.customProgramCacheKey()}},getProgramCacheKey:function I(q){const ne=[];if(q.shaderID?ne.push(q.shaderID):(ne.push(q.customVertexShaderID),ne.push(q.customFragmentShaderID)),void 0!==q.defines)for(const je in q.defines)ne.push(je),ne.push(q.defines[je]);return!1===q.isRawShaderMaterial&&(function V(q,ne){q.push(ne.precision),q.push(ne.outputColorSpace),q.push(ne.envMapMode),q.push(ne.envMapCubeUVHeight),q.push(ne.mapUv),q.push(ne.alphaMapUv),q.push(ne.lightMapUv),q.push(ne.aoMapUv),q.push(ne.bumpMapUv),q.push(ne.normalMapUv),q.push(ne.displacementMapUv),q.push(ne.emissiveMapUv),q.push(ne.metalnessMapUv),q.push(ne.roughnessMapUv),q.push(ne.anisotropyMapUv),q.push(ne.clearcoatMapUv),q.push(ne.clearcoatNormalMapUv),q.push(ne.clearcoatRoughnessMapUv),q.push(ne.iridescenceMapUv),q.push(ne.iridescenceThicknessMapUv),q.push(ne.sheenColorMapUv),q.push(ne.sheenRoughnessMapUv),q.push(ne.specularMapUv),q.push(ne.specularColorMapUv),q.push(ne.specularIntensityMapUv),q.push(ne.transmissionMapUv),q.push(ne.thicknessMapUv),q.push(ne.combine),q.push(ne.fogExp2),q.push(ne.sizeAttenuation),q.push(ne.morphTargetsCount),q.push(ne.morphAttributeCount),q.push(ne.numDirLights),q.push(ne.numPointLights),q.push(ne.numSpotLights),q.push(ne.numSpotLightMaps),q.push(ne.numHemiLights),q.push(ne.numRectAreaLights),q.push(ne.numDirLightShadows),q.push(ne.numPointLightShadows),q.push(ne.numSpotLightShadows),q.push(ne.numSpotLightShadowsWithMaps),q.push(ne.shadowMapType),q.push(ne.toneMapping),q.push(ne.numClippingPlanes),q.push(ne.numClipIntersection),q.push(ne.depthPacking)}(ne,q),function k(q,ne){d.disableAll(),ne.isWebGL2&&d.enable(0),ne.supportsVertexTextures&&d.enable(1),ne.instancing&&d.enable(2),ne.instancingColor&&d.enable(3),ne.matcap&&d.enable(4),ne.envMap&&d.enable(5),ne.normalMapObjectSpace&&d.enable(6),ne.normalMapTangentSpace&&d.enable(7),ne.clearcoat&&d.enable(8),ne.iridescence&&d.enable(9),ne.alphaTest&&d.enable(10),ne.vertexColors&&d.enable(11),ne.vertexAlphas&&d.enable(12),ne.vertexUv1s&&d.enable(13),ne.vertexUv2s&&d.enable(14),ne.vertexUv3s&&d.enable(15),ne.vertexTangents&&d.enable(16),ne.anisotropy&&d.enable(17),q.push(d.mask),d.disableAll(),ne.fog&&d.enable(0),ne.useFog&&d.enable(1),ne.flatShading&&d.enable(2),ne.logarithmicDepthBuffer&&d.enable(3),ne.skinning&&d.enable(4),ne.morphTargets&&d.enable(5),ne.morphNormals&&d.enable(6),ne.morphColors&&d.enable(7),ne.premultipliedAlpha&&d.enable(8),ne.shadowMapEnabled&&d.enable(9),ne.useLegacyLights&&d.enable(10),ne.doubleSided&&d.enable(11),ne.flipSided&&d.enable(12),ne.useDepthPacking&&d.enable(13),ne.dithering&&d.enable(14),ne.transmission&&d.enable(15),ne.sheen&&d.enable(16),ne.opaque&&d.enable(17),ne.pointsUvs&&d.enable(18),ne.decodeVideoTexture&&d.enable(19),q.push(d.mask)}(ne,q),ne.push(h.outputColorSpace)),ne.push(q.customProgramCacheKey),ne.join()},getUniforms:function j(q){const ne=w[q.type];let je;return je=ne?Mf.clone(Al[ne].uniforms):q.uniforms,je},acquireProgram:function Q(q,ne){let je;for(let dt=0,we=g.length;dt<we;dt++){const Re=g[dt];if(Re.cacheKey===ne){je=Re,++je.usedTimes;break}}return void 0===je&&(je=new Jf(h,ne,q,a),g.push(je)),je},releaseProgram:function se(q){if(0==--q.usedTimes){const ne=g.indexOf(q);g[ne]=g[g.length-1],g.pop(),q.destroy()}},releaseShaderCache:function oe(q){p.remove(q)},programs:g,dispose:function _e(){p.dispose()}}}function Jy(){let h=new WeakMap;return{get:function e(a){let c=h.get(a);return void 0===c&&(c={},h.set(a,c)),c},remove:function t(a){h.delete(a)},update:function r(a,c,d){h.get(a)[c]=d},dispose:function s(){h=new WeakMap}}}function sE(h,e){return h.groupOrder!==e.groupOrder?h.groupOrder-e.groupOrder:h.renderOrder!==e.renderOrder?h.renderOrder-e.renderOrder:h.material.id!==e.material.id?h.material.id-e.material.id:h.z!==e.z?h.z-e.z:h.id-e.id}function Qy(h,e){return h.groupOrder!==e.groupOrder?h.groupOrder-e.groupOrder:h.renderOrder!==e.renderOrder?h.renderOrder-e.renderOrder:h.z!==e.z?e.z-h.z:h.id-e.id}function e0(){const h=[];let e=0;const t=[],r=[],s=[];function c(b,_,M,w,P,R){let I=h[e];return void 0===I?(I={id:b.id,object:b,geometry:_,material:M,groupOrder:w,renderOrder:b.renderOrder,z:P,group:R},h[e]=I):(I.id=b.id,I.object=b,I.geometry=_,I.material=M,I.groupOrder=w,I.renderOrder=b.renderOrder,I.z=P,I.group=R),e++,I}return{opaque:t,transmissive:r,transparent:s,init:function a(){e=0,t.length=0,r.length=0,s.length=0},push:function d(b,_,M,w,P,R){const I=c(b,_,M,w,P,R);M.transmission>0?r.push(I):!0===M.transparent?s.push(I):t.push(I)},unshift:function p(b,_,M,w,P,R){const I=c(b,_,M,w,P,R);M.transmission>0?r.unshift(I):!0===M.transparent?s.unshift(I):t.unshift(I)},finish:function v(){for(let b=e,_=h.length;b<_;b++){const M=h[b];if(null===M.id)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}},sort:function g(b,_){t.length>1&&t.sort(b||sE),r.length>1&&r.sort(_||Qy),s.length>1&&s.sort(_||Qy)}}}function oE(){let h=new WeakMap;return{get:function e(r,s){const a=h.get(r);let c;return void 0===a?(c=new e0,h.set(r,[c])):s>=a.length?(c=new e0,a.push(c)):c=a[s],c},dispose:function t(){h=new WeakMap}}}function aE(){const h={};return{get:function(e){if(void 0!==h[e.id])return h[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new de,color:new ei};break;case"SpotLight":t={position:new de,direction:new de,color:new ei,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new de,color:new ei,distance:0,decay:0};break;case"HemisphereLight":t={direction:new de,skyColor:new ei,groundColor:new ei};break;case"RectAreaLight":t={color:new ei,position:new de,halfWidth:new de,halfHeight:new de}}return h[e.id]=t,t}}}let sh=0;function lE(h,e){return(e.castShadow?2:0)-(h.castShadow?2:0)+(e.map?1:0)-(h.map?1:0)}function CC(h,e){const t=new aE,r=function tc(){const h={};return{get:function(e){if(void 0!==h[e.id])return h[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new en};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new en,shadowCameraNear:1,shadowCameraFar:1e3}}return h[e.id]=t,t}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)s.probe.push(new de);const a=new de,c=new Mi,d=new Mi;return{setup:function p(v,b){let _=0,M=0,w=0;for(let je=0;je<9;je++)s.probe[je].set(0,0,0);let P=0,R=0,I=0,V=0,k=0,j=0,Q=0,se=0,oe=0,_e=0;v.sort(lE);const q=!0===b?Math.PI:1;for(let je=0,dt=v.length;je<dt;je++){const we=v[je],Re=we.color,Pe=we.intensity,$e=we.distance,xt=we.shadow&&we.shadow.map?we.shadow.map.texture:null;if(we.isAmbientLight)_+=Re.r*Pe*q,M+=Re.g*Pe*q,w+=Re.b*Pe*q;else if(we.isLightProbe)for(let wt=0;wt<9;wt++)s.probe[wt].addScaledVector(we.sh.coefficients[wt],Pe);else if(we.isDirectionalLight){const wt=t.get(we);if(wt.color.copy(we.color).multiplyScalar(we.intensity*q),we.castShadow){const At=we.shadow,Ut=r.get(we);Ut.shadowBias=At.bias,Ut.shadowNormalBias=At.normalBias,Ut.shadowRadius=At.radius,Ut.shadowMapSize=At.mapSize,s.directionalShadow[P]=Ut,s.directionalShadowMap[P]=xt,s.directionalShadowMatrix[P]=we.shadow.matrix,j++}s.directional[P]=wt,P++}else if(we.isSpotLight){const wt=t.get(we);wt.position.setFromMatrixPosition(we.matrixWorld),wt.color.copy(Re).multiplyScalar(Pe*q),wt.distance=$e,wt.coneCos=Math.cos(we.angle),wt.penumbraCos=Math.cos(we.angle*(1-we.penumbra)),wt.decay=we.decay,s.spot[I]=wt;const At=we.shadow;if(we.map&&(s.spotLightMap[oe]=we.map,oe++,At.updateMatrices(we),we.castShadow&&_e++),s.spotLightMatrix[I]=At.matrix,we.castShadow){const Ut=r.get(we);Ut.shadowBias=At.bias,Ut.shadowNormalBias=At.normalBias,Ut.shadowRadius=At.radius,Ut.shadowMapSize=At.mapSize,s.spotShadow[I]=Ut,s.spotShadowMap[I]=xt,se++}I++}else if(we.isRectAreaLight){const wt=t.get(we);wt.color.copy(Re).multiplyScalar(Pe),wt.halfWidth.set(.5*we.width,0,0),wt.halfHeight.set(0,.5*we.height,0),s.rectArea[V]=wt,V++}else if(we.isPointLight){const wt=t.get(we);if(wt.color.copy(we.color).multiplyScalar(we.intensity*q),wt.distance=we.distance,wt.decay=we.decay,we.castShadow){const At=we.shadow,Ut=r.get(we);Ut.shadowBias=At.bias,Ut.shadowNormalBias=At.normalBias,Ut.shadowRadius=At.radius,Ut.shadowMapSize=At.mapSize,Ut.shadowCameraNear=At.camera.near,Ut.shadowCameraFar=At.camera.far,s.pointShadow[R]=Ut,s.pointShadowMap[R]=xt,s.pointShadowMatrix[R]=we.shadow.matrix,Q++}s.point[R]=wt,R++}else if(we.isHemisphereLight){const wt=t.get(we);wt.skyColor.copy(we.color).multiplyScalar(Pe*q),wt.groundColor.copy(we.groundColor).multiplyScalar(Pe*q),s.hemi[k]=wt,k++}}V>0&&(e.isWebGL2||!0===h.has("OES_texture_float_linear")?(s.rectAreaLTC1=kn.LTC_FLOAT_1,s.rectAreaLTC2=kn.LTC_FLOAT_2):!0===h.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=kn.LTC_HALF_1,s.rectAreaLTC2=kn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=_,s.ambient[1]=M,s.ambient[2]=w;const ne=s.hash;(ne.directionalLength!==P||ne.pointLength!==R||ne.spotLength!==I||ne.rectAreaLength!==V||ne.hemiLength!==k||ne.numDirectionalShadows!==j||ne.numPointShadows!==Q||ne.numSpotShadows!==se||ne.numSpotMaps!==oe)&&(s.directional.length=P,s.spot.length=I,s.rectArea.length=V,s.point.length=R,s.hemi.length=k,s.directionalShadow.length=j,s.directionalShadowMap.length=j,s.pointShadow.length=Q,s.pointShadowMap.length=Q,s.spotShadow.length=se,s.spotShadowMap.length=se,s.directionalShadowMatrix.length=j,s.pointShadowMatrix.length=Q,s.spotLightMatrix.length=se+oe-_e,s.spotLightMap.length=oe,s.numSpotLightShadowsWithMaps=_e,ne.directionalLength=P,ne.pointLength=R,ne.spotLength=I,ne.rectAreaLength=V,ne.hemiLength=k,ne.numDirectionalShadows=j,ne.numPointShadows=Q,ne.numSpotShadows=se,ne.numSpotMaps=oe,s.version=sh++)},setupView:function g(v,b){let _=0,M=0,w=0,P=0,R=0;const I=b.matrixWorldInverse;for(let V=0,k=v.length;V<k;V++){const j=v[V];if(j.isDirectionalLight){const Q=s.directional[_];Q.direction.setFromMatrixPosition(j.matrixWorld),a.setFromMatrixPosition(j.target.matrixWorld),Q.direction.sub(a),Q.direction.transformDirection(I),_++}else if(j.isSpotLight){const Q=s.spot[w];Q.position.setFromMatrixPosition(j.matrixWorld),Q.position.applyMatrix4(I),Q.direction.setFromMatrixPosition(j.matrixWorld),a.setFromMatrixPosition(j.target.matrixWorld),Q.direction.sub(a),Q.direction.transformDirection(I),w++}else if(j.isRectAreaLight){const Q=s.rectArea[P];Q.position.setFromMatrixPosition(j.matrixWorld),Q.position.applyMatrix4(I),d.identity(),c.copy(j.matrixWorld),c.premultiply(I),d.extractRotation(c),Q.halfWidth.set(.5*j.width,0,0),Q.halfHeight.set(0,.5*j.height,0),Q.halfWidth.applyMatrix4(d),Q.halfHeight.applyMatrix4(d),P++}else if(j.isPointLight){const Q=s.point[M];Q.position.setFromMatrixPosition(j.matrixWorld),Q.position.applyMatrix4(I),M++}else if(j.isHemisphereLight){const Q=s.hemi[R];Q.direction.setFromMatrixPosition(j.matrixWorld),Q.direction.transformDirection(I),R++}}},state:s}}function cE(h,e){const t=new CC(h,e),r=[],s=[];return{init:function a(){r.length=0,s.length=0},state:{lightsArray:r,shadowsArray:s,lights:t},setupLights:function p(b){t.setup(r,b)},setupLightsView:function g(b){t.setupView(r,b)},pushLight:function c(b){r.push(b)},pushShadow:function d(b){s.push(b)}}}function AC(h,e){let t=new WeakMap;return{get:function r(a,c=0){const d=t.get(a);let p;return void 0===d?(p=new cE(h,e),t.set(a,[p])):c>=d.length?(p=new cE(h,e),d.push(p)):p=d[c],p},dispose:function s(){t=new WeakMap}}}class uE extends al{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class dE extends al{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function fE(h,e,t){let r=new Tf;const s=new en,a=new en,c=new Br,d=new uE({depthPacking:3201}),p=new dE,g={},v=t.maxTextureSize,b={0:1,1:0,2:2},_=new Cl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new en},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),M=_.clone();M.defines.HORIZONTAL_PASS=1;const w=new Qi;w.setAttribute("position",new K(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const P=new ms(w,_),R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=We;let I=this.type;function V(Q,se){const oe=e.update(P);_.defines.VSM_SAMPLES!==Q.blurSamples&&(_.defines.VSM_SAMPLES=Q.blurSamples,M.defines.VSM_SAMPLES=Q.blurSamples,_.needsUpdate=!0,M.needsUpdate=!0),null===Q.mapPass&&(Q.mapPass=new H(s.x,s.y)),_.uniforms.shadow_pass.value=Q.map.texture,_.uniforms.resolution.value=Q.mapSize,_.uniforms.radius.value=Q.radius,h.setRenderTarget(Q.mapPass),h.clear(),h.renderBufferDirect(se,null,oe,_,P,null),M.uniforms.shadow_pass.value=Q.mapPass.texture,M.uniforms.resolution.value=Q.mapSize,M.uniforms.radius.value=Q.radius,h.setRenderTarget(Q.map),h.clear(),h.renderBufferDirect(se,null,oe,M,P,null)}function k(Q,se,oe,_e){let q=null;const ne=!0===oe.isPointLight?Q.customDistanceMaterial:Q.customDepthMaterial;if(void 0!==ne)q=ne;else if(q=!0===oe.isPointLight?p:d,h.localClippingEnabled&&!0===se.clipShadows&&Array.isArray(se.clippingPlanes)&&0!==se.clippingPlanes.length||se.displacementMap&&0!==se.displacementScale||se.alphaMap&&se.alphaTest>0||se.map&&se.alphaTest>0){const je=q.uuid,dt=se.uuid;let we=g[je];void 0===we&&(we={},g[je]=we);let Re=we[dt];void 0===Re&&(Re=q.clone(),we[dt]=Re),q=Re}return q.visible=se.visible,q.wireframe=se.wireframe,q.side=_e===Ke?null!==se.shadowSide?se.shadowSide:se.side:null!==se.shadowSide?se.shadowSide:b[se.side],q.alphaMap=se.alphaMap,q.alphaTest=se.alphaTest,q.map=se.map,q.clipShadows=se.clipShadows,q.clippingPlanes=se.clippingPlanes,q.clipIntersection=se.clipIntersection,q.displacementMap=se.displacementMap,q.displacementScale=se.displacementScale,q.displacementBias=se.displacementBias,q.wireframeLinewidth=se.wireframeLinewidth,q.linewidth=se.linewidth,!0===oe.isPointLight&&!0===q.isMeshDistanceMaterial&&(h.properties.get(q).light=oe),q}function j(Q,se,oe,_e,q){if(!1===Q.visible)return;if(Q.layers.test(se.layers)&&(Q.isMesh||Q.isLine||Q.isPoints)&&(Q.castShadow||Q.receiveShadow&&q===Ke)&&(!Q.frustumCulled||r.intersectsObject(Q))){Q.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,Q.matrixWorld);const dt=e.update(Q),we=Q.material;if(Array.isArray(we)){const Re=dt.groups;for(let Pe=0,$e=Re.length;Pe<$e;Pe++){const xt=Re[Pe],wt=we[xt.materialIndex];if(wt&&wt.visible){const At=k(Q,wt,_e,q);h.renderBufferDirect(oe,null,dt,At,Q,xt)}}}else if(we.visible){const Re=k(Q,we,_e,q);h.renderBufferDirect(oe,null,dt,Re,Q,null)}}const je=Q.children;for(let dt=0,we=je.length;dt<we;dt++)j(je[dt],se,oe,_e,q)}this.render=function(Q,se,oe){if(!1===R.enabled||!1===R.autoUpdate&&!1===R.needsUpdate||0===Q.length)return;const _e=h.getRenderTarget(),q=h.getActiveCubeFace(),ne=h.getActiveMipmapLevel(),je=h.state;je.setBlending(0),je.buffers.color.setClear(1,1,1,1),je.buffers.depth.setTest(!0),je.setScissorTest(!1);const dt=I!==Ke&&this.type===Ke,we=I===Ke&&this.type!==Ke;for(let Re=0,Pe=Q.length;Re<Pe;Re++){const $e=Q[Re],xt=$e.shadow;if(void 0===xt){console.warn("THREE.WebGLShadowMap:",$e,"has no shadow.");continue}if(!1===xt.autoUpdate&&!1===xt.needsUpdate)continue;s.copy(xt.mapSize);const wt=xt.getFrameExtents();if(s.multiply(wt),a.copy(xt.mapSize),(s.x>v||s.y>v)&&(s.x>v&&(a.x=Math.floor(v/wt.x),s.x=a.x*wt.x,xt.mapSize.x=a.x),s.y>v&&(a.y=Math.floor(v/wt.y),s.y=a.y*wt.y,xt.mapSize.y=a.y)),null===xt.map||!0===dt||!0===we){const Ut=this.type!==Ke?{minFilter:Jn,magFilter:Jn}:{};null!==xt.map&&xt.map.dispose(),xt.map=new H(s.x,s.y,Ut),xt.map.texture.name=$e.name+".shadowMap",xt.camera.updateProjectionMatrix()}h.setRenderTarget(xt.map),h.clear();const At=xt.getViewportCount();for(let Ut=0;Ut<At;Ut++){const pt=xt.getViewport(Ut);c.set(a.x*pt.x,a.y*pt.y,a.x*pt.z,a.y*pt.w),je.viewport(c),xt.updateMatrices($e,Ut),r=xt.getFrustum(),j(se,oe,xt.camera,$e,this.type)}!0!==xt.isPointLightShadow&&this.type===Ke&&V(xt,oe),xt.needsUpdate=!1}I=this.type,R.needsUpdate=!1,h.setRenderTarget(_e,q,ne)}}function pE(h,e,t){const r=t.isWebGL2,d=new function s(){let nt=!1;const jn=new Br;let Ht=null;const xn=new Br(0,0,0,0);return{setMask:function(Un){Ht!==Un&&!nt&&(h.colorMask(Un,Un,Un,Un),Ht=Un)},setLocked:function(Un){nt=Un},setClear:function(Un,br,Hr,Qr,sa){!0===sa&&(Un*=Qr,br*=Qr,Hr*=Qr),jn.set(Un,br,Hr,Qr),!1===xn.equals(jn)&&(h.clearColor(Un,br,Hr,Qr),xn.copy(jn))},reset:function(){nt=!1,Ht=null,xn.set(-1,0,0,0)}}},p=new function a(){let nt=!1,jn=null,Ht=null,xn=null;return{setTest:function(Un){Un?qn(h.DEPTH_TEST):ri(h.DEPTH_TEST)},setMask:function(Un){jn!==Un&&!nt&&(h.depthMask(Un),jn=Un)},setFunc:function(Un){if(Ht!==Un){switch(Un){case 0:h.depthFunc(h.NEVER);break;case 1:h.depthFunc(h.ALWAYS);break;case 2:h.depthFunc(h.LESS);break;case 3:default:h.depthFunc(h.LEQUAL);break;case 4:h.depthFunc(h.EQUAL);break;case 5:h.depthFunc(h.GEQUAL);break;case 6:h.depthFunc(h.GREATER);break;case 7:h.depthFunc(h.NOTEQUAL)}Ht=Un}},setLocked:function(Un){nt=Un},setClear:function(Un){xn!==Un&&(h.clearDepth(Un),xn=Un)},reset:function(){nt=!1,jn=null,Ht=null,xn=null}}},g=new function c(){let nt=!1,jn=null,Ht=null,xn=null,Un=null,br=null,Hr=null,Qr=null,sa=null;return{setTest:function(vs){nt||(vs?qn(h.STENCIL_TEST):ri(h.STENCIL_TEST))},setMask:function(vs){jn!==vs&&!nt&&(h.stencilMask(vs),jn=vs)},setFunc:function(vs,Ja,Yo){(Ht!==vs||xn!==Ja||Un!==Yo)&&(h.stencilFunc(vs,Ja,Yo),Ht=vs,xn=Ja,Un=Yo)},setOp:function(vs,Ja,Yo){(br!==vs||Hr!==Ja||Qr!==Yo)&&(h.stencilOp(vs,Ja,Yo),br=vs,Hr=Ja,Qr=Yo)},setLocked:function(vs){nt=vs},setClear:function(vs){sa!==vs&&(h.clearStencil(vs),sa=vs)},reset:function(){nt=!1,jn=null,Ht=null,xn=null,Un=null,br=null,Hr=null,Qr=null,sa=null}}},v=new WeakMap,b=new WeakMap;let _={},M={},w=new WeakMap,P=[],R=null,I=!1,V=null,k=null,j=null,Q=null,se=null,oe=null,_e=null,q=!1,ne=null,je=null,dt=null,we=null,Re=null;const Pe=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let $e=!1,xt=0;const wt=h.getParameter(h.VERSION);-1!==wt.indexOf("WebGL")?(xt=parseFloat(/^WebGL (\d)/.exec(wt)[1]),$e=xt>=1):-1!==wt.indexOf("OpenGL ES")&&(xt=parseFloat(/^OpenGL ES (\d)/.exec(wt)[1]),$e=xt>=2);let At=null,Ut={};const pt=h.getParameter(h.SCISSOR_BOX),gt=h.getParameter(h.VIEWPORT),_n=(new Br).fromArray(pt),Tn=(new Br).fromArray(gt);function Fn(nt,jn,Ht,xn){const Un=new Uint8Array(4),br=h.createTexture();h.bindTexture(nt,br),h.texParameteri(nt,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(nt,h.TEXTURE_MAG_FILTER,h.NEAREST);for(let Hr=0;Hr<Ht;Hr++)!r||nt!==h.TEXTURE_3D&&nt!==h.TEXTURE_2D_ARRAY?h.texImage2D(jn+Hr,0,h.RGBA,1,1,0,h.RGBA,h.UNSIGNED_BYTE,Un):h.texImage3D(jn,0,h.RGBA,1,1,xn,0,h.RGBA,h.UNSIGNED_BYTE,Un);return br}const Xn={};function qn(nt){!0!==_[nt]&&(h.enable(nt),_[nt]=!0)}function ri(nt){!1!==_[nt]&&(h.disable(nt),_[nt]=!1)}Xn[h.TEXTURE_2D]=Fn(h.TEXTURE_2D,h.TEXTURE_2D,1),Xn[h.TEXTURE_CUBE_MAP]=Fn(h.TEXTURE_CUBE_MAP,h.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Xn[h.TEXTURE_2D_ARRAY]=Fn(h.TEXTURE_2D_ARRAY,h.TEXTURE_2D_ARRAY,1,1),Xn[h.TEXTURE_3D]=Fn(h.TEXTURE_3D,h.TEXTURE_3D,1,1)),d.setClear(0,0,0,1),p.setClear(1),g.setClear(0),qn(h.DEPTH_TEST),p.setFunc(3),fn(!1),vi(1),qn(h.CULL_FACE),tn(0);const Ve={100:h.FUNC_ADD,101:h.FUNC_SUBTRACT,102:h.FUNC_REVERSE_SUBTRACT};if(r)Ve[103]=h.MIN,Ve[104]=h.MAX;else{const nt=e.get("EXT_blend_minmax");null!==nt&&(Ve[103]=nt.MIN_EXT,Ve[104]=nt.MAX_EXT)}const Sn={200:h.ZERO,201:h.ONE,202:h.SRC_COLOR,204:h.SRC_ALPHA,210:h.SRC_ALPHA_SATURATE,208:h.DST_COLOR,206:h.DST_ALPHA,203:h.ONE_MINUS_SRC_COLOR,205:h.ONE_MINUS_SRC_ALPHA,209:h.ONE_MINUS_DST_COLOR,207:h.ONE_MINUS_DST_ALPHA};function tn(nt,jn,Ht,xn,Un,br,Hr,Qr){if(0!==nt){if(!1===I&&(qn(h.BLEND),I=!0),5===nt)Un=Un||jn,br=br||Ht,Hr=Hr||xn,(jn!==k||Un!==se)&&(h.blendEquationSeparate(Ve[jn],Ve[Un]),k=jn,se=Un),(Ht!==j||xn!==Q||br!==oe||Hr!==_e)&&(h.blendFuncSeparate(Sn[Ht],Sn[xn],Sn[br],Sn[Hr]),j=Ht,Q=xn,oe=br,_e=Hr),V=nt,q=!1;else if(nt!==V||Qr!==q){if((100!==k||100!==se)&&(h.blendEquation(h.FUNC_ADD),k=100,se=100),Qr)switch(nt){case 1:h.blendFuncSeparate(h.ONE,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA);break;case 2:h.blendFunc(h.ONE,h.ONE);break;case 3:h.blendFuncSeparate(h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ZERO,h.ONE);break;case 4:h.blendFuncSeparate(h.ZERO,h.SRC_COLOR,h.ZERO,h.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",nt)}else switch(nt){case 1:h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA);break;case 2:h.blendFunc(h.SRC_ALPHA,h.ONE);break;case 3:h.blendFuncSeparate(h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ZERO,h.ONE);break;case 4:h.blendFunc(h.ZERO,h.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",nt)}j=null,Q=null,oe=null,_e=null,V=nt,q=Qr}}else!0===I&&(ri(h.BLEND),I=!1)}function fn(nt){ne!==nt&&(h.frontFace(nt?h.CW:h.CCW),ne=nt)}function vi(nt){0!==nt?(qn(h.CULL_FACE),nt!==je&&h.cullFace(1===nt?h.BACK:2===nt?h.FRONT:h.FRONT_AND_BACK)):ri(h.CULL_FACE),je=nt}function si(nt,jn,Ht){nt?(qn(h.POLYGON_OFFSET_FILL),(we!==jn||Re!==Ht)&&(h.polygonOffset(jn,Ht),we=jn,Re=Ht)):ri(h.POLYGON_OFFSET_FILL)}return{buffers:{color:d,depth:p,stencil:g},enable:qn,disable:ri,bindFramebuffer:function Gi(nt,jn){return M[nt]!==jn&&(h.bindFramebuffer(nt,jn),M[nt]=jn,r&&(nt===h.DRAW_FRAMEBUFFER&&(M[h.FRAMEBUFFER]=jn),nt===h.FRAMEBUFFER&&(M[h.DRAW_FRAMEBUFFER]=jn)),!0)},drawBuffers:function hr(nt,jn){let Ht=P,xn=!1;if(nt)if(Ht=w.get(jn),void 0===Ht&&(Ht=[],w.set(jn,Ht)),nt.isWebGLMultipleRenderTargets){const Un=nt.texture;if(Ht.length!==Un.length||Ht[0]!==h.COLOR_ATTACHMENT0){for(let br=0,Hr=Un.length;br<Hr;br++)Ht[br]=h.COLOR_ATTACHMENT0+br;Ht.length=Un.length,xn=!0}}else Ht[0]!==h.COLOR_ATTACHMENT0&&(Ht[0]=h.COLOR_ATTACHMENT0,xn=!0);else Ht[0]!==h.BACK&&(Ht[0]=h.BACK,xn=!0);xn&&(t.isWebGL2?h.drawBuffers(Ht):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ht))},useProgram:function pi(nt){return R!==nt&&(h.useProgram(nt),R=nt,!0)},setBlending:tn,setMaterial:function bn(nt,jn){2===nt.side?ri(h.CULL_FACE):qn(h.CULL_FACE);let Ht=1===nt.side;jn&&(Ht=!Ht),fn(Ht),1===nt.blending&&!1===nt.transparent?tn(0):tn(nt.blending,nt.blendEquation,nt.blendSrc,nt.blendDst,nt.blendEquationAlpha,nt.blendSrcAlpha,nt.blendDstAlpha,nt.premultipliedAlpha),p.setFunc(nt.depthFunc),p.setTest(nt.depthTest),p.setMask(nt.depthWrite),d.setMask(nt.colorWrite);const xn=nt.stencilWrite;g.setTest(xn),xn&&(g.setMask(nt.stencilWriteMask),g.setFunc(nt.stencilFunc,nt.stencilRef,nt.stencilFuncMask),g.setOp(nt.stencilFail,nt.stencilZFail,nt.stencilZPass)),si(nt.polygonOffset,nt.polygonOffsetFactor,nt.polygonOffsetUnits),!0===nt.alphaToCoverage?qn(h.SAMPLE_ALPHA_TO_COVERAGE):ri(h.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:fn,setCullFace:vi,setLineWidth:function ni(nt){nt!==dt&&($e&&h.lineWidth(nt),dt=nt)},setPolygonOffset:si,setScissorTest:function Di(nt){nt?qn(h.SCISSOR_TEST):ri(h.SCISSOR_TEST)},activeTexture:function yr(nt){void 0===nt&&(nt=h.TEXTURE0+Pe-1),At!==nt&&(h.activeTexture(nt),At=nt)},bindTexture:function cs(nt,jn,Ht){void 0===Ht&&(Ht=null===At?h.TEXTURE0+Pe-1:At);let xn=Ut[Ht];void 0===xn&&(xn={type:void 0,texture:void 0},Ut[Ht]=xn),(xn.type!==nt||xn.texture!==jn)&&(At!==Ht&&(h.activeTexture(Ht),At=Ht),h.bindTexture(nt,jn||Xn[nt]),xn.type=nt,xn.texture=jn)},unbindTexture:function Ce(){const nt=Ut[At];void 0!==nt&&void 0!==nt.type&&(h.bindTexture(nt.type,null),nt.type=void 0,nt.texture=void 0)},compressedTexImage2D:function he(){try{h.compressedTexImage2D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexImage3D:function Ft(){try{h.compressedTexImage3D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texImage2D:function Ge(){try{h.texImage2D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texImage3D:function dn(){try{h.texImage3D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},updateUBOMapping:function Wn(nt,jn){let Ht=b.get(jn);void 0===Ht&&(Ht=new WeakMap,b.set(jn,Ht));let xn=Ht.get(nt);void 0===xn&&(xn=h.getUniformBlockIndex(jn,nt.name),Ht.set(nt,xn))},uniformBlockBinding:function ji(nt,jn){const xn=b.get(jn).get(nt);v.get(jn)!==xn&&(h.uniformBlockBinding(jn,xn,nt.__bindingPointIndex),v.set(jn,xn))},texStorage2D:function In(){try{h.texStorage2D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texStorage3D:function Vt(){try{h.texStorage3D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texSubImage2D:function Dn(){try{h.texSubImage2D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},texSubImage3D:function pn(){try{h.texSubImage3D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexSubImage2D:function An(){try{h.compressedTexSubImage2D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},compressedTexSubImage3D:function yi(){try{h.compressedTexSubImage3D.apply(h,arguments)}catch(nt){console.error("THREE.WebGLState:",nt)}},scissor:function Zn(nt){!1===_n.equals(nt)&&(h.scissor(nt.x,nt.y,nt.z,nt.w),_n.copy(nt))},viewport:function Hn(nt){!1===Tn.equals(nt)&&(h.viewport(nt.x,nt.y,nt.z,nt.w),Tn.copy(nt))},reset:function _r(){h.disable(h.BLEND),h.disable(h.CULL_FACE),h.disable(h.DEPTH_TEST),h.disable(h.POLYGON_OFFSET_FILL),h.disable(h.SCISSOR_TEST),h.disable(h.STENCIL_TEST),h.disable(h.SAMPLE_ALPHA_TO_COVERAGE),h.blendEquation(h.FUNC_ADD),h.blendFunc(h.ONE,h.ZERO),h.blendFuncSeparate(h.ONE,h.ZERO,h.ONE,h.ZERO),h.colorMask(!0,!0,!0,!0),h.clearColor(0,0,0,0),h.depthMask(!0),h.depthFunc(h.LESS),h.clearDepth(1),h.stencilMask(4294967295),h.stencilFunc(h.ALWAYS,0,4294967295),h.stencilOp(h.KEEP,h.KEEP,h.KEEP),h.clearStencil(0),h.cullFace(h.BACK),h.frontFace(h.CCW),h.polygonOffset(0,0),h.activeTexture(h.TEXTURE0),h.bindFramebuffer(h.FRAMEBUFFER,null),!0===r&&(h.bindFramebuffer(h.DRAW_FRAMEBUFFER,null),h.bindFramebuffer(h.READ_FRAMEBUFFER,null)),h.useProgram(null),h.lineWidth(1),h.scissor(0,0,h.canvas.width,h.canvas.height),h.viewport(0,0,h.canvas.width,h.canvas.height),_={},At=null,Ut={},M={},w=new WeakMap,P=[],R=null,I=!1,V=null,k=null,j=null,Q=null,se=null,oe=null,_e=null,q=!1,ne=null,je=null,dt=null,we=null,Re=null,_n.set(0,0,h.canvas.width,h.canvas.height),Tn.set(0,0,h.canvas.width,h.canvas.height),d.reset(),p.reset(),g.reset()}}}function mE(h,e,t,r,s,a,c){const d=s.isWebGL2,p=s.maxTextures,g=s.maxCubemapSize,v=s.maxTextureSize,b=s.maxSamples,_=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,M=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),w=new WeakMap;let P;const R=new WeakMap;let I=!1;try{I=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function V(Ce,he){return I?new OffscreenCanvas(Ce,he):xl("canvas")}function k(Ce,he,Ft,Dn){let pn=1;if((Ce.width>Dn||Ce.height>Dn)&&(pn=Dn/Math.max(Ce.width,Ce.height)),pn<1||!0===he){if(typeof HTMLImageElement<"u"&&Ce instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ce instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ce instanceof ImageBitmap){const An=he?No:Math.floor,yi=An(pn*Ce.width),In=An(pn*Ce.height);void 0===P&&(P=V(yi,In));const Vt=Ft?V(yi,In):P;return Vt.width=yi,Vt.height=In,Vt.getContext("2d").drawImage(Ce,0,0,yi,In),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ce.width+"x"+Ce.height+") to ("+yi+"x"+In+")."),Vt}return"data"in Ce&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ce.width+"x"+Ce.height+")."),Ce}return Ce}function j(Ce){return go(Ce.width)&&go(Ce.height)}function se(Ce,he){return Ce.generateMipmaps&&he&&Ce.minFilter!==Jn&&Ce.minFilter!==pr}function oe(Ce){h.generateMipmap(Ce)}function _e(Ce,he,Ft,Dn,pn=!1){if(!1===d)return he;if(null!==Ce){if(void 0!==h[Ce])return h[Ce];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ce+"'")}let An=he;return he===h.RED&&(Ft===h.FLOAT&&(An=h.R32F),Ft===h.HALF_FLOAT&&(An=h.R16F),Ft===h.UNSIGNED_BYTE&&(An=h.R8)),he===h.RED_INTEGER&&(Ft===h.UNSIGNED_BYTE&&(An=h.R8UI),Ft===h.UNSIGNED_SHORT&&(An=h.R16UI),Ft===h.UNSIGNED_INT&&(An=h.R32UI),Ft===h.BYTE&&(An=h.R8I),Ft===h.SHORT&&(An=h.R16I),Ft===h.INT&&(An=h.R32I)),he===h.RG&&(Ft===h.FLOAT&&(An=h.RG32F),Ft===h.HALF_FLOAT&&(An=h.RG16F),Ft===h.UNSIGNED_BYTE&&(An=h.RG8)),he===h.RGBA&&(Ft===h.FLOAT&&(An=h.RGBA32F),Ft===h.HALF_FLOAT&&(An=h.RGBA16F),Ft===h.UNSIGNED_BYTE&&(An=Dn===tr&&!1===pn?h.SRGB8_ALPHA8:h.RGBA8),Ft===h.UNSIGNED_SHORT_4_4_4_4&&(An=h.RGBA4),Ft===h.UNSIGNED_SHORT_5_5_5_1&&(An=h.RGB5_A1)),(An===h.R16F||An===h.R32F||An===h.RG16F||An===h.RG32F||An===h.RGBA16F||An===h.RGBA32F)&&e.get("EXT_color_buffer_float"),An}function q(Ce,he,Ft){return!0===se(Ce,Ft)||Ce.isFramebufferTexture&&Ce.minFilter!==Jn&&Ce.minFilter!==pr?Math.log2(Math.max(he.width,he.height))+1:void 0!==Ce.mipmaps&&Ce.mipmaps.length>0?Ce.mipmaps.length:Ce.isCompressedTexture&&Array.isArray(Ce.image)?he.mipmaps.length:1}function ne(Ce){return Ce===Jn||1004===Ce||1005===Ce?h.NEAREST:h.LINEAR}function je(Ce){const he=Ce.target;he.removeEventListener("dispose",je),function we(Ce){const he=r.get(Ce);if(void 0===he.__webglInit)return;const Ft=Ce.source,Dn=R.get(Ft);if(Dn){const pn=Dn[he.__cacheKey];pn.usedTimes--,0===pn.usedTimes&&Re(Ce),0===Object.keys(Dn).length&&R.delete(Ft)}r.remove(Ce)}(he),he.isVideoTexture&&w.delete(he)}function dt(Ce){const he=Ce.target;he.removeEventListener("dispose",dt),function Pe(Ce){const he=Ce.texture,Ft=r.get(Ce),Dn=r.get(he);if(void 0!==Dn.__webglTexture&&(h.deleteTexture(Dn.__webglTexture),c.memory.textures--),Ce.depthTexture&&Ce.depthTexture.dispose(),Ce.isWebGLCubeRenderTarget)for(let pn=0;pn<6;pn++){if(Array.isArray(Ft.__webglFramebuffer[pn]))for(let An=0;An<Ft.__webglFramebuffer[pn].length;An++)h.deleteFramebuffer(Ft.__webglFramebuffer[pn][An]);else h.deleteFramebuffer(Ft.__webglFramebuffer[pn]);Ft.__webglDepthbuffer&&h.deleteRenderbuffer(Ft.__webglDepthbuffer[pn])}else{if(Array.isArray(Ft.__webglFramebuffer))for(let pn=0;pn<Ft.__webglFramebuffer.length;pn++)h.deleteFramebuffer(Ft.__webglFramebuffer[pn]);else h.deleteFramebuffer(Ft.__webglFramebuffer);if(Ft.__webglDepthbuffer&&h.deleteRenderbuffer(Ft.__webglDepthbuffer),Ft.__webglMultisampledFramebuffer&&h.deleteFramebuffer(Ft.__webglMultisampledFramebuffer),Ft.__webglColorRenderbuffer)for(let pn=0;pn<Ft.__webglColorRenderbuffer.length;pn++)Ft.__webglColorRenderbuffer[pn]&&h.deleteRenderbuffer(Ft.__webglColorRenderbuffer[pn]);Ft.__webglDepthRenderbuffer&&h.deleteRenderbuffer(Ft.__webglDepthRenderbuffer)}if(Ce.isWebGLMultipleRenderTargets)for(let pn=0,An=he.length;pn<An;pn++){const yi=r.get(he[pn]);yi.__webglTexture&&(h.deleteTexture(yi.__webglTexture),c.memory.textures--),r.remove(he[pn])}r.remove(he),r.remove(Ce)}(he)}function Re(Ce){const he=r.get(Ce);h.deleteTexture(he.__webglTexture),delete R.get(Ce.source)[he.__cacheKey],c.memory.textures--}let $e=0;function Ut(Ce,he){const Ft=r.get(Ce);if(Ce.isVideoTexture&&function yr(Ce){const he=c.render.frame;w.get(Ce)!==he&&(w.set(Ce,he),Ce.update())}(Ce),!1===Ce.isRenderTargetTexture&&Ce.version>0&&Ft.__version!==Ce.version){const Dn=Ce.image;if(null===Dn)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Dn.complete)return void Gi(Ft,Ce,he);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(h.TEXTURE_2D,Ft.__webglTexture,h.TEXTURE0+he)}const Tn={1e3:h.REPEAT,[xi]:h.CLAMP_TO_EDGE,1002:h.MIRRORED_REPEAT},Fn={[Jn]:h.NEAREST,1004:h.NEAREST_MIPMAP_NEAREST,1005:h.NEAREST_MIPMAP_LINEAR,[pr]:h.LINEAR,1007:h.LINEAR_MIPMAP_NEAREST,[Ur]:h.LINEAR_MIPMAP_LINEAR},Xn={512:h.NEVER,519:h.ALWAYS,513:h.LESS,515:h.LEQUAL,514:h.EQUAL,518:h.GEQUAL,516:h.GREATER,517:h.NOTEQUAL};function qn(Ce,he,Ft){if(Ft?(h.texParameteri(Ce,h.TEXTURE_WRAP_S,Tn[he.wrapS]),h.texParameteri(Ce,h.TEXTURE_WRAP_T,Tn[he.wrapT]),(Ce===h.TEXTURE_3D||Ce===h.TEXTURE_2D_ARRAY)&&h.texParameteri(Ce,h.TEXTURE_WRAP_R,Tn[he.wrapR]),h.texParameteri(Ce,h.TEXTURE_MAG_FILTER,Fn[he.magFilter]),h.texParameteri(Ce,h.TEXTURE_MIN_FILTER,Fn[he.minFilter])):(h.texParameteri(Ce,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(Ce,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),(Ce===h.TEXTURE_3D||Ce===h.TEXTURE_2D_ARRAY)&&h.texParameteri(Ce,h.TEXTURE_WRAP_R,h.CLAMP_TO_EDGE),(he.wrapS!==xi||he.wrapT!==xi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),h.texParameteri(Ce,h.TEXTURE_MAG_FILTER,ne(he.magFilter)),h.texParameteri(Ce,h.TEXTURE_MIN_FILTER,ne(he.minFilter)),he.minFilter!==Jn&&he.minFilter!==pr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),he.compareFunction&&(h.texParameteri(Ce,h.TEXTURE_COMPARE_MODE,h.COMPARE_REF_TO_TEXTURE),h.texParameteri(Ce,h.TEXTURE_COMPARE_FUNC,Xn[he.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const Dn=e.get("EXT_texture_filter_anisotropic");if(he.magFilter===Jn||1005!==he.minFilter&&he.minFilter!==Ur||he.type===ke&&!1===e.has("OES_texture_float_linear")||!1===d&&he.type===mt&&!1===e.has("OES_texture_half_float_linear"))return;(he.anisotropy>1||r.get(he).__currentAnisotropy)&&(h.texParameterf(Ce,Dn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(he.anisotropy,s.getMaxAnisotropy())),r.get(he).__currentAnisotropy=he.anisotropy)}}function ri(Ce,he){let Ft=!1;void 0===Ce.__webglInit&&(Ce.__webglInit=!0,he.addEventListener("dispose",je));const Dn=he.source;let pn=R.get(Dn);void 0===pn&&(pn={},R.set(Dn,pn));const An=function At(Ce){const he=[];return he.push(Ce.wrapS),he.push(Ce.wrapT),he.push(Ce.wrapR||0),he.push(Ce.magFilter),he.push(Ce.minFilter),he.push(Ce.anisotropy),he.push(Ce.internalFormat),he.push(Ce.format),he.push(Ce.type),he.push(Ce.generateMipmaps),he.push(Ce.premultiplyAlpha),he.push(Ce.flipY),he.push(Ce.unpackAlignment),he.push(Ce.colorSpace),he.join()}(he);if(An!==Ce.__cacheKey){void 0===pn[An]&&(pn[An]={texture:h.createTexture(),usedTimes:0},c.memory.textures++,Ft=!0),pn[An].usedTimes++;const yi=pn[Ce.__cacheKey];void 0!==yi&&(pn[Ce.__cacheKey].usedTimes--,0===yi.usedTimes&&Re(he)),Ce.__cacheKey=An,Ce.__webglTexture=pn[An].texture}return Ft}function Gi(Ce,he,Ft){let Dn=h.TEXTURE_2D;(he.isDataArrayTexture||he.isCompressedArrayTexture)&&(Dn=h.TEXTURE_2D_ARRAY),he.isData3DTexture&&(Dn=h.TEXTURE_3D);const pn=ri(Ce,he),An=he.source;t.bindTexture(Dn,Ce.__webglTexture,h.TEXTURE0+Ft);const yi=r.get(An);if(An.version!==yi.__version||!0===pn){t.activeTexture(h.TEXTURE0+Ft),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,he.flipY),h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),h.pixelStorei(h.UNPACK_ALIGNMENT,he.unpackAlignment),h.pixelStorei(h.UNPACK_COLORSPACE_CONVERSION_WEBGL,h.NONE);const In=function Q(Ce){return!d&&(Ce.wrapS!==xi||Ce.wrapT!==xi||Ce.minFilter!==Jn&&Ce.minFilter!==pr)}(he)&&!1===j(he.image);let Vt=k(he.image,In,!1,v);Vt=cs(he,Vt);const Ge=j(Vt)||d,dn=a.convert(he.format,he.colorSpace);let Wn,Zn=a.convert(he.type),Hn=_e(he.internalFormat,dn,Zn,he.colorSpace,he.isVideoTexture);qn(Dn,he,Ge);const ji=he.mipmaps,_r=d&&!0!==he.isVideoTexture,nt=void 0===yi.__version||!0===pn,jn=q(he,Vt,Ge);if(he.isDepthTexture)Hn=h.DEPTH_COMPONENT,d?Hn=he.type===ke?h.DEPTH_COMPONENT32F:he.type===_t?h.DEPTH_COMPONENT24:he.type===ti?h.DEPTH24_STENCIL8:h.DEPTH_COMPONENT16:he.type===ke&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),he.format===Yn&&Hn===h.DEPTH_COMPONENT&&1012!==he.type&&he.type!==_t&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),he.type=_t,Zn=a.convert(he.type)),he.format===Hs&&Hn===h.DEPTH_COMPONENT&&(Hn=h.DEPTH_STENCIL,he.type!==ti&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),he.type=ti,Zn=a.convert(he.type))),nt&&(_r?t.texStorage2D(h.TEXTURE_2D,1,Hn,Vt.width,Vt.height):t.texImage2D(h.TEXTURE_2D,0,Hn,Vt.width,Vt.height,0,dn,Zn,null));else if(he.isDataTexture)if(ji.length>0&&Ge){_r&&nt&&t.texStorage2D(h.TEXTURE_2D,jn,Hn,ji[0].width,ji[0].height);for(let Ht=0,xn=ji.length;Ht<xn;Ht++)Wn=ji[Ht],_r?t.texSubImage2D(h.TEXTURE_2D,Ht,0,0,Wn.width,Wn.height,dn,Zn,Wn.data):t.texImage2D(h.TEXTURE_2D,Ht,Hn,Wn.width,Wn.height,0,dn,Zn,Wn.data);he.generateMipmaps=!1}else _r?(nt&&t.texStorage2D(h.TEXTURE_2D,jn,Hn,Vt.width,Vt.height),t.texSubImage2D(h.TEXTURE_2D,0,0,0,Vt.width,Vt.height,dn,Zn,Vt.data)):t.texImage2D(h.TEXTURE_2D,0,Hn,Vt.width,Vt.height,0,dn,Zn,Vt.data);else if(he.isCompressedTexture)if(he.isCompressedArrayTexture){_r&&nt&&t.texStorage3D(h.TEXTURE_2D_ARRAY,jn,Hn,ji[0].width,ji[0].height,Vt.depth);for(let Ht=0,xn=ji.length;Ht<xn;Ht++)Wn=ji[Ht],he.format!==Ui?null!==dn?_r?t.compressedTexSubImage3D(h.TEXTURE_2D_ARRAY,Ht,0,0,0,Wn.width,Wn.height,Vt.depth,dn,Wn.data,0,0):t.compressedTexImage3D(h.TEXTURE_2D_ARRAY,Ht,Hn,Wn.width,Wn.height,Vt.depth,0,Wn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_r?t.texSubImage3D(h.TEXTURE_2D_ARRAY,Ht,0,0,0,Wn.width,Wn.height,Vt.depth,dn,Zn,Wn.data):t.texImage3D(h.TEXTURE_2D_ARRAY,Ht,Hn,Wn.width,Wn.height,Vt.depth,0,dn,Zn,Wn.data)}else{_r&&nt&&t.texStorage2D(h.TEXTURE_2D,jn,Hn,ji[0].width,ji[0].height);for(let Ht=0,xn=ji.length;Ht<xn;Ht++)Wn=ji[Ht],he.format!==Ui?null!==dn?_r?t.compressedTexSubImage2D(h.TEXTURE_2D,Ht,0,0,Wn.width,Wn.height,dn,Wn.data):t.compressedTexImage2D(h.TEXTURE_2D,Ht,Hn,Wn.width,Wn.height,0,Wn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_r?t.texSubImage2D(h.TEXTURE_2D,Ht,0,0,Wn.width,Wn.height,dn,Zn,Wn.data):t.texImage2D(h.TEXTURE_2D,Ht,Hn,Wn.width,Wn.height,0,dn,Zn,Wn.data)}else if(he.isDataArrayTexture)_r?(nt&&t.texStorage3D(h.TEXTURE_2D_ARRAY,jn,Hn,Vt.width,Vt.height,Vt.depth),t.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,0,Vt.width,Vt.height,Vt.depth,dn,Zn,Vt.data)):t.texImage3D(h.TEXTURE_2D_ARRAY,0,Hn,Vt.width,Vt.height,Vt.depth,0,dn,Zn,Vt.data);else if(he.isData3DTexture)_r?(nt&&t.texStorage3D(h.TEXTURE_3D,jn,Hn,Vt.width,Vt.height,Vt.depth),t.texSubImage3D(h.TEXTURE_3D,0,0,0,0,Vt.width,Vt.height,Vt.depth,dn,Zn,Vt.data)):t.texImage3D(h.TEXTURE_3D,0,Hn,Vt.width,Vt.height,Vt.depth,0,dn,Zn,Vt.data);else if(he.isFramebufferTexture){if(nt)if(_r)t.texStorage2D(h.TEXTURE_2D,jn,Hn,Vt.width,Vt.height);else{let Ht=Vt.width,xn=Vt.height;for(let Un=0;Un<jn;Un++)t.texImage2D(h.TEXTURE_2D,Un,Hn,Ht,xn,0,dn,Zn,null),Ht>>=1,xn>>=1}}else if(ji.length>0&&Ge){_r&&nt&&t.texStorage2D(h.TEXTURE_2D,jn,Hn,ji[0].width,ji[0].height);for(let Ht=0,xn=ji.length;Ht<xn;Ht++)Wn=ji[Ht],_r?t.texSubImage2D(h.TEXTURE_2D,Ht,0,0,dn,Zn,Wn):t.texImage2D(h.TEXTURE_2D,Ht,Hn,dn,Zn,Wn);he.generateMipmaps=!1}else _r?(nt&&t.texStorage2D(h.TEXTURE_2D,jn,Hn,Vt.width,Vt.height),t.texSubImage2D(h.TEXTURE_2D,0,0,0,dn,Zn,Vt)):t.texImage2D(h.TEXTURE_2D,0,Hn,dn,Zn,Vt);se(he,Ge)&&oe(Dn),yi.__version=An.version,he.onUpdate&&he.onUpdate(he)}Ce.__version=he.version}function pi(Ce,he,Ft,Dn,pn,An){const yi=a.convert(Ft.format,Ft.colorSpace),In=a.convert(Ft.type),Vt=_e(Ft.internalFormat,yi,In,Ft.colorSpace);if(!r.get(he).__hasExternalTextures){const dn=Math.max(1,he.width>>An),Zn=Math.max(1,he.height>>An);pn===h.TEXTURE_3D||pn===h.TEXTURE_2D_ARRAY?t.texImage3D(pn,An,Vt,dn,Zn,he.depth,0,yi,In,null):t.texImage2D(pn,An,Vt,dn,Zn,0,yi,In,null)}t.bindFramebuffer(h.FRAMEBUFFER,Ce),Di(he)?_.framebufferTexture2DMultisampleEXT(h.FRAMEBUFFER,Dn,pn,r.get(Ft).__webglTexture,0,si(he)):(pn===h.TEXTURE_2D||pn>=h.TEXTURE_CUBE_MAP_POSITIVE_X&&pn<=h.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&h.framebufferTexture2D(h.FRAMEBUFFER,Dn,pn,r.get(Ft).__webglTexture,An),t.bindFramebuffer(h.FRAMEBUFFER,null)}function Ve(Ce,he,Ft){if(h.bindRenderbuffer(h.RENDERBUFFER,Ce),he.depthBuffer&&!he.stencilBuffer){let Dn=h.DEPTH_COMPONENT16;if(Ft||Di(he)){const pn=he.depthTexture;pn&&pn.isDepthTexture&&(pn.type===ke?Dn=h.DEPTH_COMPONENT32F:pn.type===_t&&(Dn=h.DEPTH_COMPONENT24));const An=si(he);Di(he)?_.renderbufferStorageMultisampleEXT(h.RENDERBUFFER,An,Dn,he.width,he.height):h.renderbufferStorageMultisample(h.RENDERBUFFER,An,Dn,he.width,he.height)}else h.renderbufferStorage(h.RENDERBUFFER,Dn,he.width,he.height);h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,Ce)}else if(he.depthBuffer&&he.stencilBuffer){const Dn=si(he);Ft&&!1===Di(he)?h.renderbufferStorageMultisample(h.RENDERBUFFER,Dn,h.DEPTH24_STENCIL8,he.width,he.height):Di(he)?_.renderbufferStorageMultisampleEXT(h.RENDERBUFFER,Dn,h.DEPTH24_STENCIL8,he.width,he.height):h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_STENCIL,he.width,he.height),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,Ce)}else{const Dn=!0===he.isWebGLMultipleRenderTargets?he.texture:[he.texture];for(let pn=0;pn<Dn.length;pn++){const An=Dn[pn],yi=a.convert(An.format,An.colorSpace),In=a.convert(An.type),Vt=_e(An.internalFormat,yi,In,An.colorSpace),Ge=si(he);Ft&&!1===Di(he)?h.renderbufferStorageMultisample(h.RENDERBUFFER,Ge,Vt,he.width,he.height):Di(he)?_.renderbufferStorageMultisampleEXT(h.RENDERBUFFER,Ge,Vt,he.width,he.height):h.renderbufferStorage(h.RENDERBUFFER,Vt,he.width,he.height)}}h.bindRenderbuffer(h.RENDERBUFFER,null)}function tn(Ce){const he=r.get(Ce),Ft=!0===Ce.isWebGLCubeRenderTarget;if(Ce.depthTexture&&!he.__autoAllocateDepthBuffer){if(Ft)throw new Error("target.depthTexture not supported in Cube render targets");!function Sn(Ce,he){if(he&&he.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(h.FRAMEBUFFER,Ce),!he.depthTexture||!he.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(he.depthTexture).__webglTexture||he.depthTexture.image.width!==he.width||he.depthTexture.image.height!==he.height)&&(he.depthTexture.image.width=he.width,he.depthTexture.image.height=he.height,he.depthTexture.needsUpdate=!0),Ut(he.depthTexture,0);const Dn=r.get(he.depthTexture).__webglTexture,pn=si(he);if(he.depthTexture.format===Yn)Di(he)?_.framebufferTexture2DMultisampleEXT(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.TEXTURE_2D,Dn,0,pn):h.framebufferTexture2D(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.TEXTURE_2D,Dn,0);else{if(he.depthTexture.format!==Hs)throw new Error("Unknown depthTexture format");Di(he)?_.framebufferTexture2DMultisampleEXT(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.TEXTURE_2D,Dn,0,pn):h.framebufferTexture2D(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.TEXTURE_2D,Dn,0)}}(he.__webglFramebuffer,Ce)}else if(Ft){he.__webglDepthbuffer=[];for(let Dn=0;Dn<6;Dn++)t.bindFramebuffer(h.FRAMEBUFFER,he.__webglFramebuffer[Dn]),he.__webglDepthbuffer[Dn]=h.createRenderbuffer(),Ve(he.__webglDepthbuffer[Dn],Ce,!1)}else t.bindFramebuffer(h.FRAMEBUFFER,he.__webglFramebuffer),he.__webglDepthbuffer=h.createRenderbuffer(),Ve(he.__webglDepthbuffer,Ce,!1);t.bindFramebuffer(h.FRAMEBUFFER,null)}function si(Ce){return Math.min(b,Ce.samples)}function Di(Ce){const he=r.get(Ce);return d&&Ce.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==he.__useRenderToTexture}function cs(Ce,he){const Ft=Ce.colorSpace,Dn=Ce.format,pn=Ce.type;return!0===Ce.isCompressedTexture||!0===Ce.isVideoTexture||1035===Ce.format||Ft!==is&&""!==Ft&&(Ft===tr||Ft===Oi?!1===d?!0===e.has("EXT_sRGB")&&Dn===Ui?(Ce.format=1035,Ce.minFilter=pr,Ce.generateMipmaps=!1):he=pf.sRGBToLinear(he):(Dn!==Ui||pn!==Lr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ft)),he}this.allocateTextureUnit=function wt(){const Ce=$e;return Ce>=p&&console.warn("THREE.WebGLTextures: Trying to use "+Ce+" texture units while this GPU supports only "+p),$e+=1,Ce},this.resetTextureUnits=function xt(){$e=0},this.setTexture2D=Ut,this.setTexture2DArray=function pt(Ce,he){const Ft=r.get(Ce);Ce.version>0&&Ft.__version!==Ce.version?Gi(Ft,Ce,he):t.bindTexture(h.TEXTURE_2D_ARRAY,Ft.__webglTexture,h.TEXTURE0+he)},this.setTexture3D=function gt(Ce,he){const Ft=r.get(Ce);Ce.version>0&&Ft.__version!==Ce.version?Gi(Ft,Ce,he):t.bindTexture(h.TEXTURE_3D,Ft.__webglTexture,h.TEXTURE0+he)},this.setTextureCube=function _n(Ce,he){const Ft=r.get(Ce);Ce.version>0&&Ft.__version!==Ce.version?function hr(Ce,he,Ft){if(6!==he.image.length)return;const Dn=ri(Ce,he),pn=he.source;t.bindTexture(h.TEXTURE_CUBE_MAP,Ce.__webglTexture,h.TEXTURE0+Ft);const An=r.get(pn);if(pn.version!==An.__version||!0===Dn){t.activeTexture(h.TEXTURE0+Ft),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,he.flipY),h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),h.pixelStorei(h.UNPACK_ALIGNMENT,he.unpackAlignment),h.pixelStorei(h.UNPACK_COLORSPACE_CONVERSION_WEBGL,h.NONE);const yi=he.isCompressedTexture||he.image[0].isCompressedTexture,In=he.image[0]&&he.image[0].isDataTexture,Vt=[];for(let Ht=0;Ht<6;Ht++)Vt[Ht]=yi||In?In?he.image[Ht].image:he.image[Ht]:k(he.image[Ht],!1,!0,g),Vt[Ht]=cs(he,Vt[Ht]);const Ge=Vt[0],dn=j(Ge)||d,Zn=a.convert(he.format,he.colorSpace),Hn=a.convert(he.type),Wn=_e(he.internalFormat,Zn,Hn,he.colorSpace),ji=d&&!0!==he.isVideoTexture,_r=void 0===An.__version||!0===Dn;let jn,nt=q(he,Ge,dn);if(qn(h.TEXTURE_CUBE_MAP,he,dn),yi){ji&&_r&&t.texStorage2D(h.TEXTURE_CUBE_MAP,nt,Wn,Ge.width,Ge.height);for(let Ht=0;Ht<6;Ht++){jn=Vt[Ht].mipmaps;for(let xn=0;xn<jn.length;xn++){const Un=jn[xn];he.format!==Ui?null!==Zn?ji?t.compressedTexSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn,0,0,Un.width,Un.height,Zn,Un.data):t.compressedTexImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn,Wn,Un.width,Un.height,0,Un.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ji?t.texSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn,0,0,Un.width,Un.height,Zn,Hn,Un.data):t.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn,Wn,Un.width,Un.height,0,Zn,Hn,Un.data)}}}else{jn=he.mipmaps,ji&&_r&&(jn.length>0&&nt++,t.texStorage2D(h.TEXTURE_CUBE_MAP,nt,Wn,Vt[0].width,Vt[0].height));for(let Ht=0;Ht<6;Ht++)if(In){ji?t.texSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,Vt[Ht].width,Vt[Ht].height,Zn,Hn,Vt[Ht].data):t.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,Wn,Vt[Ht].width,Vt[Ht].height,0,Zn,Hn,Vt[Ht].data);for(let xn=0;xn<jn.length;xn++){const br=jn[xn].image[Ht].image;ji?t.texSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn+1,0,0,br.width,br.height,Zn,Hn,br.data):t.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn+1,Wn,br.width,br.height,0,Zn,Hn,br.data)}}else{ji?t.texSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,Zn,Hn,Vt[Ht]):t.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,Wn,Zn,Hn,Vt[Ht]);for(let xn=0;xn<jn.length;xn++){const Un=jn[xn];ji?t.texSubImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn+1,0,0,Zn,Hn,Un.image[Ht]):t.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,xn+1,Wn,Zn,Hn,Un.image[Ht])}}}se(he,dn)&&oe(h.TEXTURE_CUBE_MAP),An.__version=pn.version,he.onUpdate&&he.onUpdate(he)}Ce.__version=he.version}(Ft,Ce,he):t.bindTexture(h.TEXTURE_CUBE_MAP,Ft.__webglTexture,h.TEXTURE0+he)},this.rebindTextures=function bn(Ce,he,Ft){const Dn=r.get(Ce);void 0!==he&&pi(Dn.__webglFramebuffer,Ce,Ce.texture,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,0),void 0!==Ft&&tn(Ce)},this.setupRenderTarget=function fn(Ce){const he=Ce.texture,Ft=r.get(Ce),Dn=r.get(he);Ce.addEventListener("dispose",dt),!0!==Ce.isWebGLMultipleRenderTargets&&(void 0===Dn.__webglTexture&&(Dn.__webglTexture=h.createTexture()),Dn.__version=he.version,c.memory.textures++);const pn=!0===Ce.isWebGLCubeRenderTarget,An=!0===Ce.isWebGLMultipleRenderTargets,yi=j(Ce)||d;if(pn){Ft.__webglFramebuffer=[];for(let In=0;In<6;In++)if(d&&he.mipmaps&&he.mipmaps.length>0){Ft.__webglFramebuffer[In]=[];for(let Vt=0;Vt<he.mipmaps.length;Vt++)Ft.__webglFramebuffer[In][Vt]=h.createFramebuffer()}else Ft.__webglFramebuffer[In]=h.createFramebuffer()}else{if(d&&he.mipmaps&&he.mipmaps.length>0){Ft.__webglFramebuffer=[];for(let In=0;In<he.mipmaps.length;In++)Ft.__webglFramebuffer[In]=h.createFramebuffer()}else Ft.__webglFramebuffer=h.createFramebuffer();if(An)if(s.drawBuffers){const In=Ce.texture;for(let Vt=0,Ge=In.length;Vt<Ge;Vt++){const dn=r.get(In[Vt]);void 0===dn.__webglTexture&&(dn.__webglTexture=h.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(d&&Ce.samples>0&&!1===Di(Ce)){const In=An?he:[he];Ft.__webglMultisampledFramebuffer=h.createFramebuffer(),Ft.__webglColorRenderbuffer=[],t.bindFramebuffer(h.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer);for(let Vt=0;Vt<In.length;Vt++){const Ge=In[Vt];Ft.__webglColorRenderbuffer[Vt]=h.createRenderbuffer(),h.bindRenderbuffer(h.RENDERBUFFER,Ft.__webglColorRenderbuffer[Vt]);const dn=a.convert(Ge.format,Ge.colorSpace),Zn=a.convert(Ge.type),Hn=_e(Ge.internalFormat,dn,Zn,Ge.colorSpace,!0===Ce.isXRRenderTarget),Wn=si(Ce);h.renderbufferStorageMultisample(h.RENDERBUFFER,Wn,Hn,Ce.width,Ce.height),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0+Vt,h.RENDERBUFFER,Ft.__webglColorRenderbuffer[Vt])}h.bindRenderbuffer(h.RENDERBUFFER,null),Ce.depthBuffer&&(Ft.__webglDepthRenderbuffer=h.createRenderbuffer(),Ve(Ft.__webglDepthRenderbuffer,Ce,!0)),t.bindFramebuffer(h.FRAMEBUFFER,null)}}if(pn){t.bindTexture(h.TEXTURE_CUBE_MAP,Dn.__webglTexture),qn(h.TEXTURE_CUBE_MAP,he,yi);for(let In=0;In<6;In++)if(d&&he.mipmaps&&he.mipmaps.length>0)for(let Vt=0;Vt<he.mipmaps.length;Vt++)pi(Ft.__webglFramebuffer[In][Vt],Ce,he,h.COLOR_ATTACHMENT0,h.TEXTURE_CUBE_MAP_POSITIVE_X+In,Vt);else pi(Ft.__webglFramebuffer[In],Ce,he,h.COLOR_ATTACHMENT0,h.TEXTURE_CUBE_MAP_POSITIVE_X+In,0);se(he,yi)&&oe(h.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(An){const In=Ce.texture;for(let Vt=0,Ge=In.length;Vt<Ge;Vt++){const dn=In[Vt],Zn=r.get(dn);t.bindTexture(h.TEXTURE_2D,Zn.__webglTexture),qn(h.TEXTURE_2D,dn,yi),pi(Ft.__webglFramebuffer,Ce,dn,h.COLOR_ATTACHMENT0+Vt,h.TEXTURE_2D,0),se(dn,yi)&&oe(h.TEXTURE_2D)}t.unbindTexture()}else{let In=h.TEXTURE_2D;if((Ce.isWebGL3DRenderTarget||Ce.isWebGLArrayRenderTarget)&&(d?In=Ce.isWebGL3DRenderTarget?h.TEXTURE_3D:h.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(In,Dn.__webglTexture),qn(In,he,yi),d&&he.mipmaps&&he.mipmaps.length>0)for(let Vt=0;Vt<he.mipmaps.length;Vt++)pi(Ft.__webglFramebuffer[Vt],Ce,he,h.COLOR_ATTACHMENT0,In,Vt);else pi(Ft.__webglFramebuffer,Ce,he,h.COLOR_ATTACHMENT0,In,0);se(he,yi)&&oe(In),t.unbindTexture()}Ce.depthBuffer&&tn(Ce)},this.updateRenderTargetMipmap=function vi(Ce){const he=j(Ce)||d,Ft=!0===Ce.isWebGLMultipleRenderTargets?Ce.texture:[Ce.texture];for(let Dn=0,pn=Ft.length;Dn<pn;Dn++){const An=Ft[Dn];if(se(An,he)){const yi=Ce.isWebGLCubeRenderTarget?h.TEXTURE_CUBE_MAP:h.TEXTURE_2D,In=r.get(An).__webglTexture;t.bindTexture(yi,In),oe(yi),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ni(Ce){if(d&&Ce.samples>0&&!1===Di(Ce)){const he=Ce.isWebGLMultipleRenderTargets?Ce.texture:[Ce.texture],Ft=Ce.width,Dn=Ce.height;let pn=h.COLOR_BUFFER_BIT;const An=[],yi=Ce.stencilBuffer?h.DEPTH_STENCIL_ATTACHMENT:h.DEPTH_ATTACHMENT,In=r.get(Ce),Vt=!0===Ce.isWebGLMultipleRenderTargets;if(Vt)for(let Ge=0;Ge<he.length;Ge++)t.bindFramebuffer(h.FRAMEBUFFER,In.__webglMultisampledFramebuffer),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0+Ge,h.RENDERBUFFER,null),t.bindFramebuffer(h.FRAMEBUFFER,In.__webglFramebuffer),h.framebufferTexture2D(h.DRAW_FRAMEBUFFER,h.COLOR_ATTACHMENT0+Ge,h.TEXTURE_2D,null,0);t.bindFramebuffer(h.READ_FRAMEBUFFER,In.__webglMultisampledFramebuffer),t.bindFramebuffer(h.DRAW_FRAMEBUFFER,In.__webglFramebuffer);for(let Ge=0;Ge<he.length;Ge++){An.push(h.COLOR_ATTACHMENT0+Ge),Ce.depthBuffer&&An.push(yi);const dn=void 0!==In.__ignoreDepthValues&&In.__ignoreDepthValues;if(!1===dn&&(Ce.depthBuffer&&(pn|=h.DEPTH_BUFFER_BIT),Ce.stencilBuffer&&(pn|=h.STENCIL_BUFFER_BIT)),Vt&&h.framebufferRenderbuffer(h.READ_FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.RENDERBUFFER,In.__webglColorRenderbuffer[Ge]),!0===dn&&(h.invalidateFramebuffer(h.READ_FRAMEBUFFER,[yi]),h.invalidateFramebuffer(h.DRAW_FRAMEBUFFER,[yi])),Vt){const Zn=r.get(he[Ge]).__webglTexture;h.framebufferTexture2D(h.DRAW_FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,Zn,0)}h.blitFramebuffer(0,0,Ft,Dn,0,0,Ft,Dn,pn,h.NEAREST),M&&h.invalidateFramebuffer(h.READ_FRAMEBUFFER,An)}if(t.bindFramebuffer(h.READ_FRAMEBUFFER,null),t.bindFramebuffer(h.DRAW_FRAMEBUFFER,null),Vt)for(let Ge=0;Ge<he.length;Ge++){t.bindFramebuffer(h.FRAMEBUFFER,In.__webglMultisampledFramebuffer),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0+Ge,h.RENDERBUFFER,In.__webglColorRenderbuffer[Ge]);const dn=r.get(he[Ge]).__webglTexture;t.bindFramebuffer(h.FRAMEBUFFER,In.__webglFramebuffer),h.framebufferTexture2D(h.DRAW_FRAMEBUFFER,h.COLOR_ATTACHMENT0+Ge,h.TEXTURE_2D,dn,0)}t.bindFramebuffer(h.DRAW_FRAMEBUFFER,In.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=tn,this.setupFrameBufferTexture=pi,this.useMultisampledRTT=Di}function oh(h,e,t){const r=t.isWebGL2;return{convert:function s(a,c=""){let d;const p=c===tr||c===Oi?1:0;if(a===Lr)return h.UNSIGNED_BYTE;if(1017===a)return h.UNSIGNED_SHORT_4_4_4_4;if(1018===a)return h.UNSIGNED_SHORT_5_5_5_1;if(1010===a)return h.BYTE;if(1011===a)return h.SHORT;if(1012===a)return h.UNSIGNED_SHORT;if(1013===a)return h.INT;if(a===_t)return h.UNSIGNED_INT;if(a===ke)return h.FLOAT;if(a===mt)return r?h.HALF_FLOAT:(d=e.get("OES_texture_half_float"),null!==d?d.HALF_FLOAT_OES:null);if(1021===a)return h.ALPHA;if(a===Ui)return h.RGBA;if(1024===a)return h.LUMINANCE;if(1025===a)return h.LUMINANCE_ALPHA;if(a===Yn)return h.DEPTH_COMPONENT;if(a===Hs)return h.DEPTH_STENCIL;if(1035===a)return d=e.get("EXT_sRGB"),null!==d?d.SRGB_ALPHA_EXT:null;if(1028===a)return h.RED;if(1029===a)return h.RED_INTEGER;if(1030===a)return h.RG;if(1031===a)return h.RG_INTEGER;if(1033===a)return h.RGBA_INTEGER;if(33776===a||33777===a||33778===a||33779===a)if(1===p){if(d=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===d)return null;if(33776===a)return d.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===a)return d.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(d=e.get("WEBGL_compressed_texture_s3tc"),null===d)return null;if(33776===a)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a){if(d=e.get("WEBGL_compressed_texture_pvrtc"),null===d)return null;if(35840===a)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a)return d=e.get("WEBGL_compressed_texture_etc1"),null!==d?d.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===a||37496===a){if(d=e.get("WEBGL_compressed_texture_etc"),null===d)return null;if(37492===a)return 1===p?d.COMPRESSED_SRGB8_ETC2:d.COMPRESSED_RGB8_ETC2;if(37496===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:d.COMPRESSED_RGBA8_ETC2_EAC}if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a){if(d=e.get("WEBGL_compressed_texture_astc"),null===d)return null;if(37808===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:d.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:d.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:d.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:d.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:d.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:d.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:d.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:d.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:d.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:d.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:d.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:d.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:d.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===a)return 1===p?d.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:d.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===a||36494===a||36495===a){if(d=e.get("EXT_texture_compression_bptc"),null===d)return null;if(36492===a)return 1===p?d.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:d.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===a)return d.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===a)return d.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===a||36284===a||36285===a||36286===a){if(d=e.get("EXT_texture_compression_rgtc"),null===d)return null;if(36492===a)return d.COMPRESSED_RED_RGTC1_EXT;if(36284===a)return d.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===a)return d.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===a)return d.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===ti?r?h.UNSIGNED_INT_24_8:(d=e.get("WEBGL_depth_texture"),null!==d?d.UNSIGNED_INT_24_8_WEBGL:null):void 0!==h[a]?h[a]:null}}}class n0 extends Eo{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class nd extends Co{constructor(){super(),this.isGroup=!0,this.type="Group"}}const r0={type:"move"};class s0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new nd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new nd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new de,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new de),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new nd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new de,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new de),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let s=null,a=null,c=null;const d=this._targetRay,p=this._grip,g=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(g&&e.hand){c=!0;for(const P of e.hand.values()){const R=t.getJointPose(P,r),I=this._getHandJoint(g,P);null!==R&&(I.matrix.fromArray(R.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),I.matrixWorldNeedsUpdate=!0,I.jointRadius=R.radius),I.visible=null!==R}const _=g.joints["index-finger-tip"].position.distanceTo(g.joints["thumb-tip"].position),M=.02,w=.005;g.inputState.pinching&&_>M+w?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!g.inputState.pinching&&_<=M-w&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),null!==a&&(p.matrix.fromArray(a.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,a.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(a.linearVelocity)):p.hasLinearVelocity=!1,a.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(a.angularVelocity)):p.hasAngularVelocity=!1));null!==d&&(s=t.getPose(e.targetRaySpace,r),null===s&&null!==a&&(s=a),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1,this.dispatchEvent(r0)))}return null!==d&&(d.visible=null!==s),null!==p&&(p.visible=null!==a),null!==g&&(g.visible=null!==c),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new nd;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class TC extends Zo{constructor(e,t,r,s,a,c,d,p,g,v){if((v=void 0!==v?v:Yn)!==Yn&&v!==Hs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&v===Yn&&(r=_t),void 0===r&&v===Hs&&(r=ti),super(null,s,a,c,d,p,v,r,g),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==d?d:Jn,this.minFilter=void 0!==p?p:Jn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class DC extends vr{constructor(e,t){super();const r=this;let s=null,a=1,c=null,d="local-floor",p=1,g=null,v=null,b=null,_=null,M=null,w=null;const P=t.getContextAttributes();let R=null,I=null;const V=[],k=[],j=new Eo;j.layers.enable(1),j.viewport=new Br;const Q=new Eo;Q.layers.enable(2),Q.viewport=new Br;const se=[j,Q],oe=new n0;oe.layers.enable(1),oe.layers.enable(2);let _e=null,q=null;function ne(pt){const gt=k.indexOf(pt.inputSource);if(-1===gt)return;const _n=V[gt];void 0!==_n&&(_n.update(pt.inputSource,pt.frame,g||c),_n.dispatchEvent({type:pt.type,data:pt.inputSource}))}function je(){s.removeEventListener("select",ne),s.removeEventListener("selectstart",ne),s.removeEventListener("selectend",ne),s.removeEventListener("squeeze",ne),s.removeEventListener("squeezestart",ne),s.removeEventListener("squeezeend",ne),s.removeEventListener("end",je),s.removeEventListener("inputsourceschange",dt);for(let pt=0;pt<V.length;pt++){const gt=k[pt];null!==gt&&(k[pt]=null,V[pt].disconnect(gt))}_e=null,q=null,e.setRenderTarget(R),M=null,_=null,b=null,s=null,I=null,Ut.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function dt(pt){for(let gt=0;gt<pt.removed.length;gt++){const _n=pt.removed[gt],Tn=k.indexOf(_n);Tn>=0&&(k[Tn]=null,V[Tn].disconnect(_n))}for(let gt=0;gt<pt.added.length;gt++){const _n=pt.added[gt];let Tn=k.indexOf(_n);if(-1===Tn){for(let Xn=0;Xn<V.length;Xn++){if(Xn>=k.length){k.push(_n),Tn=Xn;break}if(null===k[Xn]){k[Xn]=_n,Tn=Xn;break}}if(-1===Tn)break}const Fn=V[Tn];Fn&&Fn.connect(_n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(pt){let gt=V[pt];return void 0===gt&&(gt=new s0,V[pt]=gt),gt.getTargetRaySpace()},this.getControllerGrip=function(pt){let gt=V[pt];return void 0===gt&&(gt=new s0,V[pt]=gt),gt.getGripSpace()},this.getHand=function(pt){let gt=V[pt];return void 0===gt&&(gt=new s0,V[pt]=gt),gt.getHandSpace()},this.setFramebufferScaleFactor=function(pt){a=pt,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pt){d=pt,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||c},this.setReferenceSpace=function(pt){g=pt},this.getBaseLayer=function(){return null!==_?_:M},this.getBinding=function(){return b},this.getFrame=function(){return w},this.getSession=function(){return s},this.setSession=function(){var pt=(0,Fe.Z)(function*(gt){if(s=gt,null!==s){if(R=e.getRenderTarget(),s.addEventListener("select",ne),s.addEventListener("selectstart",ne),s.addEventListener("selectend",ne),s.addEventListener("squeeze",ne),s.addEventListener("squeezestart",ne),s.addEventListener("squeezeend",ne),s.addEventListener("end",je),s.addEventListener("inputsourceschange",dt),!0!==P.xrCompatible&&(yield t.makeXRCompatible()),void 0===s.renderState.layers||!1===e.capabilities.isWebGL2)M=new XRWebGLLayer(s,t,{antialias:void 0!==s.renderState.layers||P.antialias,alpha:!0,depth:P.depth,stencil:P.stencil,framebufferScaleFactor:a}),s.updateRenderState({baseLayer:M}),I=new H(M.framebufferWidth,M.framebufferHeight,{format:Ui,type:Lr,colorSpace:e.outputColorSpace,stencilBuffer:P.stencil});else{let _n=null,Tn=null,Fn=null;P.depth&&(Fn=P.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,_n=P.stencil?Hs:Yn,Tn=P.stencil?ti:_t);const Xn={colorFormat:t.RGBA8,depthFormat:Fn,scaleFactor:a};b=new XRWebGLBinding(s,t),_=b.createProjectionLayer(Xn),s.updateRenderState({layers:[_]}),I=new H(_.textureWidth,_.textureHeight,{format:Ui,type:Lr,depthTexture:new TC(_.textureWidth,_.textureHeight,Tn,void 0,void 0,void 0,void 0,void 0,void 0,_n),stencilBuffer:P.stencil,colorSpace:e.outputColorSpace,samples:P.antialias?4:0}),e.properties.get(I).__ignoreDepthValues=_.ignoreDepthValues}I.isXRRenderTarget=!0,this.setFoveation(p),g=null,c=yield s.requestReferenceSpace(d),Ut.setContext(s),Ut.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}});return function(gt){return pt.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode};const we=new de,Re=new de;function $e(pt,gt){null===gt?pt.matrixWorld.copy(pt.matrix):pt.matrixWorld.multiplyMatrices(gt.matrixWorld,pt.matrix),pt.matrixWorldInverse.copy(pt.matrixWorld).invert()}this.updateCamera=function(pt){if(null===s)return;oe.near=Q.near=j.near=pt.near,oe.far=Q.far=j.far=pt.far,(_e!==oe.near||q!==oe.far)&&(s.updateRenderState({depthNear:oe.near,depthFar:oe.far}),_e=oe.near,q=oe.far);const gt=pt.parent,_n=oe.cameras;$e(oe,gt);for(let Tn=0;Tn<_n.length;Tn++)$e(_n[Tn],gt);2===_n.length?function Pe(pt,gt,_n){we.setFromMatrixPosition(gt.matrixWorld),Re.setFromMatrixPosition(_n.matrixWorld);const Tn=we.distanceTo(Re),Fn=gt.projectionMatrix.elements,Xn=_n.projectionMatrix.elements,qn=Fn[14]/(Fn[10]-1),ri=Fn[14]/(Fn[10]+1),Gi=(Fn[9]+1)/Fn[5],hr=(Fn[9]-1)/Fn[5],pi=(Fn[8]-1)/Fn[0],Ve=(Xn[8]+1)/Xn[0],Sn=qn*pi,tn=qn*Ve,bn=Tn/(-pi+Ve),fn=bn*-pi;gt.matrixWorld.decompose(pt.position,pt.quaternion,pt.scale),pt.translateX(fn),pt.translateZ(bn),pt.matrixWorld.compose(pt.position,pt.quaternion,pt.scale),pt.matrixWorldInverse.copy(pt.matrixWorld).invert();const vi=qn+bn,ni=ri+bn;pt.projectionMatrix.makePerspective(Sn-fn,tn+(Tn-fn),Gi*ri/ni*vi,hr*ri/ni*vi,vi,ni),pt.projectionMatrixInverse.copy(pt.projectionMatrix).invert()}(oe,j,Q):oe.projectionMatrix.copy(j.projectionMatrix),function xt(pt,gt,_n){null===_n?pt.matrix.copy(gt.matrixWorld):(pt.matrix.copy(_n.matrixWorld),pt.matrix.invert(),pt.matrix.multiply(gt.matrixWorld)),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt.updateMatrixWorld(!0),pt.projectionMatrix.copy(gt.projectionMatrix),pt.projectionMatrixInverse.copy(gt.projectionMatrixInverse),pt.isPerspectiveCamera&&(pt.fov=2*rs*Math.atan(1/pt.projectionMatrix.elements[5]),pt.zoom=1)}(pt,oe,gt)},this.getCamera=function(){return oe},this.getFoveation=function(){if(null!==_||null!==M)return p},this.setFoveation=function(pt){p=pt,null!==_&&(_.fixedFoveation=pt),null!==M&&void 0!==M.fixedFoveation&&(M.fixedFoveation=pt)};let wt=null;const Ut=new Df;Ut.setAnimationLoop(function At(pt,gt){if(v=gt.getViewerPose(g||c),w=gt,null!==v){const _n=v.views;null!==M&&(e.setRenderTargetFramebuffer(I,M.framebuffer),e.setRenderTarget(I));let Tn=!1;_n.length!==oe.cameras.length&&(oe.cameras.length=0,Tn=!0);for(let Fn=0;Fn<_n.length;Fn++){const Xn=_n[Fn];let qn=null;if(null!==M)qn=M.getViewport(Xn);else{const Gi=b.getViewSubImage(_,Xn);qn=Gi.viewport,0===Fn&&(e.setRenderTargetTextures(I,Gi.colorTexture,_.ignoreDepthValues?void 0:Gi.depthStencilTexture),e.setRenderTarget(I))}let ri=se[Fn];void 0===ri&&(ri=new Eo,ri.layers.enable(Fn),ri.viewport=new Br,se[Fn]=ri),ri.matrix.fromArray(Xn.transform.matrix),ri.matrix.decompose(ri.position,ri.quaternion,ri.scale),ri.projectionMatrix.fromArray(Xn.projectionMatrix),ri.projectionMatrixInverse.copy(ri.projectionMatrix).invert(),ri.viewport.set(qn.x,qn.y,qn.width,qn.height),0===Fn&&(oe.matrix.copy(ri.matrix),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale)),!0===Tn&&oe.cameras.push(ri)}}for(let _n=0;_n<V.length;_n++){const Tn=k[_n],Fn=V[_n];null!==Tn&&void 0!==Fn&&Fn.update(Tn,gt,g||c)}wt&&wt(pt,gt),gt.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:gt}),w=null}),this.setAnimationLoop=function(pt){wt=pt},this.dispose=function(){}}}function ig(h,e){function t(R,I){!0===R.matrixAutoUpdate&&R.updateMatrix(),I.value.copy(R.matrix)}function a(R,I){R.opacity.value=I.opacity,I.color&&R.diffuse.value.copy(I.color),I.emissive&&R.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(R.map.value=I.map,t(I.map,R.mapTransform)),I.alphaMap&&(R.alphaMap.value=I.alphaMap,t(I.alphaMap,R.alphaMapTransform)),I.bumpMap&&(R.bumpMap.value=I.bumpMap,t(I.bumpMap,R.bumpMapTransform),R.bumpScale.value=I.bumpScale,1===I.side&&(R.bumpScale.value*=-1)),I.normalMap&&(R.normalMap.value=I.normalMap,t(I.normalMap,R.normalMapTransform),R.normalScale.value.copy(I.normalScale),1===I.side&&R.normalScale.value.negate()),I.displacementMap&&(R.displacementMap.value=I.displacementMap,t(I.displacementMap,R.displacementMapTransform),R.displacementScale.value=I.displacementScale,R.displacementBias.value=I.displacementBias),I.emissiveMap&&(R.emissiveMap.value=I.emissiveMap,t(I.emissiveMap,R.emissiveMapTransform)),I.specularMap&&(R.specularMap.value=I.specularMap,t(I.specularMap,R.specularMapTransform)),I.alphaTest>0&&(R.alphaTest.value=I.alphaTest);const V=e.get(I).envMap;if(V&&(R.envMap.value=V,R.flipEnvMap.value=V.isCubeTexture&&!1===V.isRenderTargetTexture?-1:1,R.reflectivity.value=I.reflectivity,R.ior.value=I.ior,R.refractionRatio.value=I.refractionRatio),I.lightMap){R.lightMap.value=I.lightMap;const k=!0===h._useLegacyLights?Math.PI:1;R.lightMapIntensity.value=I.lightMapIntensity*k,t(I.lightMap,R.lightMapTransform)}I.aoMap&&(R.aoMap.value=I.aoMap,R.aoMapIntensity.value=I.aoMapIntensity,t(I.aoMap,R.aoMapTransform))}return{refreshFogUniforms:function r(R,I){I.color.getRGB(R.fogColor.value,Em(h)),I.isFog?(R.fogNear.value=I.near,R.fogFar.value=I.far):I.isFogExp2&&(R.fogDensity.value=I.density)},refreshMaterialUniforms:function s(R,I,V,k,j){I.isMeshBasicMaterial||I.isMeshLambertMaterial?a(R,I):I.isMeshToonMaterial?(a(R,I),function b(R,I){I.gradientMap&&(R.gradientMap.value=I.gradientMap)}(R,I)):I.isMeshPhongMaterial?(a(R,I),function v(R,I){R.specular.value.copy(I.specular),R.shininess.value=Math.max(I.shininess,1e-4)}(R,I)):I.isMeshStandardMaterial?(a(R,I),function _(R,I){R.metalness.value=I.metalness,I.metalnessMap&&(R.metalnessMap.value=I.metalnessMap,t(I.metalnessMap,R.metalnessMapTransform)),R.roughness.value=I.roughness,I.roughnessMap&&(R.roughnessMap.value=I.roughnessMap,t(I.roughnessMap,R.roughnessMapTransform)),e.get(I).envMap&&(R.envMapIntensity.value=I.envMapIntensity)}(R,I),I.isMeshPhysicalMaterial&&function M(R,I,V){R.ior.value=I.ior,I.sheen>0&&(R.sheenColor.value.copy(I.sheenColor).multiplyScalar(I.sheen),R.sheenRoughness.value=I.sheenRoughness,I.sheenColorMap&&(R.sheenColorMap.value=I.sheenColorMap,t(I.sheenColorMap,R.sheenColorMapTransform)),I.sheenRoughnessMap&&(R.sheenRoughnessMap.value=I.sheenRoughnessMap,t(I.sheenRoughnessMap,R.sheenRoughnessMapTransform))),I.clearcoat>0&&(R.clearcoat.value=I.clearcoat,R.clearcoatRoughness.value=I.clearcoatRoughness,I.clearcoatMap&&(R.clearcoatMap.value=I.clearcoatMap,t(I.clearcoatMap,R.clearcoatMapTransform)),I.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap,t(I.clearcoatRoughnessMap,R.clearcoatRoughnessMapTransform)),I.clearcoatNormalMap&&(R.clearcoatNormalMap.value=I.clearcoatNormalMap,t(I.clearcoatNormalMap,R.clearcoatNormalMapTransform),R.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),1===I.side&&R.clearcoatNormalScale.value.negate())),I.iridescence>0&&(R.iridescence.value=I.iridescence,R.iridescenceIOR.value=I.iridescenceIOR,R.iridescenceThicknessMinimum.value=I.iridescenceThicknessRange[0],R.iridescenceThicknessMaximum.value=I.iridescenceThicknessRange[1],I.iridescenceMap&&(R.iridescenceMap.value=I.iridescenceMap,t(I.iridescenceMap,R.iridescenceMapTransform)),I.iridescenceThicknessMap&&(R.iridescenceThicknessMap.value=I.iridescenceThicknessMap,t(I.iridescenceThicknessMap,R.iridescenceThicknessMapTransform))),I.transmission>0&&(R.transmission.value=I.transmission,R.transmissionSamplerMap.value=V.texture,R.transmissionSamplerSize.value.set(V.width,V.height),I.transmissionMap&&(R.transmissionMap.value=I.transmissionMap,t(I.transmissionMap,R.transmissionMapTransform)),R.thickness.value=I.thickness,I.thicknessMap&&(R.thicknessMap.value=I.thicknessMap,t(I.thicknessMap,R.thicknessMapTransform)),R.attenuationDistance.value=I.attenuationDistance,R.attenuationColor.value.copy(I.attenuationColor)),I.anisotropy>0&&(R.anisotropyVector.value.set(I.anisotropy*Math.cos(I.anisotropyRotation),I.anisotropy*Math.sin(I.anisotropyRotation)),I.anisotropyMap&&(R.anisotropyMap.value=I.anisotropyMap,t(I.anisotropyMap,R.anisotropyMapTransform))),R.specularIntensity.value=I.specularIntensity,R.specularColor.value.copy(I.specularColor),I.specularColorMap&&(R.specularColorMap.value=I.specularColorMap,t(I.specularColorMap,R.specularColorMapTransform)),I.specularIntensityMap&&(R.specularIntensityMap.value=I.specularIntensityMap,t(I.specularIntensityMap,R.specularIntensityMapTransform))}(R,I,j)):I.isMeshMatcapMaterial?(a(R,I),function w(R,I){I.matcap&&(R.matcap.value=I.matcap)}(R,I)):I.isMeshDepthMaterial?a(R,I):I.isMeshDistanceMaterial?(a(R,I),function P(R,I){const V=e.get(I).light;R.referencePosition.value.setFromMatrixPosition(V.matrixWorld),R.nearDistance.value=V.shadow.camera.near,R.farDistance.value=V.shadow.camera.far}(R,I)):I.isMeshNormalMaterial?a(R,I):I.isLineBasicMaterial?(function c(R,I){R.diffuse.value.copy(I.color),R.opacity.value=I.opacity,I.map&&(R.map.value=I.map,t(I.map,R.mapTransform))}(R,I),I.isLineDashedMaterial&&function d(R,I){R.dashSize.value=I.dashSize,R.totalSize.value=I.dashSize+I.gapSize,R.scale.value=I.scale}(R,I)):I.isPointsMaterial?function p(R,I,V,k){R.diffuse.value.copy(I.color),R.opacity.value=I.opacity,R.size.value=I.size*V,R.scale.value=.5*k,I.map&&(R.map.value=I.map,t(I.map,R.uvTransform)),I.alphaMap&&(R.alphaMap.value=I.alphaMap,t(I.alphaMap,R.alphaMapTransform)),I.alphaTest>0&&(R.alphaTest.value=I.alphaTest)}(R,I,V,k):I.isSpriteMaterial?function g(R,I){R.diffuse.value.copy(I.color),R.opacity.value=I.opacity,R.rotation.value=I.rotation,I.map&&(R.map.value=I.map,t(I.map,R.mapTransform)),I.alphaMap&&(R.alphaMap.value=I.alphaMap,t(I.alphaMap,R.alphaMapTransform)),I.alphaTest>0&&(R.alphaTest.value=I.alphaTest)}(R,I):I.isShadowMaterial?(R.color.value.copy(I.color),R.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function rg(h,e,t,r){let s={},a={},c=[];const d=t.isWebGL2?h.getParameter(h.MAX_UNIFORM_BUFFER_BINDINGS):0;function M(V,k,j){const Q=V.value;if(void 0===j[k]){if("number"==typeof Q)j[k]=Q;else{const se=Array.isArray(Q)?Q:[Q],oe=[];for(let _e=0;_e<se.length;_e++)oe.push(se[_e].clone());j[k]=oe}return!0}if("number"==typeof Q){if(j[k]!==Q)return j[k]=Q,!0}else{const se=Array.isArray(j[k])?j[k]:[j[k]],oe=Array.isArray(Q)?Q:[Q];for(let _e=0;_e<se.length;_e++){const q=se[_e];if(!1===q.equals(oe[_e]))return q.copy(oe[_e]),!0}}return!1}function P(V){const k={boundary:0,storage:0};return"number"==typeof V?(k.boundary=4,k.storage=4):V.isVector2?(k.boundary=8,k.storage=8):V.isVector3||V.isColor?(k.boundary=16,k.storage=12):V.isVector4?(k.boundary=16,k.storage=16):V.isMatrix3?(k.boundary=48,k.storage=48):V.isMatrix4?(k.boundary=64,k.storage=64):V.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",V),k}function R(V){const k=V.target;k.removeEventListener("dispose",R);const j=c.indexOf(k.__bindingPointIndex);c.splice(j,1),h.deleteBuffer(s[k.id]),delete s[k.id],delete a[k.id]}return{bind:function p(V,k){r.uniformBlockBinding(V,k.program)},update:function g(V,k){let j=s[V.id];void 0===j&&(function w(V){const k=V.uniforms;let j=0;let se=0;for(let oe=0,_e=k.length;oe<_e;oe++){const q=k[oe],ne={boundary:0,storage:0},je=Array.isArray(q.value)?q.value:[q.value];for(let dt=0,we=je.length;dt<we;dt++){const Pe=P(je[dt]);ne.boundary+=Pe.boundary,ne.storage+=Pe.storage}q.__data=new Float32Array(ne.storage/Float32Array.BYTES_PER_ELEMENT),q.__offset=j,oe>0&&(se=j%16,0!==se&&16-se-ne.boundary<0&&(j+=16-se,q.__offset=j)),j+=ne.storage}se=j%16,se>0&&(j+=16-se),V.__size=j,V.__cache={}}(V),j=function v(V){const k=function b(){for(let V=0;V<d;V++)if(-1===c.indexOf(V))return c.push(V),V;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();V.__bindingPointIndex=k;const j=h.createBuffer(),Q=V.__size,se=V.usage;return h.bindBuffer(h.UNIFORM_BUFFER,j),h.bufferData(h.UNIFORM_BUFFER,Q,se),h.bindBuffer(h.UNIFORM_BUFFER,null),h.bindBufferBase(h.UNIFORM_BUFFER,k,j),j}(V),s[V.id]=j,V.addEventListener("dispose",R)),r.updateUBOMapping(V,k.program);const se=e.render.frame;a[V.id]!==se&&(function _(V){const j=V.uniforms,Q=V.__cache;h.bindBuffer(h.UNIFORM_BUFFER,s[V.id]);for(let se=0,oe=j.length;se<oe;se++){const _e=j[se];if(!0===M(_e,se,Q)){const q=_e.__offset,ne=Array.isArray(_e.value)?_e.value:[_e.value];let je=0;for(let dt=0;dt<ne.length;dt++){const we=ne[dt],Re=P(we);"number"==typeof we?(_e.__data[0]=we,h.bufferSubData(h.UNIFORM_BUFFER,q+je,_e.__data)):we.isMatrix3?(_e.__data[0]=we.elements[0],_e.__data[1]=we.elements[1],_e.__data[2]=we.elements[2],_e.__data[3]=we.elements[0],_e.__data[4]=we.elements[3],_e.__data[5]=we.elements[4],_e.__data[6]=we.elements[5],_e.__data[7]=we.elements[0],_e.__data[8]=we.elements[6],_e.__data[9]=we.elements[7],_e.__data[10]=we.elements[8],_e.__data[11]=we.elements[0]):(we.toArray(_e.__data,je),je+=Re.storage/Float32Array.BYTES_PER_ELEMENT)}h.bufferSubData(h.UNIFORM_BUFFER,q,_e.__data)}}h.bindBuffer(h.UNIFORM_BUFFER,null)}(V),a[V.id]=se)},dispose:function I(){for(const V in s)h.deleteBuffer(s[V]);c=[],s={},a={}}}}class gE{constructor(e={}){const{canvas:t=ol(),context:r=null,depth:s=!0,stencil:a=!0,alpha:c=!1,antialias:d=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:g=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:b=!1}=e;let _;this.isWebGLRenderer=!0,_=null!==r?r.getContextAttributes().alpha:c;const M=new Uint32Array(4),w=new Int32Array(4);let P=null,R=null;const I=[],V=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=tr,this._useLegacyLights=!1,this.toneMapping=$n,this.toneMappingExposure=1;const k=this;let j=!1,Q=0,se=0,oe=null,_e=-1,q=null;const ne=new Br,je=new Br;let dt=null;const we=new ei(0);let Re=0,Pe=t.width,$e=t.height,xt=1,wt=null,At=null;const Ut=new Br(0,0,Pe,$e),pt=new Br(0,0,Pe,$e);let gt=!1;const _n=new Tf;let Tn=!1,Fn=!1,Xn=null;const qn=new Mi,ri=new en,Gi=new de,hr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function pi(){return null===oe?xt:1}let tn,bn,fn,vi,ni,si,Di,yr,cs,Ce,he,Ft,Dn,pn,An,yi,In,Vt,Ge,dn,Zn,Hn,Wn,ji,Ve=r;function Sn(Se,It){for(let Jt=0;Jt<Se.length;Jt++){const Qt=t.getContext(Se[Jt],It);if(null!==Qt)return Qt}return null}try{const Se={alpha:!0,depth:s,stencil:a,antialias:d,premultipliedAlpha:p,preserveDrawingBuffer:g,powerPreference:v,failIfMajorPerformanceCaveat:b};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r156"),t.addEventListener("webglcontextlost",jn,!1),t.addEventListener("webglcontextrestored",Ht,!1),t.addEventListener("webglcontextcreationerror",xn,!1),null===Ve){const It=["webgl2","webgl","experimental-webgl"];if(!0===k.isWebGL1Renderer&&It.shift(),Ve=Sn(It,Se),null===Ve)throw Sn(It)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ve instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Ve.getShaderPrecisionFormat&&(Ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Se){throw console.error("THREE.WebGLRenderer: "+Se.message),Se}function _r(){tn=new xy(Ve),bn=new MC(Ve,tn,e),tn.init(bn),Hn=new oh(Ve,tn,bn),fn=new pE(Ve,tn,bn),vi=new $f(Ve),ni=new Jy,si=new mE(Ve,tn,fn,ni,bn,Hn,vi),Di=new wC(k),yr=new Px(k),cs=new Ub(Ve,bn),Wn=new Tx(Ve,tn,cs,bn),Ce=new Ey(Ve,cs,vi,Wn),he=new Nx(Ve,Ce,cs,vi),Ge=new Lx(Ve,bn,si),yi=new yy(ni),Ft=new Ky(k,Di,yr,tn,bn,Wn,yi),Dn=new ig(k,ni),pn=new oE,An=new AC(tn,bn),Vt=new gy(k,Di,yr,fn,he,_,p),In=new fE(k,he,bn),ji=new rg(Ve,vi,bn,fn),dn=new vy(Ve,tn,vi,bn),Zn=new Hf(Ve,tn,vi,bn),vi.programs=Ft.programs,k.capabilities=bn,k.extensions=tn,k.properties=ni,k.renderLists=pn,k.shadowMap=In,k.state=fn,k.info=vi}_r();const nt=new DC(k,Ve);function jn(Se){Se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),j=!0}function Ht(){console.log("THREE.WebGLRenderer: Context Restored."),j=!1;const Se=vi.autoReset,It=In.enabled,Jt=In.autoUpdate,Lt=In.needsUpdate,Qt=In.type;_r(),vi.autoReset=Se,In.enabled=It,In.autoUpdate=Jt,In.needsUpdate=Lt,In.type=Qt}function xn(Se){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Se.statusMessage)}function Un(Se){const It=Se.target;It.removeEventListener("dispose",Un),function br(Se){(function Hr(Se){const It=ni.get(Se).programs;void 0!==It&&(It.forEach(function(Jt){Ft.releaseProgram(Jt)}),Se.isShaderMaterial&&Ft.releaseShaderCache(Se))})(Se),ni.remove(Se)}(It)}this.xr=nt,this.getContext=function(){return Ve},this.getContextAttributes=function(){return Ve.getContextAttributes()},this.forceContextLoss=function(){const Se=tn.get("WEBGL_lose_context");Se&&Se.loseContext()},this.forceContextRestore=function(){const Se=tn.get("WEBGL_lose_context");Se&&Se.restoreContext()},this.getPixelRatio=function(){return xt},this.setPixelRatio=function(Se){void 0!==Se&&(xt=Se,this.setSize(Pe,$e,!1))},this.getSize=function(Se){return Se.set(Pe,$e)},this.setSize=function(Se,It,Jt=!0){nt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Pe=Se,$e=It,t.width=Math.floor(Se*xt),t.height=Math.floor(It*xt),!0===Jt&&(t.style.width=Se+"px",t.style.height=It+"px"),this.setViewport(0,0,Se,It))},this.getDrawingBufferSize=function(Se){return Se.set(Pe*xt,$e*xt).floor()},this.setDrawingBufferSize=function(Se,It,Jt){Pe=Se,$e=It,xt=Jt,t.width=Math.floor(Se*Jt),t.height=Math.floor(It*Jt),this.setViewport(0,0,Se,It)},this.getCurrentViewport=function(Se){return Se.copy(ne)},this.getViewport=function(Se){return Se.copy(Ut)},this.setViewport=function(Se,It,Jt,Lt){Se.isVector4?Ut.set(Se.x,Se.y,Se.z,Se.w):Ut.set(Se,It,Jt,Lt),fn.viewport(ne.copy(Ut).multiplyScalar(xt).floor())},this.getScissor=function(Se){return Se.copy(pt)},this.setScissor=function(Se,It,Jt,Lt){Se.isVector4?pt.set(Se.x,Se.y,Se.z,Se.w):pt.set(Se,It,Jt,Lt),fn.scissor(je.copy(pt).multiplyScalar(xt).floor())},this.getScissorTest=function(){return gt},this.setScissorTest=function(Se){fn.setScissorTest(gt=Se)},this.setOpaqueSort=function(Se){wt=Se},this.setTransparentSort=function(Se){At=Se},this.getClearColor=function(Se){return Se.copy(Vt.getClearColor())},this.setClearColor=function(){Vt.setClearColor.apply(Vt,arguments)},this.getClearAlpha=function(){return Vt.getClearAlpha()},this.setClearAlpha=function(){Vt.setClearAlpha.apply(Vt,arguments)},this.clear=function(Se=!0,It=!0,Jt=!0){let Lt=0;if(Se){let Qt=!1;if(null!==oe){const ui=oe.texture.format;Qt=1033===ui||1031===ui||1029===ui}if(Qt){const ui=oe.texture.type,Pi=ui===Lr||ui===_t||1012===ui||ui===ti||1017===ui||1018===ui,Li=Vt.getClearColor(),Wi=Vt.getClearAlpha(),fr=Li.r,zi=Li.g,nr=Li.b;Pi?(M[0]=fr,M[1]=zi,M[2]=nr,M[3]=Wi,Ve.clearBufferuiv(Ve.COLOR,0,M)):(w[0]=fr,w[1]=zi,w[2]=nr,w[3]=Wi,Ve.clearBufferiv(Ve.COLOR,0,w))}else Lt|=Ve.COLOR_BUFFER_BIT}It&&(Lt|=Ve.DEPTH_BUFFER_BIT),Jt&&(Lt|=Ve.STENCIL_BUFFER_BIT),Ve.clear(Lt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",jn,!1),t.removeEventListener("webglcontextrestored",Ht,!1),t.removeEventListener("webglcontextcreationerror",xn,!1),pn.dispose(),An.dispose(),ni.dispose(),Di.dispose(),yr.dispose(),he.dispose(),Wn.dispose(),ji.dispose(),Ft.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",vs),nt.removeEventListener("sessionend",Ja),Xn&&(Xn.dispose(),Xn=null),Yo.stop()},this.renderBufferDirect=function(Se,It,Jt,Lt,Qt,ui){null===It&&(It=hr);const Pi=Qt.isMesh&&Qt.matrixWorld.determinant()<0,Li=function CS(Se,It,Jt,Lt,Qt){!0!==It.isScene&&(It=hr),si.resetTextureUnits();const ui=It.fog,Li=null===oe?k.outputColorSpace:!0===oe.isXRRenderTarget?oe.texture.colorSpace:is,Wi=(Lt.isMeshStandardMaterial?yr:Di).get(Lt.envMap||(Lt.isMeshStandardMaterial?It.environment:null)),fr=!0===Lt.vertexColors&&!!Jt.attributes.color&&4===Jt.attributes.color.itemSize,zi=!!Jt.attributes.tangent&&(!!Lt.normalMap||Lt.anisotropy>0),nr=!!Jt.morphAttributes.position,Ss=!!Jt.morphAttributes.normal,zs=!!Jt.morphAttributes.color;let Fa=$n;Lt.toneMapped&&(null===oe||!0===oe.isXRRenderTarget)&&(Fa=k.toneMapping);const mc=Jt.morphAttributes.position||Jt.morphAttributes.normal||Jt.morphAttributes.color,ho=void 0!==mc?mc.length:0,Er=ni.get(Lt),Lv=R.state.lights;!0!==Tn||!0!==Fn&&Se===q||yi.setState(Lt,Se,Se===q&&Lt.id===_e);let Js=!1;Lt.version===Er.__version?(Er.needsLights&&Er.lightsStateVersion!==Lv.state.version||Er.outputColorSpace!==Li||Qt.isInstancedMesh&&!1===Er.instancing||!Qt.isInstancedMesh&&!0===Er.instancing||Qt.isSkinnedMesh&&!1===Er.skinning||!Qt.isSkinnedMesh&&!0===Er.skinning||Qt.isInstancedMesh&&!0===Er.instancingColor&&null===Qt.instanceColor||Qt.isInstancedMesh&&!1===Er.instancingColor&&null!==Qt.instanceColor||Er.envMap!==Wi||!0===Lt.fog&&Er.fog!==ui||void 0!==Er.numClippingPlanes&&(Er.numClippingPlanes!==yi.numPlanes||Er.numIntersection!==yi.numIntersection)||Er.vertexAlphas!==fr||Er.vertexTangents!==zi||Er.morphTargets!==nr||Er.morphNormals!==Ss||Er.morphColors!==zs||Er.toneMapping!==Fa||!0===bn.isWebGL2&&Er.morphTargetsCount!==ho)&&(Js=!0):(Js=!0,Er.__version=Lt.version);let gu=Er.currentProgram;!0===Js&&(gu=Ov(Lt,It,Qt));let Sb=!1,Ul=!1,Nv=!1;const Do=gu.getUniforms(),Qa=Er.uniforms;if(fn.useProgram(gu.program)&&(Sb=!0,Ul=!0,Nv=!0),Lt.id!==_e&&(_e=Lt.id,Ul=!0),Sb||q!==Se){Do.setValue(Ve,"projectionMatrix",Se.projectionMatrix),Do.setValue(Ve,"viewMatrix",Se.matrixWorldInverse);const va=Do.map.cameraPosition;void 0!==va&&va.setValue(Ve,Gi.setFromMatrixPosition(Se.matrixWorld)),bn.logarithmicDepthBuffer&&Do.setValue(Ve,"logDepthBufFC",2/(Math.log(Se.far+1)/Math.LN2)),(Lt.isMeshPhongMaterial||Lt.isMeshToonMaterial||Lt.isMeshLambertMaterial||Lt.isMeshBasicMaterial||Lt.isMeshStandardMaterial||Lt.isShaderMaterial)&&Do.setValue(Ve,"isOrthographic",!0===Se.isOrthographicCamera),q!==Se&&(q=Se,Ul=!0,Nv=!0)}if(Qt.isSkinnedMesh){Do.setOptional(Ve,Qt,"bindMatrix"),Do.setOptional(Ve,Qt,"bindMatrixInverse");const va=Qt.skeleton;va&&(bn.floatVertexTextures?(null===va.boneTexture&&va.computeBoneTexture(),Do.setValue(Ve,"boneTexture",va.boneTexture,si),Do.setValue(Ve,"boneTextureSize",va.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Fv=Jt.morphAttributes;if((void 0!==Fv.position||void 0!==Fv.normal||void 0!==Fv.color&&!0===bn.isWebGL2)&&Ge.update(Qt,Jt,gu),(Ul||Er.receiveShadow!==Qt.receiveShadow)&&(Er.receiveShadow=Qt.receiveShadow,Do.setValue(Ve,"receiveShadow",Qt.receiveShadow)),Lt.isMeshGouraudMaterial&&null!==Lt.envMap&&(Qa.envMap.value=Wi,Qa.flipEnvMap.value=Wi.isCubeTexture&&!1===Wi.isRenderTargetTexture?-1:1),Ul&&(Do.setValue(Ve,"toneMappingExposure",k.toneMappingExposure),Er.needsLights&&function AS(Se,It){Se.ambientLightColor.needsUpdate=It,Se.lightProbe.needsUpdate=It,Se.directionalLights.needsUpdate=It,Se.directionalLightShadows.needsUpdate=It,Se.pointLights.needsUpdate=It,Se.pointLightShadows.needsUpdate=It,Se.spotLights.needsUpdate=It,Se.spotLightShadows.needsUpdate=It,Se.rectAreaLights.needsUpdate=It,Se.hemisphereLights.needsUpdate=It}(Qa,Nv),ui&&!0===Lt.fog&&Dn.refreshFogUniforms(Qa,ui),Dn.refreshMaterialUniforms(Qa,Lt,xt,$e,Xn),nh.upload(Ve,Er.uniformsList,Qa,si)),Lt.isShaderMaterial&&!0===Lt.uniformsNeedUpdate&&(nh.upload(Ve,Er.uniformsList,Qa,si),Lt.uniformsNeedUpdate=!1),Lt.isSpriteMaterial&&Do.setValue(Ve,"center",Qt.center),Do.setValue(Ve,"modelViewMatrix",Qt.modelViewMatrix),Do.setValue(Ve,"normalMatrix",Qt.normalMatrix),Do.setValue(Ve,"modelMatrix",Qt.matrixWorld),Lt.isShaderMaterial||Lt.isRawShaderMaterial){const va=Lt.uniformsGroups;for(let Bv=0,rm=va.length;Bv<rm;Bv++)if(bn.isWebGL2){const sm=va[Bv];ji.update(sm,gu),ji.bind(sm,gu)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return gu}(Se,It,Jt,Lt,Qt);fn.setMaterial(Lt,Pi);let Wi=Jt.index,fr=1;if(!0===Lt.wireframe){if(Wi=Ce.getWireframeAttribute(Jt),void 0===Wi)return;fr=2}const zi=Jt.drawRange,nr=Jt.attributes.position;let Ss=zi.start*fr,zs=(zi.start+zi.count)*fr;null!==ui&&(Ss=Math.max(Ss,ui.start*fr),zs=Math.min(zs,(ui.start+ui.count)*fr)),null!==Wi?(Ss=Math.max(Ss,0),zs=Math.min(zs,Wi.count)):null!=nr&&(Ss=Math.max(Ss,0),zs=Math.min(zs,nr.count));const Fa=zs-Ss;if(Fa<0||Fa===1/0)return;Wn.setup(Qt,Lt,Li,Jt,Wi);let mc,ho=dn;if(null!==Wi&&(mc=cs.get(Wi),ho=Zn,ho.setIndex(mc)),Qt.isMesh)!0===Lt.wireframe?(fn.setLineWidth(Lt.wireframeLinewidth*pi()),ho.setMode(Ve.LINES)):ho.setMode(Ve.TRIANGLES);else if(Qt.isLine){let Er=Lt.linewidth;void 0===Er&&(Er=1),fn.setLineWidth(Er*pi()),ho.setMode(Qt.isLineSegments?Ve.LINES:Qt.isLineLoop?Ve.LINE_LOOP:Ve.LINE_STRIP)}else Qt.isPoints?ho.setMode(Ve.POINTS):Qt.isSprite&&ho.setMode(Ve.TRIANGLES);if(Qt.isInstancedMesh)ho.renderInstances(Ss,Fa,Qt.count);else if(Jt.isInstancedBufferGeometry){const Lv=Math.min(Jt.instanceCount,void 0!==Jt._maxInstanceCount?Jt._maxInstanceCount:1/0);ho.renderInstances(Ss,Fa,Lv)}else ho.render(Ss,Fa)},this.compile=function(Se,It){function Jt(Lt,Qt,ui){!0===Lt.transparent&&2===Lt.side&&!1===Lt.forceSinglePass?(Lt.side=1,Lt.needsUpdate=!0,Ov(Lt,Qt,ui),Lt.side=0,Lt.needsUpdate=!0,Ov(Lt,Qt,ui),Lt.side=2):Ov(Lt,Qt,ui)}R=An.get(Se),R.init(),V.push(R),Se.traverseVisible(function(Lt){Lt.isLight&&Lt.layers.test(It.layers)&&(R.pushLight(Lt),Lt.castShadow&&R.pushShadow(Lt))}),R.setupLights(k._useLegacyLights),Se.traverse(function(Lt){const Qt=Lt.material;if(Qt)if(Array.isArray(Qt))for(let ui=0;ui<Qt.length;ui++)Jt(Qt[ui],Se,Lt);else Jt(Qt,Se,Lt)}),V.pop(),R=null};let Qr=null;function vs(){Yo.stop()}function Ja(){Yo.start()}const Yo=new Df;function Mb(Se,It,Jt,Lt){if(!1===Se.visible)return;if(Se.layers.test(It.layers))if(Se.isGroup)Jt=Se.renderOrder;else if(Se.isLOD)!0===Se.autoUpdate&&Se.update(It);else if(Se.isLight)R.pushLight(Se),Se.castShadow&&R.pushShadow(Se);else if(Se.isSprite){if(!Se.frustumCulled||_n.intersectsSprite(Se)){Lt&&Gi.setFromMatrixPosition(Se.matrixWorld).applyMatrix4(qn);const Pi=he.update(Se),Li=Se.material;Li.visible&&P.push(Se,Pi,Li,Jt,Gi.z,null)}}else if((Se.isMesh||Se.isLine||Se.isPoints)&&(!Se.frustumCulled||_n.intersectsObject(Se))){const Pi=he.update(Se),Li=Se.material;if(Lt&&(void 0!==Se.boundingSphere?(null===Se.boundingSphere&&Se.computeBoundingSphere(),Gi.copy(Se.boundingSphere.center)):(null===Pi.boundingSphere&&Pi.computeBoundingSphere(),Gi.copy(Pi.boundingSphere.center)),Gi.applyMatrix4(Se.matrixWorld).applyMatrix4(qn)),Array.isArray(Li)){const Wi=Pi.groups;for(let fr=0,zi=Wi.length;fr<zi;fr++){const nr=Wi[fr],Ss=Li[nr.materialIndex];Ss&&Ss.visible&&P.push(Se,Pi,Ss,Jt,Gi.z,nr)}}else Li.visible&&P.push(Se,Pi,Li,Jt,Gi.z,null)}const ui=Se.children;for(let Pi=0,Li=ui.length;Pi<Li;Pi++)Mb(ui[Pi],It,Jt,Lt)}function MS(Se,It,Jt,Lt){const Qt=Se.opaque,ui=Se.transmissive,Pi=Se.transparent;R.setupLightsView(Jt),!0===Tn&&yi.setGlobalState(k.clippingPlanes,Jt),ui.length>0&&function wS(Se,It,Jt,Lt){const Qt=bn.isWebGL2;null===Xn&&(Xn=new H(1,1,{generateMipmaps:!0,type:tn.has("EXT_color_buffer_half_float")?mt:Lr,minFilter:Ur,samples:Qt?4:0})),k.getDrawingBufferSize(ri),Qt?Xn.setSize(ri.x,ri.y):Xn.setSize(No(ri.x),No(ri.y));const ui=k.getRenderTarget();k.setRenderTarget(Xn),k.getClearColor(we),Re=k.getClearAlpha(),Re<1&&k.setClearColor(16777215,.5),k.clear();const Pi=k.toneMapping;k.toneMapping=$n,mu(Se,Jt,Lt),si.updateMultisampleRenderTarget(Xn),si.updateRenderTargetMipmap(Xn);let Li=!1;for(let Wi=0,fr=It.length;Wi<fr;Wi++){const zi=It[Wi],nr=zi.object,Ss=zi.geometry,zs=zi.material,Fa=zi.group;if(2===zs.side&&nr.layers.test(Lt.layers)){const mc=zs.side;zs.side=1,zs.needsUpdate=!0,SS(nr,Jt,Lt,Ss,zs,Fa),zs.side=mc,zs.needsUpdate=!0,Li=!0}}!0===Li&&(si.updateMultisampleRenderTarget(Xn),si.updateRenderTargetMipmap(Xn)),k.setRenderTarget(ui),k.setClearColor(we,Re),k.toneMapping=Pi}(Qt,ui,It,Jt),Lt&&fn.viewport(ne.copy(Lt)),Qt.length>0&&mu(Qt,It,Jt),ui.length>0&&mu(ui,It,Jt),Pi.length>0&&mu(Pi,It,Jt),fn.buffers.depth.setTest(!0),fn.buffers.depth.setMask(!0),fn.buffers.color.setMask(!0),fn.setPolygonOffset(!1)}function mu(Se,It,Jt){const Lt=!0===It.isScene?It.overrideMaterial:null;for(let Qt=0,ui=Se.length;Qt<ui;Qt++){const Pi=Se[Qt],Li=Pi.object,Wi=Pi.geometry,fr=null===Lt?Pi.material:Lt,zi=Pi.group;Li.layers.test(Jt.layers)&&SS(Li,It,Jt,Wi,fr,zi)}}function SS(Se,It,Jt,Lt,Qt,ui){Se.onBeforeRender(k,It,Jt,Lt,Qt,ui),Se.modelViewMatrix.multiplyMatrices(Jt.matrixWorldInverse,Se.matrixWorld),Se.normalMatrix.getNormalMatrix(Se.modelViewMatrix),Qt.onBeforeRender(k,It,Jt,Lt,Se,ui),!0===Qt.transparent&&2===Qt.side&&!1===Qt.forceSinglePass?(Qt.side=1,Qt.needsUpdate=!0,k.renderBufferDirect(Jt,It,Lt,Qt,Se,ui),Qt.side=0,Qt.needsUpdate=!0,k.renderBufferDirect(Jt,It,Lt,Qt,Se,ui),Qt.side=2):k.renderBufferDirect(Jt,It,Lt,Qt,Se,ui),Se.onAfterRender(k,It,Jt,Lt,Qt,ui)}function Ov(Se,It,Jt){!0!==It.isScene&&(It=hr);const Lt=ni.get(Se),Qt=R.state.lights,Pi=Qt.state.version,Li=Ft.getParameters(Se,Qt.state,R.state.shadowsArray,It,Jt),Wi=Ft.getProgramCacheKey(Li);let fr=Lt.programs;Lt.environment=Se.isMeshStandardMaterial?It.environment:null,Lt.fog=It.fog,Lt.envMap=(Se.isMeshStandardMaterial?yr:Di).get(Se.envMap||Lt.environment),void 0===fr&&(Se.addEventListener("dispose",Un),fr=new Map,Lt.programs=fr);let zi=fr.get(Wi);if(void 0!==zi){if(Lt.currentProgram===zi&&Lt.lightsStateVersion===Pi)return wb(Se,Li),zi}else Li.uniforms=Ft.getUniforms(Se),Se.onBuild(Jt,Li,k),Se.onBeforeCompile(Li,k),zi=Ft.acquireProgram(Li,Wi),fr.set(Wi,zi),Lt.uniforms=Li.uniforms;const nr=Lt.uniforms;(!Se.isShaderMaterial&&!Se.isRawShaderMaterial||!0===Se.clipping)&&(nr.clippingPlanes=yi.uniform),wb(Se,Li),Lt.needsLights=function TS(Se){return Se.isMeshLambertMaterial||Se.isMeshToonMaterial||Se.isMeshPhongMaterial||Se.isMeshStandardMaterial||Se.isShadowMaterial||Se.isShaderMaterial&&!0===Se.lights}(Se),Lt.lightsStateVersion=Pi,Lt.needsLights&&(nr.ambientLightColor.value=Qt.state.ambient,nr.lightProbe.value=Qt.state.probe,nr.directionalLights.value=Qt.state.directional,nr.directionalLightShadows.value=Qt.state.directionalShadow,nr.spotLights.value=Qt.state.spot,nr.spotLightShadows.value=Qt.state.spotShadow,nr.rectAreaLights.value=Qt.state.rectArea,nr.ltc_1.value=Qt.state.rectAreaLTC1,nr.ltc_2.value=Qt.state.rectAreaLTC2,nr.pointLights.value=Qt.state.point,nr.pointLightShadows.value=Qt.state.pointShadow,nr.hemisphereLights.value=Qt.state.hemi,nr.directionalShadowMap.value=Qt.state.directionalShadowMap,nr.directionalShadowMatrix.value=Qt.state.directionalShadowMatrix,nr.spotShadowMap.value=Qt.state.spotShadowMap,nr.spotLightMatrix.value=Qt.state.spotLightMatrix,nr.spotLightMap.value=Qt.state.spotLightMap,nr.pointShadowMap.value=Qt.state.pointShadowMap,nr.pointShadowMatrix.value=Qt.state.pointShadowMatrix);const Ss=zi.getUniforms(),zs=nh.seqWithValue(Ss.seq,nr);return Lt.currentProgram=zi,Lt.uniformsList=zs,zi}function wb(Se,It){const Jt=ni.get(Se);Jt.outputColorSpace=It.outputColorSpace,Jt.instancing=It.instancing,Jt.instancingColor=It.instancingColor,Jt.skinning=It.skinning,Jt.morphTargets=It.morphTargets,Jt.morphNormals=It.morphNormals,Jt.morphColors=It.morphColors,Jt.morphTargetsCount=It.morphTargetsCount,Jt.numClippingPlanes=It.numClippingPlanes,Jt.numIntersection=It.numClipIntersection,Jt.vertexAlphas=It.vertexAlphas,Jt.vertexTangents=It.vertexTangents,Jt.toneMapping=It.toneMapping}Yo.setAnimationLoop(function sa(Se){Qr&&Qr(Se)}),typeof self<"u"&&Yo.setContext(self),this.setAnimationLoop=function(Se){Qr=Se,nt.setAnimationLoop(Se),null===Se?Yo.stop():Yo.start()},nt.addEventListener("sessionstart",vs),nt.addEventListener("sessionend",Ja),this.render=function(Se,It){if(void 0===It||!0===It.isCamera){if(!0!==j){if(!0===Se.matrixWorldAutoUpdate&&Se.updateMatrixWorld(),null===It.parent&&!0===It.matrixWorldAutoUpdate&&It.updateMatrixWorld(),!0===nt.enabled&&!0===nt.isPresenting&&(!0===nt.cameraAutoUpdate&&nt.updateCamera(It),It=nt.getCamera()),!0===Se.isScene&&Se.onBeforeRender(k,Se,It,oe),R=An.get(Se,V.length),R.init(),V.push(R),qn.multiplyMatrices(It.projectionMatrix,It.matrixWorldInverse),_n.setFromProjectionMatrix(qn),Fn=this.localClippingEnabled,Tn=yi.init(this.clippingPlanes,Fn),P=pn.get(Se,I.length),P.init(),I.push(P),Mb(Se,It,0,k.sortObjects),P.finish(),!0===k.sortObjects&&P.sort(wt,At),this.info.render.frame++,!0===Tn&&yi.beginShadows(),In.render(R.state.shadowsArray,Se,It),!0===Tn&&yi.endShadows(),!0===this.info.autoReset&&this.info.reset(),Vt.render(P,Se),R.setupLights(k._useLegacyLights),It.isArrayCamera){const Lt=It.cameras;for(let Qt=0,ui=Lt.length;Qt<ui;Qt++){const Pi=Lt[Qt];MS(P,Se,Pi,Pi.viewport)}}else MS(P,Se,It);null!==oe&&(si.updateMultisampleRenderTarget(oe),si.updateRenderTargetMipmap(oe)),!0===Se.isScene&&Se.onAfterRender(k,Se,It),Wn.resetDefaultState(),_e=-1,q=null,V.pop(),R=V.length>0?V[V.length-1]:null,I.pop(),P=I.length>0?I[I.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Q},this.getActiveMipmapLevel=function(){return se},this.getRenderTarget=function(){return oe},this.setRenderTargetTextures=function(Se,It,Jt){ni.get(Se.texture).__webglTexture=It,ni.get(Se.depthTexture).__webglTexture=Jt;const Lt=ni.get(Se);Lt.__hasExternalTextures=!0,Lt.__hasExternalTextures&&(Lt.__autoAllocateDepthBuffer=void 0===Jt,Lt.__autoAllocateDepthBuffer||!0===tn.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Lt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Se,It){const Jt=ni.get(Se);Jt.__webglFramebuffer=It,Jt.__useDefaultFramebuffer=void 0===It},this.setRenderTarget=function(Se,It=0,Jt=0){oe=Se,Q=It,se=Jt;let Lt=!0,Qt=null,ui=!1,Pi=!1;if(Se){const Wi=ni.get(Se);void 0!==Wi.__useDefaultFramebuffer?(fn.bindFramebuffer(Ve.FRAMEBUFFER,null),Lt=!1):void 0===Wi.__webglFramebuffer?si.setupRenderTarget(Se):Wi.__hasExternalTextures&&si.rebindTextures(Se,ni.get(Se.texture).__webglTexture,ni.get(Se.depthTexture).__webglTexture);const fr=Se.texture;(fr.isData3DTexture||fr.isDataArrayTexture||fr.isCompressedArrayTexture)&&(Pi=!0);const zi=ni.get(Se).__webglFramebuffer;Se.isWebGLCubeRenderTarget?(Qt=Array.isArray(zi[It])?zi[It][Jt]:zi[It],ui=!0):Qt=bn.isWebGL2&&Se.samples>0&&!1===si.useMultisampledRTT(Se)?ni.get(Se).__webglMultisampledFramebuffer:Array.isArray(zi)?zi[Jt]:zi,ne.copy(Se.viewport),je.copy(Se.scissor),dt=Se.scissorTest}else ne.copy(Ut).multiplyScalar(xt).floor(),je.copy(pt).multiplyScalar(xt).floor(),dt=gt;if(fn.bindFramebuffer(Ve.FRAMEBUFFER,Qt)&&bn.drawBuffers&&Lt&&fn.drawBuffers(Se,Qt),fn.viewport(ne),fn.scissor(je),fn.setScissorTest(dt),ui){const Wi=ni.get(Se.texture);Ve.framebufferTexture2D(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_CUBE_MAP_POSITIVE_X+It,Wi.__webglTexture,Jt)}else if(Pi){const Wi=ni.get(Se.texture);Ve.framebufferTextureLayer(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Wi.__webglTexture,Jt||0,It||0)}_e=-1},this.readRenderTargetPixels=function(Se,It,Jt,Lt,Qt,ui,Pi){if(!Se||!Se.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Li=ni.get(Se).__webglFramebuffer;if(Se.isWebGLCubeRenderTarget&&void 0!==Pi&&(Li=Li[Pi]),Li){fn.bindFramebuffer(Ve.FRAMEBUFFER,Li);try{const Wi=Se.texture,fr=Wi.format,zi=Wi.type;if(fr!==Ui&&Hn.convert(fr)!==Ve.getParameter(Ve.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const nr=zi===mt&&(tn.has("EXT_color_buffer_half_float")||bn.isWebGL2&&tn.has("EXT_color_buffer_float"));if(!(zi===Lr||Hn.convert(zi)===Ve.getParameter(Ve.IMPLEMENTATION_COLOR_READ_TYPE)||zi===ke&&(bn.isWebGL2||tn.has("OES_texture_float")||tn.has("WEBGL_color_buffer_float"))||nr))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");It>=0&&It<=Se.width-Lt&&Jt>=0&&Jt<=Se.height-Qt&&Ve.readPixels(It,Jt,Lt,Qt,Hn.convert(fr),Hn.convert(zi),ui)}finally{const Wi=null!==oe?ni.get(oe).__webglFramebuffer:null;fn.bindFramebuffer(Ve.FRAMEBUFFER,Wi)}}},this.copyFramebufferToTexture=function(Se,It,Jt=0){const Lt=Math.pow(2,-Jt),Qt=Math.floor(It.image.width*Lt),ui=Math.floor(It.image.height*Lt);si.setTexture2D(It,0),Ve.copyTexSubImage2D(Ve.TEXTURE_2D,Jt,0,0,Se.x,Se.y,Qt,ui),fn.unbindTexture()},this.copyTextureToTexture=function(Se,It,Jt,Lt=0){const Qt=It.image.width,ui=It.image.height,Pi=Hn.convert(Jt.format),Li=Hn.convert(Jt.type);si.setTexture2D(Jt,0),Ve.pixelStorei(Ve.UNPACK_FLIP_Y_WEBGL,Jt.flipY),Ve.pixelStorei(Ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Jt.premultiplyAlpha),Ve.pixelStorei(Ve.UNPACK_ALIGNMENT,Jt.unpackAlignment),It.isDataTexture?Ve.texSubImage2D(Ve.TEXTURE_2D,Lt,Se.x,Se.y,Qt,ui,Pi,Li,It.image.data):It.isCompressedTexture?Ve.compressedTexSubImage2D(Ve.TEXTURE_2D,Lt,Se.x,Se.y,It.mipmaps[0].width,It.mipmaps[0].height,Pi,It.mipmaps[0].data):Ve.texSubImage2D(Ve.TEXTURE_2D,Lt,Se.x,Se.y,Pi,Li,It.image),0===Lt&&Jt.generateMipmaps&&Ve.generateMipmap(Ve.TEXTURE_2D),fn.unbindTexture()},this.copyTextureToTexture3D=function(Se,It,Jt,Lt,Qt=0){if(k.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ui=Se.max.x-Se.min.x+1,Pi=Se.max.y-Se.min.y+1,Li=Se.max.z-Se.min.z+1,Wi=Hn.convert(Lt.format),fr=Hn.convert(Lt.type);let zi;if(Lt.isData3DTexture)si.setTexture3D(Lt,0),zi=Ve.TEXTURE_3D;else{if(!Lt.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");si.setTexture2DArray(Lt,0),zi=Ve.TEXTURE_2D_ARRAY}Ve.pixelStorei(Ve.UNPACK_FLIP_Y_WEBGL,Lt.flipY),Ve.pixelStorei(Ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Lt.premultiplyAlpha),Ve.pixelStorei(Ve.UNPACK_ALIGNMENT,Lt.unpackAlignment);const nr=Ve.getParameter(Ve.UNPACK_ROW_LENGTH),Ss=Ve.getParameter(Ve.UNPACK_IMAGE_HEIGHT),zs=Ve.getParameter(Ve.UNPACK_SKIP_PIXELS),Fa=Ve.getParameter(Ve.UNPACK_SKIP_ROWS),mc=Ve.getParameter(Ve.UNPACK_SKIP_IMAGES),ho=Jt.isCompressedTexture?Jt.mipmaps[0]:Jt.image;Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,ho.width),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,ho.height),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,Se.min.x),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,Se.min.y),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,Se.min.z),Jt.isDataTexture||Jt.isData3DTexture?Ve.texSubImage3D(zi,Qt,It.x,It.y,It.z,ui,Pi,Li,Wi,fr,ho.data):Jt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ve.compressedTexSubImage3D(zi,Qt,It.x,It.y,It.z,ui,Pi,Li,Wi,ho.data)):Ve.texSubImage3D(zi,Qt,It.x,It.y,It.z,ui,Pi,Li,Wi,fr,ho),Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,nr),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,Ss),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,zs),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,Fa),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,mc),0===Qt&&Lt.generateMipmaps&&Ve.generateMipmap(zi),fn.unbindTexture()},this.initTexture=function(Se){Se.isCubeTexture?si.setTextureCube(Se,0):Se.isData3DTexture?si.setTexture3D(Se,0):Se.isDataArrayTexture||Se.isCompressedArrayTexture?si.setTexture2DArray(Se,0):si.setTexture2D(Se,0),fn.unbindTexture()},this.resetState=function(){Q=0,se=0,oe=null,fn.reset(),Wn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Xo}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===tr?Pr:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Pr?tr:is}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class IC extends gE{}).prototype.isWebGL1Renderer=!0;class o0 extends Co{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class ud extends Qi{constructor(e=1,t=1,r=1,s=32,a=1,c=!1,d=0,p=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:s,heightSegments:a,openEnded:c,thetaStart:d,thetaLength:p};const g=this;s=Math.floor(s),a=Math.floor(a);const v=[],b=[],_=[],M=[];let w=0;const P=[],R=r/2;let I=0;function k(j){const Q=w,se=new en,oe=new de;let _e=0;const q=!0===j?e:t,ne=!0===j?1:-1;for(let dt=1;dt<=s;dt++)b.push(0,R*ne,0),_.push(0,ne,0),M.push(.5,.5),w++;const je=w;for(let dt=0;dt<=s;dt++){const Re=dt/s*p+d,Pe=Math.cos(Re),$e=Math.sin(Re);oe.x=q*$e,oe.y=R*ne,oe.z=q*Pe,b.push(oe.x,oe.y,oe.z),_.push(0,ne,0),se.x=.5*Pe+.5,se.y=.5*$e*ne+.5,M.push(se.x,se.y),w++}for(let dt=0;dt<s;dt++){const we=Q+dt,Re=je+dt;!0===j?v.push(Re,Re+1,we):v.push(Re+1,Re,we),_e+=3}g.addGroup(I,_e,!0===j?1:2),I+=_e}(function V(){const j=new de,Q=new de;let se=0;const oe=(t-e)/r;for(let _e=0;_e<=a;_e++){const q=[],ne=_e/a,je=ne*(t-e)+e;for(let dt=0;dt<=s;dt++){const we=dt/s,Re=we*p+d,Pe=Math.sin(Re),$e=Math.cos(Re);Q.x=je*Pe,Q.y=-ne*r+R,Q.z=je*$e,b.push(Q.x,Q.y,Q.z),j.set(Pe,oe,$e).normalize(),_.push(j.x,j.y,j.z),M.push(we,1-ne),q.push(w++)}P.push(q)}for(let _e=0;_e<s;_e++)for(let q=0;q<a;q++){const je=P[q+1][_e],dt=P[q+1][_e+1],we=P[q][_e+1];v.push(P[q][_e],je,we),v.push(je,dt,we),se+=6}g.addGroup(I,se,0),I+=se})(),!1===c&&(e>0&&k(!0),t>0&&k(!1)),this.setIndex(v),this.setAttribute("position",new Bn(b,3)),this.setAttribute("normal",new Bn(_,3)),this.setAttribute("uv",new Bn(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ud(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class gd extends Qi{constructor(e=1,t=32,r=16,s=0,a=2*Math.PI,c=0,d=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:s,phiLength:a,thetaStart:c,thetaLength:d},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const p=Math.min(c+d,Math.PI);let g=0;const v=[],b=new de,_=new de,M=[],w=[],P=[],R=[];for(let I=0;I<=r;I++){const V=[],k=I/r;let j=0;0===I&&0===c?j=.5/t:I===r&&p===Math.PI&&(j=-.5/t);for(let Q=0;Q<=t;Q++){const se=Q/t;b.x=-e*Math.cos(s+se*a)*Math.sin(c+k*d),b.y=e*Math.cos(c+k*d),b.z=e*Math.sin(s+se*a)*Math.sin(c+k*d),w.push(b.x,b.y,b.z),_.copy(b).normalize(),P.push(_.x,_.y,_.z),R.push(se+j,1-k),V.push(g++)}v.push(V)}for(let I=0;I<r;I++)for(let V=0;V<t;V++){const j=v[I][V],Q=v[I+1][V],se=v[I+1][V+1];(0!==I||c>0)&&M.push(v[I][V+1],j,se),(I!==r-1||p<Math.PI)&&M.push(j,Q,se)}this.setIndex(M),this.setAttribute("position",new Bn(w,3)),this.setAttribute("normal",new Bn(P,3)),this.setAttribute("uv",new Bn(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class W0 extends al{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ei(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class j0 extends al{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ei(16777215),this.specular=new ei(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new en(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function ma(h,e,t){return pp(h)?new h.constructor(h.subarray(e,void 0!==t?t:h.length)):h.slice(e,t)}function Kc(h,e,t){return!h||!t&&h.constructor===e?h:"number"==typeof e.BYTES_PER_ELEMENT?new e(h):Array.prototype.slice.call(h)}function pp(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}class Ih{constructor(e,t,r,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,s=t[r],a=t[r-1];e:{t:{let c;n:{i:if(!(e<s)){for(let d=r+2;;){if(void 0===s){if(e<a)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===d)break;if(a=s,s=t[++r],e<s)break t}c=t.length;break n}if(e>=a)break e;{const d=t[1];e<d&&(r=2,a=d);for(let p=r-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(r===p)break;if(s=a,a=t[--r-1],e>=a)break t}c=r,r=0}}for(;r<c;){const d=r+c>>>1;e<t[d]?c=d:r=d+1}if(s=t[r],a=t[r-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,s)}return this.interpolate_(r,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s;for(let c=0;c!==s;++c)t[c]=r[a+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class mp extends Ih{constructor(e,t,r,s){super(e,t,r,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,r){const s=this.parameterPositions;let a=e-2,c=e+1,d=s[a],p=s[c];if(void 0===d)switch(this.getSettings_().endingStart){case 2401:a=e,d=2*t-r;break;case 2402:a=s.length-2,d=t+s[a]-s[a+1];break;default:a=e,d=r}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:c=e,p=2*r-t;break;case 2402:c=1,p=r+s[1]-s[0];break;default:c=e-1,p=t}const g=.5*(r-t),v=this.valueSize;this._weightPrev=g/(t-d),this._weightNext=g/(p-r),this._offsetPrev=a*v,this._offsetNext=c*v}interpolate_(e,t,r,s){const a=this.resultBuffer,c=this.sampleValues,d=this.valueSize,p=e*d,g=p-d,v=this._offsetPrev,b=this._offsetNext,_=this._weightPrev,M=this._weightNext,w=(r-t)/(s-t),P=w*w,R=P*w,I=-_*R+2*_*P-_*w,V=(1+_)*R+(-1.5-2*_)*P+(-.5+_)*w+1,k=(-1-M)*R+(1.5+M)*P+.5*w,j=M*R-M*P;for(let Q=0;Q!==d;++Q)a[Q]=I*c[v+Q]+V*c[g+Q]+k*c[p+Q]+j*c[b+Q];return a}}class gp extends Ih{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const a=this.resultBuffer,c=this.sampleValues,d=this.valueSize,p=e*d,g=p-d,v=(r-t)/(s-t),b=1-v;for(let _=0;_!==d;++_)a[_]=c[g+_]*b+c[p+_]*v;return a}}class Dl extends Ih{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class hl{constructor(e,t,r,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kc(t,this.TimeBufferType),this.values=Kc(r,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Kc(e.times,Array),values:Kc(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(r.interpolation=s)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Dl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new gp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new mp(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,s=t.length;r!==s;++r)t[r]*=e}return this}trim(e,t){const r=this.times,s=r.length;let a=0,c=s-1;for(;a!==s&&r[a]<e;)++a;for(;-1!==c&&r[c]>t;)--c;if(++c,0!==a||c!==s){a>=c&&(c=Math.max(c,1),a=c-1);const d=this.getValueSize();this.times=ma(r,a,c),this.values=ma(this.values,a*d,c*d)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,s=this.values,a=r.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let d=0;d!==a;d++){const p=r[d];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,d,p),e=!1;break}if(null!==c&&c>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,d,p,c),e=!1;break}c=p}if(void 0!==s&&pp(s))for(let d=0,p=s.length;d!==p;++d){const g=s[d];if(isNaN(g)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,g),e=!1;break}}return e}optimize(){const e=ma(this.times),t=ma(this.values),r=this.getValueSize(),s=2302===this.getInterpolation(),a=e.length-1;let c=1;for(let d=1;d<a;++d){let p=!1;const g=e[d];if(g!==e[d+1]&&(1!==d||g!==e[0]))if(s)p=!0;else{const b=d*r,_=b-r,M=b+r;for(let w=0;w!==r;++w){const P=t[b+w];if(P!==t[_+w]||P!==t[M+w]){p=!0;break}}}if(p){if(d!==c){e[c]=e[d];const b=d*r,_=c*r;for(let M=0;M!==r;++M)t[_+M]=t[b+M]}++c}}if(a>0){e[c]=e[a];for(let d=a*r,p=c*r,g=0;g!==r;++g)t[p+g]=t[d+g];++c}return c!==e.length?(this.times=ma(e,0,c),this.values=ma(t,0,c*r)):(this.times=e,this.values=t),this}clone(){const e=ma(this.times,0),t=ma(this.values,0),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}hl.prototype.TimeBufferType=Float32Array,hl.prototype.ValueBufferType=Float32Array,hl.prototype.DefaultInterpolation=2301;class oc extends hl{}oc.prototype.ValueTypeName="bool",oc.prototype.ValueBufferType=Array,oc.prototype.DefaultInterpolation=2300,oc.prototype.InterpolantFactoryMethodLinear=void 0,oc.prototype.InterpolantFactoryMethodSmooth=void 0;(class q0 extends hl{}).prototype.ValueTypeName="color";(class Rg extends hl{}).prototype.ValueTypeName="number";class kE extends Ih{constructor(e,t,r,s){super(e,t,r,s)}interpolate_(e,t,r,s){const a=this.resultBuffer,c=this.sampleValues,d=this.valueSize,p=(r-t)/(s-t);let g=e*d;for(let v=g+d;g!==v;g+=4)ln.slerpFlat(a,0,c,g-d,c,g,p);return a}}class Rh extends hl{InterpolantFactoryMethodLinear(e){return new kE(this.times,this.values,this.getValueSize(),e)}}Rh.prototype.ValueTypeName="quaternion",Rh.prototype.DefaultInterpolation=2301,Rh.prototype.InterpolantFactoryMethodSmooth=void 0;class Jc extends hl{}Jc.prototype.ValueTypeName="string",Jc.prototype.ValueBufferType=Array,Jc.prototype.DefaultInterpolation=2300,Jc.prototype.InterpolantFactoryMethodLinear=void 0,Jc.prototype.InterpolantFactoryMethodSmooth=void 0;(class vp extends hl{}).prototype.ValueTypeName="vector";const Qc={enabled:!1,files:{},add:function(h,e){!1!==this.enabled&&(this.files[h]=e)},get:function(h){if(!1!==this.enabled)return this.files[h]},remove:function(h){delete this.files[h]},clear:function(){this.files={}}};class yd{constructor(e,t,r){const s=this;let p,a=!1,c=0,d=0;const g=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(v){d++,!1===a&&void 0!==s.onStart&&s.onStart(v,c,d),a=!0},this.itemEnd=function(v){c++,void 0!==s.onProgress&&s.onProgress(v,c,d),c===d&&(a=!1,void 0!==s.onLoad&&s.onLoad())},this.itemError=function(v){void 0!==s.onError&&s.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,b){return g.push(v,b),this},this.removeHandler=function(v){const b=g.indexOf(v);return-1!==b&&g.splice(b,2),this},this.getHandler=function(v){for(let b=0,_=g.length;b<_;b+=2){const M=g[b],w=g[b+1];if(M.global&&(M.lastIndex=0),M.test(v))return w}return null}}}const Ph=new yd;let Og=(()=>{class h{constructor(t){this.manager=void 0!==t?t:Ph,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,r){const s=this;return new Promise(function(a,c){s.load(t,a,r,c)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return h.DEFAULT_MATERIAL_NAME="__DEFAULT",h})();class Lg extends Og{constructor(e){super(e)}load(e,t,r,s){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=Qc.get(e);if(void 0!==c)return a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c;const d=xl("img");function p(){v(),Qc.add(e,this),t&&t(this),a.manager.itemEnd(e)}function g(b){v(),s&&s(b),a.manager.itemError(e),a.manager.itemEnd(e)}function v(){d.removeEventListener("load",p,!1),d.removeEventListener("error",g,!1)}return d.addEventListener("load",p,!1),d.addEventListener("error",g,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(d.crossOrigin=this.crossOrigin),a.manager.itemStart(e),d.src=e,d}}class Fg extends Og{constructor(e){super(e)}load(e,t,r,s){const a=new Zo,c=new Lg(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(d){a.image=d,a.needsUpdate=!0,void 0!==t&&t(a)},r,s),a}}class VE extends Co{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ei(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Bg=new Mi,Z0=new de,K0=new de;class HE{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new en(512,512),this.map=null,this.mapPass=null,this.matrix=new Mi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Tf,this._frameExtents=new en(1,1),this._viewportCount=1,this._viewports=[new Br(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;Z0.setFromMatrixPosition(e.matrixWorld),t.position.copy(Z0),K0.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(K0),t.updateMatrixWorld(),Bg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bg),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Bg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class GE extends HE{constructor(){super(new Um(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class WE extends VE{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Co.DEFAULT_UP),this.updateMatrix(),this.target=new Co,this.shadow=new GE}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ks extends VE{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}const xp="\\[\\]\\.:\\/",zg=new RegExp("["+xp+"]","g"),Hg="[^"+xp+"]",Ep="[^"+xp.replace("\\.","")+"]",aM=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Hg)+/(WCOD+)?/.source.replace("WCOD",Ep)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hg)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hg)+"$"),lM=["material","materials","bones","map"];class cM{constructor(e,t,r){const s=r||Jr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=r.length;s!==a;++s)r[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}let Jr=(()=>{class h{constructor(t,r,s){this.path=r,this.parsedPath=s||h.parseTrackName(r),this.node=h.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,s){return t&&t.isAnimationObjectGroup?new h.Composite(t,r,s):new h(t,r,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(zg,"")}static parseTrackName(t){const r=aM.exec(t);if(null===r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},a=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const c=s.nodeName.substring(a+1);-1!==lM.indexOf(c)&&(s.nodeName=s.nodeName.substring(0,a),s.objectName=c)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,r){if(void 0===r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(r);if(void 0!==s)return s}if(t.children){const s=function(c){for(let d=0;d<c.length;d++){const p=c[d];if(p.name===r||p.uuid===r)return p;const g=s(p.children);if(g)return g}return null},a=s(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)t[r++]=s[a]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,s=r.objectName,a=r.propertyName;let c=r.propertyIndex;if(t||(t=h.findNode(this.rootNode,r.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(s){let v=r.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let b=0;b<t.length;b++)if(t[b].name===v){v=b;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const d=t[a];if(void 0===d)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+a+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let g=this.BindingType.Direct;if(void 0!==c){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[c]&&(c=t.morphTargetDictionary[c])}g=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=c}else void 0!==d.fromArray&&void 0!==d.toArray?(g=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(g=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=a;this.getValue=this.GetterByBindingType[g],this.setValue=this.SetterByBindingTypeAndVersioning[g][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return h.Composite=cM,h})();Jr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Jr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Jr.prototype.GetterByBindingType=[Jr.prototype._getValue_direct,Jr.prototype._getValue_array,Jr.prototype._getValue_arrayElement,Jr.prototype._getValue_toArray],Jr.prototype.SetterByBindingTypeAndVersioning=[[Jr.prototype._setValue_direct,Jr.prototype._setValue_direct_setNeedsUpdate,Jr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_array,Jr.prototype._setValue_array_setNeedsUpdate,Jr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_arrayElement,Jr.prototype._setValue_arrayElement_setNeedsUpdate,Jr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jr.prototype._setValue_fromArray,Jr.prototype._setValue_fromArray_setNeedsUpdate,Jr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class ru{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(xr(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"156"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="156");class Ra{constructor(e){void 0===e&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e){void 0===e&&(e=new X);const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t){void 0===t&&(t=new X);const r=this.elements,s=e.x,a=e.y,c=e.z;return t.x=r[0]*s+r[1]*a+r[2]*c,t.y=r[3]*s+r[4]*a+r[5]*c,t.z=r[6]*s+r[7]*a+r[8]*c,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t){void 0===t&&(t=new Ra);const r=this.elements,s=e.elements,a=t.elements,c=r[0],d=r[1],p=r[2],g=r[3],v=r[4],b=r[5],_=r[6],M=r[7],w=r[8],P=s[0],R=s[1],I=s[2],V=s[3],k=s[4],j=s[5],Q=s[6],se=s[7],oe=s[8];return a[0]=c*P+d*V+p*Q,a[1]=c*R+d*k+p*se,a[2]=c*I+d*j+p*oe,a[3]=g*P+v*V+b*Q,a[4]=g*R+v*k+b*se,a[5]=g*I+v*j+b*oe,a[6]=_*P+M*V+w*Q,a[7]=_*R+M*k+w*se,a[8]=_*I+M*j+w*oe,t}scale(e,t){void 0===t&&(t=new Ra);const r=this.elements,s=t.elements;for(let a=0;3!==a;a++)s[3*a+0]=e.x*r[3*a+0],s[3*a+1]=e.y*r[3*a+1],s[3*a+2]=e.z*r[3*a+2];return t}solve(e,t){void 0===t&&(t=new X);const a=[];let c,d;for(c=0;c<12;c++)a.push(0);for(c=0;c<3;c++)for(d=0;d<3;d++)a[c+4*d]=this.elements[c+3*d];a[3]=e.x,a[7]=e.y,a[11]=e.z;let p=3;const g=p;let v,_;do{if(c=g-p,0===a[c+4*c])for(d=c+1;d<g;d++)if(0!==a[c+4*d]){v=4;do{_=4-v,a[_+4*c]+=a[_+4*d]}while(--v);break}if(0!==a[c+4*c])for(d=c+1;d<g;d++){const M=a[c+4*d]/a[c+4*c];v=4;do{_=4-v,a[_+4*d]=_<=c?0:a[_+4*d]-a[_+4*c]*M}while(--v)}}while(--p);if(t.z=a[11]/a[10],t.y=(a[7]-a[6]*t.z)/a[5],t.x=(a[3]-a[2]*t.z-a[1]*t.y)/a[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw`Could not solve equation! Got x=[${t.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return t}e(e,t,r){if(void 0===r)return this.elements[t+3*e];this.elements[t+3*e]=r}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let r=0;r<9;r++)e+=this.elements[r]+",";return e}reverse(e){void 0===e&&(e=new Ra);const s=xd;let a,c;for(a=0;a<3;a++)for(c=0;c<3;c++)s[a+6*c]=this.elements[a+3*c];s[3]=1,s[9]=0,s[15]=0,s[4]=0,s[10]=1,s[16]=0,s[5]=0,s[11]=0,s[17]=1;let d=3;const p=d;let g,b;do{if(a=p-d,0===s[a+6*a])for(c=a+1;c<p;c++)if(0!==s[a+6*c]){g=6;do{b=6-g,s[b+6*a]+=s[b+6*c]}while(--g);break}if(0!==s[a+6*a])for(c=a+1;c<p;c++){const _=s[a+6*c]/s[a+6*a];g=6;do{b=6-g,s[b+6*c]=b<=a?0:s[b+6*c]-s[b+6*a]*_}while(--g)}}while(--d);a=2;do{c=a-1;do{const _=s[a+6*c]/s[a+6*a];g=6;do{b=6-g,s[b+6*c]=s[b+6*c]-s[b+6*a]*_}while(--g)}while(c--)}while(--a);a=2;do{const _=1/s[a+6*a];g=6;do{b=6-g,s[b+6*a]=s[b+6*a]*_}while(--g)}while(a--);a=2;do{c=2;do{if(b=s[3+c+6*a],isNaN(b)||b===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(a,c,b)}while(c--)}while(a--);return e}setRotationFromQuaternion(e){const t=e.x,r=e.y,s=e.z,a=e.w,c=t+t,d=r+r,p=s+s,g=t*c,v=t*d,b=t*p,_=r*d,M=r*p,w=s*p,P=a*c,R=a*d,I=a*p,V=this.elements;return V[0]=1-(_+w),V[1]=v-I,V[2]=b+R,V[3]=v+I,V[4]=1-(g+w),V[5]=M-P,V[6]=b-R,V[7]=M+P,V[8]=1-(g+_),this}transpose(e){void 0===e&&(e=new Ra);const t=this.elements,r=e.elements;let s;return r[0]=t[0],r[4]=t[4],r[8]=t[8],s=t[1],r[1]=t[3],r[3]=s,s=t[2],r[2]=t[6],r[6]=s,s=t[5],r[5]=t[7],r[7]=s,e}}const xd=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class X{constructor(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.z=r}cross(e,t){void 0===t&&(t=new X);const r=e.x,s=e.y,a=e.z,c=this.x,d=this.y,p=this.z;return t.x=d*a-p*s,t.y=p*r-c*a,t.z=c*s-d*r,t}set(e,t,r){return this.x=e,this.y=t,this.z=r,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new X(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new X(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Ra([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,r=this.z,s=Math.sqrt(e*e+t*t+r*r);if(s>0){const a=1/s;this.x*=a,this.y*=a,this.z*=a}else this.x=0,this.y=0,this.z=0;return s}unit(e){void 0===e&&(e=new X);const t=this.x,r=this.y,s=this.z;let a=Math.sqrt(t*t+r*r+s*s);return a>0?(a=1/a,e.x=t*a,e.y=r*a,e.z=s*a):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,r=this.z;return Math.sqrt(e*e+t*t+r*r)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,r=this.y,s=this.z,a=e.x,c=e.y,d=e.z;return Math.sqrt((a-t)*(a-t)+(c-r)*(c-r)+(d-s)*(d-s))}distanceSquared(e){const t=this.x,r=this.y,s=this.z,a=e.x,c=e.y,d=e.z;return(a-t)*(a-t)+(c-r)*(c-r)+(d-s)*(d-s)}scale(e,t){void 0===t&&(t=new X);const s=this.y,a=this.z;return t.x=e*this.x,t.y=e*s,t.z=e*a,t}vmul(e,t){return void 0===t&&(t=new X),t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,r){return void 0===r&&(r=new X),r.x=this.x+e*t.x,r.y=this.y+e*t.y,r.z=this.z+e*t.z,r}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e){return void 0===e&&(e=new X),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const r=this.length();if(r>0){const s=yM,a=1/r;s.set(this.x*a,this.y*a,this.z*a);const c=u_;Math.abs(s.x)<.9?(c.set(1,0,0),s.cross(c,e)):(c.set(0,1,0),s.cross(c,e)),s.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,r){const s=this.x,a=this.y,c=this.z;r.x=s+(e.x-s)*t,r.y=a+(e.y-a)*t,r.z=c+(e.z-c)*t}almostEquals(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(d_),d_.almostEquals(e,t)}clone(){return new X(this.x,this.y,this.z)}}X.ZERO=new X(0,0,0),X.UNIT_X=new X(1,0,0),X.UNIT_Y=new X(0,1,0),X.UNIT_Z=new X(0,0,1);const yM=new X,u_=new X,d_=new X;class os{constructor(e){void 0===e&&(e={}),this.lowerBound=new X,this.upperBound=new X,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,r,s){const a=this.lowerBound,c=this.upperBound,d=r;a.copy(e[0]),d&&d.vmult(a,a),c.copy(a);for(let p=1;p<e.length;p++){let g=e[p];d&&(d.vmult(g,_M),g=_M),g.x>c.x&&(c.x=g.x),g.x<a.x&&(a.x=g.x),g.y>c.y&&(c.y=g.y),g.y<a.y&&(a.y=g.y),g.z>c.z&&(c.z=g.z),g.z<a.z&&(a.z=g.z)}return t&&(t.vadd(a,a),t.vadd(c,c)),s&&(a.x-=s,a.y-=s,a.z-=s,c.x+=s,c.y+=s,c.z+=s),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new os).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,r=this.upperBound,s=e.lowerBound,a=e.upperBound;return(s.x<=r.x&&r.x<=a.x||t.x<=a.x&&a.x<=r.x)&&(s.y<=r.y&&r.y<=a.y||t.y<=a.y&&a.y<=r.y)&&(s.z<=r.z&&r.z<=a.z||t.z<=a.z&&a.z<=r.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,r=this.upperBound,s=e.lowerBound,a=e.upperBound;return t.x<=s.x&&r.x>=a.x&&t.y<=s.y&&r.y>=a.y&&t.z<=s.z&&r.z>=a.z}getCorners(e,t,r,s,a,c,d,p){const g=this.lowerBound,v=this.upperBound;e.copy(g),t.set(v.x,g.y,g.z),r.set(v.x,v.y,g.z),s.set(g.x,v.y,v.z),a.set(v.x,g.y,v.z),c.set(g.x,v.y,g.z),d.set(g.x,g.y,v.z),p.copy(v)}toLocalFrame(e,t){const r=Ap;this.getCorners(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);for(let _=0;8!==_;_++){const M=r[_];e.pointToLocal(M,M)}return t.setFromPoints(r)}toWorldFrame(e,t){const r=Ap;this.getCorners(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);for(let _=0;8!==_;_++){const M=r[_];e.pointToWorld(M,M)}return t.setFromPoints(r)}overlapsRay(e){const{direction:t,from:r}=e,s=1/t.x,a=1/t.y,c=1/t.z,d=(this.lowerBound.x-r.x)*s,p=(this.upperBound.x-r.x)*s,g=(this.lowerBound.y-r.y)*a,v=(this.upperBound.y-r.y)*a,b=(this.lowerBound.z-r.z)*c,_=(this.upperBound.z-r.z)*c,M=Math.max(Math.max(Math.min(d,p),Math.min(g,v)),Math.min(b,_)),w=Math.min(Math.min(Math.max(d,p),Math.max(g,v)),Math.max(b,_));return!(w<0||M>w)}}const _M=new X,Ap=[new X,new X,new X,new X,new X,new X,new X,new X];class Tp{constructor(){this.matrix=[]}get(e,t){let{index:r}=e,{index:s}=t;if(s>r){const a=s;s=r,r=a}return this.matrix[(r*(r+1)>>1)+s-1]}set(e,t,r){let{index:s}=e,{index:a}=t;if(a>s){const c=a;a=s,s=c}this.matrix[(s*(s+1)>>1)+a-1]=r?1:0}reset(){for(let e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class Zg{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;return void 0===r[e]&&(r[e]=[]),r[e].includes(t)||r[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return!(void 0===r[e]||!r[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const r=this._listeners;if(void 0===r[e])return this;const s=r[e].indexOf(t);return-1!==s&&r[e].splice(s,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const r=this._listeners[e.type];if(void 0!==r){e.target=this;for(let s=0,a=r.length;s<a;s++)r[s].call(this,e)}return this}}class as{constructor(e,t,r,s){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===s&&(s=1),this.x=e,this.y=t,this.z=r,this.w=s}set(e,t,r,s){return this.x=e,this.y=t,this.z=r,this.w=s,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const r=Math.sin(.5*t);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(.5*t),this}toAxisAngle(e){void 0===e&&(e=new X),this.normalize();const t=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/r,e.y=this.y/r,e.z=this.z/r),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const r=ml;e.tangents(r,bM),this.setFromAxisAngle(r,Math.PI)}else{const r=e.cross(t);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t){void 0===t&&(t=new as);const r=this.x,s=this.y,a=this.z,c=this.w,d=e.x,p=e.y,g=e.z,v=e.w;return t.x=r*v+c*d+s*g-a*p,t.y=s*v+c*p+a*d-r*g,t.z=a*v+c*g+r*p-s*d,t.w=c*v-r*d-s*p-a*g,t}inverse(e){void 0===e&&(e=new as);const t=this.x,r=this.y,s=this.z,a=this.w;this.conjugate(e);const c=1/(t*t+r*r+s*s+a*a);return e.x*=c,e.y*=c,e.z*=c,e.w*=c,e}conjugate(e){return void 0===e&&(e=new as),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t){void 0===t&&(t=new X);const r=e.x,s=e.y,a=e.z,c=this.x,d=this.y,p=this.z,g=this.w,v=g*r+d*a-p*s,b=g*s+p*r-c*a,_=g*a+c*s-d*r,M=-c*r-d*s-p*a;return t.x=v*g+M*-c+b*-p-_*-d,t.y=b*g+M*-d+_*-c-v*-p,t.z=_*g+M*-p+v*-d-b*-c,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t){let r,s,a;void 0===t&&(t="YZX");const c=this.x,d=this.y,p=this.z,g=this.w;if("YZX"!==t)throw new Error(`Euler order ${t} not supported yet.`);{const v=c*d+p*g;if(v>.499&&(r=2*Math.atan2(c,g),s=Math.PI/2,a=0),v<-.499&&(r=-2*Math.atan2(c,g),s=-Math.PI/2,a=0),void 0===r){const b=c*c,M=p*p;r=Math.atan2(2*d*g-2*c*p,1-d*d*2-2*M),s=Math.asin(2*v),a=Math.atan2(2*c*g-2*d*p,1-2*b-2*M)}}e.y=r,e.z=s,e.x=a}setFromEuler(e,t,r,s){void 0===s&&(s="XYZ");const a=Math.cos(e/2),c=Math.cos(t/2),d=Math.cos(r/2),p=Math.sin(e/2),g=Math.sin(t/2),v=Math.sin(r/2);return"XYZ"===s?(this.x=p*c*d+a*g*v,this.y=a*g*d-p*c*v,this.z=a*c*v+p*g*d,this.w=a*c*d-p*g*v):"YXZ"===s?(this.x=p*c*d+a*g*v,this.y=a*g*d-p*c*v,this.z=a*c*v-p*g*d,this.w=a*c*d+p*g*v):"ZXY"===s?(this.x=p*c*d-a*g*v,this.y=a*g*d+p*c*v,this.z=a*c*v+p*g*d,this.w=a*c*d-p*g*v):"ZYX"===s?(this.x=p*c*d-a*g*v,this.y=a*g*d+p*c*v,this.z=a*c*v-p*g*d,this.w=a*c*d+p*g*v):"YZX"===s?(this.x=p*c*d+a*g*v,this.y=a*g*d+p*c*v,this.z=a*c*v-p*g*d,this.w=a*c*d-p*g*v):"XZY"===s&&(this.x=p*c*d-a*g*v,this.y=a*g*d-p*c*v,this.z=a*c*v+p*g*d,this.w=a*c*d+p*g*v),this}clone(){return new as(this.x,this.y,this.z,this.w)}slerp(e,t,r){void 0===r&&(r=new as);const s=this.x,a=this.y,c=this.z,d=this.w;let _,M,w,P,R,p=e.x,g=e.y,v=e.z,b=e.w;return M=s*p+a*g+c*v+d*b,M<0&&(M=-M,p=-p,g=-g,v=-v,b=-b),1-M>1e-6?(_=Math.acos(M),w=Math.sin(_),P=Math.sin((1-t)*_)/w,R=Math.sin(t*_)/w):(P=1-t,R=t),r.x=P*s+R*p,r.y=P*a+R*g,r.z=P*c+R*v,r.w=P*d+R*b,r}integrate(e,t,r,s){void 0===s&&(s=new as);const a=e.x*r.x,c=e.y*r.y,d=e.z*r.z,p=this.x,g=this.y,v=this.z,b=this.w,_=.5*t;return s.x+=_*(a*b+c*v-d*g),s.y+=_*(c*b+d*p-a*v),s.z+=_*(d*b+a*g-c*p),s.w+=_*(-a*p-c*g-d*v),s}}const ml=new X,bM=new X,xM={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let Nn=(()=>{class h{constructor(t){void 0===t&&(t={}),this.id=h.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,r){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,r,s,a){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}return h.idCounter=0,h.types=xM,h})();class Xi{constructor(e){void 0===e&&(e={}),this.position=new X,this.quaternion=new as,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Xi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Xi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,r,s){return void 0===s&&(s=new X),r.vsub(e,s),t.conjugate(Pa),Pa.vmult(s,s),s}static pointToWorldFrame(e,t,r,s){return void 0===s&&(s=new X),t.vmult(r,s),s.vadd(e,s),s}static vectorToWorldFrame(e,t,r){return void 0===r&&(r=new X),e.vmult(t,r),r}static vectorToLocalFrame(e,t,r,s){return void 0===s&&(s=new X),t.w*=-1,t.vmult(r,s),t.w*=-1,s}}const Pa=new as;class Ol extends Nn{constructor(e){void 0===e&&(e={});const{vertices:t=[],faces:r=[],normals:s=[],axes:a,boundingSphereRadius:c}=e;super({type:Nn.types.CONVEXPOLYHEDRON}),this.vertices=t,this.faces=r,this.faceNormals=s,0===this.faceNormals.length&&this.computeNormals(),c?this.boundingSphereRadius=c:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=a?a.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,r=this.uniqueEdges;r.length=0;const s=new X;for(let a=0;a!==e.length;a++){const c=e[a],d=c.length;for(let p=0;p!==d;p++){t[c[p]].vsub(t[c[(p+1)%d]],s),s.normalize();let v=!1;for(let b=0;b!==r.length;b++)if(r[b].almostEquals(s)||r[b].almostEquals(s)){v=!0;break}v||r.push(s.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let s=0;s<this.faces[e].length;s++)if(!this.vertices[this.faces[e][s]])throw new Error(`Vertex ${this.faces[e][s]} not found!`);const t=this.faceNormals[e]||new X;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(`.faceNormals[${e}] = Vec3(${t.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let s=0;s<this.faces[e].length;s++)console.warn(`.vertices[${this.faces[e][s]}] = Vec3(${this.vertices[this.faces[e][s]].toString()})`)}}}getFaceNormal(e,t){const r=this.faces[e];Ol.computeNormal(this.vertices[r[0]],this.vertices[r[1]],this.vertices[r[2]],t)}static computeNormal(e,t,r,s){const a=new X,c=new X;t.vsub(e,c),r.vsub(t,a),a.cross(c,s),s.isZero()||s.normalize()}clipAgainstHull(e,t,r,s,a,c,d,p,g){const v=new X;let b=-1,_=-Number.MAX_VALUE;for(let w=0;w<r.faces.length;w++){v.copy(r.faceNormals[w]),a.vmult(v,v);const P=v.dot(c);P>_&&(_=P,b=w)}const M=[];for(let w=0;w<r.faces[b].length;w++){const P=r.vertices[r.faces[b][w]],R=new X;R.copy(P),a.vmult(R,R),s.vadd(R,R),M.push(R)}b>=0&&this.clipFaceAgainstHull(c,e,t,M,d,p,g)}findSeparatingAxis(e,t,r,s,a,c,d,p){const g=new X,v=new X,b=new X,_=new X,M=new X,w=new X;let P=Number.MAX_VALUE;const R=this;if(R.uniqueAxes)for(let I=0;I!==R.uniqueAxes.length;I++){r.vmult(R.uniqueAxes[I],g);const V=R.testSepAxis(g,e,t,r,s,a);if(!1===V)return!1;V<P&&(P=V,c.copy(g))}else{const I=d?d.length:R.faces.length;for(let V=0;V<I;V++){g.copy(R.faceNormals[d?d[V]:V]),r.vmult(g,g);const j=R.testSepAxis(g,e,t,r,s,a);if(!1===j)return!1;j<P&&(P=j,c.copy(g))}}if(e.uniqueAxes)for(let I=0;I!==e.uniqueAxes.length;I++){a.vmult(e.uniqueAxes[I],v);const V=R.testSepAxis(v,e,t,r,s,a);if(!1===V)return!1;V<P&&(P=V,c.copy(v))}else{const I=p?p.length:e.faces.length;for(let V=0;V<I;V++){v.copy(e.faceNormals[p?p[V]:V]),a.vmult(v,v);const j=R.testSepAxis(v,e,t,r,s,a);if(!1===j)return!1;j<P&&(P=j,c.copy(v))}}for(let I=0;I!==R.uniqueEdges.length;I++){r.vmult(R.uniqueEdges[I],_);for(let V=0;V!==e.uniqueEdges.length;V++)if(a.vmult(e.uniqueEdges[V],M),_.cross(M,w),!w.almostZero()){w.normalize();const k=R.testSepAxis(w,e,t,r,s,a);if(!1===k)return!1;k<P&&(P=k,c.copy(w))}}return s.vsub(t,b),b.dot(c)>0&&c.negate(c),!0}testSepAxis(e,t,r,s,a,c){Ol.project(this,e,r,s,Dp),Ol.project(t,e,a,c,Kg);const p=Dp[0],g=Dp[1],v=Kg[0],b=Kg[1];if(p<b||v<g)return!1;const _=p-b,M=v-g;return _<M?_:M}calculateLocalInertia(e,t){const r=new X,s=new X;this.computeLocalAABB(s,r);const a=r.x-s.x,c=r.y-s.y,d=r.z-s.z;t.x=1/12*e*(2*c*2*c+2*d*2*d),t.y=1/12*e*(2*a*2*a+2*d*2*d),t.z=1/12*e*(2*c*2*c+2*a*2*a)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,r,s,a,c,d){const p=new X,g=new X,v=new X,b=new X,_=new X,M=new X,w=new X,P=new X,R=this,V=s,k=[];let j=-1,Q=Number.MAX_VALUE;for(let ne=0;ne<R.faces.length;ne++){p.copy(R.faceNormals[ne]),r.vmult(p,p);const je=p.dot(e);je<Q&&(Q=je,j=ne)}if(j<0)return;const se=R.faces[j];se.connectedFaces=[];for(let ne=0;ne<R.faces.length;ne++)for(let je=0;je<R.faces[ne].length;je++)-1!==se.indexOf(R.faces[ne][je])&&ne!==j&&-1===se.connectedFaces.indexOf(ne)&&se.connectedFaces.push(ne);const oe=se.length;for(let ne=0;ne<oe;ne++){const je=R.vertices[se[ne]];je.vsub(R.vertices[se[(ne+1)%oe]],g),v.copy(g),r.vmult(v,v),t.vadd(v,v),b.copy(this.faceNormals[j]),r.vmult(b,b),t.vadd(b,b),v.cross(b,_),_.negate(_),M.copy(je),r.vmult(M,M),t.vadd(M,M);const we=se.connectedFaces[ne];w.copy(this.faceNormals[we]);const Re=this.getPlaneConstantOfFace(we);P.copy(w),r.vmult(P,P);const Pe=Re-P.dot(t);for(this.clipFaceAgainstPlane(V,k,P,Pe);V.length;)V.shift();for(;k.length;)V.push(k.shift())}w.copy(this.faceNormals[j]);const _e=this.getPlaneConstantOfFace(j);P.copy(w),r.vmult(P,P);const q=_e-P.dot(t);for(let ne=0;ne<V.length;ne++){let je=P.dot(V[ne])+q;je<=a&&(console.log(`clamped: depth=${je} to minDist=${a}`),je=a),je<=c&&je<=1e-6&&d.push({point:V[ne],normal:P,depth:je})}}clipFaceAgainstPlane(e,t,r,s){let a,c;const d=e.length;if(d<2)return t;let p=e[e.length-1],g=e[0];a=r.dot(p)+s;for(let v=0;v<d;v++){if(g=e[v],c=r.dot(g)+s,a<0)if(c<0){const b=new X;b.copy(g),t.push(b)}else{const b=new X;p.lerp(g,a/(a-c),b),t.push(b)}else if(c<0){const b=new X;p.lerp(g,a/(a-c),b),t.push(b),t.push(g)}p=g,a=c}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new X);const r=this.vertices,s=this.worldVertices;for(let a=0;a!==this.vertices.length;a++)t.vmult(r[a],s[a]),e.vadd(s[a],s[a]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const r=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let s=0;s<this.vertices.length;s++){const a=r[s];a.x<e.x?e.x=a.x:a.x>t.x&&(t.x=a.x),a.y<e.y?e.y=a.y:a.y>t.y&&(t.y=a.y),a.z<e.z?e.z=a.z:a.z>t.z&&(t.z=a.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new X);const r=this.faceNormals,s=this.worldFaceNormals;for(let a=0;a!==t;a++)e.vmult(r[a],s[a]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let r=0;r!==t.length;r++){const s=t[r].lengthSquared();s>e&&(e=s)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,r,s){const a=this.vertices;let c,d,p,g,v,b,_=new X;for(let M=0;M<a.length;M++)_.copy(a[M]),t.vmult(_,_),e.vadd(_,_),(void 0===c||_.x<c)&&(c=_.x),(void 0===g||_.x>g)&&(g=_.x),(void 0===d||_.y<d)&&(d=_.y),(void 0===v||_.y>v)&&(v=_.y),(void 0===p||_.z<p)&&(p=_.z),(void 0===b||_.z>b)&&(b=_.z);r.set(c,d,p),s.set(g,v,b)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){void 0===e&&(e=new X);const t=this.vertices;for(let r=0;r<t.length;r++)e.vadd(t[r],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const r=this.vertices.length,s=this.vertices;if(t){for(let a=0;a<r;a++){const c=s[a];t.vmult(c,c)}for(let a=0;a<this.faceNormals.length;a++){const c=this.faceNormals[a];t.vmult(c,c)}}if(e)for(let a=0;a<r;a++){const c=s[a];c.vadd(e,c)}}pointIsInside(e){const t=this.vertices,r=this.faces,s=this.faceNormals,c=new X;this.getAveragePointLocal(c);for(let d=0;d<this.faces.length;d++){let p=s[d];const g=t[r[d][0]],v=new X;e.vsub(g,v);const b=p.dot(v),_=new X;c.vsub(g,_);const M=p.dot(_);if(b<0&&M>0||b>0&&M<0)return!1}return-1}static project(e,t,r,s,a){const c=e.vertices.length,d=MM;let p=0,g=0;const v=wM,b=e.vertices;v.setZero(),Xi.vectorToLocalFrame(r,s,t,d),Xi.pointToLocalFrame(r,s,v,v);const _=v.dot(d);g=p=b[0].dot(d);for(let M=1;M<c;M++){const w=b[M].dot(d);w>p&&(p=w),w<g&&(g=w)}if(g-=_,p-=_,g>p){const M=g;g=p,p=M}a[0]=p,a[1]=g}}const Dp=[],Kg=[],MM=(new X,new X),wM=new X;class Ed extends Nn{constructor(e){super({type:Nn.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,r=this.halfExtents.z,s=X,a=[new s(-e,-t,-r),new s(e,-t,-r),new s(e,t,-r),new s(-e,t,-r),new s(-e,-t,r),new s(e,-t,r),new s(e,t,r),new s(-e,t,r)],d=[new s(0,0,1),new s(0,1,0),new s(1,0,0)],p=new Ol({vertices:a,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:d});this.convexPolyhedronRepresentation=p,p.material=this.material}calculateLocalInertia(e,t){return void 0===t&&(t=new X),Ed.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,r){const s=e;r.x=1/12*t*(2*s.y*2*s.y+2*s.z*2*s.z),r.y=1/12*t*(2*s.x*2*s.x+2*s.z*2*s.z),r.z=1/12*t*(2*s.y*2*s.y+2*s.x*2*s.x)}getSideNormals(e,t){const r=e,s=this.halfExtents;if(r[0].set(s.x,0,0),r[1].set(0,s.y,0),r[2].set(0,0,s.z),r[3].set(-s.x,0,0),r[4].set(0,-s.y,0),r[5].set(0,0,-s.z),void 0!==t)for(let a=0;a!==r.length;a++)t.vmult(r[a],r[a]);return r}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,r){const s=this.halfExtents,a=[[s.x,s.y,s.z],[-s.x,s.y,s.z],[-s.x,-s.y,s.z],[-s.x,-s.y,-s.z],[s.x,-s.y,-s.z],[s.x,s.y,-s.z],[-s.x,s.y,-s.z],[s.x,-s.y,s.z]];for(let c=0;c<a.length;c++)Oa.set(a[c][0],a[c][1],a[c][2]),t.vmult(Oa,Oa),e.vadd(Oa,Oa),r(Oa.x,Oa.y,Oa.z)}calculateWorldAABB(e,t,r,s){const a=this.halfExtents;gl[0].set(a.x,a.y,a.z),gl[1].set(-a.x,a.y,a.z),gl[2].set(-a.x,-a.y,a.z),gl[3].set(-a.x,-a.y,-a.z),gl[4].set(a.x,-a.y,-a.z),gl[5].set(a.x,a.y,-a.z),gl[6].set(-a.x,a.y,-a.z),gl[7].set(a.x,-a.y,a.z);const c=gl[0];t.vmult(c,c),e.vadd(c,c),s.copy(c),r.copy(c);for(let d=1;d<8;d++){const p=gl[d];t.vmult(p,p),e.vadd(p,p);const g=p.x,v=p.y,b=p.z;g>s.x&&(s.x=g),v>s.y&&(s.y=v),b>s.z&&(s.z=b),g<r.x&&(r.x=g),v<r.y&&(r.y=v),b<r.z&&(r.z=b)}}}const Oa=new X,gl=[new X,new X,new X,new X,new X,new X,new X,new X];class ii extends Zg{constructor(e){void 0===e&&(e={}),super(),this.id=ii.idCounter++,this.index=-1,this.world=null,this.vlambda=new X,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new X,this.previousPosition=new X,this.interpolatedPosition=new X,this.initPosition=new X,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new X,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new X,this.force=new X;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?ii.STATIC:ii.DYNAMIC,typeof e.type==typeof ii.STATIC&&(this.type=e.type),this.allowSleep=!(typeof e.allowSleep<"u")||e.allowSleep,this.sleepState=ii.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new X,this.quaternion=new as,this.initQuaternion=new as,this.previousQuaternion=new as,this.interpolatedQuaternion=new as,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new X,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new X,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new X,this.invInertia=new X,this.invInertiaWorld=new Ra,this.invMassSolve=0,this.invInertiaSolve=new X,this.invInertiaWorldSolve=new Ra,this.fixedRotation=typeof e.fixedRotation<"u"&&e.fixedRotation,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new X(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new X(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new os,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new X,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=ii.AWAKE,this.wakeUpAfterNarrowphase=!1,e===ii.SLEEPING&&this.dispatchEvent(ii.wakeupEvent)}sleep(){this.sleepState=ii.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,r=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),s=this.sleepSpeedLimit**2;t===ii.AWAKE&&r<s?(this.sleepState=ii.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(ii.sleepyEvent)):t===ii.SLEEPY&&r>s?this.wakeUp():t===ii.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(ii.sleepEvent))}}updateSolveMassProperties(){this.sleepState===ii.SLEEPING||this.type===ii.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t){return void 0===t&&(t=new X),e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t){return void 0===t&&(t=new X),this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t){return void 0===t&&(t=new X),this.quaternion.vmult(e,t),t}addShape(e,t,r){const s=new X,a=new as;return t&&s.copy(t),r&&a.copy(r),this.shapes.push(e),this.shapeOffsets.push(s),this.shapeOrientations.push(a),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,r=e.length;let s=0;for(let a=0;a!==r;a++){const c=e[a];c.updateBoundingSphereRadius();const d=t[a].length(),p=c.boundingSphereRadius;d+p>s&&(s=d+p)}this.boundingRadius=s}updateAABB(){const e=this.shapes,t=this.shapeOffsets,r=this.shapeOrientations,s=e.length,a=h_,c=f_,d=this.quaternion,p=this.aabb,g=Rp;for(let v=0;v!==s;v++){const b=e[v];d.vmult(t[v],a),a.vadd(this.position,a),d.mult(r[v],c),b.calculateWorldAABB(a,c,g.lowerBound,g.upperBound),0===v?p.copy(g):p.extend(g)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const r=SM,s=p_;r.setRotationFromQuaternion(this.quaternion),r.transpose(s),r.scale(t,r),r.mmult(s,this.invInertiaWorld)}}applyForce(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;this.sleepState===ii.SLEEPING&&this.wakeUp();const r=AM;t.cross(e,r),this.force.vadd(e,this.force),this.torque.vadd(r,this.torque)}applyLocalForce(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;const r=TM,s=DM;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,s),this.applyForce(r,s)}applyTorque(e){this.type===ii.DYNAMIC&&(this.sleepState===ii.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;this.sleepState===ii.SLEEPING&&this.wakeUp();const r=t,s=IM;s.copy(e),s.scale(this.invMass,s),this.velocity.vadd(s,this.velocity);const a=RM;r.cross(e,a),this.invInertiaWorld.vmult(a,a),this.angularVelocity.vadd(a,this.angularVelocity)}applyLocalImpulse(e,t){if(void 0===t&&(t=new X),this.type!==ii.DYNAMIC)return;const r=PM,s=OM;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,s),this.applyImpulse(r,s)}updateMassProperties(){const e=LM;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,r=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Ed.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!r?1/t.x:0,t.y>0&&!r?1/t.y:0,t.z>0&&!r?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const r=new X;return e.vsub(this.position,r),this.angularVelocity.cross(r,t),this.velocity.vadd(t,t),t}integrate(e,t,r){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==ii.DYNAMIC&&this.type!==ii.KINEMATIC||this.sleepState===ii.SLEEPING)return;const s=this.velocity,a=this.angularVelocity,c=this.position,d=this.force,p=this.torque,g=this.quaternion,b=this.invInertiaWorld,_=this.linearFactor,M=this.invMass*e;s.x+=d.x*M*_.x,s.y+=d.y*M*_.y,s.z+=d.z*M*_.z;const w=b.elements,P=this.angularFactor,R=p.x*P.x,I=p.y*P.y,V=p.z*P.z;a.x+=e*(w[0]*R+w[1]*I+w[2]*V),a.y+=e*(w[3]*R+w[4]*I+w[5]*V),a.z+=e*(w[6]*R+w[7]*I+w[8]*V),c.x+=s.x*e,c.y+=s.y*e,c.z+=s.z*e,g.integrate(this.angularVelocity,e,this.angularFactor,g),t&&(r?g.normalizeFast():g.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}ii.idCounter=0,ii.COLLIDE_EVENT_NAME="collide",ii.DYNAMIC=1,ii.STATIC=2,ii.KINEMATIC=4,ii.AWAKE=0,ii.SLEEPY=1,ii.SLEEPING=2,ii.wakeupEvent={type:"wakeup"},ii.sleepyEvent={type:"sleepy"},ii.sleepEvent={type:"sleep"};const h_=new X,f_=new as,Rp=new os,SM=new Ra,p_=new Ra,AM=(new Ra,new X),TM=new X,DM=new X,IM=new X,RM=new X,PM=new X,OM=new X,LM=new X;class NM{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,t,r){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,t){return!(!(e.collisionFilterGroup&t.collisionFilterMask)||!(t.collisionFilterGroup&e.collisionFilterMask)||(e.type&ii.STATIC||e.sleepState===ii.SLEEPING)&&(t.type&ii.STATIC||t.sleepState===ii.SLEEPING))}intersectionTest(e,t,r,s){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,r,s):this.doBoundingSphereBroadphase(e,t,r,s)}doBoundingSphereBroadphase(e,t,r,s){const a=Qg;t.position.vsub(e.position,a);const c=(e.boundingRadius+t.boundingRadius)**2;a.lengthSquared()<c&&(r.push(e),s.push(t))}doBoundingBoxBroadphase(e,t,r,s){e.aabbNeedsUpdate&&e.updateAABB(),t.aabbNeedsUpdate&&t.updateAABB(),e.aabb.overlaps(t.aabb)&&(r.push(e),s.push(t))}makePairsUnique(e,t){const r=FM,s=tA,a=nA,c=e.length;for(let d=0;d!==c;d++)s[d]=e[d],a[d]=t[d];e.length=0,t.length=0;for(let d=0;d!==c;d++){const p=s[d].id,g=a[d].id,v=p<g?`${p},${g}`:`${g},${p}`;r[v]=d,r.keys.push(v)}for(let d=0;d!==r.keys.length;d++){const p=r.keys.pop(),g=r[p];e.push(s[g]),t.push(a[g]),delete r[p]}}setWorld(e){}static boundingSphereCheck(e,t){const r=new X;return e.position.vsub(t.position,r),Math.pow(e.shapes[0].boundingSphereRadius+t.shapes[0].boundingSphereRadius,2)>r.lengthSquared()}aabbQuery(e,t,r){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const Qg=new X;new X,new as,new X;const FM={keys:[]},tA=[],nA=[];new X,new X,new X;class rA extends NM{constructor(){super()}collisionPairs(e,t,r){const s=e.bodies,a=s.length;let c,d;for(let p=0;p!==a;p++)for(let g=0;g!==p;g++)c=s[p],d=s[g],this.needBroadphaseCollision(c,d)&&this.intersectionTest(c,d,t,r)}aabbQuery(e,t,r){void 0===r&&(r=[]);for(let s=0;s<e.bodies.length;s++){const a=e.bodies[s];a.aabbNeedsUpdate&&a.updateAABB(),a.aabb.overlaps(t)&&r.push(a)}return r}}class Wh{constructor(){this.rayFromWorld=new X,this.rayToWorld=new X,this.hitNormalWorld=new X,this.hitPointWorld=new X,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,r,s,a,c,d){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(r),this.hitPointWorld.copy(s),this.shape=a,this.body=c,this.distance=d}}let kM,m_,g_,v_,Pp,Md,Op;kM=Nn.types.SPHERE,m_=Nn.types.PLANE,g_=Nn.types.BOX,v_=Nn.types.CYLINDER,Pp=Nn.types.CONVEXPOLYHEDRON,Md=Nn.types.HEIGHTFIELD,Op=Nn.types.TRIMESH;class Us{get[kM](){return this._intersectSphere}get[m_](){return this._intersectPlane}get[g_](){return this._intersectBox}get[v_](){return this._intersectConvex}get[Pp](){return this._intersectConvex}get[Md](){return this._intersectHeightfield}get[Op](){return this._intersectTrimesh}constructor(e,t){void 0===e&&(e=new X),void 0===t&&(t=new X),this.from=e.clone(),this.to=t.clone(),this.direction=new X,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Us.ANY,this.result=new Wh,this.hasHit=!1,this.callback=r=>{}}intersectWorld(e,t){return this.mode=t.mode||Us.ANY,this.result=t.result||new Wh,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=typeof t.collisionFilterMask<"u"?t.collisionFilterMask:-1,this.collisionFilterGroup=typeof t.collisionFilterGroup<"u"?t.collisionFilterGroup:-1,this.checkCollisionResponse=!(typeof t.checkCollisionResponse<"u")||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Sd),Lp.length=0,e.broadphase.aabbQuery(e,Sd,Lp),this.intersectBodies(Lp),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const r=this.checkCollisionResponse;if(r&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const s=y_,a=UM;for(let c=0,d=e.shapes.length;c<d;c++){const p=e.shapes[c];if((!r||p.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[c],a),e.quaternion.vmult(e.shapeOffsets[c],s),s.vadd(e.position,s),this.intersectShape(p,a,s,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let r=0,s=e.length;!this.result.shouldStop&&r<s;r++)this.intersectBody(e[r])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,r,s){if(function nv(h,e,t){t.vsub(h,La);const r=La.dot(e);return e.scale(r,kp),kp.vadd(h,kp),t.distanceTo(kp)}(this.from,this.direction,r)>e.boundingSphereRadius)return;const d=this[e.type];d&&d.call(this,e,t,r,s,e)}_intersectBox(e,t,r,s,a){return this._intersectConvex(e.convexPolyhedronRepresentation,t,r,s,a)}_intersectPlane(e,t,r,s,a){const c=this.from,d=this.to,p=this.direction,g=new X(0,0,1);t.vmult(g,g);const v=new X;c.vsub(r,v);const b=v.dot(g);if(d.vsub(r,v),b*v.dot(g)>0||c.distanceTo(d)<b)return;const M=g.dot(p);if(Math.abs(M)<this.precision)return;const w=new X,P=new X,R=new X;c.vsub(r,w);const I=-g.dot(w)/M;p.scale(I,P),c.vadd(P,R),this.reportIntersection(g,R,a,s,-1)}getAABB(e){const{lowerBound:t,upperBound:r}=e,s=this.to,a=this.from;t.x=Math.min(s.x,a.x),t.y=Math.min(s.y,a.y),t.z=Math.min(s.z,a.z),r.x=Math.max(s.x,a.x),r.y=Math.max(s.y,a.y),r.z=Math.max(s.z,a.z)}_intersectHeightfield(e,t,r,s,a){const c=VM;c.from.copy(this.from),c.to.copy(this.to),Xi.pointToLocalFrame(r,t,c.from,c.from),Xi.pointToLocalFrame(r,t,c.to,c.to),c.updateDirection();const d=ev;let p,g,v,b;p=g=0,v=b=e.data.length-1;const _=new os;c.getAABB(_),e.getIndexOfPosition(_.lowerBound.x,_.lowerBound.y,d,!0),p=Math.max(p,d[0]),g=Math.max(g,d[1]),e.getIndexOfPosition(_.upperBound.x,_.upperBound.y,d,!0),v=Math.min(v,d[0]+1),b=Math.min(b,d[1]+1);for(let M=p;M<v;M++)for(let w=g;w<b;w++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(M,w,_),_.overlapsRay(c)){if(e.getConvexTrianglePillar(M,w,!1),Xi.pointToWorldFrame(r,t,e.pillarOffset,Np),this._intersectConvex(e.pillarConvex,t,Np,s,a,__),this.result.shouldStop)return;e.getConvexTrianglePillar(M,w,!0),Xi.pointToWorldFrame(r,t,e.pillarOffset,Np),this._intersectConvex(e.pillarConvex,t,Np,s,a,__)}}}_intersectSphere(e,t,r,s,a){const c=this.from,d=this.to,g=(d.x-c.x)**2+(d.y-c.y)**2+(d.z-c.z)**2,v=2*((d.x-c.x)*(c.x-r.x)+(d.y-c.y)*(c.y-r.y)+(d.z-c.z)*(c.z-r.z)),_=v**2-4*g*((c.x-r.x)**2+(c.y-r.y)**2+(c.z-r.z)**2-e.radius**2),M=Yh,w=Fp;if(!(_<0))if(0===_)c.lerp(d,_,M),M.vsub(r,w),w.normalize(),this.reportIntersection(w,M,a,s,-1);else{const P=(-v-Math.sqrt(_))/(2*g),R=(-v+Math.sqrt(_))/(2*g);if(P>=0&&P<=1&&(c.lerp(d,P,M),M.vsub(r,w),w.normalize(),this.reportIntersection(w,M,a,s,-1)),this.result.shouldStop)return;R>=0&&R<=1&&(c.lerp(d,R,M),M.vsub(r,w),w.normalize(),this.reportIntersection(w,M,a,s,-1))}}_intersectConvex(e,t,r,s,a,c){const d=Bp,p=b_,g=c&&c.faceList||null,v=e.faces,b=e.vertices,_=e.faceNormals,M=this.direction,w=this.from,R=w.distanceTo(this.to),I=g?g.length:v.length,V=this.result;for(let k=0;!V.shouldStop&&k<I;k++){const j=g?g[k]:k,Q=v[j],se=_[j],oe=t,_e=r;p.copy(b[Q[0]]),oe.vmult(p,p),p.vadd(_e,p),p.vsub(w,p),oe.vmult(se,d);const q=M.dot(d);if(Math.abs(q)<this.precision)continue;const ne=d.dot(p)/q;if(!(ne<0)){M.scale(ne,jo),jo.vadd(w,jo),ia.copy(b[Q[0]]),oe.vmult(ia,ia),_e.vadd(ia,ia);for(let je=1;!V.shouldStop&&je<Q.length-1;je++){vl.copy(b[Q[je]]),yl.copy(b[Q[je+1]]),oe.vmult(vl,vl),oe.vmult(yl,yl),_e.vadd(vl,vl),_e.vadd(yl,yl);const dt=jo.distanceTo(w);!Us.pointInTriangle(jo,ia,vl,yl)&&!Us.pointInTriangle(jo,vl,ia,yl)||dt>R||this.reportIntersection(d,jo,a,s,j)}}}}_intersectTrimesh(e,t,r,s,a,c){const d=tv,p=WM,g=jM,v=b_,b=HM,_=x_,M=$M,w=E_,P=GM,R=e.indices,I=this.from,V=this.to,k=this.direction;g.position.copy(r),g.quaternion.copy(t),Xi.vectorToLocalFrame(r,t,k,b),Xi.pointToLocalFrame(r,t,I,_),Xi.pointToLocalFrame(r,t,V,M),M.x*=e.scale.x,M.y*=e.scale.y,M.z*=e.scale.z,_.x*=e.scale.x,_.y*=e.scale.y,_.z*=e.scale.z,M.vsub(_,b),b.normalize();const j=_.distanceSquared(M);e.tree.rayQuery(this,g,p);for(let Q=0,se=p.length;!this.result.shouldStop&&Q!==se;Q++){const oe=p[Q];e.getNormal(oe,d),e.getVertex(R[3*oe],ia),ia.vsub(_,v);const _e=b.dot(d),q=d.dot(v)/_e;if(q<0)continue;b.scale(q,jo),jo.vadd(_,jo),e.getVertex(R[3*oe+1],vl),e.getVertex(R[3*oe+2],yl);const ne=jo.distanceSquared(_);!Us.pointInTriangle(jo,vl,ia,yl)&&!Us.pointInTriangle(jo,ia,vl,yl)||ne>j||(Xi.vectorToWorldFrame(t,d,P),Xi.pointToWorldFrame(r,t,jo,w),this.reportIntersection(P,w,a,s,oe))}p.length=0}reportIntersection(e,t,r,s,a){const c=this.from,d=this.to,p=c.distanceTo(t),g=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(g.hitFaceIndex=typeof a<"u"?a:-1,this.mode){case Us.ALL:this.hasHit=!0,g.set(c,d,e,t,r,s,p),g.hasHit=!0,this.callback(g);break;case Us.CLOSEST:(p<g.distance||!g.hasHit)&&(this.hasHit=!0,g.hasHit=!0,g.set(c,d,e,t,r,s,p));break;case Us.ANY:this.hasHit=!0,g.hasHit=!0,g.set(c,d,e,t,r,s,p),g.shouldStop=!0}}static pointInTriangle(e,t,r,s){s.vsub(t,La),r.vsub(t,jh),e.vsub(t,cu);const a=La.dot(La),c=La.dot(jh),d=La.dot(cu),p=jh.dot(jh),g=jh.dot(cu);let v,b;return(v=p*d-c*g)>=0&&(b=a*g-c*d)>=0&&v+b<a*p-c*c}}Us.CLOSEST=1,Us.ANY=2,Us.ALL=4;const Sd=new os,Lp=[],jh=new X,cu=new X,y_=new X,UM=new as,jo=new X,ia=new X,vl=new X,yl=new X;new X,new Wh;const __={faceList:[0]},Np=new X,VM=new Us,ev=[],Yh=new X,Fp=new X,Bp=new X,b_=(new X,new X,new X),tv=new X,HM=new X,x_=new X,$M=new X,GM=new X,E_=new X;new os;const WM=[],jM=new Xi,La=new X,kp=new X;class Xh{static defaults(e,t){void 0===e&&(e={});for(let r in t)r in e||(e[r]=t[r]);return e}}class iv{constructor(){this.spatial=new X,this.rotational=new X}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}}let rv=(()=>{class h{constructor(t,r,s,a){void 0===s&&(s=-1e6),void 0===a&&(a=1e6),this.id=h.idCounter++,this.minForce=s,this.maxForce=a,this.bi=t,this.bj=r,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new iv,this.jacobianElementB=new iv,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(t,r,s){const a=r,c=t,d=s;this.a=4/(d*(1+4*a)),this.b=4*a/(1+4*a),this.eps=4/(d*d*c*(1+4*a))}computeB(t,r,s){const a=this.computeGW();return-this.computeGq()*t-a*r-this.computeGiMf()*s}computeGq(){const r=this.jacobianElementB,d=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+r.spatial.dot(d)}computeGW(){const r=this.jacobianElementB,s=this.bi,a=this.bj,d=a.velocity,g=a.angularVelocity;return this.jacobianElementA.multiplyVectors(s.velocity,s.angularVelocity)+r.multiplyVectors(d,g)}computeGWlambda(){const r=this.jacobianElementB,s=this.bi,a=this.bj,d=a.vlambda,g=a.wlambda;return this.jacobianElementA.multiplyVectors(s.vlambda,s.wlambda)+r.multiplyVectors(d,g)}computeGiMf(){const t=this.jacobianElementA,r=this.jacobianElementB,s=this.bi,a=this.bj,d=s.torque,p=a.force,g=a.torque,b=a.invMassSolve;return s.force.scale(s.invMassSolve,Cd),p.scale(b,sv),s.invInertiaWorldSolve.vmult(d,uu),a.invInertiaWorldSolve.vmult(g,Ad),t.multiplyVectors(Cd,uu)+r.multiplyVectors(sv,Ad)}computeGiMGt(){const t=this.jacobianElementA,r=this.jacobianElementB,s=this.bi,a=this.bj,g=a.invInertiaWorldSolve;let v=s.invMassSolve+a.invMassSolve;return s.invInertiaWorldSolve.vmult(t.rotational,Td),v+=Td.dot(t.rotational),g.vmult(r.rotational,Td),v+=Td.dot(r.rotational),v}addToWlambda(t){const r=this.jacobianElementA,s=this.jacobianElementB,a=this.bi,c=this.bj,d=Up;a.vlambda.addScaledVector(a.invMassSolve*t,r.spatial,a.vlambda),c.vlambda.addScaledVector(c.invMassSolve*t,s.spatial,c.vlambda),a.invInertiaWorldSolve.vmult(r.rotational,d),a.wlambda.addScaledVector(t,d,a.wlambda),c.invInertiaWorldSolve.vmult(s.rotational,d),c.wlambda.addScaledVector(t,d,c.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}return h.idCounter=0,h})();const Cd=new X,sv=new X,uu=new X,Ad=new X,Td=new X,Up=new X;class Zh extends rv{constructor(e,t,r){void 0===r&&(r=1e6),super(e,t,0,r),this.restitution=0,this.ri=new X,this.rj=new X,this.ni=new X}computeB(e){const t=this.a,r=this.b,s=this.bi,a=this.bj,c=this.ri,d=this.rj,p=qM,g=M_,v=s.velocity,b=s.angularVelocity,_=a.velocity,M=a.angularVelocity,w=w_,P=this.jacobianElementA,R=this.jacobianElementB,I=this.ni;c.cross(I,p),d.cross(I,g),I.negate(P.spatial),p.negate(P.rotational),R.spatial.copy(I),R.rotational.copy(g),w.copy(a.position),w.vadd(d,w),w.vsub(s.position,w),w.vsub(c,w);const V=I.dot(w),k=this.restitution+1;return-V*t-(k*_.dot(I)-k*v.dot(I)+M.dot(g)-b.dot(p))*r-e*this.computeGiMf()}getImpactVelocityAlongNormal(){const e=ov,t=S_,r=XM,s=C_,a=av;return this.bi.position.vadd(this.ri,r),this.bj.position.vadd(this.rj,s),this.bi.getVelocityAtWorldPoint(r,e),this.bj.getVelocityAtWorldPoint(s,t),e.vsub(t,a),this.ni.dot(a)}}const qM=new X,M_=new X,w_=new X,ov=new X,S_=new X,XM=new X,C_=new X,av=new X;new X,new X,new X,new X,new X,new X,new X,new X,new X,new X;class T_ extends rv{constructor(e,t,r){super(e,t,-r,r),this.ri=new X,this.rj=new X,this.t=new X}computeB(e){const t=this.b,s=this.rj,a=lw,c=cw,d=this.t;this.ri.cross(d,a),s.cross(d,c);const p=this.jacobianElementA,g=this.jacobianElementB;return d.negate(p.spatial),a.negate(p.rotational),g.spatial.copy(d),g.rotational.copy(c),-this.computeGW()*t-e*this.computeGiMf()}}const lw=new X,cw=new X;let lv=(()=>{class h{constructor(t,r,s){s=Xh.defaults(s,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=h.idCounter++,this.materials=[t,r],this.friction=s.friction,this.restitution=s.restitution,this.contactEquationStiffness=s.contactEquationStiffness,this.contactEquationRelaxation=s.contactEquationRelaxation,this.frictionEquationStiffness=s.frictionEquationStiffness,this.frictionEquationRelaxation=s.frictionEquationRelaxation}}return h.idCounter=0,h})(),uw=(()=>{class h{constructor(t){void 0===t&&(t={});let r="";"string"==typeof t&&(r=t,t={}),this.name=r,this.id=h.idCounter++,this.friction=typeof t.friction<"u"?t.friction:-1,this.restitution=typeof t.restitution<"u"?t.restitution:-1}}return h.idCounter=0,h})();new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new Us,new X,new X,new X,new X(1,0,0),new X(0,1,0),new X(0,0,1),new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X;class vv extends Nn{constructor(e){if(super({type:Nn.types.SPHERE}),this.radius=void 0!==e?e:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(e,t){void 0===t&&(t=new X);const r=2*e*this.radius*this.radius/5;return t.x=r,t.y=r,t.z=r,t}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(e,t,r,s){const a=this.radius,c=["x","y","z"];for(let d=0;d<c.length;d++){const p=c[d];r[p]=e[p]-a,s[p]=e[p]+a}}}new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new X,new os,new X,new os,new X,new X,new X,new X,new X,new X,new X,new os,new X,new Xi,new os;class Xp{constructor(){this.equations=[]}solve(e,t){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const t=this.equations,r=t.indexOf(e);-1!==r&&t.splice(r,1)}removeAllEquations(){this.equations.length=0}}class bv extends Xp{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,t){let r=0;const s=this.iterations,a=this.tolerance*this.tolerance,c=this.equations,d=c.length,p=t.bodies,g=p.length,v=e;let b,_,M,w,P,R;if(0!==d)for(let j=0;j!==g;j++)p[j].updateSolveMassProperties();const I=Nw,V=Fw,k=j_;I.length=d,V.length=d,k.length=d;for(let j=0;j!==d;j++){const Q=c[j];k[j]=0,V[j]=Q.computeB(v),I[j]=1/Q.computeC()}if(0!==d){for(let se=0;se!==g;se++){const oe=p[se],q=oe.wlambda;oe.vlambda.set(0,0,0),q.set(0,0,0)}for(r=0;r!==s;r++){w=0;for(let se=0;se!==d;se++){const oe=c[se];b=V[se],_=I[se],R=k[se],P=oe.computeGWlambda(),M=_*(b-P-oe.eps*R),R+M<oe.minForce?M=oe.minForce-R:R+M>oe.maxForce&&(M=oe.maxForce-R),k[se]+=M,w+=M>0?M:-M,oe.addToWlambda(M)}if(w*w<a)break}for(let se=0;se!==g;se++){const oe=p[se],_e=oe.velocity,q=oe.angularVelocity;oe.vlambda.vmul(oe.linearFactor,oe.vlambda),_e.vadd(oe.vlambda,_e),oe.wlambda.vmul(oe.angularFactor,oe.wlambda),q.vadd(oe.wlambda,q)}let j=c.length;const Q=1/v;for(;j--;)c[j].multiplier=k[j]*Q}return r}}const j_=[],Nw=[],Fw=[];class pu{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let t=0;t!==e;t++)this.objects.push(t<0||arguments.length<=t?void 0:arguments[t]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}class kw extends pu{constructor(){super(...arguments),this.type=X}constructObject(){return new X}}const ls_sphereSphere=Nn.types.SPHERE,ls_spherePlane=Nn.types.SPHERE|Nn.types.PLANE,ls_boxBox=Nn.types.BOX|Nn.types.BOX,ls_sphereBox=Nn.types.SPHERE|Nn.types.BOX,ls_planeBox=Nn.types.PLANE|Nn.types.BOX,ls_convexConvex=Nn.types.CONVEXPOLYHEDRON,ls_sphereConvex=Nn.types.SPHERE|Nn.types.CONVEXPOLYHEDRON,ls_planeConvex=Nn.types.PLANE|Nn.types.CONVEXPOLYHEDRON,ls_boxConvex=Nn.types.BOX|Nn.types.CONVEXPOLYHEDRON,ls_sphereHeightfield=Nn.types.SPHERE|Nn.types.HEIGHTFIELD,ls_boxHeightfield=Nn.types.BOX|Nn.types.HEIGHTFIELD,ls_convexHeightfield=Nn.types.CONVEXPOLYHEDRON|Nn.types.HEIGHTFIELD,ls_sphereParticle=Nn.types.PARTICLE|Nn.types.SPHERE,ls_planeParticle=Nn.types.PLANE|Nn.types.PARTICLE,ls_boxParticle=Nn.types.BOX|Nn.types.PARTICLE,ls_convexParticle=Nn.types.PARTICLE|Nn.types.CONVEXPOLYHEDRON,ls_cylinderCylinder=Nn.types.CYLINDER,ls_sphereCylinder=Nn.types.SPHERE|Nn.types.CYLINDER,ls_planeCylinder=Nn.types.PLANE|Nn.types.CYLINDER,ls_boxCylinder=Nn.types.BOX|Nn.types.CYLINDER,ls_convexCylinder=Nn.types.CONVEXPOLYHEDRON|Nn.types.CYLINDER,ls_heightfieldCylinder=Nn.types.HEIGHTFIELD|Nn.types.CYLINDER,ls_particleCylinder=Nn.types.PARTICLE|Nn.types.CYLINDER,ls_sphereTrimesh=Nn.types.SPHERE|Nn.types.TRIMESH,ls_planeTrimesh=Nn.types.PLANE|Nn.types.TRIMESH;class Fd{get[ls_sphereSphere](){return this.sphereSphere}get[ls_spherePlane](){return this.spherePlane}get[ls_boxBox](){return this.boxBox}get[ls_sphereBox](){return this.sphereBox}get[ls_planeBox](){return this.planeBox}get[ls_convexConvex](){return this.convexConvex}get[ls_sphereConvex](){return this.sphereConvex}get[ls_planeConvex](){return this.planeConvex}get[ls_boxConvex](){return this.boxConvex}get[ls_sphereHeightfield](){return this.sphereHeightfield}get[ls_boxHeightfield](){return this.boxHeightfield}get[ls_convexHeightfield](){return this.convexHeightfield}get[ls_sphereParticle](){return this.sphereParticle}get[ls_planeParticle](){return this.planeParticle}get[ls_boxParticle](){return this.boxParticle}get[ls_convexParticle](){return this.convexParticle}get[ls_cylinderCylinder](){return this.convexConvex}get[ls_sphereCylinder](){return this.sphereConvex}get[ls_planeCylinder](){return this.planeConvex}get[ls_boxCylinder](){return this.boxConvex}get[ls_convexCylinder](){return this.convexConvex}get[ls_heightfieldCylinder](){return this.heightfieldCylinder}get[ls_particleCylinder](){return this.particleCylinder}get[ls_sphereTrimesh](){return this.sphereTrimesh}get[ls_planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new kw,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,t,r,s,a,c){let d;this.contactPointPool.length?(d=this.contactPointPool.pop(),d.bi=e,d.bj=t):d=new Zh(e,t),d.enabled=e.collisionResponse&&t.collisionResponse&&r.collisionResponse&&s.collisionResponse;const p=this.currentContactMaterial;d.restitution=p.restitution,d.setSpookParams(p.contactEquationStiffness,p.contactEquationRelaxation,this.world.dt);const g=r.material||e.material,v=s.material||t.material;return g&&v&&g.restitution>=0&&v.restitution>=0&&(d.restitution=g.restitution*v.restitution),d.si=a||r,d.sj=c||s,d}createFrictionEquationsFromContact(e,t){const r=e.bi,s=e.bj,d=this.world,p=this.currentContactMaterial;let g=p.friction;const v=e.si.material||r.material,b=e.sj.material||s.material;if(v&&b&&v.friction>=0&&b.friction>=0&&(g=v.friction*b.friction),g>0){const _=g*(d.frictionGravity||d.gravity).length();let M=r.invMass+s.invMass;M>0&&(M=1/M);const w=this.frictionEquationPool,P=w.length?w.pop():new T_(r,s,_*M),R=w.length?w.pop():new T_(r,s,_*M);return P.bi=R.bi=r,P.bj=R.bj=s,P.minForce=R.minForce=-_*M,P.maxForce=R.maxForce=_*M,P.ri.copy(e.ri),P.rj.copy(e.rj),R.ri.copy(e.ri),R.rj.copy(e.rj),e.ni.tangents(P.t,R.t),P.setSpookParams(p.frictionEquationStiffness,p.frictionEquationRelaxation,d.dt),R.setSpookParams(p.frictionEquationStiffness,p.frictionEquationRelaxation,d.dt),P.enabled=R.enabled=e.enabled,t.push(P,R),!0}return!1}createFrictionFromAverage(e){let t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||1===e)return;const r=this.frictionResult[this.frictionResult.length-2],s=this.frictionResult[this.frictionResult.length-1];Bd.setZero(),fc.setZero(),tf.setZero();const a=t.bi;for(let d=0;d!==e;d++)t=this.result[this.result.length-1-d],t.bi!==a?(Bd.vadd(t.ni,Bd),fc.vadd(t.ri,fc),tf.vadd(t.rj,tf)):(Bd.vsub(t.ni,Bd),fc.vadd(t.rj,fc),tf.vadd(t.ri,tf));const c=1/e;fc.scale(c,r.ri),tf.scale(c,r.rj),s.ri.copy(r.ri),s.rj.copy(r.rj),Bd.normalize(),Bd.tangents(r.t,s.t)}getContacts(e,t,r,s,a,c,d){this.contactPointPool=a,this.frictionEquationPool=d,this.result=s,this.frictionResult=c;const p=hA,g=kd,v=K_,b=J_;for(let _=0,M=e.length;_!==M;_++){const w=e[_],P=t[_];let R=null;w.material&&P.material&&(R=r.getContactMaterial(w.material,P.material)||null);const I=w.type&ii.KINEMATIC&&P.type&ii.STATIC||w.type&ii.STATIC&&P.type&ii.KINEMATIC||w.type&ii.KINEMATIC&&P.type&ii.KINEMATIC;for(let V=0;V<w.shapes.length;V++){w.quaternion.mult(w.shapeOrientations[V],p),w.quaternion.vmult(w.shapeOffsets[V],v),v.vadd(w.position,v);const k=w.shapes[V];for(let j=0;j<P.shapes.length;j++){P.quaternion.mult(P.shapeOrientations[j],g),P.quaternion.vmult(P.shapeOffsets[j],b),b.vadd(P.position,b);const Q=P.shapes[j];if(!(k.collisionFilterMask&Q.collisionFilterGroup&&Q.collisionFilterMask&k.collisionFilterGroup)||v.distanceTo(b)>k.boundingSphereRadius+Q.boundingSphereRadius)continue;let se=null;k.material&&Q.material&&(se=r.getContactMaterial(k.material,Q.material)||null),this.currentContactMaterial=se||R||r.defaultContactMaterial;const _e=this[k.type|Q.type];if(_e){let q=!1;q=k.type<Q.type?_e.call(this,k,Q,v,b,p,g,w,P,k,Q,I):_e.call(this,Q,k,b,v,g,p,P,w,k,Q,I),q&&I&&(r.shapeOverlapKeeper.set(k.id,Q.id),r.bodyOverlapKeeper.set(w.id,P.id))}}}}}sphereSphere(e,t,r,s,a,c,d,p,g,v,b){if(b)return r.distanceSquared(s)<(e.radius+t.radius)**2;const _=this.createContactEquation(d,p,e,t,g,v);s.vsub(r,_.ni),_.ni.normalize(),_.ri.copy(_.ni),_.rj.copy(_.ni),_.ri.scale(e.radius,_.ri),_.rj.scale(-t.radius,_.rj),_.ri.vadd(r,_.ri),_.ri.vsub(d.position,_.ri),_.rj.vadd(s,_.rj),_.rj.vsub(p.position,_.rj),this.result.push(_),this.createFrictionEquationsFromContact(_,this.frictionResult)}spherePlane(e,t,r,s,a,c,d,p,g,v,b){const _=this.createContactEquation(d,p,e,t,g,v);if(_.ni.set(0,0,1),c.vmult(_.ni,_.ni),_.ni.negate(_.ni),_.ni.normalize(),_.ni.scale(e.radius,_.ri),r.vsub(s,pc),_.ni.scale(_.ni.dot(pc),sb),pc.vsub(sb,_.rj),-pc.dot(_.ni)<=e.radius){if(b)return!0;const M=_.ri,w=_.rj;M.vadd(r,M),M.vsub(d.position,M),w.vadd(s,w),w.vsub(p.position,w),this.result.push(_),this.createFrictionEquationsFromContact(_,this.frictionResult)}}boxBox(e,t,r,s,a,c,d,p,g,v,b){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,r,s,a,c,d,p,e,t,b)}sphereBox(e,t,r,s,a,c,d,p,g,v,b){const _=this.v3pool,M=sf;r.vsub(s,nf),t.getSideNormals(M,c);const w=e.radius;let P=!1;const R=Kw,I=Jw,V=lb;let k=null,j=0,Q=0,se=0,oe=null;for(let $e=0,xt=M.length;$e!==xt&&!1===P;$e++){const wt=ab;wt.copy(M[$e]);const At=wt.length();wt.normalize();const Ut=nf.dot(wt);if(Ut<At+w&&Ut>0){const pt=Xw,gt=rf;pt.copy(M[($e+1)%3]),gt.copy(M[($e+2)%3]);const _n=pt.length(),Tn=gt.length();pt.normalize(),gt.normalize();const Fn=nf.dot(pt),Xn=nf.dot(gt);if(Fn<_n&&Fn>-_n&&Xn<Tn&&Xn>-Tn){const qn=Math.abs(Ut-At-w);if((null===oe||qn<oe)&&(oe=qn,Q=Fn,se=Xn,k=At,R.copy(wt),I.copy(pt),V.copy(gt),j++,b))return!0}}}if(j){P=!0;const $e=this.createContactEquation(d,p,e,t,g,v);R.scale(-w,$e.ri),$e.ni.copy(R),$e.ni.negate($e.ni),R.scale(k,R),I.scale(Q,I),R.vadd(I,R),V.scale(se,V),R.vadd(V,$e.rj),$e.ri.vadd(r,$e.ri),$e.ri.vsub(d.position,$e.ri),$e.rj.vadd(s,$e.rj),$e.rj.vsub(p.position,$e.rj),this.result.push($e),this.createFrictionEquationsFromContact($e,this.frictionResult)}let _e=_.get();const q=Zw;for(let $e=0;2!==$e&&!P;$e++)for(let xt=0;2!==xt&&!P;xt++)for(let wt=0;2!==wt&&!P;wt++)if(_e.set(0,0,0),$e?_e.vadd(M[0],_e):_e.vsub(M[0],_e),xt?_e.vadd(M[1],_e):_e.vsub(M[1],_e),wt?_e.vadd(M[2],_e):_e.vsub(M[2],_e),s.vadd(_e,q),q.vsub(r,q),q.lengthSquared()<w*w){if(b)return!0;P=!0;const At=this.createContactEquation(d,p,e,t,g,v);At.ri.copy(q),At.ri.normalize(),At.ni.copy(At.ri),At.ri.scale(w,At.ri),At.rj.copy(_e),At.ri.vadd(r,At.ri),At.ri.vsub(d.position,At.ri),At.rj.vadd(s,At.rj),At.rj.vsub(p.position,At.rj),this.result.push(At),this.createFrictionEquationsFromContact(At,this.frictionResult)}_.release(_e),_e=null;const ne=_.get(),je=_.get(),dt=_.get(),we=_.get(),Re=_.get(),Pe=M.length;for(let $e=0;$e!==Pe&&!P;$e++)for(let xt=0;xt!==Pe&&!P;xt++)if($e%3!=xt%3){M[xt].cross(M[$e],ne),ne.normalize(),M[$e].vadd(M[xt],je),dt.copy(r),dt.vsub(je,dt),dt.vsub(s,dt);const wt=dt.dot(ne);ne.scale(wt,we);let At=0;for(;At===$e%3||At===xt%3;)At++;Re.copy(r),Re.vsub(we,Re),Re.vsub(je,Re),Re.vsub(s,Re);const Ut=Math.abs(wt),pt=Re.length();if(Ut<M[At].length()&&pt<w){if(b)return!0;P=!0;const gt=this.createContactEquation(d,p,e,t,g,v);je.vadd(we,gt.rj),gt.rj.copy(gt.rj),Re.negate(gt.ni),gt.ni.normalize(),gt.ri.copy(gt.rj),gt.ri.vadd(s,gt.ri),gt.ri.vsub(r,gt.ri),gt.ri.normalize(),gt.ri.scale(w,gt.ri),gt.ri.vadd(r,gt.ri),gt.ri.vsub(d.position,gt.ri),gt.rj.vadd(s,gt.rj),gt.rj.vsub(p.position,gt.rj),this.result.push(gt),this.createFrictionEquationsFromContact(gt,this.frictionResult)}}_.release(ne,je,dt,we,Re)}planeBox(e,t,r,s,a,c,d,p,g,v,b){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,r,s,a,c,d,p,e,t,b)}convexConvex(e,t,r,s,a,c,d,p,g,v,b,_,M){const w=fb;if(!(r.distanceTo(s)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,r,a,s,c,w,_,M)){const P=[],R=af;e.clipAgainstHull(r,a,t,s,c,w,-100,100,P);let I=0;for(let V=0;V!==P.length;V++){if(b)return!0;const k=this.createContactEquation(d,p,e,t,g,v),j=k.ri,Q=k.rj;w.negate(k.ni),P[V].normal.negate(R),R.scale(P[V].depth,R),P[V].point.vadd(R,j),Q.copy(P[V].point),j.vsub(r,j),Q.vsub(s,Q),j.vadd(r,j),j.vsub(d.position,j),Q.vadd(s,Q),Q.vsub(p.position,Q),this.result.push(k),I++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(k,this.frictionResult)}this.enableFrictionReduction&&I&&this.createFrictionFromAverage(I)}}sphereConvex(e,t,r,s,a,c,d,p,g,v,b){const _=this.v3pool;r.vsub(s,cb);const M=t.faceNormals,w=t.faces,P=t.vertices,R=e.radius;let I=!1;for(let V=0;V!==P.length;V++){const j=eS;c.vmult(P[V],j),s.vadd(j,j);const Q=db;if(j.vsub(r,Q),Q.lengthSquared()<R*R){if(b)return!0;I=!0;const se=this.createContactEquation(d,p,e,t,g,v);return se.ri.copy(Q),se.ri.normalize(),se.ni.copy(se.ri),se.ri.scale(R,se.ri),j.vsub(s,se.rj),se.ri.vadd(r,se.ri),se.ri.vsub(d.position,se.ri),se.rj.vadd(s,se.rj),se.rj.vsub(p.position,se.rj),this.result.push(se),void this.createFrictionEquationsFromContact(se,this.frictionResult)}}for(let V=0,k=w.length;V!==k&&!1===I;V++){const Q=w[V],se=tS;c.vmult(M[V],se);const oe=fA;c.vmult(P[Q[0]],oe),oe.vadd(s,oe);const _e=pA;se.scale(-R,_e),r.vadd(_e,_e);const q=mA;_e.vsub(oe,q);const ne=q.dot(se),je=gA;if(r.vsub(oe,je),ne<0&&je.dot(se)>0){const dt=[];for(let we=0,Re=Q.length;we!==Re;we++){const Pe=_.get();c.vmult(P[Q[we]],Pe),s.vadd(Pe,Pe),dt.push(Pe)}if(ob(dt,se,r)){if(b)return!0;I=!0;const we=this.createContactEquation(d,p,e,t,g,v);se.scale(-R,we.ri),se.negate(we.ni);const Re=_.get();se.scale(-ne,Re);const Pe=_.get();se.scale(-R,Pe),r.vsub(s,we.rj),we.rj.vadd(Pe,we.rj),we.rj.vadd(Re,we.rj),we.rj.vadd(s,we.rj),we.rj.vsub(p.position,we.rj),we.ri.vadd(r,we.ri),we.ri.vsub(d.position,we.ri),_.release(Re),_.release(Pe),this.result.push(we),this.createFrictionEquationsFromContact(we,this.frictionResult);for(let $e=0,xt=dt.length;$e!==xt;$e++)_.release(dt[$e]);return}for(let we=0;we!==Q.length;we++){const Re=_.get(),Pe=_.get();c.vmult(P[Q[(we+1)%Q.length]],Re),c.vmult(P[Q[(we+2)%Q.length]],Pe),s.vadd(Re,Re),s.vadd(Pe,Pe);const $e=ub;Pe.vsub(Re,$e);const xt=Qw;$e.unit(xt);const wt=_.get(),At=_.get();r.vsub(Re,At);const Ut=At.dot(xt);xt.scale(Ut,wt),wt.vadd(Re,wt);const pt=_.get();if(wt.vsub(r,pt),Ut>0&&Ut*Ut<$e.lengthSquared()&&pt.lengthSquared()<R*R){if(b)return!0;const gt=this.createContactEquation(d,p,e,t,g,v);wt.vsub(s,gt.rj),wt.vsub(r,gt.ni),gt.ni.normalize(),gt.ni.scale(R,gt.ri),gt.rj.vadd(s,gt.rj),gt.rj.vsub(p.position,gt.rj),gt.ri.vadd(r,gt.ri),gt.ri.vsub(d.position,gt.ri),this.result.push(gt),this.createFrictionEquationsFromContact(gt,this.frictionResult);for(let _n=0,Tn=dt.length;_n!==Tn;_n++)_.release(dt[_n]);return _.release(Re),_.release(Pe),_.release(wt),_.release(pt),void _.release(At)}_.release(Re),_.release(Pe),_.release(wt),_.release(pt),_.release(At)}for(let we=0,Re=dt.length;we!==Re;we++)_.release(dt[we])}}}planeConvex(e,t,r,s,a,c,d,p,g,v,b){const _=hb,M=em;M.set(0,0,1),a.vmult(M,M);let w=0;const P=nS;for(let R=0;R!==t.vertices.length;R++)if(_.copy(t.vertices[R]),c.vmult(_,_),s.vadd(_,_),_.vsub(r,P),M.dot(P)<=0){if(b)return!0;const V=this.createContactEquation(d,p,e,t,g,v),k=iS;M.scale(M.dot(P),k),_.vsub(k,k),k.vsub(r,V.ri),V.ni.copy(M),_.vsub(s,V.rj),V.ri.vadd(r,V.ri),V.ri.vsub(d.position,V.ri),V.rj.vadd(s,V.rj),V.rj.vsub(p.position,V.rj),this.result.push(V),w++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(V,this.frictionResult)}this.enableFrictionReduction&&w&&this.createFrictionFromAverage(w)}boxConvex(e,t,r,s,a,c,d,p,g,v,b){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,r,s,a,c,d,p,e,t,b)}sphereHeightfield(e,t,r,s,a,c,d,p,g,v,b){const _=t.data,M=e.radius,w=t.elementSize,P=vb,R=hS;Xi.pointToLocalFrame(s,c,r,R);let I=Math.floor((R.x-M)/w)-1,V=Math.ceil((R.x+M)/w)+1,k=Math.floor((R.y-M)/w)-1,j=Math.ceil((R.y+M)/w)+1;if(V<0||j<0||I>_.length||k>_[0].length)return;I<0&&(I=0),V<0&&(V=0),k<0&&(k=0),j<0&&(j=0),I>=_.length&&(I=_.length-1),V>=_.length&&(V=_.length-1),j>=_[0].length&&(j=_[0].length-1),k>=_[0].length&&(k=_[0].length-1);const Q=[];if(t.getRectMinMax(I,k,V,j,Q),R.z-M>Q[1]||R.z+M<Q[0])return;const _e=this.result;for(let q=I;q<V;q++)for(let ne=k;ne<j;ne++){const je=_e.length;let dt=!1;if(t.getConvexTrianglePillar(q,ne,!1),Xi.pointToWorldFrame(s,c,t.pillarOffset,P),r.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(dt=this.sphereConvex(e,t.pillarConvex,r,P,a,c,d,p,e,t,b)),b&&dt||(t.getConvexTrianglePillar(q,ne,!0),Xi.pointToWorldFrame(s,c,t.pillarOffset,P),r.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(dt=this.sphereConvex(e,t.pillarConvex,r,P,a,c,d,p,e,t,b)),b&&dt))return!0;if(_e.length-je>2)return}}boxHeightfield(e,t,r,s,a,c,d,p,g,v,b){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,r,s,a,c,d,p,e,t,b)}convexHeightfield(e,t,r,s,a,c,d,p,g,v,b){const _=t.data,M=t.elementSize,w=e.boundingSphereRadius,P=dS,R=gb,I=lf;Xi.pointToLocalFrame(s,c,r,I);let V=Math.floor((I.x-w)/M)-1,k=Math.ceil((I.x+w)/M)+1,j=Math.floor((I.y-w)/M)-1,Q=Math.ceil((I.y+w)/M)+1;if(k<0||Q<0||V>_.length||j>_[0].length)return;V<0&&(V=0),k<0&&(k=0),j<0&&(j=0),Q<0&&(Q=0),V>=_.length&&(V=_.length-1),k>=_.length&&(k=_.length-1),Q>=_[0].length&&(Q=_[0].length-1),j>=_[0].length&&(j=_[0].length-1);const se=[];if(t.getRectMinMax(V,j,k,Q,se),!(I.z-w>se[1]||I.z+w<se[0]))for(let q=V;q<k;q++)for(let ne=j;ne<Q;ne++){let je=!1;if(t.getConvexTrianglePillar(q,ne,!1),Xi.pointToWorldFrame(s,c,t.pillarOffset,P),r.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(je=this.convexConvex(e,t.pillarConvex,r,P,a,c,d,p,null,null,b,R,null)),b&&je||(t.getConvexTrianglePillar(q,ne,!0),Xi.pointToWorldFrame(s,c,t.pillarOffset,P),r.distanceTo(P)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(je=this.convexConvex(e,t.pillarConvex,r,P,a,c,d,p,null,null,b,R,null)),b&&je))return!0}}sphereParticle(e,t,r,s,a,c,d,p,g,v,b){const _=aS;if(_.set(0,0,1),s.vsub(r,_),_.lengthSquared()<=e.radius*e.radius){if(b)return!0;const w=this.createContactEquation(p,d,t,e,g,v);_.normalize(),w.rj.copy(_),w.rj.scale(e.radius,w.rj),w.ni.copy(_),w.ni.negate(w.ni),w.ri.set(0,0,0),this.result.push(w),this.createFrictionEquationsFromContact(w,this.frictionResult)}}planeParticle(e,t,r,s,a,c,d,p,g,v,b){const _=rS;_.set(0,0,1),d.quaternion.vmult(_,_);const M=sS;if(s.vsub(d.position,M),_.dot(M)<=0){if(b)return!0;const P=this.createContactEquation(p,d,t,e,g,v);P.ni.copy(_),P.ni.negate(P.ni),P.ri.set(0,0,0);const R=oS;_.scale(_.dot(s),R),s.vsub(R,R),P.rj.copy(R),this.result.push(P),this.createFrictionEquationsFromContact(P,this.frictionResult)}}boxParticle(e,t,r,s,a,c,d,p,g,v,b){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,r,s,a,c,d,p,e,t,b)}convexParticle(e,t,r,s,a,c,d,p,g,v,b){let _=-1;const M=pb,w=uS;let P=null;const R=cS;if(R.copy(s),R.vsub(r,R),a.conjugate(lS),lS.vmult(R,R),e.pointIsInside(R)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(r,a),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(a);for(let I=0,V=e.faces.length;I!==V;I++){const j=e.worldFaceNormals[I];s.vsub(e.worldVertices[e.faces[I][0]],mb);const Q=-j.dot(mb);if(null===P||Math.abs(Q)<Math.abs(P)){if(b)return!0;P=Q,_=I,M.copy(j)}}if(-1!==_){const I=this.createContactEquation(p,d,t,e,g,v);M.scale(P,w),w.vadd(s,w),w.vsub(r,w),I.rj.copy(w),M.negate(I.ni),I.ri.set(0,0,0);const V=I.ri,k=I.rj;V.vadd(s,V),V.vsub(p.position,V),k.vadd(r,k),k.vsub(d.position,k),this.result.push(I),this.createFrictionEquationsFromContact(I,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,t,r,s,a,c,d,p,g,v,b){return this.convexHeightfield(t,e,s,r,c,a,p,d,g,v,b)}particleCylinder(e,t,r,s,a,c,d,p,g,v,b){return this.convexParticle(t,e,s,r,c,a,p,d,g,v,b)}sphereTrimesh(e,t,r,s,a,c,d,p,g,v,b){const _=ra,M=Q_,w=eb,P=$w,R=tb,I=nb,V=Ww,k=Jp,j=Hw,Q=jw;Xi.pointToLocalFrame(s,c,r,R);const se=e.radius;V.lowerBound.set(R.x-se,R.y-se,R.z-se),V.upperBound.set(R.x+se,R.y+se,R.z+se),t.getTrianglesInAABB(V,Q);const oe=Kp,_e=e.radius*e.radius;for(let we=0;we<Q.length;we++)for(let Re=0;Re<3;Re++)if(t.getVertex(t.indices[3*Q[we]+Re],oe),oe.vsub(R,j),j.lengthSquared()<=_e){if(k.copy(oe),Xi.pointToWorldFrame(s,c,k,oe),oe.vsub(r,j),b)return!0;let Pe=this.createContactEquation(d,p,e,t,g,v);Pe.ni.copy(j),Pe.ni.normalize(),Pe.ri.copy(Pe.ni),Pe.ri.scale(e.radius,Pe.ri),Pe.ri.vadd(r,Pe.ri),Pe.ri.vsub(d.position,Pe.ri),Pe.rj.copy(oe),Pe.rj.vsub(p.position,Pe.rj),this.result.push(Pe),this.createFrictionEquationsFromContact(Pe,this.frictionResult)}for(let we=0;we<Q.length;we++)for(let Re=0;Re<3;Re++){t.getVertex(t.indices[3*Q[we]+Re],_),t.getVertex(t.indices[3*Q[we]+(Re+1)%3],M),M.vsub(_,w),R.vsub(M,I);const Pe=I.dot(w);R.vsub(_,I);let $e=I.dot(w);if($e>0&&Pe<0&&(R.vsub(_,I),P.copy(w),P.normalize(),$e=I.dot(P),P.scale($e,I),I.vadd(_,I),I.distanceTo(R)<e.radius)){if(b)return!0;const wt=this.createContactEquation(d,p,e,t,g,v);I.vsub(R,wt.ni),wt.ni.normalize(),wt.ni.scale(e.radius,wt.ri),wt.ri.vadd(r,wt.ri),wt.ri.vsub(d.position,wt.ri),Xi.pointToWorldFrame(s,c,I,I),I.vsub(p.position,wt.rj),Xi.vectorToWorldFrame(c,wt.ni,wt.ni),Xi.vectorToWorldFrame(c,wt.ri,wt.ri),this.result.push(wt),this.createFrictionEquationsFromContact(wt,this.frictionResult)}}const q=ib,ne=rb,je=Gw,dt=Ud;for(let we=0,Re=Q.length;we!==Re;we++){t.getTriangleVertices(Q[we],q,ne,je),t.getNormal(Q[we],dt),R.vsub(q,I);let Pe=I.dot(dt);if(dt.scale(Pe,I),R.vsub(I,I),Pe=I.distanceTo(R),Us.pointInTriangle(I,q,ne,je)&&Pe<e.radius){if(b)return!0;let $e=this.createContactEquation(d,p,e,t,g,v);I.vsub(R,$e.ni),$e.ni.normalize(),$e.ni.scale(e.radius,$e.ri),$e.ri.vadd(r,$e.ri),$e.ri.vsub(d.position,$e.ri),Xi.pointToWorldFrame(s,c,I,I),I.vsub(p.position,$e.rj),Xi.vectorToWorldFrame(c,$e.ni,$e.ni),Xi.vectorToWorldFrame(c,$e.ri,$e.ri),this.result.push($e),this.createFrictionEquationsFromContact($e,this.frictionResult)}}Q.length=0}planeTrimesh(e,t,r,s,a,c,d,p,g,v,b){const _=new X,M=Uw;M.set(0,0,1),a.vmult(M,M);for(let w=0;w<t.vertices.length/3;w++){t.getVertex(w,_);const P=new X;P.copy(_),Xi.pointToWorldFrame(s,c,P,_);const R=Vw;if(_.vsub(r,R),M.dot(R)<=0){if(b)return!0;const V=this.createContactEquation(d,p,e,t,g,v);V.ni.copy(M);const k=zw;M.scale(R.dot(M),k),_.vsub(k,k),V.ri.copy(k),V.ri.vsub(d.position,V.ri),V.rj.copy(_),V.rj.vsub(p.position,V.rj),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}}}}const Bd=new X,fc=new X,tf=new X,K_=new X,J_=new X,hA=new as,kd=new as,Uw=new X,Vw=new X,zw=new X,Ud=new X,Hw=new X;new X;const Kp=new X,Jp=new X,ra=new X,Q_=new X,eb=new X,$w=new X,tb=new X,nb=new X,ib=new X,rb=new X,Gw=new X,Ww=new os,jw=[],pc=new X,sb=new X,Yw=new X,qw=new X,Qp=new X;function ob(h,e,t){let r=null;const s=h.length;for(let a=0;a!==s;a++){const c=h[a],d=Yw;h[(a+1)%s].vsub(c,d);const p=qw;d.cross(e,p);const g=Qp;t.vsub(c,g);const v=p.dot(g);if(!(null===r||v>0&&!0===r||v<=0&&!1===r))return!1;null===r&&(r=v>0)}return!0}const nf=new X,ab=new X,Xw=new X,rf=new X,sf=[new X,new X,new X,new X,new X,new X],Zw=new X,Kw=new X,Jw=new X,lb=new X,cb=new X,ub=new X,Qw=new X,db=new X,eS=new X,tS=new X,fA=new X,pA=new X,mA=new X,gA=new X;new X,new X;const hb=new X,em=new X,nS=new X,iS=new X,fb=new X,af=new X,rS=new X,sS=new X,oS=new X,aS=new X,lS=new as,cS=new X;new X;const pb=new X,mb=new X,uS=new X,lf=new X,dS=new X,gb=[0],hS=new X,vb=new X;class yb{constructor(){this.current=[],this.previous=[]}getKey(e,t){if(t<e){const r=t;t=e,e=r}return e<<16|t}set(e,t){const r=this.getKey(e,t),s=this.current;let a=0;for(;r>s[a];)a++;if(r!==s[a]){for(let c=s.length-1;c>=a;c--)s[c+1]=s[c];s[a]=r}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,t){const r=this.current,s=this.previous,a=r.length,c=s.length;let d=0;for(let p=0;p<a;p++){let g=!1;const v=r[p];for(;v>s[d];)d++;g=v===s[d],g||wv(e,v)}d=0;for(let p=0;p<c;p++){let g=!1;const v=s[p];for(;v>r[d];)d++;g=r[d]===v,g||wv(t,v)}}}function wv(h,e){h.push((4294901760&e)>>16,65535&e)}const Sv=(h,e)=>h<e?`${h}-${e}`:`${e}-${h}`;class Cv{constructor(){this.data={keys:[]}}get(e,t){const r=Sv(e,t);return this.data[r]}set(e,t,r){const s=Sv(e,t);this.get(e,t)||this.data.keys.push(s),this.data[s]=r}delete(e,t){const r=Sv(e,t),s=this.data.keys.indexOf(r);-1!==s&&this.data.keys.splice(s,1),delete this.data[r]}reset(){const e=this.data,t=e.keys;for(;t.length>0;)delete e[t.pop()]}}class fS extends Zg{constructor(e){void 0===e&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==e.quatNormalizeSkip?e.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==e.quatNormalizeFast&&e.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new X,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new X,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=void 0!==e.broadphase?e.broadphase:new rA,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==e.solver?e.solver:new bv,this.constraints=[],this.narrowphase=new Fd(this),this.collisionMatrix=new Tp,this.collisionMatrixPrevious=new Tp,this.bodyOverlapKeeper=new yb,this.shapeOverlapKeeper=new yb,this.contactmaterials=[],this.contactMaterialTable=new Cv,this.defaultMaterial=new uw("default"),this.defaultContactMaterial=new lv(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,t){return this.contactMaterialTable.get(e.id,t.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)}rayTest(e,t,r){r instanceof Wh?this.raycastClosest(e,t,{skipBackfaces:!0},r):this.raycastAll(e,t,{skipBackfaces:!0},r)}raycastAll(e,t,r,s){return void 0===r&&(r={}),r.mode=Us.ALL,r.from=e,r.to=t,r.callback=s,tm.intersectWorld(this,r)}raycastAny(e,t,r,s){return void 0===r&&(r={}),r.mode=Us.ANY,r.from=e,r.to=t,r.result=s,tm.intersectWorld(this,r)}raycastClosest(e,t,r,s){return void 0===r&&(r={}),r.mode=Us.CLOSEST,r.from=e,r.to=t,r.result=s,tm.intersectWorld(this,r)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof ii&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const t=this.bodies.length-1,r=this.bodies,s=r.indexOf(e);if(-1!==s){r.splice(s,1);for(let a=0;a!==r.length;a++)r[a].index=a;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const t=this.bodies;for(let r=0;r<t.length;r++){const s=t[r].shapes;for(let a=0;a<s.length;a++){const c=s[a];if(c.id===e)return c}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const t=this.contactmaterials.indexOf(e);-1!==t&&(this.contactmaterials.splice(t,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,t){void 0===e&&(e=1/60),void 0===t&&(t=10);const r=Ks.now()/1e3;this.step(e,this.lastCallTime?r-this.lastCallTime:void 0,t),this.lastCallTime=r}step(e,t,r){if(void 0===r&&(r=10),void 0===t)this.internalStep(e),this.time+=e;else{this.accumulator+=t;const s=Ks.now();let a=0;for(;this.accumulator>=e&&a<r&&(this.internalStep(e),this.accumulator-=e,a++,!(Ks.now()-s>1e3*e)););this.accumulator=this.accumulator%e;const c=this.accumulator/e;for(let d=0;d!==this.bodies.length;d++){const p=this.bodies[d];p.previousPosition.lerp(p.position,c,p.interpolatedPosition),p.previousQuaternion.slerp(p.quaternion,c,p.interpolatedQuaternion),p.previousQuaternion.normalize()}this.time+=t}}internalStep(e){this.dt=e;const t=this.contacts,r=_b,s=vS,a=this.bodies.length,c=this.bodies,d=this.solver,p=this.gravity,g=this.doProfiling,v=this.profile,b=ii.DYNAMIC;let _=-1/0;const M=this.constraints,w=gS;p.length();const P=p.x,R=p.y,I=p.z;let V=0;for(g&&(_=Ks.now()),V=0;V!==a;V++){const we=c[V];if(we.type===b){const Re=we.force,Pe=we.mass;Re.x+=Pe*P,Re.y+=Pe*R,Re.z+=Pe*I}}for(let we=0,Re=this.subsystems.length;we!==Re;we++)this.subsystems[we].update();g&&(_=Ks.now()),r.length=0,s.length=0,this.broadphase.collisionPairs(this,r,s),g&&(v.broadphase=Ks.now()-_);let k=M.length;for(V=0;V!==k;V++){const we=M[V];if(!we.collideConnected)for(let Re=r.length-1;Re>=0;Re-=1)(we.bodyA===r[Re]&&we.bodyB===s[Re]||we.bodyB===r[Re]&&we.bodyA===s[Re])&&(r.splice(Re,1),s.splice(Re,1))}this.collisionMatrixTick(),g&&(_=Ks.now());const j=Av,Q=t.length;for(V=0;V!==Q;V++)j.push(t[V]);t.length=0;const se=this.frictionEquations.length;for(V=0;V!==se;V++)w.push(this.frictionEquations[V]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(r,s,this,t,j,this.frictionEquations,w),g&&(v.narrowphase=Ks.now()-_),g&&(_=Ks.now()),V=0;V<this.frictionEquations.length;V++)d.addEquation(this.frictionEquations[V]);const oe=t.length;for(let we=0;we!==oe;we++){const Re=t[we],Pe=Re.bi,$e=Re.bj,xt=Re.si,wt=Re.sj;let At;At=Pe.material&&$e.material&&this.getContactMaterial(Pe.material,$e.material)||this.defaultContactMaterial,Pe.material&&$e.material&&Pe.material.restitution>=0&&$e.material.restitution>=0&&(Re.restitution=Pe.material.restitution*$e.material.restitution),d.addEquation(Re),Pe.allowSleep&&Pe.type===ii.DYNAMIC&&Pe.sleepState===ii.SLEEPING&&$e.sleepState===ii.AWAKE&&$e.type!==ii.STATIC&&$e.velocity.lengthSquared()+$e.angularVelocity.lengthSquared()>=2*$e.sleepSpeedLimit**2&&(Pe.wakeUpAfterNarrowphase=!0),$e.allowSleep&&$e.type===ii.DYNAMIC&&$e.sleepState===ii.SLEEPING&&Pe.sleepState===ii.AWAKE&&Pe.type!==ii.STATIC&&Pe.velocity.lengthSquared()+Pe.angularVelocity.lengthSquared()>=2*Pe.sleepSpeedLimit**2&&($e.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Pe,$e,!0),this.collisionMatrixPrevious.get(Pe,$e)||(cf.body=$e,cf.contact=Re,Pe.dispatchEvent(cf),cf.body=Pe,$e.dispatchEvent(cf)),this.bodyOverlapKeeper.set(Pe.id,$e.id),this.shapeOverlapKeeper.set(xt.id,wt.id)}for(this.emitContactEvents(),g&&(v.makeContactConstraints=Ks.now()-_,_=Ks.now()),V=0;V!==a;V++){const we=c[V];we.wakeUpAfterNarrowphase&&(we.wakeUp(),we.wakeUpAfterNarrowphase=!1)}for(k=M.length,V=0;V!==k;V++){const we=M[V];we.update();for(let Re=0,Pe=we.equations.length;Re!==Pe;Re++)d.addEquation(we.equations[Re])}d.solve(e,this),g&&(v.solve=Ks.now()-_),d.removeAllEquations();const _e=Math.pow;for(V=0;V!==a;V++){const we=c[V];if(we.type&b){const Re=_e(1-we.linearDamping,e),Pe=we.velocity;Pe.scale(Re,Pe);const $e=we.angularVelocity;if($e){const xt=_e(1-we.angularDamping,e);$e.scale(xt,$e)}}}this.dispatchEvent(mS),g&&(_=Ks.now());const ne=this.stepnumber%(this.quatNormalizeSkip+1)==0,je=this.quatNormalizeFast;for(V=0;V!==a;V++)c[V].integrate(e,ne,je);this.clearForces(),this.broadphase.dirty=!0,g&&(v.integrate=Ks.now()-_),this.stepnumber+=1,this.dispatchEvent(pS);let dt=!0;if(this.allowSleep)for(dt=!1,V=0;V!==a;V++){const we=c[V];we.sleepTick(this.time),we.sleepState!==ii.SLEEPING&&(dt=!0)}this.hasActiveBodies=dt}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(Nl,Fl),e){for(let a=0,c=Nl.length;a<c;a+=2)uf.bodyA=this.getBodyById(Nl[a]),uf.bodyB=this.getBodyById(Nl[a+1]),this.dispatchEvent(uf);uf.bodyA=uf.bodyB=null}if(t){for(let a=0,c=Fl.length;a<c;a+=2)df.bodyA=this.getBodyById(Fl[a]),df.bodyB=this.getBodyById(Fl[a+1]),this.dispatchEvent(df);df.bodyA=df.bodyB=null}Nl.length=Fl.length=0;const r=this.hasAnyEventListener("beginShapeContact"),s=this.hasAnyEventListener("endShapeContact");if((r||s)&&this.shapeOverlapKeeper.getDiff(Nl,Fl),r){for(let a=0,c=Nl.length;a<c;a+=2){const d=this.getShapeById(Nl[a]),p=this.getShapeById(Nl[a+1]);Bl.shapeA=d,Bl.shapeB=p,d&&(Bl.bodyA=d.body),p&&(Bl.bodyB=p.body),this.dispatchEvent(Bl)}Bl.bodyA=Bl.bodyB=Bl.shapeA=Bl.shapeB=null}if(s){for(let a=0,c=Fl.length;a<c;a+=2){const d=this.getShapeById(Fl[a]),p=this.getShapeById(Fl[a+1]);kl.shapeA=d,kl.shapeB=p,d&&(kl.bodyA=d.body),p&&(kl.bodyB=p.body),this.dispatchEvent(kl)}kl.bodyA=kl.bodyB=kl.shapeA=kl.shapeB=null}}clearForces(){const e=this.bodies,t=e.length;for(let r=0;r!==t;r++){const s=e[r];s.force.set(0,0,0),s.torque.set(0,0,0)}}}new os;const tm=new Us,Ks=globalThis.performance||{};if(!Ks.now){let h=Date.now();Ks.timing&&Ks.timing.navigationStart&&(h=Ks.timing.navigationStart),Ks.now=()=>Date.now()-h}new X;const pS={type:"postStep"},mS={type:"preStep"},cf={type:ii.COLLIDE_EVENT_NAME,body:null,contact:null},Av=[],gS=[],_b=[],vS=[],Nl=[],Fl=[],uf={type:"beginContact",bodyA:null,bodyB:null},df={type:"endContact",bodyA:null,bodyB:null},Bl={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},kl={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};function yS(h,e,t){let{color:r=65280,scale:s=1,onInit:a,onUpdate:c}=void 0===t?{}:t;const d=[],p=new Sl({color:null!=r?r:65280,wireframe:!0}),g=new X,v=new X,b=new X,_=new as,M=new gd(1),w=new To(1,1,1),P=new Tc(10,10,10,10);function se(_e,q){let ne=d[_e],je=!1;return function Q(_e,q){if(!_e)return!1;const{geometry:ne}=_e;return ne instanceof gd&&q.type===Nn.types.SPHERE||ne instanceof To&&q.type===Nn.types.BOX||ne instanceof Tc&&q.type===Nn.types.PLANE||ne.id===q.geometryId&&q.type===Nn.types.CYLINDER||ne.id===q.geometryId&&q.type===Nn.types.CONVEXPOLYHEDRON||ne.id===q.geometryId&&q.type===Nn.types.TRIMESH||ne.id===q.geometryId&&q.type===Nn.types.HEIGHTFIELD}(ne,q)||(ne&&h.remove(ne),d[_e]=ne=function k(_e){let q=new ms;const{SPHERE:ne,BOX:je,PLANE:dt,CYLINDER:we,CONVEXPOLYHEDRON:Re,TRIMESH:Pe,HEIGHTFIELD:$e}=Nn.types;switch(_e.type){case ne:q=new ms(M,p);break;case je:q=new ms(w,p);break;case dt:q=new ms(P,p);break;case we:{const xt=new ud(_e.radiusTop,_e.radiusBottom,_e.height,_e.numSegments);q=new ms(xt,p),_e.geometryId=xt.id;break}case Re:{const xt=function R(_e){const q=new Qi,ne=[];for(let dt=0;dt<_e.vertices.length;dt++){const we=_e.vertices[dt];ne.push(we.x,we.y,we.z)}q.setAttribute("position",new Bn(ne,3));const je=[];for(let dt=0;dt<_e.faces.length;dt++){const we=_e.faces[dt],Re=we[0];for(let Pe=1;Pe<we.length-1;Pe++)je.push(Re,we[Pe],we[Pe+1])}return q.setIndex(je),q.computeBoundingSphere(),q.computeVertexNormals(),q}(_e);q=new ms(xt,p),_e.geometryId=xt.id;break}case Pe:{const xt=function I(_e){const q=new Qi,ne=[],je=g,dt=v,we=b;for(let Re=0;Re<_e.indices.length/3;Re++)_e.getTriangleVertices(Re,je,dt,we),ne.push(je.x,je.y,je.z),ne.push(dt.x,dt.y,dt.z),ne.push(we.x,we.y,we.z);return q.setAttribute("position",new Bn(ne,3)),q.computeBoundingSphere(),q.computeVertexNormals(),q}(_e);q=new ms(xt,p),_e.geometryId=xt.id;break}case $e:{const xt=function V(_e){const q=new Qi,ne=_e.elementSize||1,je=_e.data.flatMap((we,Re)=>we.flatMap((Pe,$e)=>[Re*ne,$e*ne,Pe])),dt=[];for(let we=0;we<_e.data.length-1;we++)for(let Re=0;Re<_e.data[we].length-1;Re++){const Pe=_e.data[we].length,$e=we*Pe+Re;dt.push($e+1,$e+Pe,$e+Pe+1),dt.push($e+Pe,$e+1,$e)}return q.setIndex(dt),q.setAttribute("position",new Bn(je,3)),q.computeBoundingSphere(),q.computeVertexNormals(),q}(_e);q=new ms(xt,p),_e.geometryId=xt.id;break}}return h.add(q),q}(q),je=!0),function j(_e,q){const{SPHERE:ne,BOX:je,PLANE:dt,CYLINDER:we,CONVEXPOLYHEDRON:Re,TRIMESH:Pe,HEIGHTFIELD:$e}=Nn.types;switch(q.type){case ne:{const{radius:xt}=q;_e.scale.set(xt*s,xt*s,xt*s);break}case je:_e.scale.copy(q.halfExtents),_e.scale.multiplyScalar(2*s);break;case dt:break;case we:case Re:_e.scale.set(1*s,1*s,1*s);break;case Pe:_e.scale.copy(q.scale).multiplyScalar(s);break;case $e:_e.scale.set(1*s,1*s,1*s)}}(ne,q),je}return P.translate(0,0,1e-4),{update:function oe(){const _e=d,q=g,ne=_;let je=0;for(const dt of e.bodies)for(let we=0;we!==dt.shapes.length;we++){const Re=dt.shapes[we],Pe=se(je,Re),$e=_e[je];$e&&(dt.quaternion.vmult(dt.shapeOffsets[we],q),dt.position.vadd(q,q),dt.quaternion.mult(dt.shapeOrientations[we],ne),$e.position.copy(q),$e.quaternion.copy(ne),Pe&&a instanceof Function&&a(dt,$e,Re),!Pe&&c instanceof Function&&c(dt,$e,Re)),je++}for(let dt=je;dt<_e.length;dt++){const we=_e[dt];we&&h.remove(we)}_e.length=je}}}const Tv={type:"change"},nm={type:"start"},bb={type:"end"},im=new El,Dv=new ha,_S=Math.cos(70*ko_DEG2RAD);class bS extends vr{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new de,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Ge){Ge.addEventListener("keydown",he),this._domElementKeyEvents=Ge},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",he),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(Tv),r.update(),a=s.NONE},this.update=function(){const Ge=new de,dn=(new ln).setFromUnitVectors(e.up,new de(0,1,0)),Zn=dn.clone().invert(),Hn=new de,Wn=new ln,ji=new de,_r=2*Math.PI;return function(jn=null){const Ht=r.object.position;Ge.copy(Ht).sub(r.target),Ge.applyQuaternion(dn),d.setFromVector3(Ge),r.autoRotate&&a===s.NONE&&je(function q(Ge){return null!==Ge?2*Math.PI/60*r.autoRotateSpeed*Ge:2*Math.PI/60/60*r.autoRotateSpeed}(jn)),r.enableDamping?(d.theta+=p.theta*r.dampingFactor,d.phi+=p.phi*r.dampingFactor):(d.theta+=p.theta,d.phi+=p.phi);let xn=r.minAzimuthAngle,Un=r.maxAzimuthAngle;isFinite(xn)&&isFinite(Un)&&(xn<-Math.PI?xn+=_r:xn>Math.PI&&(xn-=_r),Un<-Math.PI?Un+=_r:Un>Math.PI&&(Un-=_r),d.theta=xn<=Un?Math.max(xn,Math.min(Un,d.theta)):d.theta>(xn+Un)/2?Math.max(xn,d.theta):Math.min(Un,d.theta)),d.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,d.phi)),d.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(v,r.dampingFactor):r.target.add(v),d.radius=At(r.zoomToCursor&&se||r.object.isOrthographicCamera?d.radius:d.radius*g),Ge.setFromSpherical(d),Ge.applyQuaternion(Zn),Ht.copy(r.target).add(Ge),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,v.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),v.set(0,0,0));let br=!1;if(r.zoomToCursor&&se){let Hr=null;if(r.object.isPerspectiveCamera){const Qr=Ge.length();Hr=At(Qr*g),r.object.position.addScaledVector(j,Qr-Hr),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Qr=new de(Q.x,Q.y,0);Qr.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/g)),r.object.updateProjectionMatrix(),br=!0;const sa=new de(Q.x,Q.y,0);sa.unproject(r.object),r.object.position.sub(sa).add(Qr),r.object.updateMatrixWorld(),Hr=Ge.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==Hr&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Hr).add(r.object.position):(im.origin.copy(r.object.position),im.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(im.direction))<_S?e.lookAt(r.target):(Dv.setFromNormalAndCoplanarPoint(r.object.up,r.target),im.intersectPlane(Dv,r.target))))}else r.object.isOrthographicCamera&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/g)),r.object.updateProjectionMatrix(),br=!0);return g=1,se=!1,!!(br||Hn.distanceToSquared(r.object.position)>c||8*(1-Wn.dot(r.object.quaternion))>c||ji.distanceToSquared(r.target)>0)&&(r.dispatchEvent(Tv),Hn.copy(r.object.position),Wn.copy(r.object.quaternion),ji.copy(r.target),br=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",pn),r.domElement.removeEventListener("pointerdown",ni),r.domElement.removeEventListener("pointercancel",Di),r.domElement.removeEventListener("wheel",Ce),r.domElement.removeEventListener("pointermove",si),r.domElement.removeEventListener("pointerup",Di),null!==r._domElementKeyEvents&&(r._domElementKeyEvents.removeEventListener("keydown",he),r._domElementKeyEvents=null)};const r=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=s.NONE;const c=1e-6,d=new ru,p=new ru;let g=1;const v=new de,b=new en,_=new en,M=new en,w=new en,P=new en,R=new en,I=new en,V=new en,k=new en,j=new de,Q=new en;let se=!1;const oe=[],_e={};function ne(){return Math.pow(.95,r.zoomSpeed)}function je(Ge){p.theta-=Ge}function dt(Ge){p.phi-=Ge}const we=function(){const Ge=new de;return function(Zn,Hn){Ge.setFromMatrixColumn(Hn,0),Ge.multiplyScalar(-Zn),v.add(Ge)}}(),Re=function(){const Ge=new de;return function(Zn,Hn){!0===r.screenSpacePanning?Ge.setFromMatrixColumn(Hn,1):(Ge.setFromMatrixColumn(Hn,0),Ge.crossVectors(r.object.up,Ge)),Ge.multiplyScalar(Zn),v.add(Ge)}}(),Pe=function(){const Ge=new de;return function(Zn,Hn){const Wn=r.domElement;if(r.object.isPerspectiveCamera){Ge.copy(r.object.position).sub(r.target);let _r=Ge.length();_r*=Math.tan(r.object.fov/2*Math.PI/180),we(2*Zn*_r/Wn.clientHeight,r.object.matrix),Re(2*Hn*_r/Wn.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(we(Zn*(r.object.right-r.object.left)/r.object.zoom/Wn.clientWidth,r.object.matrix),Re(Hn*(r.object.top-r.object.bottom)/r.object.zoom/Wn.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function $e(Ge){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?g/=Ge:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function xt(Ge){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?g*=Ge:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function wt(Ge){if(!r.zoomToCursor)return;se=!0;const dn=r.domElement.getBoundingClientRect(),Hn=Ge.clientY-dn.top,ji=dn.height;Q.x=(Ge.clientX-dn.left)/dn.width*2-1,Q.y=-Hn/ji*2+1,j.set(Q.x,Q.y,1).unproject(r.object).sub(r.object.position).normalize()}function At(Ge){return Math.max(r.minDistance,Math.min(r.maxDistance,Ge))}function Ut(Ge){b.set(Ge.clientX,Ge.clientY)}function gt(Ge){w.set(Ge.clientX,Ge.clientY)}function ri(){1===oe.length?b.set(oe[0].pageX,oe[0].pageY):b.set(.5*(oe[0].pageX+oe[1].pageX),.5*(oe[0].pageY+oe[1].pageY))}function Gi(){1===oe.length?w.set(oe[0].pageX,oe[0].pageY):w.set(.5*(oe[0].pageX+oe[1].pageX),.5*(oe[0].pageY+oe[1].pageY))}function hr(){const Ge=oe[0].pageX-oe[1].pageX,dn=oe[0].pageY-oe[1].pageY,Zn=Math.sqrt(Ge*Ge+dn*dn);I.set(0,Zn)}function Sn(Ge){if(1==oe.length)_.set(Ge.pageX,Ge.pageY);else{const Zn=Vt(Ge);_.set(.5*(Ge.pageX+Zn.x),.5*(Ge.pageY+Zn.y))}M.subVectors(_,b).multiplyScalar(r.rotateSpeed);const dn=r.domElement;je(2*Math.PI*M.x/dn.clientHeight),dt(2*Math.PI*M.y/dn.clientHeight),b.copy(_)}function tn(Ge){if(1===oe.length)P.set(Ge.pageX,Ge.pageY);else{const dn=Vt(Ge);P.set(.5*(Ge.pageX+dn.x),.5*(Ge.pageY+dn.y))}R.subVectors(P,w).multiplyScalar(r.panSpeed),Pe(R.x,R.y),w.copy(P)}function bn(Ge){const dn=Vt(Ge),Zn=Ge.pageX-dn.x,Hn=Ge.pageY-dn.y,Wn=Math.sqrt(Zn*Zn+Hn*Hn);V.set(0,Wn),k.set(0,Math.pow(V.y/I.y,r.zoomSpeed)),$e(k.y),I.copy(V)}function ni(Ge){!1!==r.enabled&&(0===oe.length&&(r.domElement.setPointerCapture(Ge.pointerId),r.domElement.addEventListener("pointermove",si),r.domElement.addEventListener("pointerup",Di)),function An(Ge){oe.push(Ge)}(Ge),"touch"===Ge.pointerType?function Ft(Ge){switch(In(Ge),oe.length){case 1:switch(r.touches.ONE){case 0:if(!1===r.enableRotate)return;ri(),a=s.TOUCH_ROTATE;break;case 1:if(!1===r.enablePan)return;Gi(),a=s.TOUCH_PAN;break;default:a=s.NONE}break;case 2:switch(r.touches.TWO){case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;(function pi(){r.enableZoom&&hr(),r.enablePan&&Gi()})(),a=s.TOUCH_DOLLY_PAN;break;case 3:if(!1===r.enableZoom&&!1===r.enableRotate)return;(function Ve(){r.enableZoom&&hr(),r.enableRotate&&ri()})(),a=s.TOUCH_DOLLY_ROTATE;break;default:a=s.NONE}break;default:a=s.NONE}a!==s.NONE&&r.dispatchEvent(nm)}(Ge):function yr(Ge){let dn;switch(Ge.button){case 0:dn=r.mouseButtons.LEFT;break;case 1:dn=r.mouseButtons.MIDDLE;break;case 2:dn=r.mouseButtons.RIGHT;break;default:dn=-1}switch(dn){case 1:if(!1===r.enableZoom)return;(function pt(Ge){wt(Ge),I.set(Ge.clientX,Ge.clientY)})(Ge),a=s.DOLLY;break;case 0:if(Ge.ctrlKey||Ge.metaKey||Ge.shiftKey){if(!1===r.enablePan)return;gt(Ge),a=s.PAN}else{if(!1===r.enableRotate)return;Ut(Ge),a=s.ROTATE}break;case 2:if(Ge.ctrlKey||Ge.metaKey||Ge.shiftKey){if(!1===r.enableRotate)return;Ut(Ge),a=s.ROTATE}else{if(!1===r.enablePan)return;gt(Ge),a=s.PAN}break;default:a=s.NONE}a!==s.NONE&&r.dispatchEvent(nm)}(Ge))}function si(Ge){!1!==r.enabled&&("touch"===Ge.pointerType?function Dn(Ge){switch(In(Ge),a){case s.TOUCH_ROTATE:if(!1===r.enableRotate)return;Sn(Ge),r.update();break;case s.TOUCH_PAN:if(!1===r.enablePan)return;tn(Ge),r.update();break;case s.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;(function fn(Ge){r.enableZoom&&bn(Ge),r.enablePan&&tn(Ge)})(Ge),r.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;(function vi(Ge){r.enableZoom&&bn(Ge),r.enableRotate&&Sn(Ge)})(Ge),r.update();break;default:a=s.NONE}}(Ge):function cs(Ge){switch(a){case s.ROTATE:if(!1===r.enableRotate)return;!function _n(Ge){_.set(Ge.clientX,Ge.clientY),M.subVectors(_,b).multiplyScalar(r.rotateSpeed);const dn=r.domElement;je(2*Math.PI*M.x/dn.clientHeight),dt(2*Math.PI*M.y/dn.clientHeight),b.copy(_),r.update()}(Ge);break;case s.DOLLY:if(!1===r.enableZoom)return;!function Tn(Ge){V.set(Ge.clientX,Ge.clientY),k.subVectors(V,I),k.y>0?$e(ne()):k.y<0&&xt(ne()),I.copy(V),r.update()}(Ge);break;case s.PAN:if(!1===r.enablePan)return;!function Fn(Ge){P.set(Ge.clientX,Ge.clientY),R.subVectors(P,w).multiplyScalar(r.panSpeed),Pe(R.x,R.y),w.copy(P),r.update()}(Ge)}}(Ge))}function Di(Ge){(function yi(Ge){delete _e[Ge.pointerId];for(let dn=0;dn<oe.length;dn++)if(oe[dn].pointerId==Ge.pointerId)return void oe.splice(dn,1)})(Ge),0===oe.length&&(r.domElement.releasePointerCapture(Ge.pointerId),r.domElement.removeEventListener("pointermove",si),r.domElement.removeEventListener("pointerup",Di)),r.dispatchEvent(bb),a=s.NONE}function Ce(Ge){!1===r.enabled||!1===r.enableZoom||a!==s.NONE||(Ge.preventDefault(),r.dispatchEvent(nm),function Xn(Ge){wt(Ge),Ge.deltaY<0?xt(ne()):Ge.deltaY>0&&$e(ne()),r.update()}(Ge),r.dispatchEvent(bb))}function he(Ge){!1===r.enabled||!1===r.enablePan||function qn(Ge){let dn=!1;switch(Ge.code){case r.keys.UP:Ge.ctrlKey||Ge.metaKey||Ge.shiftKey?dt(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Pe(0,r.keyPanSpeed),dn=!0;break;case r.keys.BOTTOM:Ge.ctrlKey||Ge.metaKey||Ge.shiftKey?dt(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Pe(0,-r.keyPanSpeed),dn=!0;break;case r.keys.LEFT:Ge.ctrlKey||Ge.metaKey||Ge.shiftKey?je(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Pe(r.keyPanSpeed,0),dn=!0;break;case r.keys.RIGHT:Ge.ctrlKey||Ge.metaKey||Ge.shiftKey?je(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Pe(-r.keyPanSpeed,0),dn=!0}dn&&(Ge.preventDefault(),r.update())}(Ge)}function pn(Ge){!1!==r.enabled&&Ge.preventDefault()}function In(Ge){let dn=_e[Ge.pointerId];void 0===dn&&(dn=new en,_e[Ge.pointerId]=dn),dn.set(Ge.pageX,Ge.pageY)}function Vt(Ge){return _e[(Ge.pointerId===oe[0].pointerId?oe[1]:oe[0]).pointerId]}r.domElement.addEventListener("contextmenu",pn),r.domElement.addEventListener("pointerdown",ni),r.domElement.addEventListener("pointercancel",Di),r.domElement.addEventListener("wheel",Ce,{passive:!1}),this.update()}}const Iv=["threeCanvas"];let Rv=(()=>{var h;class e{constructor(){}ngAfterViewInit(){this.createScene(),this.createPhysicsWorld(),requestAnimationFrame(r=>this.render(r))}createScene(){this.scene=new o0,this.camera=new Eo(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new gE({canvas:this.canvasRef.nativeElement,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight);const r=new WE(16777215,1);r.position.set(1,1,1).normalize(),this.scene.add(r),new bS(this.camera,this.canvasRef.nativeElement);const a=new ks(16777215,.5);this.scene.add(a),(new Fg).load("assets/texture/HeightMap.jpg",g=>this.onTextureLoaded(g));const d=new gd(1),p=new W0({color:16711680});this.threeSphere=new ms(d,p),this.scene.add(this.threeSphere)}createPhysicsWorld(){this.physicsWorld=new fS({gravity:new X(0,-9.82,0)}),this.cannonSphere=new ii({mass:1,shape:new vv(1),position:new X(0,10,0)}),this.physicsWorld.addBody(this.cannonSphere),this.cannonDebugger=new yS(this.scene,this.physicsWorld)}render(r){this.renderer.render(this.scene,this.camera),this.animate(),requestAnimationFrame(s=>this.render(s))}generateTerrain(r){const s=[],a=[],c=[];let d=0;for(let b=0;b<r.height;b++)for(let _=0;_<r.width;_++){let M=0;M+=r.data[4*(b*r.height+_)]/128,M+=r.data[4*(b*r.height+_+1)]/128,M+=r.data[4*(b*r.height+_+2)]/128,isNaN(M)&&(M=0),d<M&&(d=M),a.push(_,M,b),c.push(_/(r.width-1),b/(r.height-1))}for(let b=0;b<r.height-1;b++)for(let _=0;_<r.width-1;_++){const w=_+1+b*r.width,P=_+(b+1)*r.width,R=_+1+(b+1)*r.width;s.push(_+b*r.width,w,P),s.push(w,R,P)}const p=new Qi;p.setIndex(s),p.setAttribute("position",new K(new Float32Array(a),3)),p.setAttribute("uv",new K(new Float32Array(c),2)),p.computeVertexNormals();const g=new j0({vertexColors:!1,wireframe:!1,flatShading:!1,normalMap:(new Fg).load("assets/texture/NormalMapSample.jpg"),map:(new Fg).load("assets/texture/Sample.jpg"),side:2});this.map=new ms(p,g),this.map.receiveShadow=!0;const v=[];for(let b=0;b<a.length;b+=3)v.push(new X(a[b],a[b+1],a[b+2]));this.terrainShape=new Ol({vertices:v,faces:this.chunkArray(s,3)}),this.cannonTerrain=new ii({mass:0,shape:this.terrainShape,position:new X(0,0,0)}),this.scene.add(this.map),this.physicsWorld.addBody(this.cannonTerrain)}onTextureLoaded(r){const s=document.createElement("canvas");s.width=r.image.width,s.height=r.image.height;const a=s.getContext("2d");a.drawImage(r.image,0,0);const c=a.getImageData(0,0,s.width,s.height);this.camera.position.x=c.width/2,this.camera.position.y=c.height/1.5,this.camera.position.z=c.width,this.camera.lookAt(c.width/2,0,c.width/2),this.generateTerrain(c)}chunkArray(r,s){const a=[];for(let c=0;c<r.length;c+=s)a.push(r.slice(c,c+s));return a}convertToThreeVector(r){return new de(r.x,r.y,r.z)}convertToThreeQuaternion(r){return new ln(r.x,r.y,r.z,r.w)}animate(){this.physicsWorld.step(1/60),this.cannonDebugger.update(),this.threeSphere.position.copy(this.convertToThreeVector(this.cannonSphere.position)),this.threeSphere.quaternion.copy(this.convertToThreeQuaternion(this.cannonSphere.quaternion))}}return(h=e).\u0275fac=function(r){return new(r||h)},h.\u0275cmp=ie.Xpm({type:h,selectors:[["app-main"]],viewQuery:function(r,s){if(1&r&&ie.Gf(Iv,5),2&r){let a;ie.iGM(a=ie.CRH())&&(s.canvasRef=a.first)}},decls:2,vars:0,consts:[["threeCanvas",""]],template:function(r,s){1&r&&ie._UZ(0,"canvas",null,0)}}),e})(),Pv=(()=>{var h;class e{constructor(){}}return(h=e).\u0275fac=function(r){return new(r||h)},h.\u0275cmp=ie.Xpm({type:h,selectors:[["app-root"]],decls:2,vars:0,template:function(r,s){1&r&&(ie.TgZ(0,"ion-app"),ie._UZ(1,"app-main"),ie.qZA())},dependencies:[ht.dr,Rv]}),e})();const xb=[{path:"home",loadChildren:()=>te.e(6260).then(te.bind(te,6260)).then(h=>h.HomePageModule)},{path:"",redirectTo:"home",pathMatch:"full"},{path:"main",component:Rv}];let xS=(()=>{var h;class e{}return(h=e).\u0275fac=function(r){return new(r||h)},h.\u0275mod=ie.oAB({type:h}),h.\u0275inj=ie.cJS({imports:[Ye.Bz.forRoot(xb,{preloadingStrategy:Ye.wm}),Ye.Bz]}),e})(),Eb=(()=>{var h;class e{}return(h=e).\u0275fac=function(r){return new(r||h)},h.\u0275mod=ie.oAB({type:h,bootstrap:[Pv]}),h.\u0275inj=ie.cJS({providers:[{provide:Ye.wN,useClass:Ie.r4}],imports:[f.b2,ht.Pc.forRoot(),xS]}),e})();(0,ie.G48)(),f.q6().bootstrapModule(Eb).catch(h=>console.log(h))},5619:(Kn,zt,te)=>{"use strict";te.d(zt,{X:()=>ie});var f=te(8645);class ie extends f.x{constructor(Ie){super(),this._value=Ie}get value(){return this.getValue()}_subscribe(Ie){const ht=super._subscribe(Ie);return!ht.closed&&Ie.next(this._value),ht}getValue(){const{hasError:Ie,thrownError:ht,_value:Fe}=this;if(Ie)throw ht;return this._throwIfClosed(),Fe}next(Ie){super.next(this._value=Ie)}}},5592:(Kn,zt,te)=>{"use strict";te.d(zt,{y:()=>Tt});var f=te(305),ie=te(7394),Ye=te(4850),Ie=te(8407),ht=te(2653),Fe=te(4674),Be=te(1441);let Tt=(()=>{class ft{constructor(tt){tt&&(this._subscribe=tt)}lift(tt){const We=new ft;return We.source=this,We.operator=tt,We}subscribe(tt,We,Rt){const Ke=function Oe(ft){return ft&&ft instanceof f.Lv||function yt(ft){return ft&&(0,Fe.m)(ft.next)&&(0,Fe.m)(ft.error)&&(0,Fe.m)(ft.complete)}(ft)&&(0,ie.Nn)(ft)}(tt)?tt:new f.Hp(tt,We,Rt);return(0,Be.x)(()=>{const{operator:Je,source:et}=this;Ke.add(Je?Je.call(Ke,et):et?this._subscribe(Ke):this._trySubscribe(Ke))}),Ke}_trySubscribe(tt){try{return this._subscribe(tt)}catch(We){tt.error(We)}}forEach(tt,We){return new(We=Pt(We))((Rt,Ke)=>{const Je=new f.Hp({next:et=>{try{tt(et)}catch($t){Ke($t),Je.unsubscribe()}},error:Ke,complete:Rt});this.subscribe(Je)})}_subscribe(tt){var We;return null===(We=this.source)||void 0===We?void 0:We.subscribe(tt)}[Ye.L](){return this}pipe(...tt){return(0,Ie.U)(tt)(this)}toPromise(tt){return new(tt=Pt(tt))((We,Rt)=>{let Ke;this.subscribe(Je=>Ke=Je,Je=>Rt(Je),()=>We(Ke))})}}return ft.create=lt=>new ft(lt),ft})();function Pt(ft){var lt;return null!==(lt=null!=ft?ft:ht.config.Promise)&&void 0!==lt?lt:Promise}},8645:(Kn,zt,te)=>{"use strict";te.d(zt,{x:()=>Be});var f=te(5592),ie=te(7394);const Ie=(0,te(2306).d)(Pt=>function(){Pt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ht=te(9039),Fe=te(1441);let Be=(()=>{class Pt extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Oe){const ft=new Tt(this,this);return ft.operator=Oe,ft}_throwIfClosed(){if(this.closed)throw new Ie}next(Oe){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ft of this.currentObservers)ft.next(Oe)}})}error(Oe){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Oe;const{observers:ft}=this;for(;ft.length;)ft.shift().error(Oe)}})}complete(){(0,Fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Oe}=this;for(;Oe.length;)Oe.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Oe;return(null===(Oe=this.observers)||void 0===Oe?void 0:Oe.length)>0}_trySubscribe(Oe){return this._throwIfClosed(),super._trySubscribe(Oe)}_subscribe(Oe){return this._throwIfClosed(),this._checkFinalizedStatuses(Oe),this._innerSubscribe(Oe)}_innerSubscribe(Oe){const{hasError:ft,isStopped:lt,observers:tt}=this;return ft||lt?ie.Lc:(this.currentObservers=null,tt.push(Oe),new ie.w0(()=>{this.currentObservers=null,(0,ht.P)(tt,Oe)}))}_checkFinalizedStatuses(Oe){const{hasError:ft,thrownError:lt,isStopped:tt}=this;ft?Oe.error(lt):tt&&Oe.complete()}asObservable(){const Oe=new f.y;return Oe.source=this,Oe}}return Pt.create=(yt,Oe)=>new Tt(yt,Oe),Pt})();class Tt extends Be{constructor(yt,Oe){super(),this.destination=yt,this.source=Oe}next(yt){var Oe,ft;null===(ft=null===(Oe=this.destination)||void 0===Oe?void 0:Oe.next)||void 0===ft||ft.call(Oe,yt)}error(yt){var Oe,ft;null===(ft=null===(Oe=this.destination)||void 0===Oe?void 0:Oe.error)||void 0===ft||ft.call(Oe,yt)}complete(){var yt,Oe;null===(Oe=null===(yt=this.destination)||void 0===yt?void 0:yt.complete)||void 0===Oe||Oe.call(yt)}_subscribe(yt){var Oe,ft;return null!==(ft=null===(Oe=this.source)||void 0===Oe?void 0:Oe.subscribe(yt))&&void 0!==ft?ft:ie.Lc}}},305:(Kn,zt,te)=>{"use strict";te.d(zt,{Hp:()=>Rt,Lv:()=>ft});var f=te(4674),ie=te(7394),Ye=te(2653),Ie=te(3894),ht=te(2420);const Fe=Pt("C",void 0,void 0);function Pt(rt,st,bt){return{kind:rt,value:st,error:bt}}var yt=te(7599),Oe=te(1441);class ft extends ie.w0{constructor(st){super(),this.isStopped=!1,st?(this.destination=st,(0,ie.Nn)(st)&&st.add(this)):this.destination=$t}static create(st,bt,He){return new Rt(st,bt,He)}next(st){this.isStopped?et(function Tt(rt){return Pt("N",rt,void 0)}(st),this):this._next(st)}error(st){this.isStopped?et(function Be(rt){return Pt("E",void 0,rt)}(st),this):(this.isStopped=!0,this._error(st))}complete(){this.isStopped?et(Fe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(st){this.destination.next(st)}_error(st){try{this.destination.error(st)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const lt=Function.prototype.bind;function tt(rt,st){return lt.call(rt,st)}class We{constructor(st){this.partialObserver=st}next(st){const{partialObserver:bt}=this;if(bt.next)try{bt.next(st)}catch(He){Ke(He)}}error(st){const{partialObserver:bt}=this;if(bt.error)try{bt.error(st)}catch(He){Ke(He)}else Ke(st)}complete(){const{partialObserver:st}=this;if(st.complete)try{st.complete()}catch(bt){Ke(bt)}}}class Rt extends ft{constructor(st,bt,He){let pe;if(super(),(0,f.m)(st)||!st)pe={next:null!=st?st:void 0,error:null!=bt?bt:void 0,complete:null!=He?He:void 0};else{let ge;this&&Ye.config.useDeprecatedNextContext?(ge=Object.create(st),ge.unsubscribe=()=>this.unsubscribe(),pe={next:st.next&&tt(st.next,ge),error:st.error&&tt(st.error,ge),complete:st.complete&&tt(st.complete,ge)}):pe=st}this.destination=new We(pe)}}function Ke(rt){Ye.config.useDeprecatedSynchronousErrorHandling?(0,Oe.O)(rt):(0,Ie.h)(rt)}function et(rt,st){const{onStoppedNotification:bt}=Ye.config;bt&&yt.z.setTimeout(()=>bt(rt,st))}const $t={closed:!0,next:ht.Z,error:function Je(rt){throw rt},complete:ht.Z}},7394:(Kn,zt,te)=>{"use strict";te.d(zt,{Lc:()=>Fe,w0:()=>ht,Nn:()=>Be});var f=te(4674);const Ye=(0,te(2306).d)(Pt=>function(Oe){Pt(this),this.message=Oe?`${Oe.length} errors occurred during unsubscription:\n${Oe.map((ft,lt)=>`${lt+1}) ${ft.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Oe});var Ie=te(9039);class ht{constructor(yt){this.initialTeardown=yt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let yt;if(!this.closed){this.closed=!0;const{_parentage:Oe}=this;if(Oe)if(this._parentage=null,Array.isArray(Oe))for(const tt of Oe)tt.remove(this);else Oe.remove(this);const{initialTeardown:ft}=this;if((0,f.m)(ft))try{ft()}catch(tt){yt=tt instanceof Ye?tt.errors:[tt]}const{_finalizers:lt}=this;if(lt){this._finalizers=null;for(const tt of lt)try{Tt(tt)}catch(We){yt=null!=yt?yt:[],We instanceof Ye?yt=[...yt,...We.errors]:yt.push(We)}}if(yt)throw new Ye(yt)}}add(yt){var Oe;if(yt&&yt!==this)if(this.closed)Tt(yt);else{if(yt instanceof ht){if(yt.closed||yt._hasParent(this))return;yt._addParent(this)}(this._finalizers=null!==(Oe=this._finalizers)&&void 0!==Oe?Oe:[]).push(yt)}}_hasParent(yt){const{_parentage:Oe}=this;return Oe===yt||Array.isArray(Oe)&&Oe.includes(yt)}_addParent(yt){const{_parentage:Oe}=this;this._parentage=Array.isArray(Oe)?(Oe.push(yt),Oe):Oe?[Oe,yt]:yt}_removeParent(yt){const{_parentage:Oe}=this;Oe===yt?this._parentage=null:Array.isArray(Oe)&&(0,Ie.P)(Oe,yt)}remove(yt){const{_finalizers:Oe}=this;Oe&&(0,Ie.P)(Oe,yt),yt instanceof ht&&yt._removeParent(this)}}ht.EMPTY=(()=>{const Pt=new ht;return Pt.closed=!0,Pt})();const Fe=ht.EMPTY;function Be(Pt){return Pt instanceof ht||Pt&&"closed"in Pt&&(0,f.m)(Pt.remove)&&(0,f.m)(Pt.add)&&(0,f.m)(Pt.unsubscribe)}function Tt(Pt){(0,f.m)(Pt)?Pt():Pt.unsubscribe()}},2653:(Kn,zt,te)=>{"use strict";te.d(zt,{config:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(Kn,zt,te)=>{"use strict";te.d(zt,{a:()=>yt});var f=te(5592),ie=te(7453),Ye=te(7715),Ie=te(2737),ht=te(7400),Fe=te(4564),Be=te(2714),Tt=te(8251),Pt=te(7103);function yt(...lt){const tt=(0,Fe.yG)(lt),We=(0,Fe.jO)(lt),{args:Rt,keys:Ke}=(0,ie.D)(lt);if(0===Rt.length)return(0,Ye.D)([],tt);const Je=new f.y(function Oe(lt,tt,We=Ie.y){return Rt=>{ft(tt,()=>{const{length:Ke}=lt,Je=new Array(Ke);let et=Ke,$t=Ke;for(let rt=0;rt<Ke;rt++)ft(tt,()=>{const st=(0,Ye.D)(lt[rt],tt);let bt=!1;st.subscribe((0,Tt.x)(Rt,He=>{Je[rt]=He,bt||(bt=!0,$t--),$t||Rt.next(We(Je.slice()))},()=>{--et||Rt.complete()}))},Rt)},Rt)}}(Rt,tt,Ke?et=>(0,Be.n)(Ke,et):Ie.y));return We?Je.pipe((0,ht.Z)(We)):Je}function ft(lt,tt,We){lt?(0,Pt.f)(We,lt,tt):tt()}},7715:(Kn,zt,te)=>{"use strict";te.d(zt,{D:()=>He});var f=te(4829),ie=te(7103),Ye=te(9360),Ie=te(8251);function ht(pe,ge=0){return(0,Ye.e)((Ue,Ae)=>{Ue.subscribe((0,Ie.x)(Ae,ot=>(0,ie.f)(Ae,pe,()=>Ae.next(ot),ge),()=>(0,ie.f)(Ae,pe,()=>Ae.complete(),ge),ot=>(0,ie.f)(Ae,pe,()=>Ae.error(ot),ge)))})}function Fe(pe,ge=0){return(0,Ye.e)((Ue,Ae)=>{Ae.add(pe.schedule(()=>Ue.subscribe(Ae),ge))})}var Pt=te(5592),Oe=te(4971),ft=te(4674);function tt(pe,ge){if(!pe)throw new Error("Iterable cannot be null");return new Pt.y(Ue=>{(0,ie.f)(Ue,ge,()=>{const Ae=pe[Symbol.asyncIterator]();(0,ie.f)(Ue,ge,()=>{Ae.next().then(ot=>{ot.done?Ue.complete():Ue.next(ot.value)})},0,!0)})})}var We=te(8382),Rt=te(4026),Ke=te(4266),Je=te(3664),et=te(5726),$t=te(9853),rt=te(541);function He(pe,ge){return ge?function bt(pe,ge){if(null!=pe){if((0,We.c)(pe))return function Be(pe,ge){return(0,f.Xf)(pe).pipe(Fe(ge),ht(ge))}(pe,ge);if((0,Ke.z)(pe))return function yt(pe,ge){return new Pt.y(Ue=>{let Ae=0;return ge.schedule(function(){Ae===pe.length?Ue.complete():(Ue.next(pe[Ae++]),Ue.closed||this.schedule())})})}(pe,ge);if((0,Rt.t)(pe))return function Tt(pe,ge){return(0,f.Xf)(pe).pipe(Fe(ge),ht(ge))}(pe,ge);if((0,et.D)(pe))return tt(pe,ge);if((0,Je.T)(pe))return function lt(pe,ge){return new Pt.y(Ue=>{let Ae;return(0,ie.f)(Ue,ge,()=>{Ae=pe[Oe.h](),(0,ie.f)(Ue,ge,()=>{let ot,at;try{({value:ot,done:at}=Ae.next())}catch(ut){return void Ue.error(ut)}at?Ue.complete():Ue.next(ot)},0,!0)}),()=>(0,ft.m)(null==Ae?void 0:Ae.return)&&Ae.return()})}(pe,ge);if((0,rt.L)(pe))return function st(pe,ge){return tt((0,rt.Q)(pe),ge)}(pe,ge)}throw(0,$t.z)(pe)}(pe,ge):(0,f.Xf)(pe)}},2438:(Kn,zt,te)=>{"use strict";te.d(zt,{R:()=>yt});var f=te(4829),ie=te(5592),Ye=te(1631),Ie=te(4266),ht=te(4674),Fe=te(7400);const Be=["addListener","removeListener"],Tt=["addEventListener","removeEventListener"],Pt=["on","off"];function yt(We,Rt,Ke,Je){if((0,ht.m)(Ke)&&(Je=Ke,Ke=void 0),Je)return yt(We,Rt,Ke).pipe((0,Fe.Z)(Je));const[et,$t]=function tt(We){return(0,ht.m)(We.addEventListener)&&(0,ht.m)(We.removeEventListener)}(We)?Tt.map(rt=>st=>We[rt](Rt,st,Ke)):function ft(We){return(0,ht.m)(We.addListener)&&(0,ht.m)(We.removeListener)}(We)?Be.map(Oe(We,Rt)):function lt(We){return(0,ht.m)(We.on)&&(0,ht.m)(We.off)}(We)?Pt.map(Oe(We,Rt)):[];if(!et&&(0,Ie.z)(We))return(0,Ye.z)(rt=>yt(rt,Rt,Ke))((0,f.Xf)(We));if(!et)throw new TypeError("Invalid event target");return new ie.y(rt=>{const st=(...bt)=>rt.next(1<bt.length?bt:bt[0]);return et(st),()=>$t(st)})}function Oe(We,Rt){return Ke=>Je=>We[Ke](Rt,Je)}},4829:(Kn,zt,te)=>{"use strict";te.d(zt,{Xf:()=>lt});var f=te(7582),ie=te(4266),Ye=te(4026),Ie=te(5592),ht=te(8382),Fe=te(5726),Be=te(9853),Tt=te(3664),Pt=te(541),yt=te(4674),Oe=te(3894),ft=te(4850);function lt(rt){if(rt instanceof Ie.y)return rt;if(null!=rt){if((0,ht.c)(rt))return function tt(rt){return new Ie.y(st=>{const bt=rt[ft.L]();if((0,yt.m)(bt.subscribe))return bt.subscribe(st);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(rt);if((0,ie.z)(rt))return function We(rt){return new Ie.y(st=>{for(let bt=0;bt<rt.length&&!st.closed;bt++)st.next(rt[bt]);st.complete()})}(rt);if((0,Ye.t)(rt))return function Rt(rt){return new Ie.y(st=>{rt.then(bt=>{st.closed||(st.next(bt),st.complete())},bt=>st.error(bt)).then(null,Oe.h)})}(rt);if((0,Fe.D)(rt))return Je(rt);if((0,Tt.T)(rt))return function Ke(rt){return new Ie.y(st=>{for(const bt of rt)if(st.next(bt),st.closed)return;st.complete()})}(rt);if((0,Pt.L)(rt))return function et(rt){return Je((0,Pt.Q)(rt))}(rt)}throw(0,Be.z)(rt)}function Je(rt){return new Ie.y(st=>{(function $t(rt,st){var bt,He,pe,ge;return(0,f.mG)(this,void 0,void 0,function*(){try{for(bt=(0,f.KL)(rt);!(He=yield bt.next()).done;)if(st.next(He.value),st.closed)return}catch(Ue){pe={error:Ue}}finally{try{He&&!He.done&&(ge=bt.return)&&(yield ge.call(bt))}finally{if(pe)throw pe.error}}st.complete()})})(rt,st).catch(bt=>st.error(bt))})}},2096:(Kn,zt,te)=>{"use strict";te.d(zt,{of:()=>Ye});var f=te(4564),ie=te(7715);function Ye(...Ie){const ht=(0,f.yG)(Ie);return(0,ie.D)(Ie,ht)}},8251:(Kn,zt,te)=>{"use strict";te.d(zt,{x:()=>ie});var f=te(305);function ie(Ie,ht,Fe,Be,Tt){return new Ye(Ie,ht,Fe,Be,Tt)}class Ye extends f.Lv{constructor(ht,Fe,Be,Tt,Pt,yt){super(ht),this.onFinalize=Pt,this.shouldUnsubscribe=yt,this._next=Fe?function(Oe){try{Fe(Oe)}catch(ft){ht.error(ft)}}:super._next,this._error=Tt?function(Oe){try{Tt(Oe)}catch(ft){ht.error(ft)}finally{this.unsubscribe()}}:super._error,this._complete=Be?function(){try{Be()}catch(Oe){ht.error(Oe)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ht;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Fe}=this;super.unsubscribe(),!Fe&&(null===(ht=this.onFinalize)||void 0===ht||ht.call(this))}}}},2181:(Kn,zt,te)=>{"use strict";te.d(zt,{h:()=>Ye});var f=te(9360),ie=te(8251);function Ye(Ie,ht){return(0,f.e)((Fe,Be)=>{let Tt=0;Fe.subscribe((0,ie.x)(Be,Pt=>Ie.call(ht,Pt,Tt++)&&Be.next(Pt)))})}},7398:(Kn,zt,te)=>{"use strict";te.d(zt,{U:()=>Ye});var f=te(9360),ie=te(8251);function Ye(Ie,ht){return(0,f.e)((Fe,Be)=>{let Tt=0;Fe.subscribe((0,ie.x)(Be,Pt=>{Be.next(Ie.call(ht,Pt,Tt++))}))})}},1631:(Kn,zt,te)=>{"use strict";te.d(zt,{z:()=>Tt});var f=te(7398),ie=te(4829),Ye=te(9360),Ie=te(7103),ht=te(8251),Be=te(4674);function Tt(Pt,yt,Oe=1/0){return(0,Be.m)(yt)?Tt((ft,lt)=>(0,f.U)((tt,We)=>yt(ft,tt,lt,We))((0,ie.Xf)(Pt(ft,lt))),Oe):("number"==typeof yt&&(Oe=yt),(0,Ye.e)((ft,lt)=>function Fe(Pt,yt,Oe,ft,lt,tt,We,Rt){const Ke=[];let Je=0,et=0,$t=!1;const rt=()=>{$t&&!Ke.length&&!Je&&yt.complete()},st=He=>Je<ft?bt(He):Ke.push(He),bt=He=>{tt&&yt.next(He),Je++;let pe=!1;(0,ie.Xf)(Oe(He,et++)).subscribe((0,ht.x)(yt,ge=>{null==lt||lt(ge),tt?st(ge):yt.next(ge)},()=>{pe=!0},void 0,()=>{if(pe)try{for(Je--;Ke.length&&Je<ft;){const ge=Ke.shift();We?(0,Ie.f)(yt,We,()=>bt(ge)):bt(ge)}rt()}catch(ge){yt.error(ge)}}))};return Pt.subscribe((0,ht.x)(yt,st,()=>{$t=!0,rt()})),()=>{null==Rt||Rt()}}(ft,lt,Pt,Oe)))}},4664:(Kn,zt,te)=>{"use strict";te.d(zt,{w:()=>Ie});var f=te(4829),ie=te(9360),Ye=te(8251);function Ie(ht,Fe){return(0,ie.e)((Be,Tt)=>{let Pt=null,yt=0,Oe=!1;const ft=()=>Oe&&!Pt&&Tt.complete();Be.subscribe((0,Ye.x)(Tt,lt=>{null==Pt||Pt.unsubscribe();let tt=0;const We=yt++;(0,f.Xf)(ht(lt,We)).subscribe(Pt=(0,Ye.x)(Tt,Rt=>Tt.next(Fe?Fe(lt,Rt,We,tt++):Rt),()=>{Pt=null,ft()}))},()=>{Oe=!0,ft()}))})}},7599:(Kn,zt,te)=>{"use strict";te.d(zt,{z:()=>f});const f={setTimeout(ie,Ye,...Ie){const{delegate:ht}=f;return null!=ht&&ht.setTimeout?ht.setTimeout(ie,Ye,...Ie):setTimeout(ie,Ye,...Ie)},clearTimeout(ie){const{delegate:Ye}=f;return((null==Ye?void 0:Ye.clearTimeout)||clearTimeout)(ie)},delegate:void 0}},4971:(Kn,zt,te)=>{"use strict";te.d(zt,{h:()=>ie});const ie=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Kn,zt,te)=>{"use strict";te.d(zt,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(Kn,zt,te)=>{"use strict";te.d(zt,{jO:()=>Ie,yG:()=>ht});var f=te(4674);function Ye(Be){return Be[Be.length-1]}function Ie(Be){return(0,f.m)(Ye(Be))?Be.pop():void 0}function ht(Be){return function ie(Be){return Be&&(0,f.m)(Be.schedule)}(Ye(Be))?Be.pop():void 0}},7453:(Kn,zt,te)=>{"use strict";te.d(zt,{D:()=>ht});const{isArray:f}=Array,{getPrototypeOf:ie,prototype:Ye,keys:Ie}=Object;function ht(Be){if(1===Be.length){const Tt=Be[0];if(f(Tt))return{args:Tt,keys:null};if(function Fe(Be){return Be&&"object"==typeof Be&&ie(Be)===Ye}(Tt)){const Pt=Ie(Tt);return{args:Pt.map(yt=>Tt[yt]),keys:Pt}}}return{args:Be,keys:null}}},9039:(Kn,zt,te)=>{"use strict";function f(ie,Ye){if(ie){const Ie=ie.indexOf(Ye);0<=Ie&&ie.splice(Ie,1)}}te.d(zt,{P:()=>f})},2306:(Kn,zt,te)=>{"use strict";function f(ie){const Ie=ie(ht=>{Error.call(ht),ht.stack=(new Error).stack});return Ie.prototype=Object.create(Error.prototype),Ie.prototype.constructor=Ie,Ie}te.d(zt,{d:()=>f})},2714:(Kn,zt,te)=>{"use strict";function f(ie,Ye){return ie.reduce((Ie,ht,Fe)=>(Ie[ht]=Ye[Fe],Ie),{})}te.d(zt,{n:()=>f})},1441:(Kn,zt,te)=>{"use strict";te.d(zt,{O:()=>Ie,x:()=>Ye});var f=te(2653);let ie=null;function Ye(ht){if(f.config.useDeprecatedSynchronousErrorHandling){const Fe=!ie;if(Fe&&(ie={errorThrown:!1,error:null}),ht(),Fe){const{errorThrown:Be,error:Tt}=ie;if(ie=null,Be)throw Tt}}else ht()}function Ie(ht){f.config.useDeprecatedSynchronousErrorHandling&&ie&&(ie.errorThrown=!0,ie.error=ht)}},7103:(Kn,zt,te)=>{"use strict";function f(ie,Ye,Ie,ht=0,Fe=!1){const Be=Ye.schedule(function(){Ie(),Fe?ie.add(this.schedule(null,ht)):this.unsubscribe()},ht);if(ie.add(Be),!Fe)return Be}te.d(zt,{f:()=>f})},2737:(Kn,zt,te)=>{"use strict";function f(ie){return ie}te.d(zt,{y:()=>f})},4266:(Kn,zt,te)=>{"use strict";te.d(zt,{z:()=>f});const f=ie=>ie&&"number"==typeof ie.length&&"function"!=typeof ie},5726:(Kn,zt,te)=>{"use strict";te.d(zt,{D:()=>ie});var f=te(4674);function ie(Ye){return Symbol.asyncIterator&&(0,f.m)(null==Ye?void 0:Ye[Symbol.asyncIterator])}},4674:(Kn,zt,te)=>{"use strict";function f(ie){return"function"==typeof ie}te.d(zt,{m:()=>f})},8382:(Kn,zt,te)=>{"use strict";te.d(zt,{c:()=>Ye});var f=te(4850),ie=te(4674);function Ye(Ie){return(0,ie.m)(Ie[f.L])}},3664:(Kn,zt,te)=>{"use strict";te.d(zt,{T:()=>Ye});var f=te(4971),ie=te(4674);function Ye(Ie){return(0,ie.m)(null==Ie?void 0:Ie[f.h])}},4026:(Kn,zt,te)=>{"use strict";te.d(zt,{t:()=>ie});var f=te(4674);function ie(Ye){return(0,f.m)(null==Ye?void 0:Ye.then)}},541:(Kn,zt,te)=>{"use strict";te.d(zt,{L:()=>Ie,Q:()=>Ye});var f=te(7582),ie=te(4674);function Ye(ht){return(0,f.FC)(this,arguments,function*(){const Be=ht.getReader();try{for(;;){const{value:Tt,done:Pt}=yield(0,f.qq)(Be.read());if(Pt)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(Tt)}}finally{Be.releaseLock()}})}function Ie(ht){return(0,ie.m)(null==ht?void 0:ht.getReader)}},9360:(Kn,zt,te)=>{"use strict";te.d(zt,{A:()=>ie,e:()=>Ye});var f=te(4674);function ie(Ie){return(0,f.m)(null==Ie?void 0:Ie.lift)}function Ye(Ie){return ht=>{if(ie(ht))return ht.lift(function(Fe){try{return Ie(Fe,this)}catch(Be){this.error(Be)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(Kn,zt,te)=>{"use strict";te.d(zt,{Z:()=>Ie});var f=te(7398);const{isArray:ie}=Array;function Ie(ht){return(0,f.U)(Fe=>function Ye(ht,Fe){return ie(Fe)?ht(...Fe):ht(Fe)}(ht,Fe))}},2420:(Kn,zt,te)=>{"use strict";function f(){}te.d(zt,{Z:()=>f})},8407:(Kn,zt,te)=>{"use strict";te.d(zt,{U:()=>Ye,z:()=>ie});var f=te(2737);function ie(...Ie){return Ye(Ie)}function Ye(Ie){return 0===Ie.length?f.y:1===Ie.length?Ie[0]:function(Fe){return Ie.reduce((Be,Tt)=>Tt(Be),Fe)}}},3894:(Kn,zt,te)=>{"use strict";te.d(zt,{h:()=>Ye});var f=te(2653),ie=te(7599);function Ye(Ie){ie.z.setTimeout(()=>{const{onUnhandledError:ht}=f.config;if(!ht)throw Ie;ht(Ie)})}},9853:(Kn,zt,te)=>{"use strict";function f(ie){return new TypeError(`You provided ${null!==ie&&"object"==typeof ie?"an invalid object":`'${ie}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}te.d(zt,{z:()=>f})},863:(Kn,zt,te)=>{var f={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,5248,433],"./ion-datetime_3.entry.js":[7059,5248,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,8592,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,8592,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,8592,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function ie(Ye){if(!te.o(f,Ye))return Promise.resolve().then(()=>{var Fe=new Error("Cannot find module '"+Ye+"'");throw Fe.code="MODULE_NOT_FOUND",Fe});var Ie=f[Ye],ht=Ie[0];return Promise.all(Ie.slice(1).map(te.e)).then(()=>te(ht))}ie.keys=()=>Object.keys(f),ie.id=863,Kn.exports=ie},6814:(Kn,zt,te)=>{"use strict";te.d(zt,{Do:()=>Rt,EM:()=>zl,HT:()=>Ie,JF:()=>Bo,K0:()=>Fe,Mx:()=>fs,O5:()=>Rs,PM:()=>_l,S$:()=>lt,V_:()=>Tt,Ye:()=>Ke,b0:()=>We,bD:()=>el,ez:()=>ba,q:()=>Ye,tP:()=>Et,w_:()=>ht});var f=te(9212);let ie=null;function Ye(){return ie}function Ie(D){ie||(ie=D)}class ht{}const Fe=new f.OlP("DocumentToken");let Be=(()=>{var D;class H{historyGo(z){throw new Error("Not implemented")}}return(D=H).\u0275fac=function(z){return new(z||D)},D.\u0275prov=f.Yz7({token:D,factory:()=>(0,f.f3M)(Pt),providedIn:"platform"}),H})();const Tt=new f.OlP("Location Initialized");let Pt=(()=>{var D;class H extends Be{constructor(){super(),this._doc=(0,f.f3M)(Fe),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ye().getBaseHref(this._doc)}onPopState(z){const ce=Ye().getGlobalEventTarget(this._doc,"window");return ce.addEventListener("popstate",z,!1),()=>ce.removeEventListener("popstate",z)}onHashChange(z){const ce=Ye().getGlobalEventTarget(this._doc,"window");return ce.addEventListener("hashchange",z,!1),()=>ce.removeEventListener("hashchange",z)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(z){this._location.pathname=z}pushState(z,ce,Te){this._history.pushState(z,ce,Te)}replaceState(z,ce,Te){this._history.replaceState(z,ce,Te)}forward(){this._history.forward()}back(){this._history.back()}historyGo(z=0){this._history.go(z)}getState(){return this._history.state}}return(D=H).\u0275fac=function(z){return new(z||D)},D.\u0275prov=f.Yz7({token:D,factory:()=>new D,providedIn:"platform"}),H})();function yt(D,H){if(0==D.length)return H;if(0==H.length)return D;let Ee=0;return D.endsWith("/")&&Ee++,H.startsWith("/")&&Ee++,2==Ee?D+H.substring(1):1==Ee?D+H:D+"/"+H}function Oe(D){const H=D.match(/#|\?|$/),Ee=H&&H.index||D.length;return D.slice(0,Ee-("/"===D[Ee-1]?1:0))+D.slice(Ee)}function ft(D){return D&&"?"!==D[0]?"?"+D:D}let lt=(()=>{var D;class H{historyGo(z){throw new Error("Not implemented")}}return(D=H).\u0275fac=function(z){return new(z||D)},D.\u0275prov=f.Yz7({token:D,factory:()=>(0,f.f3M)(We),providedIn:"root"}),H})();const tt=new f.OlP("appBaseHref");let We=(()=>{var D;class H extends lt{constructor(z,ce){var Te,jt,ln;super(),this._platformLocation=z,this._removeListenerFns=[],this._baseHref=null!==(Te=null!==(jt=null!=ce?ce:this._platformLocation.getBaseHrefFromDOM())&&void 0!==jt?jt:null===(ln=(0,f.f3M)(Fe).location)||void 0===ln?void 0:ln.origin)&&void 0!==Te?Te:""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}prepareExternalUrl(z){return yt(this._baseHref,z)}path(z=!1){const ce=this._platformLocation.pathname+ft(this._platformLocation.search),Te=this._platformLocation.hash;return Te&&z?`${ce}${Te}`:ce}pushState(z,ce,Te,jt){const ln=this.prepareExternalUrl(Te+ft(jt));this._platformLocation.pushState(z,ce,ln)}replaceState(z,ce,Te,jt){const ln=this.prepareExternalUrl(Te+ft(jt));this._platformLocation.replaceState(z,ce,ln)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(z=0){var ce,Te;null===(ce=(Te=this._platformLocation).historyGo)||void 0===ce||ce.call(Te,z)}}return(D=H).\u0275fac=function(z){return new(z||D)(f.LFG(Be),f.LFG(tt,8))},D.\u0275prov=f.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),H})(),Rt=(()=>{var D;class H extends lt{constructor(z,ce){super(),this._platformLocation=z,this._baseHref="",this._removeListenerFns=[],null!=ce&&(this._baseHref=ce)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(z){this._removeListenerFns.push(this._platformLocation.onPopState(z),this._platformLocation.onHashChange(z))}getBaseHref(){return this._baseHref}path(z=!1){let ce=this._platformLocation.hash;return null==ce&&(ce="#"),ce.length>0?ce.substring(1):ce}prepareExternalUrl(z){const ce=yt(this._baseHref,z);return ce.length>0?"#"+ce:ce}pushState(z,ce,Te,jt){let ln=this.prepareExternalUrl(Te+ft(jt));0==ln.length&&(ln=this._platformLocation.pathname),this._platformLocation.pushState(z,ce,ln)}replaceState(z,ce,Te,jt){let ln=this.prepareExternalUrl(Te+ft(jt));0==ln.length&&(ln=this._platformLocation.pathname),this._platformLocation.replaceState(z,ce,ln)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(z=0){var ce,Te;null===(ce=(Te=this._platformLocation).historyGo)||void 0===ce||ce.call(Te,z)}}return(D=H).\u0275fac=function(z){return new(z||D)(f.LFG(Be),f.LFG(tt,8))},D.\u0275prov=f.Yz7({token:D,factory:D.\u0275fac}),H})(),Ke=(()=>{var D;class H{constructor(z){this._subject=new f.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=z;const ce=this._locationStrategy.getBaseHref();this._basePath=function rt(D){if(new RegExp("^(https?:)?//").test(D)){const[,Ee]=D.split(/\/\/[^\/]+/);return Ee}return D}(Oe($t(ce))),this._locationStrategy.onPopState(Te=>{this._subject.emit({url:this.path(!0),pop:!0,state:Te.state,type:Te.type})})}ngOnDestroy(){var z;null===(z=this._urlChangeSubscription)||void 0===z||z.unsubscribe(),this._urlChangeListeners=[]}path(z=!1){return this.normalize(this._locationStrategy.path(z))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(z,ce=""){return this.path()==this.normalize(z+ft(ce))}normalize(z){return H.stripTrailingSlash(function et(D,H){if(!D||!H.startsWith(D))return H;const Ee=H.substring(D.length);return""===Ee||["/",";","?","#"].includes(Ee[0])?Ee:H}(this._basePath,$t(z)))}prepareExternalUrl(z){return z&&"/"!==z[0]&&(z="/"+z),this._locationStrategy.prepareExternalUrl(z)}go(z,ce="",Te=null){this._locationStrategy.pushState(Te,"",z,ce),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+ft(ce)),Te)}replaceState(z,ce="",Te=null){this._locationStrategy.replaceState(Te,"",z,ce),this._notifyUrlChangeListeners(this.prepareExternalUrl(z+ft(ce)),Te)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(z=0){var ce,Te;null===(ce=(Te=this._locationStrategy).historyGo)||void 0===ce||ce.call(Te,z)}onUrlChange(z){return this._urlChangeListeners.push(z),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(ce=>{this._notifyUrlChangeListeners(ce.url,ce.state)})),()=>{const ce=this._urlChangeListeners.indexOf(z);var Te;this._urlChangeListeners.splice(ce,1),0===this._urlChangeListeners.length&&(null===(Te=this._urlChangeSubscription)||void 0===Te||Te.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(z="",ce){this._urlChangeListeners.forEach(Te=>Te(z,ce))}subscribe(z,ce,Te){return this._subject.subscribe({next:z,error:ce,complete:Te})}}return(D=H).normalizeQueryParams=ft,D.joinWithSlash=yt,D.stripTrailingSlash=Oe,D.\u0275fac=function(z){return new(z||D)(f.LFG(lt))},D.\u0275prov=f.Yz7({token:D,factory:()=>function Je(){return new Ke((0,f.LFG)(lt))}(),providedIn:"root"}),H})();function $t(D){return D.replace(/\/index.html$/,"")}function fs(D,H){H=encodeURIComponent(H);for(const Ee of D.split(";")){const z=Ee.indexOf("="),[ce,Te]=-1==z?[Ee,""]:[Ee.slice(0,z),Ee.slice(z+1)];if(ce.trim()===H)return decodeURIComponent(Te)}return null}let Rs=(()=>{var D;class H{constructor(z,ce){this._viewContainer=z,this._context=new to,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=ce}set ngIf(z){this._context.$implicit=this._context.ngIf=z,this._updateView()}set ngIfThen(z){ue("ngIfThen",z),this._thenTemplateRef=z,this._thenViewRef=null,this._updateView()}set ngIfElse(z){ue("ngIfElse",z),this._elseTemplateRef=z,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(z,ce){return!0}}return(D=H).\u0275fac=function(z){return new(z||D)(f.Y36(f.s_b),f.Y36(f.Rgc))},D.\u0275dir=f.lG2({type:D,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),H})();class to{constructor(){this.$implicit=null,this.ngIf=null}}function ue(D,H){if(H&&!H.createEmbeddedView)throw new Error(`${D} must be a TemplateRef, but received '${(0,f.AaK)(H)}'.`)}let Et=(()=>{var D;class H{constructor(z){this._viewContainerRef=z,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(z){if(this._shouldRecreateView(z)){var ce;const Te=this._viewContainerRef;if(this._viewRef&&Te.remove(Te.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const jt=this._createContextForwardProxy();this._viewRef=Te.createEmbeddedView(this.ngTemplateOutlet,jt,{injector:null!==(ce=this.ngTemplateOutletInjector)&&void 0!==ce?ce:void 0})}}_shouldRecreateView(z){return!!z.ngTemplateOutlet||!!z.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(z,ce,Te)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,ce,Te),get:(z,ce,Te)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,ce,Te)}})}}return(D=H).\u0275fac=function(z){return new(z||D)(f.Y36(f.s_b))},D.\u0275dir=f.lG2({type:D,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[f.TTD]}),H})(),ba=(()=>{var D;class H{}return(D=H).\u0275fac=function(z){return new(z||D)},D.\u0275mod=f.oAB({type:D}),D.\u0275inj=f.cJS({}),H})();const el="browser",tl="server";function _l(D){return D===tl}let zl=(()=>{var D;class H{}return(D=H).\u0275prov=(0,f.Yz7)({token:D,providedIn:"root",factory:()=>new yu((0,f.LFG)(Fe),window)}),H})();class yu{constructor(H,Ee){this.document=H,this.window=Ee,this.offset=()=>[0,0]}setOffset(H){this.offset=Array.isArray(H)?()=>H:H}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(H){this.supportsScrolling()&&this.window.scrollTo(H[0],H[1])}scrollToAnchor(H){if(!this.supportsScrolling())return;const Ee=function il(D,H){const Ee=D.getElementById(H)||D.getElementsByName(H)[0];if(Ee)return Ee;if("function"==typeof D.createTreeWalker&&D.body&&"function"==typeof D.body.attachShadow){const z=D.createTreeWalker(D.body,NodeFilter.SHOW_ELEMENT);let ce=z.currentNode;for(;ce;){const Te=ce.shadowRoot;if(Te){const jt=Te.getElementById(H)||Te.querySelector(`[name="${H}"]`);if(jt)return jt}ce=z.nextNode()}}return null}(this.document,H);Ee&&(this.scrollToElement(Ee),Ee.focus())}setHistoryScrollRestoration(H){this.supportsScrolling()&&(this.window.history.scrollRestoration=H)}scrollToElement(H){const Ee=H.getBoundingClientRect(),z=Ee.left+this.window.pageXOffset,ce=Ee.top+this.window.pageYOffset,Te=this.offset();this.window.scrollTo(z-Te[0],ce-Te[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class Bo{}},9212:(Kn,zt,te)=>{"use strict";te.d(zt,{tb:()=>zS,AFp:()=>wx,ip1:()=>ZA,hGG:()=>iI,z2F:()=>lm,Ojb:()=>yC,sBO:()=>Og,Sil:()=>dD,EJc:()=>jD,Xts:()=>Dc,SBq:()=>sp,lqb:()=>cl,qLn:()=>Xa,vpe:()=>fl,XFs:()=>Ti,OlP:()=>ue,zs3:()=>ja,ZZ4:()=>pg,aQg:()=>lp,soG:()=>Db,YKP:()=>he,h0i:()=>Ce,R0b:()=>ks,FiY:()=>Pf,Lbi:()=>py,g9A:()=>Sx,Qsj:()=>LC,FYo:()=>_0,JOm:()=>Gf,tp0:()=>Of,Rgc:()=>Qa,dDg:()=>FD,eoX:()=>XA,GfV:()=>zA,s_b:()=>Up,ifc:()=>tr,T8G:()=>ZE,VuI:()=>TI,LMc:()=>II,MMx:()=>Vt,Lck:()=>Ft,eFA:()=>sT,G48:()=>KD,Gpc:()=>or,f3M:()=>re,$WT:()=>Es,_c5:()=>nI,qFp:()=>RI,r_H:()=>gx,rg0:()=>hg,c2e:()=>HA,zSh:()=>Om,wAp:()=>kd,I6F:()=>BS,vHH:()=>gn,lri:()=>YA,rWj:()=>qA,cg1:()=>fc,kuF:()=>wr,kL8:()=>K_,dqk:()=>gr,Z0I:()=>er,eJc:()=>Rc,QGY:()=>Iv,F4k:()=>Rv,RDi:()=>gC,AaK:()=>ai,qOj:()=>zg,Xq5:()=>$g,TTD:()=>lr,_Bn:()=>cs,jDz:()=>dn,xp6:()=>L0,uIk:()=>kh,ekj:()=>as,Suo:()=>xA,Xpm:()=>rl,lG2:()=>Eu,Yz7:()=>Hi,cJS:()=>_s,oAB:()=>Po,Yjl:()=>_c,Y36:()=>sc,_UZ:()=>bv,GkF:()=>Mv,qZA:()=>Xp,TgZ:()=>qp,n5z:()=>Tf,LFG:()=>ee,$8M:()=>wm,$Z:()=>F0,NdJ:()=>Pv,CRH:()=>EA,oxw:()=>e,Hsn:()=>s,F$t:()=>r,Q6J:()=>Ap,iGM:()=>_A,P3R:()=>lg,YNc:()=>Id,_uU:()=>At,Gf:()=>bA});let ie=null,Ie=1;function Fe(n){const i=ie;return ie=n,i}function lt(n){if((!bt(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Ie)){if(!n.producerMustRecompute(n)&&!et(n))return n.dirty=!1,void(n.lastCleanEpoch=Ie);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Ie}}function et(n){He(n);for(let i=0;i<n.producerNode.length;i++){const o=n.producerNode[i],l=n.producerLastReadVersion[i];if(l!==o.version||(lt(o),l!==o.version))return!0}return!1}function st(n,i){if(function pe(n){var i,o;null!==(i=n.liveConsumerNode)&&void 0!==i||(n.liveConsumerNode=[]),null!==(o=n.liveConsumerIndexOfThis)&&void 0!==o||(n.liveConsumerIndexOfThis=[])}(n),He(n),1===n.liveConsumerNode.length)for(let l=0;l<n.producerNode.length;l++)st(n.producerNode[l],n.producerIndexOfThis[l]);const o=n.liveConsumerNode.length-1;if(n.liveConsumerNode[i]=n.liveConsumerNode[o],n.liveConsumerIndexOfThis[i]=n.liveConsumerIndexOfThis[o],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,i<n.liveConsumerNode.length){const l=n.liveConsumerIndexOfThis[i],u=n.liveConsumerNode[i];He(u),u.producerIndexOfThis[l]=i}}function bt(n){var i,o;return n.consumerIsAlwaysLive||(null!==(i=null==n||null===(o=n.liveConsumerNode)||void 0===o?void 0:o.length)&&void 0!==i?i:0)>0}function He(n){var i,o,l;null!==(i=n.producerNode)&&void 0!==i||(n.producerNode=[]),null!==(o=n.producerIndexOfThis)&&void 0!==o||(n.producerIndexOfThis=[]),null!==(l=n.producerLastReadVersion)&&void 0!==l||(n.producerLastReadVersion=[])}let an=null;var Xt=te(8645),Nt=te(7394),Dt=te(5619),nn=te(7398);function kt(n){for(let i in n)if(n[i]===kt)return i;throw Error("Could not find renamed property on target object.")}function Qn(n,i){for(const o in i)i.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(n[o]=i[o])}function ai(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ai).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const o=i.indexOf("\n");return-1===o?i:i.substring(0,o)}function $n(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Ci=kt({__forward_ref__:kt});function or(n){return n.__forward_ref__=or,n.toString=function(){return ai(this())},n}function Rn(n){return mi(n)?n():n}function mi(n){return"function"==typeof n&&n.hasOwnProperty(Ci)&&n.__forward_ref__===or}function di(n){return n&&!!n.\u0275providers}const Or="https://g.co/ng/security#xss";class gn extends Error{constructor(i,o){super(wr(i,o)),this.code=i}}function wr(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}const ur=kt({\u0275cmp:kt}),es=kt({\u0275dir:kt}),xi=kt({\u0275pipe:kt}),qr=kt({\u0275mod:kt}),Jn=kt({\u0275fac:kt}),Cr=kt({__NG_ELEMENT_ID__:kt}),us=kt({__NG_ENV_ID__:kt});function Mn(n){return"string"==typeof n?n:null==n?"":String(n)}function Lr(n,i){throw new gn(-201,!1)}function ar(n,i){null==n&&function Yn(n,i,o,l){throw new Error(`ASSERTION ERROR: ${n}`+(null==l?"":` [Expected=> ${o} ${l} ${i} <=Actual]`))}(i,n,null,"!=")}function Hi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function _s(n){return{providers:n.providers||[],imports:n.imports||[]}}function Cs(n){return hs(n,Sr)||hs(n,Ts)}function er(n){return null!==Cs(n)}function hs(n,i){return n.hasOwnProperty(i)?n[i]:null}function As(n){return n&&(n.hasOwnProperty(fs)||n.hasOwnProperty(Rr))?n[fs]:null}const Sr=kt({\u0275prov:kt}),fs=kt({\u0275inj:kt}),Ts=kt({ngInjectableDef:kt}),Rr=kt({ngInjectorDef:kt});var Ti=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ti||{});let ts;function ir(){return ts}function li(n){const i=ts;return ts=n,i}function Mo(n,i,o){const l=Cs(n);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:o&Ti.Optional?null:void 0!==i?i:void Lr(ai(n))}const gr=globalThis;class ue{constructor(i,o){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=Hi({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Xe={},Wt="__NG_DI_FLAG__",Yt="ngTempTokenPath",Zt=/\n/gm,Gn="__source";let On;function dr(n){const i=On;return On=n,i}function T(n,i=Ti.Default){if(void 0===On)throw new gn(-203,!1);return null===On?Mo(n,void 0,i):On.get(n,i&Ti.Optional?null:void 0,i)}function ee(n,i=Ti.Default){return(ir()||T)(Rn(n),i)}function re(n,i=Ti.Default){return ee(n,Ze(i))}function Ze(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function gi(n){const i=[];for(let o=0;o<n.length;o++){const l=Rn(n[o]);if(Array.isArray(l)){if(0===l.length)throw new gn(900,!1);let u,m=Ti.Default;for(let y=0;y<l.length;y++){const x=l[y],C=ns(x);"number"==typeof C?-1===C?u=x.token:m|=C:u=x}i.push(ee(u,m))}else i.push(ee(l))}return i}function Pr(n,i){return n[Wt]=i,n.prototype[Wt]=i,n}function ns(n){return n[Wt]}function Ps(n){return{toString:n}.toString()}var mo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(mo||{}),tr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(tr||{});const is={},Oi=[];function Ba(n,i,o){let l=n.length;for(;;){const u=n.indexOf(i,o);if(-1===u)return u;if(0===u||n.charCodeAt(u-1)<=32){const m=i.length;if(u+m===l||n.charCodeAt(u+m)<=32)return u}o=u+1}}function qo(n,i,o){let l=0;for(;l<o.length;){const u=o[l];if("number"==typeof u){if(0!==u)break;l++;const m=o[l++],y=o[l++],x=o[l++];n.setAttribute(i,y,x,m)}else{const m=u,y=o[++l];Vl(m)?n.setProperty(i,m,y):n.setAttribute(i,m,y),l++}}return l}function ka(n){return 3===n||4===n||6===n}function Vl(n){return 64===n.charCodeAt(0)}function ba(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let o=-1;for(let l=0;l<i.length;l++){const u=i[l];"number"==typeof u?o=u:0===o||el(n,o,u,null,-1===o||2===o?i[++l]:null)}}return n}function el(n,i,o,l,u){let m=0,y=n.length;if(-1===i)y=-1;else for(;m<n.length;){const x=n[m++];if("number"==typeof x){if(x===i){y=-1;break}if(x>i){y=m-1;break}}}for(;m<n.length;){const x=n[m];if("number"==typeof x)break;if(x===o){if(null===l)return void(null!==u&&(n[m+1]=u));if(l===n[m+1])return void(n[m+2]=u)}m++,null!==l&&m++,null!==u&&m++}-1!==y&&(n.splice(y,0,i),m=y+1),n.splice(m++,0,o),null!==l&&n.splice(m++,0,l),null!==u&&n.splice(m++,0,u)}const tl="ng-template";function gc(n,i,o){let l=0,u=!0;for(;l<n.length;){let m=n[l++];if("string"==typeof m&&u){const y=n[l++];if(o&&"class"===m&&-1!==Ba(y.toLowerCase(),i,0))return!0}else{if(1===m){for(;l<n.length&&"string"==typeof(m=n[l++]);)if(m.toLowerCase()===i)return!0;return!1}"number"==typeof m&&(u=!1)}}return!1}function nl(n){return 4===n.type&&n.value!==tl}function zd(n,i,o){return i===(4!==n.type||o?n.value:tl)}function _l(n,i,o){let l=4;const u=n.attrs||[],m=function yu(n){for(let i=0;i<n.length;i++)if(ka(n[i]))return i;return n.length}(u);let y=!1;for(let x=0;x<i.length;x++){const C=i[x];if("number"!=typeof C){if(!y)if(4&l){if(l=2|1&l,""!==C&&!zd(n,C,o)||""===C&&1===i.length){if(wo(l))return!1;y=!0}}else{const U=8&l?C:i[++x];if(8&l&&null!==n.attrs){if(!gc(n.attrs,U,o)){if(wo(l))return!1;y=!0}continue}const J=Hd(8&l?"class":C,u,nl(n),o);if(-1===J){if(wo(l))return!1;y=!0;continue}if(""!==U){let Me;Me=J>m?"":u[J+1].toLowerCase();const ze=8&l?Me:null;if(ze&&-1!==Ba(ze,U,0)||2&l&&U!==Me){if(wo(l))return!1;y=!0}}}}else{if(!y&&!wo(l)&&!wo(C))return!1;if(y&&wo(C))continue;y=!1,l=C|1&l}}return wo(l)||y}function wo(n){return 0==(1&n)}function Hd(n,i,o,l){if(null===i)return-1;let u=0;if(l||!o){let m=!1;for(;u<i.length;){const y=i[u];if(y===n)return u;if(3===y||6===y)m=!0;else{if(1===y||2===y){let x=i[++u];for(;"string"==typeof x;)x=i[++u];continue}if(4===y)break;if(0===y){u+=4;continue}}u+=m?1:2}return-1}return function il(n,i){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const l=n[o];if("number"==typeof l)return-1;if(l===i)return o;o++}return-1}(i,n)}function bl(n,i,o=!1){for(let l=0;l<i.length;l++)if(_l(n,i[l],o))return!0;return!1}function Hl(n,i){e:for(let o=0;o<i.length;o++){const l=i[o];if(n.length===l.length){for(let u=0;u<n.length;u++)if(n[u]!==l[u])continue e;return!0}}return!1}function Bo(n,i){return n?":not("+i.trim()+")":i}function _u(n){let i=n[0],o=1,l=2,u="",m=!1;for(;o<n.length;){let y=n[o];if("string"==typeof y)if(2&l){const x=n[++o];u+="["+y+(x.length>0?'="'+x+'"':"")+"]"}else 8&l?u+="."+y:4&l&&(u+=" "+y);else""!==u&&!wo(y)&&(i+=Bo(m,u),u=""),l=y,m=m||!wo(l);o++}return""!==u&&(i+=Bo(m,u)),i}function rl(n){return Ps(()=>{var i;const o=Ea(n),l={...o,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===mo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:null!==(i=n.signals)&&void 0!==i&&i,data:n.data||{},encapsulation:n.encapsulation||tr.Emulated,styles:n.styles||Oi,_:null,schemas:n.schemas||null,tView:null,id:""};Mu(l);const u=n.dependencies;return l.directiveDefs=sl(u,!1),l.pipeDefs=sl(u,!0),l.id=function Ua(n){let i=0;const o=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const u of o)i=Math.imul(31,i)+u.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(l),l})}function bu(n){return Yi(n)||ps(n)}function xu(n){return null!==n}function Po(n){return Ps(()=>({type:n.type,bootstrap:n.bootstrap||Oi,declarations:n.declarations||Oi,imports:n.imports||Oi,exports:n.exports||Oi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function yc(n,i){if(null==n)return is;const o={};for(const l in n)if(n.hasOwnProperty(l)){let u=n[l],m=u;Array.isArray(u)&&(m=u[1],u=u[0]),o[u]=l,i&&(i[u]=m)}return o}function Eu(n){return Ps(()=>{const i=Ea(n);return Mu(i),i})}function _c(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Yi(n){return n[ur]||null}function ps(n){return n[es]||null}function xs(n){return n[xi]||null}function Es(n){const i=Yi(n)||ps(n)||xs(n);return null!==i&&i.standalone}function Os(n,i){const o=n[qr]||null;if(!o&&!0===i)throw new Error(`Type ${ai(n)} does not have '\u0275mod' property.`);return o}function Ea(n){const i={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputTransforms:null,inputConfig:n.inputs||is,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Oi,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:yc(n.inputs,i),outputs:yc(n.outputs),debugInfo:null}}function Mu(n){var i;null===(i=n.features)||void 0===i||i.forEach(o=>o(n))}function sl(n,i){if(!n)return null;const o=i?xs:bu;return()=>("function"==typeof n?n():n).map(l=>o(l)).filter(xu)}const vr=0,hn=1,fi=2,rr=3,rs=4,Ar=5,xr=6,Oo=7,_i=8,no=9,$=10,L=11,ae=12,G=13,ye=14,Kt=15,ci=16,Tr=17,Vr=18,Ls=19,Lo=20,go=21,Ma=22,No=23,Ai=25,io=1,ko=7,Fi=9,Kr=10;var oa=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n[n.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",n}(oa||{});function Ds(n){return Array.isArray(n)&&"object"==typeof n[io]}function Nr(n){return Array.isArray(n)&&!0===n[io]}function xl(n){return 0!=(4&n.flags)}function ol(n){return n.componentOffset>-1}function $l(n){return 1==(1&n.flags)}function vo(n){return!!n.template}function aa(n){return 0!=(512&n[fi])}function de(n,i){return n.hasOwnProperty(Jn)?n[Jn]:null}class Ki{constructor(i,o,l){this.previousValue=i,this.currentValue=o,this.firstChange=l}isFirstChange(){return this.firstChange}}function lr(){return bi}function bi(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ji),cr}function cr(){const n=Ms(this),i=null==n?void 0:n.current;if(i){const o=n.previous;if(o===is)n.previous=i;else for(let l in i)o[l]=i[l];n.current=null,this.ngOnChanges(i)}}function Ji(n,i,o,l){const u=this.declaredInputs[o],m=Ms(n)||function Ns(n,i){return n[Dr]=i}(n,{previous:is,current:null}),y=m.current||(m.current={}),x=m.previous,C=x[u];y[u]=new Ki(C&&C.currentValue,i,x===is),n[l]=i}lr.ngInherit=!0;const Dr="__ngSimpleChanges__";function Ms(n){return n[Dr]||null}const Gr=function(n,i,o){};let wa=!1;function kr(n){for(;Array.isArray(n);)n=n[vr];return n}function Ws(n,i){return kr(i[n.index])}function Vo(n,i){return n.data[i]}function yo(n,i){const o=i[n];return Ds(o)?o:o[vr]}function Yl(n){return 128==(128&n[fi])}function Jo(n,i){return null==i?null:n[i]}function El(n){n[Tr]=0}function Mi(n){1024&n[fi]||(n[fi]|=1024,Yl(n)&&wc(n))}function Qo(n){var i;return 9216&n[fi]||(null===(i=n[No])||void 0===i?void 0:i.dirty)}function ql(n){if(Qo(n))wc(n);else if(64&n[fi])if(function Mc(){return wa}())n[fi]|=1024,wc(n);else{var i;null===(i=n[$].changeDetectionScheduler)||void 0===i||i.notify()}}function wc(n){var i;null===(i=n[$].changeDetectionScheduler)||void 0===i||i.notify();let o=n[rr];for(;null!==o&&!(Nr(o)&&o[fi]&oa.HasChildViewsToRefresh||Ds(o)&&8192&o[fi]);){if(Nr(o))o[fi]|=oa.HasChildViewsToRefresh;else if(o[fi]|=8192,!Yl(o))break;o=o[rr]}}function ca(n,i){if(256==(256&n[fi]))throw new gn(911,!1);null===n[go]&&(n[go]=[]),n[go].push(i)}const hi={lFrame:A(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Tu(){return hi.bindingsEnabled}function Is(){return null!==hi.skipHydrationRootTNode}function qt(){return hi.lFrame.lView}function sr(){return hi.lFrame.tView}function zr(){let n=Co();for(;null!==n&&64===n.type;)n=n.parent;return n}function Co(){return hi.lFrame.currentTNode}function so(n,i){const o=hi.lFrame;o.currentTNode=n,o.isParent=i}function Iu(){return hi.lFrame.isParent}function Ca(){hi.lFrame.isParent=!1}function zo(){return hi.lFrame.bindingIndex++}function _f(n,i){const o=hi.lFrame;o.bindingIndex=o.bindingRootIndex=n,Zl(i)}function Zl(n){hi.lFrame.currentDirectiveIndex=n}function ei(){return hi.lFrame.currentQueryIndex}function oo(n){hi.lFrame.currentQueryIndex=n}function Sl(n){const i=n[hn];return 2===i.type?i.declTNode:1===i.type?n[Ar]:null}function Ga(n,i,o){if(o&Ti.SkipSelf){let u=i,m=n;for(;!(u=u.parent,null!==u||o&Ti.Host||(u=Sl(m),null===u||(m=m[ye],10&u.type))););if(null===u)return!1;i=u,n=m}const l=hi.lFrame=E();return l.currentTNode=i,l.lView=n,!0}function bf(n){const i=E(),o=n[hn];hi.lFrame=i,i.currentTNode=o.firstChild,i.lView=n,i.tView=o,i.contextLView=n,i.bindingIndex=o.bindingStartIndex,i.inI18n=!1}function E(){const n=hi.lFrame,i=null===n?null:n.child;return null===i?A(n):i}function A(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function O(){const n=hi.lFrame;return hi.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const S=O;function N(){const n=O();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function le(){return hi.lFrame.selectedIndex}function it(n){hi.lFrame.selectedIndex=n}function Ct(){const n=hi.lFrame;return Vo(n.tView,n.selectedIndex)}let Bn=!0;function Wa(){return Bn}function ta(n){Bn=n}function Aa(n,i){for(let U=i.directiveStart,W=i.directiveEnd;U<W;U++){const Me=n.data[U].type.prototype,{ngAfterContentInit:ze,ngAfterContentChecked:St,ngAfterViewInit:on,ngAfterViewChecked:mn,ngOnDestroy:Vn}=Me;var o,l,u,m,y,x,C;ze&&(null!==(o=n.contentHooks)&&void 0!==o?o:n.contentHooks=[]).push(-U,ze),St&&((null!==(l=n.contentHooks)&&void 0!==l?l:n.contentHooks=[]).push(U,St),(null!==(u=n.contentCheckHooks)&&void 0!==u?u:n.contentCheckHooks=[]).push(U,St)),on&&(null!==(m=n.viewHooks)&&void 0!==m?m:n.viewHooks=[]).push(-U,on),mn&&((null!==(y=n.viewHooks)&&void 0!==y?y:n.viewHooks=[]).push(U,mn),(null!==(x=n.viewCheckHooks)&&void 0!==x?x:n.viewCheckHooks=[]).push(U,mn)),null!=Vn&&(null!==(C=n.destroyHooks)&&void 0!==C?C:n.destroyHooks=[]).push(U,Vn)}}function Ho(n,i,o){ao(n,i,3,o)}function bo(n,i,o,l){(3&n[fi])===o&&ao(n,i,o,l)}function da(n,i){let o=n[fi];(3&o)===i&&(o&=16383,o+=1,n[fi]=o)}function ao(n,i,o,l){const m=null!=l?l:-1,y=i.length-1;let x=0;for(let C=void 0!==l?65535&n[Tr]:0;C<y;C++)if("number"==typeof i[C+1]){if(x=i[C],null!=l&&x>=l)break}else i[C]<0&&(n[Tr]+=65536),(x<m||-1==m)&&(Wv(n,o,i,C),n[Tr]=(4294901760&n[Tr])+C+2),C++}function Qi(n,i){Gr(4,n,i);const o=Fe(null);try{i.call(n)}finally{Fe(o),Gr(5,n,i)}}function Wv(n,i,o,l){const u=o[l]<0,m=o[l+1],x=n[u?-o[l]:o[l]];u?n[fi]>>14<n[Tr]>>16&&(3&n[fi])===i&&(n[fi]+=16384,Qi(x,m)):Qi(x,m)}const Ta=-1;class Kl{constructor(i,o,l){this.factory=i,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=l}}function Nu(n){return n!==Ta}function Ql(n){return 32767&n}function Fu(n,i){let o=function Yv(n){return n>>16}(n),l=i;for(;o>0;)l=l[ye],o--;return l}let xf=!0;function Cc(n){const i=xf;return xf=n,i}const ms=255,qv=5;let Ef=0;const To={};function xo(n,i){const o=Em(n,i);if(-1!==o)return o;const l=i[hn];l.firstCreatePass&&(n.injectorIndex=i.length,xm(l.data,n),xm(i,null),xm(l.blueprint,null));const u=Mf(n,i),m=n.injectorIndex;if(Nu(u)){const y=Ql(u),x=Fu(u,i),C=x[hn].data;for(let U=0;U<8;U++)i[m+U]=x[y+U]|C[y+U]}return i[m+8]=u,m}function xm(n,i){n.push(0,0,0,0,0,0,0,0,i)}function Em(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function Mf(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,l=null,u=i;for(;null!==u;){if(l=Tc(u),null===l)return Ta;if(o++,u=u[ye],-1!==l.injectorIndex)return l.injectorIndex|o<<16}return Ta}function Mm(n,i,o){!function Bu(n,i,o){let l;"string"==typeof o?l=o.charCodeAt(0)||0:o.hasOwnProperty(Cr)&&(l=o[Cr]),null==l&&(l=o[Cr]=Ef++);const u=l&ms;i.data[n+(u>>qv)]|=1<<u}(n,i,o)}function Cl(n,i,o){if(o&Ti.Optional||void 0!==n)return n;Lr()}function wf(n,i,o,l){if(o&Ti.Optional&&void 0===l&&(l=null),!(o&(Ti.Self|Ti.Host))){const u=n[no],m=li(void 0);try{return u?u.get(i,l,o&Ti.Optional):Mo(i,l,o&Ti.Optional)}finally{li(m)}}return Cl(l,0,o)}function Eo(n,i,o,l=Ti.Default,u){if(null!==n){if(2048&i[fi]&&!(l&Ti.Self)){const y=function Ub(n,i,o,l,u){let m=n,y=i;for(;null!==m&&null!==y&&2048&y[fi]&&!(512&y[fi]);){const x=Ac(m,y,o,l|Ti.Self,To);if(x!==To)return x;let C=m.parent;if(!C){const U=y[Lo];if(U){const W=U.get(o,To,l);if(W!==To)return W}C=Tc(y),y=y[ye]}m=C}return u}(n,i,o,l,To);if(y!==To)return y}const m=Ac(n,i,o,l,To);if(m!==To)return m}return wf(i,o,l,u)}function Ac(n,i,o,l,u){const m=function kb(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(Cr)?n[Cr]:void 0;return"number"==typeof i?i>=0?i&ms:Af:i}(o);if("function"==typeof m){if(!Ga(i,n,l))return l&Ti.Host?Cl(u,0,l):wf(i,o,l,u);try{let y;if(y=m(l),null!=y||l&Ti.Optional)return y;Lr()}finally{S()}}else if("number"==typeof m){let y=null,x=Em(n,i),C=Ta,U=l&Ti.Host?i[Kt][Ar]:null;for((-1===x||l&Ti.SkipSelf)&&(C=-1===x?Mf(n,i):i[x+8],C!==Ta&&Xv(l,!1)?(y=i[hn],x=Ql(C),i=Fu(C,i)):x=-1);-1!==x;){const W=i[hn];if(Cf(m,x,W.data)){const J=ku(x,i,o,y,l,U);if(J!==To)return J}C=i[x+8],C!==Ta&&Xv(l,i[hn].data[x+8]===U)&&Cf(m,x,i)?(y=W,x=Ql(C),i=Fu(C,i)):x=-1}}return u}function ku(n,i,o,l,u,m){const y=i[hn],x=y.data[n+8],W=Sf(x,y,o,null==l?ol(x)&&xf:l!=y&&0!=(3&x.type),u&Ti.Host&&m===x);return null!==W?ll(i,y,W,x):To}function Sf(n,i,o,l,u){const m=n.providerIndexes,y=i.data,x=1048575&m,C=n.directiveStart,W=m>>20,Me=u?x+W:n.directiveEnd;for(let ze=l?x:x+W;ze<Me;ze++){const St=y[ze];if(ze<C&&o===St||ze>=C&&St.type===o)return ze}if(u){const ze=y[C];if(ze&&vo(ze)&&ze.type===o)return C}return null}function ll(n,i,o,l){let u=n[o];const m=i.data;if(function jv(n){return n instanceof Kl}(u)){const y=u;y.resolving&&function Qs(n,i){const o=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new gn(-200,`Circular dependency in DI detected for ${n}${o}`)}(function Ei(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Mn(n)}(m[o]));const x=Cc(y.canSeeViewProviders);y.resolving=!0;const U=y.injectImpl?li(y.injectImpl):null;Ga(n,l,Ti.Default);try{u=n[o]=y.factory(void 0,m,n,l),i.firstCreatePass&&o>=l.directiveStart&&function _o(n,i,o){const{ngOnChanges:l,ngOnInit:u,ngDoCheck:m}=i.type.prototype;if(l){var y,x;const J=bi(i);(null!==(y=o.preOrderHooks)&&void 0!==y?y:o.preOrderHooks=[]).push(n,J),(null!==(x=o.preOrderCheckHooks)&&void 0!==x?x:o.preOrderCheckHooks=[]).push(n,J)}var C,U,W;u&&(null!==(C=o.preOrderHooks)&&void 0!==C?C:o.preOrderHooks=[]).push(0-n,u),m&&((null!==(U=o.preOrderHooks)&&void 0!==U?U:o.preOrderHooks=[]).push(n,m),(null!==(W=o.preOrderCheckHooks)&&void 0!==W?W:o.preOrderCheckHooks=[]).push(n,m))}(o,m[o],i)}finally{null!==U&&li(U),Cc(x),y.resolving=!1,S()}}return u}function Cf(n,i,o){return!!(o[i+(n>>qv)]&1<<n)}function Xv(n,i){return!(n&Ti.Self||n&Ti.Host&&i)}class ss{constructor(i,o){this._tNode=i,this._lView=o}get(i,o,l){return Eo(this._tNode,this._lView,i,Ze(l),o)}}function Af(){return new ss(zr(),qt())}function Tf(n){return Ps(()=>{const i=n.prototype.constructor,o=i[Jn]||Df(i),l=Object.prototype;let u=Object.getPrototypeOf(n.prototype).constructor;for(;u&&u!==l;){const m=u[Jn]||Df(u);if(m&&m!==o)return m;u=Object.getPrototypeOf(u)}return m=>new m})}function Df(n){return mi(n)?()=>{const i=Df(Rn(n));return i&&i()}:de(n)}function Tc(n){const i=n[hn],o=i.type;return 2===o?i.declTNode:1===o?n[Ar]:null}function wm(n){return function Bb(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const o=n.attrs;if(o){const l=o.length;let u=0;for(;u<l;){const m=o[u];if(ka(m))break;if(0===m)u+=2;else if("number"==typeof m)for(u++;u<l&&"string"==typeof o[u];)u++;else{if(m===i)return o[u+1];u+=2}}}return null}(zr(),n)}const zu="__parameters__";function $u(n,i,o){return Ps(()=>{const l=function Sm(n){return function(...o){if(n){const l=n(...o);for(const u in l)this[u]=l[u]}}}(i);function u(...m){if(this instanceof u)return l.apply(this,m),this;const y=new u(...m);return x.annotation=y,x;function x(C,U,W){const J=C.hasOwnProperty(zu)?C[zu]:Object.defineProperty(C,zu,{value:[]})[zu];for(;J.length<=W;)J.push(null);return(J[W]=J[W]||[]).push(y),C}}return o&&(u.prototype=Object.create(o.prototype)),u.prototype.ngMetadataName=n,u.annotationCls=u,u})}function Wu(n,i){n.forEach(o=>Array.isArray(o)?Wu(o,i):i(o))}function Kv(n,i,o){i>=n.length?n.push(o):n.splice(i,0,o)}function If(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function Yd(n,i){const o=[];for(let l=0;l<n;l++)o.push(i);return o}function fa(n,i,o){let l=ju(n,i);return l>=0?n[1|l]=o:(l=~l,function Jv(n,i,o,l){let u=n.length;if(u==i)n.push(o,l);else if(1===u)n.push(l,n[0]),n[0]=o;else{for(u--,n.push(n[u-1],n[u]);u>i;)n[u]=n[u-2],u--;n[i]=o,n[i+1]=l}}(n,l,i,o)),l}function Am(n,i){const o=ju(n,i);if(o>=0)return n[1|o]}function ju(n,i){return function Qv(n,i,o){let l=0,u=n.length>>o;for(;u!==l;){const m=l+(u-l>>1),y=n[m<<o];if(i===y)return m<<o;y>i?u=m:l=m+1}return~(u<<o)}(n,i,1)}const Pf=Pr($u("Optional"),8),Of=Pr($u("SkipSelf"),4),Dc=new ue("ENVIRONMENT_INITIALIZER"),iy=new ue("INJECTOR",-1),Im=new ue("INJECTOR_DEF_TYPES");class Nf{get(i,o=Xe){if(o===Xe){const l=new Error(`NullInjectorError: No provider for ${ai(i)}!`);throw l.name="NullInjectorError",l}return o}}function ax(...n){return{\u0275providers:sy(0,n),\u0275fromNgModule:!0}}function sy(n,...i){const o=[],l=new Set;let u;const m=y=>{o.push(y)};return Wu(i,y=>{const x=y;Ff(x,m,[],l)&&(u||(u=[]),u.push(x))}),void 0!==u&&oy(u,m),o}function oy(n,i){for(let o=0;o<n.length;o++){const{ngModule:l,providers:u}=n[o];Rm(u,m=>{i(m,l)})}}function Ff(n,i,o,l){if(!(n=Rn(n)))return!1;let u=null,m=As(n);const y=!m&&Yi(n);if(m||y){if(y&&!y.standalone)return!1;u=n}else{const C=n.ngModule;if(m=As(C),!m)return!1;u=C}const x=l.has(u);if(y){if(x)return!1;if(l.add(u),y.dependencies){const C="function"==typeof y.dependencies?y.dependencies():y.dependencies;for(const U of C)Ff(U,i,o,l)}}else{if(!m)return!1;{if(null!=m.imports&&!x){let U;l.add(u);try{Wu(m.imports,W=>{Ff(W,i,o,l)&&(U||(U=[]),U.push(W))})}finally{}void 0!==U&&oy(U,i)}if(!x){const U=de(u)||(()=>new u);i({provide:u,useFactory:U,deps:Oi},u),i({provide:Im,useValue:u,multi:!0},u),i({provide:Dc,useValue:()=>ee(u),multi:!0},u)}const C=m.providers;if(null!=C&&!x){const U=n;Rm(C,W=>{i(W,U)})}}}return u!==n&&void 0!==n.providers}function Rm(n,i){for(let o of n)di(o)&&(o=o.\u0275providers),Array.isArray(o)?Rm(o,i):i(o)}const lx=kt({provide:String,useValue:kt});function Pm(n){return null!==n&&"object"==typeof n&&lx in n}function Ic(n){return"function"==typeof n}const Om=new ue("Set Injector scope."),Bf={},ux={};let Lm;function kf(){return void 0===Lm&&(Lm=new Nf),Lm}class cl{}class qu extends cl{get destroyed(){return this._destroyed}constructor(i,o,l,u){super(),this.parent=o,this.source=l,this.scopes=u,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fm(i,y=>this.processProvider(y)),this.records.set(iy,Xu(void 0,this)),u.has("environment")&&this.records.set(cl,Xu(void 0,this));const m=this.records.get(Om);null!=m&&"string"==typeof m.value&&this.scopes.add(m.value),this.injectorDefTypes=new Set(this.get(Im,Oi,Ti.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();const i=this._onDestroyHooks;this._onDestroyHooks=[];for(const o of i)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const o=dr(this),l=li(void 0);try{return i()}finally{dr(o),li(l)}}get(i,o=Xe,l=Ti.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(us))return i[us](this);l=Ze(l);const m=dr(this),y=li(void 0);try{if(!(l&Ti.SkipSelf)){let C=this.records.get(i);if(void 0===C){const U=function mx(n){return"function"==typeof n||"object"==typeof n&&n instanceof ue}(i)&&Cs(i);C=U&&this.injectableDefInScope(U)?Xu(Nm(i),Bf):null,this.records.set(i,C)}if(null!=C)return this.hydrate(i,C)}return(l&Ti.Self?kf():this.parent).get(i,o=l&Ti.Optional&&o===Xe?null:o)}catch(x){if("NullInjectorError"===x.name){if((x[Yt]=x[Yt]||[]).unshift(ai(i)),m)throw x;return function Ro(n,i,o,l){const u=n[Yt];throw i[Gn]&&u.unshift(i[Gn]),n.message=function Zr(n,i,o,l=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let u=ai(i);if(Array.isArray(i))u=i.map(ai).join(" -> ");else if("object"==typeof i){let m=[];for(let y in i)if(i.hasOwnProperty(y)){let x=i[y];m.push(y+":"+("string"==typeof x?JSON.stringify(x):ai(x)))}u=`{${m.join(", ")}}`}return`${o}${l?"("+l+")":""}[${u}]: ${n.replace(Zt,"\n  ")}`}("\n"+n.message,u,o,l),n.ngTokenPath=u,n[Yt]=null,n}(x,i,"R3InjectorError",this.source)}throw x}finally{li(y),dr(m)}}resolveInjectorInitializers(){const i=dr(this),o=li(void 0);try{const u=this.get(Dc,Oi,Ti.Self);for(const m of u)m()}finally{dr(i),li(o)}}toString(){const i=[],o=this.records;for(const l of o.keys())i.push(ai(l));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new gn(205,!1)}processProvider(i){let o=Ic(i=Rn(i))?i:Rn(i&&i.provide);const l=function hx(n){return Pm(n)?Xu(void 0,n.useValue):Xu(cy(n),Bf)}(i);if(Ic(i)||!0!==i.multi)this.records.get(o);else{let u=this.records.get(o);u||(u=Xu(void 0,Bf,!0),u.factory=()=>gi(u.multi),this.records.set(o,u)),o=i,u.multi.push(i)}this.records.set(o,l)}hydrate(i,o){return o.value===Bf&&(o.value=ux,o.value=o.factory()),"object"==typeof o.value&&o.value&&function px(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this._ngOnDestroyHooks.add(o.value),o.value}injectableDefInScope(i){if(!i.providedIn)return!1;const o=Rn(i.providedIn);return"string"==typeof o?"any"===o||this.scopes.has(o):this.injectorDefTypes.has(o)}removeOnDestroy(i){const o=this._onDestroyHooks.indexOf(i);-1!==o&&this._onDestroyHooks.splice(o,1)}}function Nm(n){const i=Cs(n),o=null!==i?i.factory:de(n);if(null!==o)return o;if(n instanceof ue)throw new gn(204,!1);if(n instanceof Function)return function dx(n){const i=n.length;if(i>0)throw Yd(i,"?"),new gn(204,!1);const o=function po(n){return n&&(n[Sr]||n[Ts])||null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new gn(204,!1)}function cy(n,i,o){let l;if(Ic(n)){const u=Rn(n);return de(u)||Nm(u)}if(Pm(n))l=()=>Rn(n.useValue);else if(function ly(n){return!(!n||!n.useFactory)}(n))l=()=>n.useFactory(...gi(n.deps||[]));else if(function ay(n){return!(!n||!n.useExisting)}(n))l=()=>ee(Rn(n.useExisting));else{const u=Rn(n&&(n.useClass||n.provide));if(!function fx(n){return!!n.deps}(n))return de(u)||Nm(u);l=()=>new u(...gi(n.deps))}return l}function Xu(n,i,o=!1){return{factory:n,value:i,multi:o?[]:void 0}}function Fm(n,i){for(const o of n)Array.isArray(o)?Fm(o,i):o&&di(o)?Fm(o.\u0275providers,i):i(o)}function gx(n,i){n instanceof qu&&n.assertNotDestroyed();const l=dr(n),u=li(void 0);try{return i()}finally{dr(l),li(u)}}function xx(n,i=null,o=null,l){const u=Ex(n,i,o,l);return u.resolveInjectorInitializers(),u}function Ex(n,i=null,o=null,l,u=new Set){const m=[o||Oi,ax(n)];return l=l||("object"==typeof n?void 0:ai(n)),new qu(m,i||kf(),l||null,u)}let fy,ja=(()=>{var n;class i{static create(l,u){if(Array.isArray(l))return xx({name:""},u,l,"");{var m;const y=null!==(m=l.name)&&void 0!==m?m:"";return xx({name:y},l.parent,l.providers,y)}}}return(n=i).THROW_IF_NOT_FOUND=Xe,n.NULL=new Nf,n.\u0275prov=Hi({token:n,providedIn:"any",factory:()=>ee(iy)}),n.__NG_ELEMENT_ID__=-1,i})();function Rc(n){return!!Os(n)}function gC(n){fy=n}const wx=new ue("AppId",{providedIn:"root",factory:()=>vC}),vC="ng",Sx=new ue("Platform Initializer"),py=new ue("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),yC=new ue("CSP nonce",{providedIn:"root",factory:()=>{var n;return(null===(n=function Pc(){if(void 0!==fy)return fy;if(typeof document<"u")return document;throw new gn(210,!1)}().body)||void 0===n||null===(n=n.querySelector("[ngCspNonce]"))||void 0===n?void 0:n.getAttribute("ngCspNonce"))||null}});function Da(n){return n instanceof Function?n():n}function Hf(n){return 128==(128&n.flags)}var Gf=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Gf||{});const Ox=/^>|^->|<!--|-->|--!>|<!-$/g,Lx=/(<|>)/g,Nx="\u200b$1\u200b";const Wf=new Map;let My=0;const Bs="__ngContext__";function co(n,i){Ds(i)?(n[Bs]=i[Ls],function Sy(n){Wf.set(n[Ls],n)}(i)):n[Bs]=i}let Wm;function jm(n,i){return Wm(n,i)}function Qd(n){const i=n[rr];return Nr(i)?i[rr]:i}function Oy(n){return Ny(n[ae])}function Ly(n){return Ny(n[rs])}function Ny(n){for(;null!==n&&!Nr(n);)n=n[rs];return n}function Qu(n,i,o,l,u){if(null!=l){let m,y=!1;Nr(l)?m=l:Ds(l)&&(y=!0,l=l[vr]);const x=kr(l);0===n&&null!==o?null==u?Uy(i,o,x):Bc(i,o,x,u||null,!0):1===n&&null!==o?Bc(i,o,x,u||null,!0):2===n?function Xf(n,i,o){const l=th(n,i);l&&function Jx(n,i,o,l){n.removeChild(i,o,l)}(n,l,i,o)}(i,x,y):3===n&&i.destroyNode(x),null!=m&&function Qm(n,i,o,l,u){const m=o[ko];m!==kr(o)&&Qu(i,n,l,m,u);for(let x=Kr;x<o.length;x++){const C=o[x];ed(C[hn],C,n,i,l,m)}}(i,n,m,o,u)}}function Ym(n,i){return n.createComment(function $m(n){return n.replace(Ox,i=>i.replace(Lx,Nx))}(i))}function Yf(n,i,o){return n.createElement(i,o)}function By(n,i){const o=n[Fi],l=o.indexOf(i);o.splice(l,1)}function eh(n,i){if(n.length<=Kr)return;const o=Kr+i,l=n[o];if(l){const u=l[ci];null!==u&&u!==n&&By(u,l),i>0&&(n[o-1][rs]=l[rs]);const m=If(n,Kr+i);!function Gx(n,i){ed(n,i,i[L],2,null,null),i[vr]=null,i[Ar]=null}(l[hn],l);const y=m[Vr];null!==y&&y.detachView(m[hn]),l[rr]=null,l[rs]=null,l[fi]&=-129}return l}function qf(n,i){if(!(256&i[fi])){const o=i[L];o.destroyNode&&ed(n,i,o,3,null,null),function Yx(n){let i=n[ae];if(!i)return qm(n[hn],n);for(;i;){let o=null;if(Ds(i))o=i[ae];else{const l=i[Kr];l&&(o=l)}if(!o){for(;i&&!i[rs]&&i!==n;)Ds(i)&&qm(i[hn],i),i=i[rr];null===i&&(i=n),Ds(i)&&qm(i[hn],i),o=i&&i[rs]}i=o}}(i)}}function qm(n,i){if(!(256&i[fi])){i[fi]&=-129,i[fi]|=256,i[No]&&function $t(n){if(He(n),bt(n))for(let i=0;i<n.producerNode.length;i++)st(n.producerNode[i],n.producerIndexOfThis[i]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(i[No]),function Kx(n,i){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let l=0;l<o.length;l+=2){const u=i[o[l]];if(!(u instanceof Kl)){const m=o[l+1];if(Array.isArray(m))for(let y=0;y<m.length;y+=2){const x=u[m[y]],C=m[y+1];Gr(4,x,C);try{C.call(x)}finally{Gr(5,x,C)}}else{Gr(4,u,m);try{m.call(u)}finally{Gr(5,u,m)}}}}}(n,i),function Zx(n,i){const o=n.cleanup,l=i[Oo];if(null!==o)for(let m=0;m<o.length-1;m+=2)if("string"==typeof o[m]){const y=o[m+3];y>=0?l[y]():l[-y].unsubscribe(),m+=2}else o[m].call(l[o[m+1]]);null!==l&&(i[Oo]=null);const u=i[go];if(null!==u){i[go]=null;for(let m=0;m<u.length;m++)(0,u[m])()}}(n,i),1===i[hn].type&&i[L].destroy();const o=i[ci];if(null!==o&&Nr(i[rr])){o!==i[rr]&&By(o,i);const l=i[Vr];null!==l&&l.detachView(n)}!function Cy(n){Wf.delete(n[Ls])}(i)}}function Xm(n,i,o){return function ky(n,i,o){let l=i;for(;null!==l&&40&l.type;)l=(i=l).parent;if(null===l)return o[vr];{const{componentOffset:u}=l;if(u>-1){const{encapsulation:m}=n.data[l.directiveStart+u];if(m===tr.None||m===tr.Emulated)return null}return Ws(l,o)}}(n,i.parent,o)}function Bc(n,i,o,l,u){n.insertBefore(i,o,l,u)}function Uy(n,i,o){n.appendChild(i,o)}function Vy(n,i,o,l,u){null!==l?Bc(n,i,o,l,u):Uy(n,i,o)}function th(n,i){return n.parentNode(i)}function nh(n,i,o){return Hy(n,i,o)}let Km,Jf,Hy=function Zm(n,i,o){return 40&n.type?Ws(n,o):null};function ih(n,i,o,l){const u=Xm(n,l,i),m=i[L],x=nh(l.parent||i[Ar],l,i);if(null!=u)if(Array.isArray(o))for(let C=0;C<o.length;C++)Vy(m,u,o[C],x,!1);else Vy(m,u,o,x,!1);void 0!==Km&&Km(m,l,i,o,u)}function rh(n,i){if(null!==i){const o=i.type;if(3&o)return Ws(i,n);if(4&o)return Jm(-1,n[i.index]);if(8&o){const l=i.child;if(null!==l)return rh(n,l);{const u=n[i.index];return Nr(u)?Jm(-1,u):kr(u)}}if(32&o)return jm(i,n)()||kr(n[i.index]);{const l=Gy(n,i);return null!==l?Array.isArray(l)?l[0]:rh(Qd(n[Kt]),l):rh(n,i.next)}}return null}function Gy(n,i){return null!==i?n[Kt][Ar].projection[i.projection]:null}function Jm(n,i){const o=Kr+n+1;if(o<i.length){const l=i[o],u=l[hn].firstChild;if(null!==u)return rh(l,u)}return i[ko]}function kc(n,i,o,l,u,m,y){for(;null!=o;){const x=l[o.index],C=o.type;if(y&&0===i&&(x&&co(kr(x),l),o.flags|=2),32!=(32&o.flags))if(8&C)kc(n,i,o.child,l,u,m,!1),Qu(i,n,u,x,m);else if(32&C){const U=jm(o,l);let W;for(;W=U();)Qu(i,n,u,W,m);Qu(i,n,u,x,m)}else 16&C?Yy(n,i,l,o,u,m):Qu(i,n,u,x,m);o=y?o.projectionNext:o.next}}function ed(n,i,o,l,u,m){kc(o,l,n.firstChild,i,u,m,!1)}function Yy(n,i,o,l,u,m){const y=o[Kt],C=y[Ar].projection[l.projection];if(Array.isArray(C))for(let U=0;U<C.length;U++)Qu(i,n,u,C[U],m);else{let U=C;const W=y[rr];Hf(l)&&(U.flags|=128),kc(n,i,U,W,u,m,!0)}}function qy(n,i,o){""===o?n.removeAttribute(i,"class"):n.setAttribute(i,"class",o)}function eg(n,i,o){const{mergedAttrs:l,classes:u,styles:m}=o;null!==l&&qo(n,i,l),null!==u&&qy(n,i,u),null!==m&&function tE(n,i,o){n.setAttribute(i,"style",o)}(n,i,m)}function Ky(n){var i;return(null===(i=function tg(){if(void 0===Jf&&(Jf=null,gr.trustedTypes))try{Jf=gr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Jf}())||void 0===i?void 0:i.createScriptURL(n))||n}class Jy{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Or})`}}function tc(n){return n instanceof Jy?n.changingThisBreaksApplicationSecurity:n}function sh(n,i){const o=function lE(n){return n instanceof Jy&&n.getTypeName()||null}(n);if(null!=o&&o!==i){if("ResourceURL"===o&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${o} (see ${Or})`)}return o===i}const mE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Ya=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Ya||{});function og(n){const i=nc();return i?i.sanitize(Ya.URL,n)||"":sh(n,"URL")?tc(n):function ng(n){return(n=String(n)).match(mE)?n:"unsafe:"+n}(Mn(n))}function ch(n){const i=nc();if(i)return Ky(i.sanitize(Ya.RESOURCE_URL,n)||"");if(sh(n,"ResourceURL"))return Ky(tc(n));throw new gn(904,!1)}function lg(n,i,o){return function ag(n,i){return"src"===i&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===i&&("base"===n||"link"===n)?ch:og}(i,o)(n)}function nc(){const n=qt();return n&&n[$].sanitizer}class c0{}let gh=(n,i,o)=>null;function Gc(n,i,o=!1){return gh(n,i,o)}class m0{}class g0{}class rp{resolveComponentFactory(i){throw function v0(n){const i=Error(`No component factory found for ${ai(n)}.`);return i.ngComponent=n,i}(i)}}let Wc=(()=>{class i{}return i.NULL=new rp,i})();function xE(){return jc(zr(),qt())}function jc(n,i){return new sp(Ws(n,i))}let sp=(()=>{class i{constructor(l){this.nativeElement=l}}return i.__NG_ELEMENT_ID__=xE,i})();function OC(n){return n instanceof sp?n.nativeElement:n}class _0{}let LC=(()=>{class i{constructor(){this.destroyNode=null}}return i.__NG_ELEMENT_ID__=()=>function NC(){const n=qt(),o=yo(zr().index,n);return(Ds(o)?o:n)[L]}(),i})(),FC=(()=>{var n;class i{}return(n=i).\u0275prov=Hi({token:n,providedIn:"root",factory:()=>null}),i})();const Ia={};function hg(n){const i=Fe(null);try{return n()}finally{Fe(i)}}function ld(n){return!!fg(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function fg(n){return null!==n&&("function"==typeof n||"object"==typeof n)}class w0{constructor(){}supports(i){return ld(i)}create(i){return new xh(i)}}const ME=(n,i)=>i;class xh{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||ME}forEachItem(i){let o;for(o=this._itHead;null!==o;o=o._next)i(o)}forEachOperation(i){let o=this._itHead,l=this._removalsHead,u=0,m=null;for(;o||l;){const y=!l||o&&o.currentIndex<C0(l,u,m)?o:l,x=C0(y,u,m),C=y.currentIndex;if(y===l)u--,l=l._nextRemoved;else if(o=o._next,null==y.previousIndex)u++;else{m||(m=[]);const U=x-u,W=C-u;if(U!=W){for(let Me=0;Me<U;Me++){const ze=Me<m.length?m[Me]:m[Me]=0,St=ze+Me;W<=St&&St<U&&(m[Me]=ze+1)}m[y.previousIndex]=W-U}}x!==C&&i(y,x,C)}}forEachPreviousItem(i){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)i(o)}forEachAddedItem(i){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)i(o)}forEachMovedItem(i){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)i(o)}forEachRemovedItem(i){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)i(o)}forEachIdentityChange(i){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)i(o)}diff(i){if(null==i&&(i=[]),!ld(i))throw new gn(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let u,m,y,o=this._itHead,l=!1;if(Array.isArray(i)){this.length=i.length;for(let x=0;x<this.length;x++)m=i[x],y=this._trackByFn(x,m),null!==o&&Object.is(o.trackById,y)?(l&&(o=this._verifyReinsertion(o,m,y,x)),Object.is(o.item,m)||this._addIdentityChange(o,m)):(o=this._mismatch(o,m,y,x),l=!0),o=o._next}else u=0,function M0(n,i){if(Array.isArray(n))for(let o=0;o<n.length;o++)i(n[o]);else{const o=n[Symbol.iterator]();let l;for(;!(l=o.next()).done;)i(l.value)}}(i,x=>{y=this._trackByFn(u,x),null!==o&&Object.is(o.trackById,y)?(l&&(o=this._verifyReinsertion(o,x,y,u)),Object.is(o.item,x)||this._addIdentityChange(o,x)):(o=this._mismatch(o,x,y,u),l=!0),o=o._next,u++}),this.length=u;return this._truncate(o),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,o,l,u){let m;return null===i?m=this._itTail:(m=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(i.item,o)||this._addIdentityChange(i,o),this._reinsertAfter(i,m,u)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(l,u))?(Object.is(i.item,o)||this._addIdentityChange(i,o),this._moveAfter(i,m,u)):i=this._addAfter(new wE(o,l),m,u),i}_verifyReinsertion(i,o,l,u){let m=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==m?i=this._reinsertAfter(m,i._prev,u):i.currentIndex!=u&&(i.currentIndex=u,this._addToMoves(i,u)),i}_truncate(i){for(;null!==i;){const o=i._next;this._addToRemovals(this._unlink(i)),i=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,o,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const u=i._prevRemoved,m=i._nextRemoved;return null===u?this._removalsHead=m:u._nextRemoved=m,null===m?this._removalsTail=u:m._prevRemoved=u,this._insertAfter(i,o,l),this._addToMoves(i,l),i}_moveAfter(i,o,l){return this._unlink(i),this._insertAfter(i,o,l),this._addToMoves(i,l),i}_addAfter(i,o,l){return this._insertAfter(i,o,l),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,o,l){const u=null===o?this._itHead:o._next;return i._next=u,i._prev=o,null===u?this._itTail=i:u._prev=i,null===o?this._itHead=i:o._next=i,null===this._linkedRecords&&(this._linkedRecords=new S0),this._linkedRecords.put(i),i.currentIndex=l,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const o=i._prev,l=i._next;return null===o?this._itHead=l:o._next=l,null===l?this._itTail=o:l._prev=o,i}_addToMoves(i,o){return i.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new S0),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,o){return i.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class wE{constructor(i,o){this.item=i,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class SE{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,o){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===o||o<=l.currentIndex)&&Object.is(l.trackById,i))return l;return null}remove(i){const o=i._prevDup,l=i._nextDup;return null===o?this._head=l:o._nextDup=l,null===l?this._tail=o:l._prevDup=o,null===this._head}}class S0{constructor(){this.map=new Map}put(i){const o=i.trackById;let l=this.map.get(o);l||(l=new SE,this.map.set(o,l)),l.add(i)}get(i,o){const u=this.map.get(i);return u?u.get(i,o):null}remove(i){const o=i.trackById;return this.map.get(o).remove(i)&&this.map.delete(o),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function C0(n,i,o){const l=n.previousIndex;if(null===l)return l;let u=0;return o&&l<o.length&&(u=o[l]),l+i+u}class cd{constructor(){}supports(i){return i instanceof Map||fg(i)}create(){return new A0}}class A0{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let o;for(o=this._mapHead;null!==o;o=o._next)i(o)}forEachPreviousItem(i){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)i(o)}forEachChangedItem(i){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)i(o)}forEachAddedItem(i){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)i(o)}forEachRemovedItem(i){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)i(o)}diff(i){if(i){if(!(i instanceof Map||fg(i)))throw new gn(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(i,(l,u)=>{if(o&&o.key===u)this._maybeAddToChanges(o,l),this._appendAfter=o,o=o._next;else{const m=this._getOrCreateRecordForKey(u,l);o=this._insertBeforeOrAppend(o,m)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let l=o;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,o){if(i){const l=i._prev;return o._next=i,o._prev=l,i._prev=o,l&&(l._next=o),i===this._mapHead&&(this._mapHead=o),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(i,o){if(this._records.has(i)){const u=this._records.get(i);this._maybeAddToChanges(u,o);const m=u._prev,y=u._next;return m&&(m._next=y),y&&(y._prev=m),u._next=null,u._prev=null,u}const l=new CE(i);return this._records.set(i,l),l.currentValue=o,this._addToAdditions(l),l}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,o){Object.is(o,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=o,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,o){i instanceof Map?i.forEach(o):Object.keys(i).forEach(l=>o(i[l],l))}}class CE{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ap(){return new pg([new w0])}let pg=(()=>{var n;class i{constructor(l){this.factories=l}static create(l,u){if(null!=u){const m=u.factories.slice();l=l.concat(m)}return new i(l)}static extend(l){return{provide:i,useFactory:u=>i.create(l,u||ap()),deps:[[i,new Of,new Pf]]}}find(l){const u=this.factories.find(m=>m.supports(l));if(null!=u)return u;throw new gn(901,!1)}}return(n=i).\u0275prov=Hi({token:n,providedIn:"root",factory:ap}),i})();function mg(){return new lp([new cd])}let lp=(()=>{var n;class i{constructor(l){this.factories=l}static create(l,u){if(u){const m=u.factories.slice();l=l.concat(m)}return new i(l)}static extend(l){return{provide:i,useFactory:u=>i.create(l,u||mg()),deps:[[i,new Of,new Pf]]}}find(l){const u=this.factories.find(m=>m.supports(l));if(u)return u;throw new gn(901,!1)}}return(n=i).\u0275prov=Hi({token:n,providedIn:"root",factory:mg}),i})();function Eh(n,i,o,l,u=!1){for(;null!==o;){const m=i[o.index];null!==m&&l.push(kr(m)),Nr(m)&&Mh(m,l);const y=o.type;if(8&y)Eh(n,i,o.child,l);else if(32&y){const x=jm(o,i);let C;for(;C=x();)l.push(C)}else if(16&y){const x=Gy(i,o);if(Array.isArray(x))l.push(...x);else{const C=Qd(i[Kt]);Eh(C[hn],C,x,l,!0)}}o=u?o.projectionNext:o.next}return l}function Mh(n,i){for(let o=Kr;o<n.length;o++){const l=n[o],u=l[hn].firstChild;null!==u&&Eh(l[hn],l,u,i)}n[ko]!==n[vr]&&i.push(n[ko])}let wh=[];const _g={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{wc(n.lView)},consumerOnSignalRead(){this.lView[No]=this}};function dd(n){return n.ngOriginalError}class Xa{constructor(){this._console=console}handleError(i){const o=this._findOriginalError(i);this._console.error("ERROR",i),o&&this._console.error("ORIGINAL ERROR",o)}_findOriginalError(i){let o=i&&dd(i);for(;o&&dd(o);)o=dd(o);return o||null}}const cp=new ue("",{providedIn:"root",factory:()=>re(Xa).handleError.bind(void 0)}),qc=new ue("",{providedIn:"root",factory:()=>!1}),qi={};function L0(n){N0(sr(),qt(),le()+n,!1)}function N0(n,i,o,l){if(!l)if(3==(3&i[fi])){const m=n.preOrderCheckHooks;null!==m&&Ho(i,m,o)}else{const m=n.preOrderHooks;null!==m&&bo(i,m,0,o)}it(o)}function sc(n,i=Ti.Default){const o=qt();return null===o?ee(n,i):Eo(zr(),o,Rn(n),i)}function F0(){throw new Error("invalid")}function up(n,i,o,l,u,m,y,x,C,U,W){const J=i.blueprint.slice();return J[vr]=u,J[fi]=204|l,(null!==U||n&&2048&n[fi])&&(J[fi]|=2048),El(J),J[rr]=J[ye]=n,J[_i]=o,J[$]=y||n&&n[$],J[L]=x||n&&n[L],J[no]=C||n&&n[no]||null,J[Ar]=m,J[Ls]=function wy(){return My++}(),J[xr]=W,J[Lo]=U,J[Kt]=2==i.type?n[Kt]:J,J}function Wr(n,i,o,l,u){let m=n.data[i];if(null===m)m=function fd(n,i,o,l,u){const m=Co(),y=Iu(),C=n.data[i]=function Eg(n,i,o,l,u,m){let y=i?i.injectorIndex:-1,x=0;return Is()&&(x|=128),{type:o,index:l,insertBeforeIndex:null,injectorIndex:y,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:x,providerIndexes:0,value:u,attrs:m,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?m:m&&m.parent,o,i,l,u);return null===n.firstChild&&(n.firstChild=C),null!==m&&(y?null==m.child&&null!==C.parent&&(m.child=C):null===m.next&&(m.next=C,C.prev=m)),C}(n,i,o,l,u),function gm(){return hi.lFrame.inI18n}()&&(m.flags|=32);else if(64&m.type){m.type=o,m.value=l,m.attrs=u;const y=function Ao(){const n=hi.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();m.injectorIndex=null===y?-1:y.injectorIndex}return so(m,!0),m}function pd(n,i,o,l){if(0===o)return-1;const u=i.length;for(let m=0;m<o;m++)i.push(l),n.blueprint.push(l),n.data.push(null);return u}function Ch(n,i,o,l,u){const m=le(),y=2&l;try{it(-1),y&&i.length>Ai&&N0(n,i,Ai,!1),Gr(y?2:0,u),o(l,u)}finally{it(m),Gr(y?3:1,u)}}function md(n,i,o){if(xl(i)){const l=Fe(null);try{const m=i.directiveEnd;for(let y=i.directiveStart;y<m;y++){const x=n.data[y];x.contentQueries&&x.contentQueries(1,o[y],y)}}finally{Fe(l)}}}function bg(n,i,o){Tu()&&(function RE(n,i,o,l){const u=o.directiveStart,m=o.directiveEnd;ol(o)&&function NE(n,i,o){const l=Ws(i,n),u=B0(o);let y=16;o.signals?y=4096:o.onPush&&(y=64);const x=vd(n,up(n,u,null,y,l,i,null,n[$].rendererFactory.createRenderer(l,o),null,null,null));n[i.index]=x}(i,o,n.data[u+o.componentOffset]),n.firstCreatePass||xo(o,i),co(l,i);const y=o.initialInputs;for(let x=u;x<m;x++){const C=n.data[x],U=ll(i,n,x,o);co(U,i),null!==y&&FE(0,x-u,U,C,0,y),vo(C)&&(yo(o.index,i)[_i]=ll(i,n,x,o))}}(n,i,o,Ws(o,i)),64==(64&o.flags)&&Ag(n,i,o))}function Zc(n,i,o=Ws){const l=i.localNames;if(null!==l){let u=i.index+1;for(let m=0;m<l.length;m+=2){const y=l[m+1],x=-1===y?o(i,n):n[y];n[u++]=x}}}function B0(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=dp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):i}function dp(n,i,o,l,u,m,y,x,C,U,W){const J=Ai+l,Me=J+u,ze=function k0(n,i){const o=[];for(let l=0;l<i;l++)o.push(l<n?null:qi);return o}(J,Me),St="function"==typeof U?U():U;return ze[hn]={type:n,blueprint:ze,template:o,queries:null,viewQuery:x,declTNode:i,data:ze.slice().fill(null,J),bindingStartIndex:J,expandoStartIndex:Me,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof m?m():m,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:St,incompleteFirstPass:!1,ssrId:W}}let U0=n=>null;function H0(n,i,o,l){for(let u in n)if(n.hasOwnProperty(u)){o=null===o?{}:o;const m=n[u];null===l?$0(o,i,u,m):l.hasOwnProperty(u)&&$0(o,i,l[u],m)}return o}function $0(n,i,o,l){n.hasOwnProperty(o)?n[o].push(i,l):n[o]=[i,l]}function Th(n,i,o,l){if(Tu()){const u=null===l?null:{"":-1},m=function PE(n,i){const o=n.directiveRegistry;let l=null,u=null;if(o)for(let y=0;y<o.length;y++){const x=o[y];if(bl(i,x.selectors,!1))if(l||(l=[]),vo(x))if(null!==x.findHostDirectiveDefs){const C=[];u=u||new Map,x.findHostDirectiveDefs(x,C,u),l.unshift(...C,x),Tg(n,i,C.length)}else l.unshift(x),Tg(n,i,0);else{var m;u=u||new Map,null===(m=x.findHostDirectiveDefs)||void 0===m||m.call(x,x,l,u),l.push(x)}}return null===l?null:[l,u]}(n,o);let y,x;null===m?y=x=null:[y,x]=m,null!==y&&fp(n,i,o,y,u,x),u&&function W0(n,i,o){if(i){const l=n.localNames=[];for(let u=0;u<i.length;u+=2){const m=o[i[u+1]];if(null==m)throw new gn(-301,!1);l.push(i[u],m)}}}(o,l,u)}o.mergedAttrs=ba(o.mergedAttrs,o.attrs)}function fp(n,i,o,l,u,m){for(let J=0;J<l.length;J++)Mm(xo(o,i),n,l[J].type);!function j0(n,i,o){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+o,n.providerIndexes=i}(o,n.data.length,l.length);for(let J=0;J<l.length;J++){const Me=l[J];Me.providersResolver&&Me.providersResolver(Me)}let y=!1,x=!1,C=pd(n,i,l.length,null);for(let J=0;J<l.length;J++){const Me=l[J];o.mergedAttrs=ba(o.mergedAttrs,Me.hostAttrs),LE(n,o,i,C,Me),OE(C,Me,u),null!==Me.contentQueries&&(o.flags|=4),(null!==Me.hostBindings||null!==Me.hostAttrs||0!==Me.hostVars)&&(o.flags|=64);const ze=Me.type.prototype;var U,W;!y&&(ze.ngOnChanges||ze.ngOnInit||ze.ngDoCheck)&&((null!==(U=n.preOrderHooks)&&void 0!==U?U:n.preOrderHooks=[]).push(o.index),y=!0),x||!ze.ngOnChanges&&!ze.ngDoCheck||((null!==(W=n.preOrderCheckHooks)&&void 0!==W?W:n.preOrderCheckHooks=[]).push(o.index),x=!0),C++}!function Mg(n,i,o){const u=i.directiveEnd,m=n.data,y=i.attrs,x=[];let C=null,U=null;for(let W=i.directiveStart;W<u;W++){const J=m[W],Me=o?o.get(J):null,St=Me?Me.outputs:null;C=H0(J.inputs,W,C,Me?Me.inputs:null),U=H0(J.outputs,W,U,St);const on=null===C||null===y||nl(i)?null:Kc(C,W,y);x.push(on)}null!==C&&(C.hasOwnProperty("class")&&(i.flags|=8),C.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=x,i.inputs=C,i.outputs=U}(n,o,m)}function Ag(n,i,o){const l=o.directiveStart,u=o.directiveEnd,m=o.index,y=function ea(){return hi.lFrame.currentDirectiveIndex}();try{it(m);for(let x=l;x<u;x++){const C=n.data[x],U=i[x];Zl(x),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&G0(C,U)}}finally{it(-1),Zl(y)}}function G0(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function Tg(n,i,o){var l;i.componentOffset=o,(null!==(l=n.components)&&void 0!==l?l:n.components=[]).push(i.index)}function OE(n,i,o){if(o){if(i.exportAs)for(let l=0;l<i.exportAs.length;l++)o[i.exportAs[l]]=n;vo(i)&&(o[""]=n)}}function LE(n,i,o,l,u){n.data[l]=u;const m=u.factory||(u.factory=de(u.type)),y=new Kl(m,vo(u),sc);n.blueprint[l]=y,o[l]=y,function Sg(n,i,o,l,u){const m=u.hostBindings;if(m){let y=n.hostBindingOpCodes;null===y&&(y=n.hostBindingOpCodes=[]);const x=~i.index;(function Cg(n){let i=n.length;for(;i>0;){const o=n[--i];if("number"==typeof o&&o<0)return o}return 0})(y)!=x&&y.push(x),y.push(o,l,m)}}(n,i,l,pd(n,o,u.hostVars,qi),u)}function dl(n,i,o,l,u,m){const y=Ws(n,i);!function Dg(n,i,o,l,u,m,y){if(null==m)n.removeAttribute(i,u,o);else{const x=null==y?Mn(m):y(m,l||"",u);n.setAttribute(i,u,x,o)}}(i[L],y,m,n.value,o,l,u)}function FE(n,i,o,l,u,m){const y=m[i];if(null!==y)for(let x=0;x<y.length;)ma(l,o,y[x++],y[x++],y[x++])}function ma(n,i,o,l,u){const m=Fe(null);try{const y=n.inputTransforms;null!==y&&y.hasOwnProperty(l)&&(u=y[l].call(i,u)),null!==n.setInput?n.setInput(i,u,o,l):i[l]=u}finally{Fe(m)}}function Kc(n,i,o){let l=null,u=0;for(;u<o.length;){const m=o[u];if(0!==m)if(5!==m){if("number"==typeof m)break;if(n.hasOwnProperty(m)){null===l&&(l=[]);const y=n[m];for(let x=0;x<y.length;x+=2)if(y[x]===i){l.push(m,y[x+1],o[u+1]);break}}u+=2}else u+=2;else u+=4}return l}function pp(n,i,o,l){return[n,!0,0,i,null,l,null,o,null,null]}function Ig(n,i){const o=n.contentQueries;if(null!==o){const l=Fe(null);try{for(let u=0;u<o.length;u+=2){const y=o[u+1];if(-1!==y){const x=n.data[y];oo(o[u]),x.contentQueries(2,i[y],y)}}}finally{Fe(l)}}}function vd(n,i){return n[ae]?n[G][rs]=i:n[ae]=i,n[G]=i,i}function Dh(n,i,o){oo(0);const l=Fe(null);try{i(n,o)}finally{Fe(l)}}function Y0(n){return n[Oo]||(n[Oo]=[])}function BE(n){return n.cleanup||(n.cleanup=[])}function mp(n,i){const o=n[no],l=o?o.get(Xa,null):null;l&&l.handleError(i)}function gp(n,i,o,l,u){for(let m=0;m<o.length;){const y=o[m++],x=o[m++];ma(n.data[y],i[y],l,x,u)}}function kE(n,i,o,l){var u;const m=i[fi];if(256==(256&m))return;null===(u=i[$].inlineEffectRunner)||void 0===u||u.flush(),bf(i);let x=null,C=null;(function Rh(n){return 2!==n.type})(n)&&(C=function vg(n){var i;return null!==(i=n[No])&&void 0!==i?i:function yg(n){var i;const o=null!==(i=wh.pop())&&void 0!==i?i:Object.create(_g);return o.lView=n,o}(n)}(i),x=function Ke(n){return n&&(n.nextProducerIndex=0),Fe(n)}(C));try{El(i),function Ru(n){return hi.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&Ch(n,i,o,2,l);const U=3==(3&m);if(U){const Me=n.preOrderCheckHooks;null!==Me&&Ho(i,Me,null)}else{const Me=n.preOrderHooks;null!==Me&&bo(i,Me,0,null),da(i,0)}if(function vp(n){for(let i=Oy(n);null!==i;i=Ly(i)){if(!(i[fi]&oa.HasTransplantedViews))continue;const o=i[Fi];for(let l=0;l<o.length;l++){Mi(o[l])}}}(i),Jc(i,0),null!==n.contentQueries&&Ig(n,i),U){const Me=n.contentCheckHooks;null!==Me&&Ho(i,Me)}else{const Me=n.contentHooks;null!==Me&&bo(i,Me,1),da(i,1)}!function hd(n,i){const o=n.hostBindingOpCodes;if(null!==o)try{for(let l=0;l<o.length;l++){const u=o[l];if(u<0)it(~u);else{const m=u,y=o[++l],x=o[++l];_f(y,m),x(2,i[m])}}}finally{it(-1)}}(n,i);const W=n.components;null!==W&&Qc(i,W,0);const J=n.viewQuery;if(null!==J&&Dh(2,J,l),U){const Me=n.viewCheckHooks;null!==Me&&Ho(i,Me)}else{const Me=n.viewHooks;null!==Me&&bo(i,Me,2),da(i,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[Ma]){for(const Me of i[Ma])Me();i[Ma]=null}i[fi]&=-73}catch(U){throw wc(i),U}finally{null!==C&&(function Je(n,i){if(Fe(i),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(bt(n))for(let o=n.nextProducerIndex;o<n.producerNode.length;o++)st(n.producerNode[o],n.producerIndexOfThis[o]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}(C,x),function ud(n){n.lView[No]!==n&&(n.lView=null,wh.push(n))}(C)),N()}}function Jc(n,i){for(let o=Oy(n);null!==o;o=Ly(o)){o[fi]&=~oa.HasChildViewsToRefresh;for(let l=Kr;l<o.length;l++)X0(o[l],i)}}function yp(n,i,o){X0(yo(i,n),o)}function X0(n,i){Yl(n)&&Pg(n,i)}function Pg(n,i){const l=n[hn],u=n[fi],m=n[No];let y=!!(0===i&&16&u);if(y||(y=!!(64&u&&0===i)),y||(y=!!(1024&u)),y||(y=!(null==m||!m.dirty||!et(m))),m&&(m.dirty=!1),n[fi]&=-9217,y)kE(l,n,l.template,n[_i]);else if(8192&u){Jc(n,1);const x=l.components;null!==x&&Qc(n,x,1)}}function Qc(n,i,o){for(let l=0;l<i.length;l++)yp(n,i[l],o)}function yd(n){var i;for(null===(i=n[$].changeDetectionScheduler)||void 0===i||i.notify();n;){n[fi]|=64;const o=Qd(n);if(aa(n)&&!o)return n;n=o}return null}class Ph{get rootNodes(){const i=this._lView,o=i[hn];return Eh(o,i,o.firstChild,[])}constructor(i,o,l=!0){this._lView=i,this._cdRefInjectingView=o,this.notifyErrorHandler=l,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[_i]}set context(i){this._lView[_i]=i}get destroyed(){return 256==(256&this._lView[fi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[rr];if(Nr(i)){const o=i[8],l=o?o.indexOf(this):-1;l>-1&&(eh(i,l),If(o,l))}this._attachedToViewContainer=!1}qf(this._lView[hn],this._lView)}onDestroy(i){ca(this._lView,i)}markForCheck(){yd(this._cdRefInjectingView||this._lView)}detach(){this._lView[fi]&=-129}reattach(){ql(this._lView),this._lView[fi]|=128}detectChanges(){this._lView[fi]|=1024,function oc(n,i=!0){const o=n[$],l=o.rendererFactory,u=o.afterRenderEventManager;var y;null===(y=l.begin)||void 0===y||y.call(l),null==u||u.begin();try{!function q0(n){Pg(n,0);let i=0;for(;Qo(n);){if(100===i)throw new gn(103,!1);i++,Pg(n,1)}}(n)}catch(U){throw i&&mp(n,U),U}finally{var x,C;null===(x=l.end)||void 0===x||x.call(l),null===(C=o.inlineEffectRunner)||void 0===C||C.flush(),null==u||u.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new gn(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function jx(n,i){ed(n,i,i[L],2,null,null)}(this._lView[hn],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new gn(902,!1);this._appRef=i,ql(this._lView)}}let Og=(()=>{class i{}return i.__NG_ELEMENT_ID__=Il,i})();function Il(n){return function UE(n,i,o){if(ol(n)&&!o){const l=yo(n.index,i);return new Ph(l,l)}return 47&n.type?new Ph(i[Kt],i):null}(zr(),qt(),16==(16&n))}let Ng=(()=>{var n;class i{}return(n=i).__NG_ELEMENT_ID__=Fg,n.__NG_ENV_ID__=o=>o,i})();class GC extends Ng{constructor(i){super(),this._lView=i}onDestroy(i){return ca(this._lView,i),()=>function wl(n,i){if(null===n[go])return;const o=n[go].indexOf(i);-1!==o&&n[go].splice(o,1)}(this._lView,i)}}function Fg(){return new GC(qt())}const J0=new Set;function lc(n){var i,o;J0.has(n)||(J0.add(n),null===(i=performance)||void 0===i||null===(o=i.mark)||void 0===o||o.call(i,"mark_feature_usage",{detail:{feature:n}}))}function Lh(n){return i=>{setTimeout(n,void 0,i)}}const fl=class Oh extends Xt.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,o,l){let u=i,m=o||(()=>null),y=l;if(i&&"object"==typeof i){var x,C,U;const J=i;u=null===(x=J.next)||void 0===x?void 0:x.bind(J),m=null===(C=J.error)||void 0===C?void 0:C.bind(J),y=null===(U=J.complete)||void 0===U?void 0:U.bind(J)}this.__isAsync&&(m=Lh(m),u&&(u=Lh(u)),y&&(y=Lh(y)));const W=super.subscribe({next:u,error:m,complete:y});return i instanceof Nt.w0&&i.add(W),W}};function Q0(...n){}class ks{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fl(!1),this.onMicrotaskEmpty=new fl(!1),this.onStable=new fl(!1),this.onError=new fl(!1),typeof Zone>"u")throw new gn(908,!1);Zone.assertZonePatched();const u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!l&&o,u.shouldCoalesceRunChangeDetection=l,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function GE(){const n="function"==typeof gr.requestAnimationFrame;let i=gr[n?"requestAnimationFrame":"setTimeout"],o=gr[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&i&&o){const l=i[Zone.__symbol__("OriginalDelegate")];l&&(i=l);const u=o[Zone.__symbol__("OriginalDelegate")];u&&(o=u)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Ug(n){const i=()=>{!function YE(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(gr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,_p(n),n.isCheckStableRunning=!0,kg(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),_p(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,l,u,m,y,x)=>{if(function qE(n){var i;return!(!Array.isArray(n)||1!==n.length)&&!0===(null===(i=n[0].data)||void 0===i?void 0:i.__ignore_ng_zone__)}(x))return o.invokeTask(u,m,y,x);try{return e_(n),o.invokeTask(u,m,y,x)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===m.type||n.shouldCoalesceRunChangeDetection)&&i(),t_(n)}},onInvoke:(o,l,u,m,y,x,C)=>{try{return e_(n),o.invoke(u,m,y,x,C)}finally{n.shouldCoalesceRunChangeDetection&&i(),t_(n)}},onHasTask:(o,l,u,m)=>{o.hasTask(u,m),l===u&&("microTask"==m.change?(n._hasPendingMicrotasks=m.microTask,_p(n),kg(n)):"macroTask"==m.change&&(n.hasPendingMacrotasks=m.macroTask))},onHandleError:(o,l,u,m)=>(o.handleError(u,m),n.runOutsideAngular(()=>n.onError.emit(m)),!1)})}(u)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ks.isInAngularZone())throw new gn(909,!1)}static assertNotInAngularZone(){if(ks.isInAngularZone())throw new gn(909,!1)}run(i,o,l){return this._inner.run(i,o,l)}runTask(i,o,l,u){const m=this._inner,y=m.scheduleEventTask("NgZoneEvent: "+u,i,jE,Q0,Q0);try{return m.runTask(y,o,l)}finally{m.cancelTask(y)}}runGuarded(i,o,l){return this._inner.runGuarded(i,o,l)}runOutsideAngular(i){return this._outer.run(i)}}const jE={};function kg(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function _p(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function e_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function t_(n){n._nesting--,kg(n)}class WC{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fl,this.onMicrotaskEmpty=new fl,this.onStable=new fl,this.onError=new fl}run(i,o,l){return i.apply(o,l)}runGuarded(i,o,l){return i.apply(o,l)}runOutsideAngular(i){return i()}runTask(i,o,l,u){return i.apply(o,l)}}var cc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(cc||{});const XE={destroy(){}};function ZE(n,i){var o,l,u;!i&&function Bm(n){if(!ir()&&!function $i(){return On}())throw new gn(-203,!1)}();const m=null!==(o=null==i?void 0:i.injector)&&void 0!==o?o:re(ja);if(!function Oc(n){return"browser"===(null!=n?n:re(ja)).get(py)}(m))return XE;lc("NgAfterNextRender");const y=m.get(Fh),x=null!==(l=y.handler)&&void 0!==l?l:y.handler=new JE,C=null!==(u=null==i?void 0:i.phase)&&void 0!==u?u:cc.MixedReadWrite,U=()=>{x.unregister(J),W()},W=m.get(Ng).onDestroy(U),J=new KE(m,C,()=>{U(),n()});return x.register(J),{destroy:U}}class KE{constructor(i,o,l){this.phase=o,this.callbackFn=l,this.zone=i.get(ks),this.errorHandler=i.get(Xa,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(o){var i;null===(i=this.errorHandler)||void 0===i||i.handleError(o)}}}class JE{constructor(){this.executingCallbacks=!1,this.buckets={[cc.EarlyRead]:new Set,[cc.Write]:new Set,[cc.MixedReadWrite]:new Set,[cc.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new gn(102,!1)}register(i){(this.executingCallbacks?this.deferredCallbacks:this.buckets[i.phase]).add(i)}unregister(i){this.buckets[i.phase].delete(i),this.deferredCallbacks.delete(i)}execute(){this.executingCallbacks=!0;for(const i of Object.values(this.buckets))for(const o of i)o.invoke();this.executingCallbacks=!1;for(const i of this.deferredCallbacks)this.buckets[i.phase].add(i);this.deferredCallbacks.clear()}destroy(){for(const i of Object.values(this.buckets))i.clear();this.deferredCallbacks.clear()}}let Fh=(()=>{var n;class i{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){var l;null===(l=this.handler)||void 0===l||l.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){var l;for(const u of this.internalCallbacks)u();this.internalCallbacks.length=0,null===(l=this.handler)||void 0===l||l.execute()}}ngOnDestroy(){var l;null===(l=this.handler)||void 0===l||l.destroy(),this.handler=null,this.internalCallbacks.length=0}}return(n=i).\u0275prov=Hi({token:n,providedIn:"root",factory:()=>new n}),i})();function r_(n,i){const o=yo(i,n),l=o[hn];!function eu(n,i){for(let o=i.length;o<n.blueprint.length;o++)i.push(n.blueprint[o])}(l,o);const u=o[vr];null!==u&&null===o[xr]&&(o[xr]=Gc(u,o[no])),s_(l,o,o[_i])}function s_(n,i,o){bf(i);try{const l=n.viewQuery;null!==l&&Dh(1,l,o);const u=n.template;null!==u&&Ch(n,i,u,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Ig(n,i),n.staticViewQueries&&Dh(2,n.viewQuery,o);const m=n.components;null!==m&&function QE(n,i){for(let o=0;o<i.length;o++)r_(n,i[o])}(i,m)}catch(l){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),l}finally{i[fi]&=-5,N()}}function Bh(n,i,o){let l=o?n.styles:null,u=o?n.classes:null,m=0;if(null!==i)for(let y=0;y<i.length;y++){const x=i[y];"number"==typeof x?m=x:1==m?u=$n(u,x):2==m&&(l=$n(l,x+": "+i[++y]+";"))}o?n.styles=l:n.stylesWithoutHost=l,o?n.classes=u:n.classesWithoutHost=u}class uc extends Wc{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const o=Yi(i);return new bp(o,this.ngModule)}}function Vg(n){const i=[];for(let o in n)n.hasOwnProperty(o)&&i.push({propName:n[o],templateName:o});return i}class tu{constructor(i,o){this.injector=i,this.parentInjector=o}get(i,o,l){l=Ze(l);const u=this.injector.get(i,Ia,l);return u!==Ia||o===Ia?u:this.parentInjector.get(i,o,l)}}class bp extends g0{get inputs(){const i=this.componentDef,o=i.inputTransforms,l=Vg(i.inputs);if(null!==o)for(const u of l)o.hasOwnProperty(u.propName)&&(u.transform=o[u.propName]);return l}get outputs(){return Vg(this.componentDef.outputs)}constructor(i,o){super(),this.componentDef=i,this.ngModule=o,this.componentType=i.type,this.selector=function xa(n){return n.map(_u).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!o}create(i,o,l,u){var y;let x=(u=u||this.ngModule)instanceof cl?u:null===(y=u)||void 0===y?void 0:y.injector;x&&null!==this.componentDef.getStandaloneInjector&&(x=this.componentDef.getStandaloneInjector(x)||x);const C=x?new tu(i,x):i,U=C.get(_0,null);if(null===U)throw new gn(407,!1);const ze={rendererFactory:U,sanitizer:C.get(FC,null),inlineEffectRunner:null,afterRenderEventManager:C.get(Fh,null),changeDetectionScheduler:C.get(c0,null)},St=U.createRenderer(null,this.componentDef),on=this.componentDef.selectors[0][0]||"div",mn=l?function Ah(n,i,o,l){const m=l.get(qc,!1)||o===tr.ShadowDom,y=n.selectRootElement(i,m);return function xg(n){U0(n)}(y),y}(St,l,this.componentDef.encapsulation,C):Yf(St,on,function eM(n){const i=n.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(on));let Vn=512;this.componentDef.signals?Vn|=4096:this.componentDef.onPush||(Vn|=16);let rn=null;null!==mn&&(rn=Gc(mn,C,!0));const Bi=dp(0,null,null,1,0,null,null,null,null,null,null),Zi=up(null,Bi,null,Vn,null,null,ze,St,C,null,rn);let Fr,Fo;bf(Zi);try{const vu=this.componentDef;let um,JS=null;vu.findHostDirectiveDefs?(um=[],JS=new Map,vu.findHostDirectiveDefs(vu,um,JS),um.push(vu)):um=[vu];const PI=function nu(n,i){const o=n[hn],l=Ai;return n[l]=i,Wr(o,l,2,"#host",null)}(Zi,mn),OI=function o_(n,i,o,l,u,m,y){const x=u[hn];!function tM(n,i,o,l){for(const u of n)i.mergedAttrs=ba(i.mergedAttrs,u.hostAttrs);null!==i.mergedAttrs&&(Bh(i,i.mergedAttrs,!0),null!==o&&eg(l,o,i))}(l,n,i,y);let C=null;null!==i&&(C=Gc(i,u[no]));const U=m.rendererFactory.createRenderer(i,o);let W=16;o.signals?W=4096:o.onPush&&(W=64);const J=up(u,B0(o),null,W,u[n.index],n,m,U,null,null,C);return x.firstCreatePass&&Tg(x,n,l.length-1),vd(u,J),u[n.index]=J}(PI,mn,vu,um,Zi,ze,St);Fo=Vo(Bi,Ai),mn&&function YC(n,i,o,l){if(l)qo(n,o,["ng-version","17.0.8"]);else{const{attrs:u,classes:m}=function vc(n){const i=[],o=[];let l=1,u=2;for(;l<n.length;){let m=n[l];if("string"==typeof m)2===u?""!==m&&i.push(m,n[++l]):8===u&&o.push(m);else{if(!wo(u))break;u=m}l++}return{attrs:i,classes:o}}(i.selectors[0]);u&&qo(n,o,u),m&&m.length>0&&qy(n,o,m.join(" "))}}(St,vu,mn,l),void 0!==o&&function qC(n,i,o){const l=n.projection=[];for(let u=0;u<i.length;u++){const m=o[u];l.push(null!=m?Array.from(m):null)}}(Fo,this.ngContentSelectors,o),Fr=function iu(n,i,o,l,u,m){const y=zr(),x=u[hn],C=Ws(y,u);fp(x,u,y,o,null,l);for(let W=0;W<o.length;W++)co(ll(u,x,y.directiveStart+W,y),u);Ag(x,u,y),C&&co(C,u);const U=ll(u,x,y.directiveStart+y.componentOffset,y);if(n[_i]=u[_i]=U,null!==m)for(const W of m)W(U,i);return md(x,y,n),U}(OI,vu,um,JS,Zi,[nM]),s_(Bi,Zi,null)}finally{N()}return new jC(this.componentType,Fr,jc(Fo,Zi),Zi,Fo)}}class jC extends m0{constructor(i,o,l,u,m){super(),this.location=l,this._rootLView=u,this._tNode=m,this.previousInputValues=null,this.instance=o,this.hostView=this.changeDetectorRef=new Ph(u,void 0,!1),this.componentType=i}setInput(i,o){const l=this._tNode.inputs;let u;if(null!==l&&(u=l[i])){var m;if(null!==(m=this.previousInputValues)&&void 0!==m||(this.previousInputValues=new Map),this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),o))return;const y=this._rootLView;gp(y[hn],y,u,i,o),this.previousInputValues.set(i,o),yd(yo(this._tNode.index,y))}}get injector(){return new ss(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function nM(){const n=zr();Aa(qt()[hn],n)}function zg(n){let i=function xp(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),o=!0;const l=[n];for(;i;){let u;if(vo(n))u=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new gn(903,!1);u=i.\u0275dir}if(u){if(o){l.push(u);const y=n;y.inputs=Ep(n.inputs),y.inputTransforms=Ep(n.inputTransforms),y.declaredInputs=Ep(n.declaredInputs),y.outputs=Ep(n.outputs);const x=u.hostBindings;x&&sM(n,x);const C=u.viewQuery,U=u.contentQueries;if(C&&iM(n,C),U&&rM(n,U),Qn(n.inputs,u.inputs),Qn(n.declaredInputs,u.declaredInputs),Qn(n.outputs,u.outputs),null!==u.inputTransforms&&(null===y.inputTransforms&&(y.inputTransforms={}),Qn(y.inputTransforms,u.inputTransforms)),vo(u)&&u.data.animation){const W=n.data;W.animation=(W.animation||[]).concat(u.data.animation)}}const m=u.features;if(m)for(let y=0;y<m.length;y++){const x=m[y];x&&x.ngInherit&&x(n),x===zg&&(o=!1)}}i=Object.getPrototypeOf(i)}!function Hg(n){let i=0,o=null;for(let l=n.length-1;l>=0;l--){const u=n[l];u.hostVars=i+=u.hostVars,u.hostAttrs=ba(u.hostAttrs,o=ba(o,u.hostAttrs))}}(l)}function Ep(n){return n===is?{}:n===Oi?[]:n}function iM(n,i){const o=n.viewQuery;n.viewQuery=o?(l,u)=>{i(l,u),o(l,u)}:i}function rM(n,i){const o=n.contentQueries;n.contentQueries=o?(l,u,m)=>{i(l,u,m),o(l,u,m)}:i}function sM(n,i){const o=n.hostBindings;n.hostBindings=o?(l,u)=>{i(l,u),o(l,u)}:i}function $g(n){const i=n.inputConfig,o={};for(const l in i)if(i.hasOwnProperty(l)){const u=i[l];Array.isArray(u)&&u[2]&&(o[l]=u[2])}n.inputTransforms=o}function uo(n,i,o){return!Object.is(n[i],o)&&(n[i]=o,!0)}function kh(n,i,o,l){const u=qt();return uo(u,zo(),i)&&(sr(),dl(Ct(),u,n,i,o,l)),kh}function qg(n,i){return n<<17|i<<2}function lu(n){return n>>17&32767}function bd(n){return 2|n}function dc(n){return(131068&n)>>2}function c_(n,i){return-131069&n|i<<2}function gs(n){return 1|n}function mM(n,i,o,l,u){const m=n[o+1],y=null===i;let x=l?lu(m):dc(m),C=!1;for(;0!==x&&(!1===C||y);){const W=n[x+1];JC(n[x],i)&&(C=!0,n[x+1]=l?gs(W):bd(W)),x=l?lu(W):dc(W)}C&&(n[o+1]=l?bd(m):gs(m))}function JC(n,i){return null===n||null==i||(Array.isArray(n)?n[1]:n)===i||!(!Array.isArray(n)||"string"!=typeof i)&&ju(n,i)>=0}function Ap(n,i,o){const l=qt();return uo(l,zo(),i)&&function Wo(n,i,o,l,u,m,y,x){const C=Ws(i,o);let W,U=i.inputs;!x&&null!=U&&(W=U[l])?(gp(n,o,W,l,u),ol(i)&&function wg(n,i){const o=yo(i,n);16&o[fi]||(o[fi]|=64)}(o,i.index)):3&i.type&&(l=function hp(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(l),u=null!=y?y(u,i.value||"",l):u,m.setProperty(C,l,u))}(sr(),Ct(),l,n,i,l[L],o,!1),Ap}function Tp(n,i,o,l,u){const y=u?"class":"style";gp(n,o,i.inputs[y],y,l)}function as(n,i){return function Xi(n,i,o,l){const u=qt(),m=sr(),y=function ws(n){const i=hi.lFrame,o=i.bindingIndex;return i.bindingIndex=i.bindingIndex+n,o}(2);m.firstUpdatePass&&function Dp(n,i,o,l){const u=n.data;if(null===u[o+1]){const m=u[le()],y=function Ol(n,i){return i>=n.expandoStartIndex}(n,o);(function p_(n,i){return 0!=(n.flags&(i?8:16))})(m,l)&&null===i&&!y&&(i=!1),i=function Kg(n,i,o,l){const u=function Pu(n){const i=hi.lFrame.currentDirectiveIndex;return-1===i?null:n[i]}(n);let m=l?i.residualClasses:i.residualStyles;if(null===u)0===(l?i.classBindings:i.styleBindings)&&(o=Oa(o=Ed(null,n,i,o,l),i.attrs,l),m=null);else{const y=i.directiveStylingLast;if(-1===y||n[y]!==u)if(o=Ed(u,n,i,o,l),null===m){let C=function EM(n,i,o){const l=o?i.classBindings:i.styleBindings;if(0!==dc(l))return n[lu(l)]}(n,i,l);void 0!==C&&Array.isArray(C)&&(C=Ed(null,n,i,C[1],l),C=Oa(C,i.attrs,l),function MM(n,i,o,l){n[lu(o?i.classBindings:i.styleBindings)]=l}(n,i,l,C))}else m=function wM(n,i,o){let l;const u=i.directiveEnd;for(let m=1+i.directiveStylingLast;m<u;m++)l=Oa(l,n[m].hostAttrs,o);return Oa(l,i.attrs,o)}(n,i,l)}return void 0!==m&&(l?i.residualClasses=m:i.residualStyles=m),o}(u,m,i,l),function Cp(n,i,o,l,u,m){let y=m?i.classBindings:i.styleBindings,x=lu(y),C=dc(y);n[l]=o;let W,U=!1;if(Array.isArray(o)?(W=o[1],(null===W||ju(o,W)>0)&&(U=!0)):W=o,u)if(0!==C){const Me=lu(n[x+1]);n[l+1]=qg(Me,x),0!==Me&&(n[Me+1]=c_(n[Me+1],l)),n[x+1]=function l_(n,i){return 131071&n|i<<17}(n[x+1],l)}else n[l+1]=qg(x,0),0!==x&&(n[x+1]=c_(n[x+1],l)),x=l;else n[l+1]=qg(C,0),0===x?x=l:n[C+1]=c_(n[C+1],l),C=l;U&&(n[l+1]=bd(n[l+1])),mM(n,W,l,!0),mM(n,W,l,!1),function KC(n,i,o,l,u){const m=u?n.residualClasses:n.residualStyles;null!=m&&"string"==typeof i&&ju(m,i)>=0&&(o[l+1]=gs(o[l+1]))}(i,W,n,l,m),y=qg(x,C),m?i.classBindings=y:i.styleBindings=y}(u,m,i,o,y,l)}}(m,n,y,l),i!==qi&&uo(u,y,i)&&function h_(n,i,o,l,u,m,y,x){if(!(3&i.type))return;const C=n.data,U=C[x+1],W=function Sp(n){return 1==(1&n)}(U)?f_(C,i,o,u,dc(U),y):void 0;Rp(W)||(Rp(m)||function ZC(n){return 2==(2&n)}(U)&&(m=f_(C,null,o,u,x,y)),function eE(n,i,o,l,u){if(i)u?n.addClass(o,l):n.removeClass(o,l);else{let m=-1===l.indexOf("-")?void 0:Gf.DashCase;null==u?n.removeStyle(o,l,m):("string"==typeof u&&u.endsWith("!important")&&(u=u.slice(0,-10),m|=Gf.Important),n.setStyle(o,l,u,m))}}(l,y,function za(n,i){return kr(i[n])}(le(),o),u,m))}(m,m.data[le()],u,u[L],n,u[y+1]=function SM(n,i){return null==n||""===n||("string"==typeof i?n+=i:"object"==typeof n&&(n=ai(tc(n)))),n}(i,o),l,y)}(n,i,null,!0),as}function Ed(n,i,o,l,u){let m=null;const y=o.directiveEnd;let x=o.directiveStylingLast;for(-1===x?x=o.directiveStart:x++;x<y&&(m=i[x],l=Oa(l,m.hostAttrs,u),m!==n);)x++;return null!==n&&(o.directiveStylingLast=x),l}function Oa(n,i,o){const l=o?1:2;let u=-1;if(null!==i)for(let m=0;m<i.length;m++){const y=i[m];"number"==typeof y?u=y:u===l&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),fa(n,y,!!o||i[++m]))}return void 0===n?null:n}function f_(n,i,o,l,u,m){const y=null===i;let x;for(;u>0;){const C=n[u],U=Array.isArray(C),W=U?C[1]:C,J=null===W;let Me=o[u+1];Me===qi&&(Me=J?Oi:void 0);let ze=J?Am(Me,l):W===l?Me:void 0;if(U&&!Rp(ze)&&(ze=Am(C,l)),Rp(ze)&&(x=ze,y))return x;const St=n[u+1];u=y?lu(St):dc(St)}if(null!==i){let C=m?i.residualClasses:i.residualStyles;null!=C&&(x=Am(C,l))}return x}function Rp(n){return void 0!==n}function uu(n,i){return!i||null===i.firstChild||Hf(n)}function Ad(n,i,o,l=!0){const u=i[hn];if(function qx(n,i,o,l){const u=Kr+l,m=o.length;l>0&&(o[u-1][rs]=i),l<m-Kr?(i[rs]=o[u],Kv(o,Kr+l,i)):(o.push(i),i[rs]=null),i[rr]=o;const y=i[ci];null!==y&&o!==y&&function Xx(n,i){const o=n[Fi];i[Kt]!==i[rr][rr][Kt]&&(n[fi]|=oa.HasTransplantedViews),null===o?n[Fi]=[i]:o.push(i)}(y,i);const x=i[Vr];null!==x&&x.insertView(n),ql(i),i[fi]|=128}(u,i,n,o),l){const y=Jm(o,n),x=i[L],C=th(x,n[ko]);null!==C&&function Wx(n,i,o,l,u,m){l[vr]=u,l[Ar]=i,ed(n,l,o,1,u,m)}(u,n[Ar],x,i,C,y)}const m=i[xr];null!==m&&null!==m.firstChild&&(m.firstChild=null)}let Up=(()=>{class i{}return i.__NG_ELEMENT_ID__=Zh,i})();function Zh(){return S_(zr(),qt())}const qM=Up,M_=class extends qM{constructor(i,o,l){super(),this._lContainer=i,this._hostTNode=o,this._hostLView=l}get element(){return jc(this._hostTNode,this._hostLView)}get injector(){return new ss(this._hostTNode,this._hostLView)}get parentInjector(){const i=Mf(this._hostTNode,this._hostLView);if(Nu(i)){const o=Fu(i,this._hostLView),l=Ql(i);return new ss(o[hn].data[l+8],o)}return new ss(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const o=w_(this._lContainer);return null!==o&&o[i]||null}get length(){return this._lContainer.length-Kr}createEmbeddedView(i,o,l){let u,m;"number"==typeof l?u=l:null!=l&&(u=l.index,m=l.injector);const x=i.createEmbeddedViewImpl(o||{},m,null);return this.insertImpl(x,u,uu(this._hostTNode,null)),x}createComponent(i,o,l,u,m){var y,C;const U=i&&!function jd(n){return"function"==typeof n}(i);let W;if(U)W=o;else{const Vn=o||{};W=Vn.index,l=Vn.injector,u=Vn.projectableNodes,m=Vn.environmentInjector||Vn.ngModuleRef}const J=U?i:new bp(Yi(i)),Me=l||this.parentInjector;if(!m&&null==J.ngModule){const rn=(U?Me:this.parentInjector).get(cl,null);rn&&(m=rn)}const ze=Yi(null!==(y=J.componentType)&&void 0!==y?y:{}),St=(null==ze?void 0:ze.id,null),on=null!==(C=null==St?void 0:St.firstChild)&&void 0!==C?C:null,mn=J.create(Me,u,on,m);return this.insertImpl(mn.hostView,W,uu(this._hostTNode,St)),mn}insert(i,o){return this.insertImpl(i,o,!0)}insertImpl(i,o,l){const u=i._lView;if(function Cu(n){return Nr(n[rr])}(u)){const x=this.indexOf(i);if(-1!==x)this.detach(x);else{const C=u[rr],U=new M_(C,C[Ar],C[rr]);U.detach(U.indexOf(i))}}const m=this._adjustIndex(o),y=this._lContainer;return Ad(y,u,m,l),i.attachToViewContainerRef(),Kv(ov(y),m,i),i}move(i,o){return this.insert(i,o)}indexOf(i){const o=w_(this._lContainer);return null!==o?o.indexOf(i):-1}remove(i){const o=this._adjustIndex(i,-1),l=eh(this._lContainer,o);l&&(If(ov(this._lContainer),o),qf(l[hn],l))}detach(i){const o=this._adjustIndex(i,-1),l=eh(this._lContainer,o);return l&&null!=If(ov(this._lContainer),o)?new Ph(l):null}_adjustIndex(i,o=0){return null==i?this.length+o:i}};function w_(n){return n[8]}function ov(n){return n[8]||(n[8]=[])}function S_(n,i){let o;const l=i[n.index];return Nr(l)?o=l:(o=pp(l,i,null,n),i[n.index]=o,vd(i,o)),C_(o,i,n,l),new M_(o,n,i)}let C_=function A_(n,i,o,l){if(n[ko])return;let u;u=8&o.type?kr(l):function XM(n,i){const o=n[L],l=o.createComment(""),u=Ws(i,n);return Bc(o,th(o,u),l,function Qx(n,i){return n.nextSibling(i)}(o,u),!1),l}(i,o),n[ko]=u},av=(n,i,o)=>!1;function Id(n,i,o,l,u,m,y,x){const C=qt(),U=sr(),W=n+Ai,J=U.firstCreatePass?function QM(n,i,o,l,u,m,y,x,C){const U=i.consts,W=Wr(i,n,4,y||null,Jo(U,x));Th(i,o,W,Jo(U,C)),Aa(i,W);const J=W.tView=dp(2,W,l,u,m,i.directiveRegistry,i.pipeRegistry,null,i.schemas,U,null);return null!==i.queries&&(i.queries.template(i,W),J.queries=i.queries.embeddedTView(W)),W}(W,U,C,i,o,l,u,m,y):U.data[W];so(J,!1);const Me=ew(U,C,J,n);Wa()&&ih(U,C,Me,J),co(Me,C);const ze=pp(Me,C,Me,J);return C[W]=ze,vd(C,ze),function ZM(n,i,o){return av(n,i,o)}(ze,J,C),$l(J)&&bg(U,C,J),null!=y&&Zc(C,J,x),Id}let ew=function tw(n,i,o,l){return ta(!0),i[L].createComment("")};function qp(n,i,o,l){const u=qt(),m=sr(),y=Ai+n,x=u[L],C=m.firstCreatePass?function Lw(n,i,o,l,u,m){const y=i.consts,C=Wr(i,n,2,l,Jo(y,u));return Th(i,o,C,Jo(y,m)),null!==C.attrs&&Bh(C,C.attrs,!1),null!==C.mergedAttrs&&Bh(C,C.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,C),C}(y,m,u,i,o,l):m.data[y],U=j_(m,u,C,x,i,n);u[y]=U;const W=$l(C);return so(C,!0),eg(x,U,C),32!=(32&C.flags)&&Wa()&&ih(m,u,U,C),0===function Gd(){return hi.lFrame.elementDepthCount}()&&co(U,u),function Au(){hi.lFrame.elementDepthCount++}(),W&&(bg(m,u,C),md(m,C,u)),null!==l&&Zc(u,C),qp}function Xp(){let n=zr();Iu()?Ca():(n=n.parent,so(n,!1));const i=n;(function $a(n){return hi.skipHydrationRootTNode===n})(i)&&function gf(){hi.skipHydrationRootTNode=null}(),function $v(){hi.lFrame.elementDepthCount--}();const o=sr();return o.firstCreatePass&&(Aa(o,n),xl(n)&&o.queries.elementEnd(n)),null!=i.classesWithoutHost&&function Lu(n){return 0!=(8&n.flags)}(i)&&Tp(o,i,qt(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function vm(n){return 0!=(16&n.flags)}(i)&&Tp(o,i,qt(),i.stylesWithoutHost,!1),Xp}function bv(n,i,o,l){return qp(n,i,o,l),Xp(),bv}let j_=(n,i,o,l,u,m)=>(ta(!0),Yf(l,u,function Ir(){return hi.lFrame.currentNamespace}()));function xv(n,i,o){const l=qt(),u=sr(),m=n+Ai,y=u.firstCreatePass?function dA(n,i,o,l,u){const m=i.consts,y=Jo(m,l),x=Wr(i,n,8,"ng-container",y);return null!==y&&Bh(x,y,!0),Th(i,o,x,Jo(m,u)),null!==i.queries&&i.queries.elementStart(i,x),x}(m,u,l,i,o):u.data[m];so(y,!0);const x=Y_(u,l,y,n);return l[m]=x,Wa()&&ih(u,l,x,y),co(x,l),$l(y)&&(bg(u,l,y),md(u,y,l)),null!=o&&Zc(l,y),xv}function Ev(){let n=zr();const i=sr();return Iu()?Ca():(n=n.parent,so(n,!1)),i.firstCreatePass&&(Aa(i,n),xl(n)&&i.queries.elementEnd(n)),Ev}function Mv(n,i,o){return xv(n,i,o),Ev(),Mv}let Y_=(n,i,o,l)=>(ta(!0),Ym(i[L],""));const pu=void 0;var ls=["en",[["a","p"],["AM","PM"],pu],[["AM","PM"],pu,pu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pu,"{1} 'at' {0}",pu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function kw(n){const o=Math.floor(Math.abs(n)),l=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===l?1:5}];let Fd={};function fc(n){const i=function Uw(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=J_(i);if(o)return o;const l=i.split("-")[0];if(o=J_(l),o)return o;if("en"===l)return ls;throw new gn(701,!1)}function K_(n){return fc(n)[kd.PluralCase]}function J_(n){return n in Fd||(Fd[n]=gr.ng&&gr.ng.common&&gr.ng.common.locales&&gr.ng.common.locales[n]),Fd[n]}var kd=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(kd||{});const Ud="en-US";let Q_=Ud;function Iv(n){return!!n&&"function"==typeof n.then}function Rv(n){return!!n&&"function"==typeof n.subscribe}function Pv(n,i,o,l){const u=qt(),m=sr(),y=zr();return function Eb(n,i,o,l,u,m,y){const x=$l(l),U=n.firstCreatePass&&BE(n),W=i[_i],J=Y0(i);let Me=!0;if(3&l.type||y){const on=Ws(l,i),mn=y?y(on):on,Vn=J.length,rn=y?Zi=>y(kr(Zi[l.index])):l.index;let Bi=null;if(!y&&x&&(Bi=function xS(n,i,o,l){const u=n.cleanup;if(null!=u)for(let m=0;m<u.length-1;m+=2){const y=u[m];if(y===o&&u[m+1]===l){const x=i[Oo],C=u[m+2];return x.length>C?x[C]:null}"string"==typeof y&&(m+=2)}return null}(n,i,u,l.index)),null!==Bi)(Bi.__ngLastListenerFn__||Bi).__ngNextListenerFn__=m,Bi.__ngLastListenerFn__=m,Me=!1;else{m=h(l,i,W,m,!1);const Zi=o.listen(mn,u,m);J.push(m,Zi),U&&U.push(u,rn,Vn,Vn+1)}}else m=h(l,i,W,m,!1);const ze=l.outputs;let St;if(Me&&null!==ze&&(St=ze[u])){const on=St.length;if(on)for(let mn=0;mn<on;mn+=2){const Fr=i[St[mn]][St[mn+1]].subscribe(m),Fo=J.length;J.push(m,Fr),U&&U.push(u,l.index,Fo,-(Fo+1))}}}(m,u,u[L],y,n,i,l),Pv}function ES(n,i,o,l){try{return Gr(6,i,o),!1!==o(l)}catch(u){return mp(n,u),!1}finally{Gr(7,i,o)}}function h(n,i,o,l,u){return function m(y){if(y===Function)return l;yd(n.componentOffset>-1?yo(n.index,i):i);let C=ES(i,o,l,y),U=m.__ngNextListenerFn__;for(;U;)C=ES(i,o,U,y)&&C,U=U.__ngNextListenerFn__;return u&&!1===C&&y.preventDefault(),C}}function e(n=1){return function K(n){return(hi.lFrame.contextLView=function Ml(n,i){for(;n>0;)i=i[ye],n--;return i}(n,hi.lFrame.contextLView))[_i]}(n)}function t(n,i){let o=null;const l=function zl(n){const i=n.attrs;if(null!=i){const o=i.indexOf(5);if(!(1&o))return i[o+1]}return null}(n);for(let u=0;u<i.length;u++){const m=i[u];if("*"!==m){if(null===l?bl(n,m,!0):Hl(l,m))return u}else o=u}return o}function r(n){const i=qt()[Kt][Ar];if(!i.projection){const l=i.projection=Yd(n?n.length:1,null),u=l.slice();let m=i.child;for(;null!==m;){const y=n?t(m,n):0;null!==y&&(u[y]?u[y].projectionNext=m:l[y]=m,u[y]=m),m=m.next}}}function s(n,i=0,o){const l=qt(),u=sr(),m=Wr(u,Ai+n,16,null,o||null);null===m.projection&&(m.projection=i),Ca(),(!l[xr]||Is())&&32!=(32&m.flags)&&function jy(n,i,o){Yy(i[L],0,i,o,Xm(n,o,i),nh(o.parent||i[Ar],o,i))}(u,l,m)}function At(n,i=""){const o=qt(),l=sr(),u=n+Ai,m=l.firstCreatePass?Wr(l,u,1,i,null):l.data[u],y=Ut(l,o,m,i,n);o[u]=y,Wa()&&ih(l,o,y,m),so(m,!1)}let Ut=(n,i,o,l,u)=>(ta(!0),function jf(n,i){return n.createText(i)}(i[L],l));function tn(n,i,o,l,u){if(n=Rn(n),Array.isArray(n))for(let m=0;m<n.length;m++)tn(n[m],i,o,l,u);else{const m=sr(),y=qt(),x=zr();let C=Ic(n)?n:Rn(n.provide);const U=cy(n),W=1048575&x.providerIndexes,J=x.directiveStart,Me=x.providerIndexes>>20;if(Ic(n)||!n.multi){const ze=new Kl(U,u,sc),St=vi(C,i,u?W:W+Me,J);-1===St?(Mm(xo(x,y),m,C),bn(m,n,i.length),i.push(C),x.directiveStart++,x.directiveEnd++,u&&(x.providerIndexes+=1048576),o.push(ze),y.push(ze)):(o[St]=ze,y[St]=ze)}else{const ze=vi(C,i,W+Me,J),St=vi(C,i,W,W+Me),mn=St>=0&&o[St];if(u&&!mn||!u&&!(ze>=0&&o[ze])){Mm(xo(x,y),m,C);const Vn=function yr(n,i,o,l,u){const m=new Kl(n,o,sc);return m.multi=[],m.index=i,m.componentProviders=0,fn(m,u,l&&!o),m}(u?si:ni,o.length,u,l,U);!u&&mn&&(o[St].providerFactory=Vn),bn(m,n,i.length,0),i.push(C),x.directiveStart++,x.directiveEnd++,u&&(x.providerIndexes+=1048576),o.push(Vn),y.push(Vn)}else bn(m,n,ze>-1?ze:St,fn(o[u?St:ze],U,!u&&l));!u&&l&&mn&&o[St].componentProviders++}}}function bn(n,i,o,l){const u=Ic(i),m=function cx(n){return!!n.useClass}(i);if(u||m){const C=(m?Rn(i.useClass):i).prototype.ngOnDestroy;if(C){const U=n.destroyHooks||(n.destroyHooks=[]);if(!u&&i.multi){const W=U.indexOf(o);-1===W?U.push(o,[l,C]):U[W+1].push(l,C)}else U.push(o,C)}}}function fn(n,i,o){return o&&n.componentProviders++,n.multi.push(i)-1}function vi(n,i,o,l){for(let u=o;u<l;u++)if(i[u]===n)return u;return-1}function ni(n,i,o,l){return Di(this.multi,[])}function si(n,i,o,l){const u=this.multi;let m;if(this.providerFactory){const y=this.providerFactory.componentProviders,x=ll(o,o[hn],this.providerFactory.index,l);m=x.slice(0,y),Di(u,m);for(let C=y;C<x.length;C++)m.push(x[C])}else m=[],Di(u,m);return m}function Di(n,i){for(let o=0;o<n.length;o++)i.push((0,n[o])());return i}function cs(n,i=[]){return o=>{o.providersResolver=(l,u)=>function Sn(n,i,o){const l=sr();if(l.firstCreatePass){const u=vo(n);tn(o,l.data,l.blueprint,u,!0),tn(i,l.data,l.blueprint,u,!1)}}(l,u?u(n):n,i)}}class Ce{}class he{}function Ft(n,i){return new pn(n,null!=i?i:null,[])}class pn extends Ce{constructor(i,o,l){super(),this._parent=o,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new uc(this);const u=Os(i);this._bootstrapComponents=Da(u.bootstrap),this._r3Injector=Ex(i,o,[{provide:Ce,useValue:this},{provide:Wc,useValue:this.componentFactoryResolver},...l],ai(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class An extends he{constructor(i){super(),this.moduleType=i}create(i){return new pn(this.moduleType,i,[])}}class In extends Ce{constructor(i){super(),this.componentFactoryResolver=new uc(this),this.instance=null;const o=new qu([...i.providers,{provide:Ce,useValue:this},{provide:Wc,useValue:this.componentFactoryResolver}],i.parent||kf(),i.debugName,new Set(["environment"]));this.injector=o,i.runEnvironmentInitializers&&o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function Vt(n,i,o=null){return new In({providers:n,parent:i,debugName:o,runEnvironmentInitializers:!0}).injector}let Ge=(()=>{var n;class i{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l)){const u=sy(0,l.type),m=u.length>0?Vt([u],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l,m)}return this.cachedInjectors.get(l)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return(n=i).\u0275prov=Hi({token:n,providedIn:"environment",factory:()=>new n(ee(cl))}),i})();function dn(n){lc("NgStandalone"),n.getStandaloneInjector=i=>i.get(Ge).getOrCreateStandaloneInjector(n)}function Nv(){return this._results[Symbol.iterator]()}class Do{get changes(){var i;return null!==(i=this._changes)&&void 0!==i?i:this._changes=new fl}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const o=Do.prototype;o[Symbol.iterator]||(o[Symbol.iterator]=Nv)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,o){return this._results.reduce(i,o)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,o){this.dirty=!1;const l=function na(n){return n.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function Gb(n,i,o){if(n.length!==i.length)return!1;for(let l=0;l<n.length;l++){let u=n[l],m=i[l];if(o&&(u=o(u),m=o(m)),m!==u)return!1}return!0}(this._results,l,o))&&(this._results=l,this.length=l.length,this.last=l[this.length-1],this.first=l[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let Qa=(()=>{class i{}return i.__NG_ELEMENT_ID__=Bv,i})();const Fv=Qa,va=class extends Fv{constructor(i,o,l){super(),this._declarationLView=i,this._declarationTContainer=o,this.elementRef=l}get ssrId(){var i;return(null===(i=this._declarationTContainer.tView)||void 0===i?void 0:i.ssrId)||null}createEmbeddedView(i,o){return this.createEmbeddedViewImpl(i,o)}createEmbeddedViewImpl(i,o,l){const u=function Cd(n,i,o,l){var u,m;const y=i.tView,U=up(n,y,o,4096&n[fi]?4096:16,null,i,null,null,null,null!==(u=null==l?void 0:l.injector)&&void 0!==u?u:null,null!==(m=null==l?void 0:l.dehydratedView)&&void 0!==m?m:null);U[ci]=n[i.index];const J=n[Vr];return null!==J&&(U[Vr]=J.createEmbeddedView(y)),s_(y,U,o),U}(this._declarationLView,this._declarationTContainer,i,{injector:o,dehydratedView:l});return new Ph(u)}};function Bv(){return rm(zr(),qt())}function rm(n,i){return 4&n.type?new va(i,n,jc(n,i)):null}class sm{constructor(i){this.queryList=i,this.matches=null}clone(){return new sm(this.queryList)}setDirty(){this.queryList.setDirty()}}class DS{constructor(i=[]){this.queries=i}createEmbeddedView(i){const o=i.queries;if(null!==o){const l=null!==i.contentQueries?i.contentQueries[0]:o.length,u=[];for(let m=0;m<l;m++){const y=o.getByIndex(m);u.push(this.queries[y.indexInDeclarationView].clone())}return new DS(u)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let o=0;o<this.queries.length;o++)null!==SA(i,o).matches&&this.queries[o].setDirty()}}class vA{constructor(i,o,l=null){this.predicate=i,this.flags=o,this.read=l}}class IS{constructor(i=[]){this.queries=i}elementStart(i,o){for(let l=0;l<this.queries.length;l++)this.queries[l].elementStart(i,o)}elementEnd(i){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(i)}embeddedTView(i){let o=null;for(let l=0;l<this.length;l++){const u=null!==o?o.length:0,m=this.getByIndex(l).embeddedTView(i,u);m&&(m.indexInDeclarationView=l,null!==o?o.push(m):o=[m])}return null!==o?new IS(o):null}template(i,o){for(let l=0;l<this.queries.length;l++)this.queries[l].template(i,o)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class RS{constructor(i,o=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(i,o){this.isApplyingToNode(o)&&this.matchTNode(i,o)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,o){this.elementStart(i,o)}embeddedTView(i,o){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,o),new RS(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let l=i.parent;for(;null!==l&&8&l.type&&l.index!==o;)l=l.parent;return o===(null!==l?l.index:-1)}return this._appliesToNextNode}matchTNode(i,o){const l=this.metadata.predicate;if(Array.isArray(l))for(let u=0;u<l.length;u++){const m=l[u];this.matchTNodeWithReadOption(i,o,FT(o,m)),this.matchTNodeWithReadOption(i,o,Sf(o,i,m,!1,!1))}else l===Qa?4&o.type&&this.matchTNodeWithReadOption(i,o,-1):this.matchTNodeWithReadOption(i,o,Sf(o,i,l,!1,!1))}matchTNodeWithReadOption(i,o,l){if(null!==l){const u=this.metadata.read;if(null!==u)if(u===sp||u===Up||u===Qa&&4&o.type)this.addMatch(o.index,-2);else{const m=Sf(o,i,u,!1,!1);null!==m&&this.addMatch(o.index,m)}else this.addMatch(o.index,l)}}addMatch(i,o){null===this.matches?this.matches=[i,o]:this.matches.push(i,o)}}function FT(n,i){const o=n.localNames;if(null!==o)for(let l=0;l<o.length;l+=2)if(o[l]===i)return o[l+1];return null}function kT(n,i,o,l){return-1===o?function BT(n,i){return 11&n.type?jc(n,i):4&n.type?rm(n,i):null}(i,n):-2===o?function UT(n,i,o){return o===sp?jc(i,n):o===Qa?rm(i,n):o===Up?S_(i,n):void 0}(n,i,l):ll(n,n[hn],o,i)}function yA(n,i,o,l){const u=i[Vr].queries[l];if(null===u.matches){const m=n.data,y=o.matches,x=[];for(let C=0;C<y.length;C+=2){const U=y[C];x.push(U<0?null:kT(i,m[U],y[C+1],o.metadata.read))}u.matches=x}return u.matches}function PS(n,i,o,l){const u=n.queries.getByIndex(o),m=u.matches;if(null!==m){const y=yA(n,i,u,o);for(let x=0;x<m.length;x+=2){const C=m[x];if(C>0)l.push(y[x/2]);else{const U=m[x+1],W=i[-C];for(let J=Kr;J<W.length;J++){const Me=W[J];Me[ci]===Me[rr]&&PS(Me[hn],Me,U,l)}if(null!==W[Fi]){const J=W[Fi];for(let Me=0;Me<J.length;Me++){const ze=J[Me];PS(ze[hn],ze,U,l)}}}}}return l}function _A(n){const i=qt(),o=sr(),l=ei();oo(l+1);const u=SA(o,l);if(n.dirty&&function Ko(n){return 4==(4&n[fi])}(i)===(2==(2&u.metadata.flags))){if(null===u.matches)n.reset([]);else{const m=u.crossesNgTemplate?PS(o,i,l,[]):yA(o,i,u,l);n.reset(m,OC),n.notifyOnChanges()}return!0}return!1}function bA(n,i,o){const l=sr();l.firstCreatePass&&(wA(l,new vA(n,i,o),-1),2==(2&i)&&(l.staticViewQueries=!0)),MA(l,qt(),i)}function xA(n,i,o,l){const u=sr();if(u.firstCreatePass){const m=zr();wA(u,new vA(i,o,l),m.index),function zT(n,i){const o=n.contentQueries||(n.contentQueries=[]);i!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,i)}(u,n),2==(2&o)&&(u.staticContentQueries=!0)}MA(u,qt(),o)}function EA(){return function VT(n,i){return n[Vr].queries[i].queryList}(qt(),ei())}function MA(n,i,o){const l=new Do(4==(4&o));(function z0(n,i,o,l){const u=Y0(i);u.push(o),n.firstCreatePass&&BE(n).push(l,u.length-1)})(n,i,l,l.destroy),null===i[Vr]&&(i[Vr]=new DS),i[Vr].queries.push(new sm(l))}function wA(n,i,o){null===n.queries&&(n.queries=new IS),n.queries.track(new RS(i,o))}function SA(n,i){return n.queries.getByIndex(i)}class zA{constructor(i){this.full=i;const o=i.split(".");this.major=o[0],this.minor=o[1],this.patch=o.slice(2).join(".")}}let HA=(()=>{var n;class i{log(l){console.log(l)}warn(l){console.warn(l)}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})();class uD{constructor(i,o){this.ngModuleFactory=i,this.componentFactories=o}}let dD=(()=>{var n;class i{compileModuleSync(l){return new An(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const u=this.compileModuleSync(l),y=Da(Os(l).declarations).reduce((x,C)=>{const U=Yi(C);return U&&x.push(new bp(U)),x},[]);return new uD(u,y)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})(),BS=(()=>{var n;class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Dt.X(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const l=this.taskId++;return this.pendingTasks.add(l),l}remove(l){this.pendingTasks.delete(l),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();const YA=new ue(""),qA=new ue("");let US,FD=(()=>{var n;class i{constructor(l,u,m){this._ngZone=l,this.registry=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,US||(function BD(n){US=n}(m),m.addToWindow(u)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ks.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(u=>!u.updateCb||!u.updateCb(l)||(clearTimeout(u.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,u,m){let y=-1;u&&u>0&&(y=setTimeout(()=>{this._callbacks=this._callbacks.filter(x=>x.timeoutId!==y),l(this._didWork,this.getPendingTasks())},u)),this._callbacks.push({doneCb:l,timeoutId:y,updateCb:m})}whenStable(l,u,m){if(m&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,u,m),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,u,m){return[]}}return(n=i).\u0275fac=function(l){return new(l||n)(ee(ks),ee(XA),ee(qA))},n.\u0275prov=Hi({token:n,factory:n.\u0275fac}),i})(),XA=(()=>{var n;class i{constructor(){this._applications=new Map}registerApplication(l,u){this._applications.set(l,u)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,u=!0){var m,y;return null!==(m=null===(y=US)||void 0===y?void 0:y.findTestabilityInTree(this,l,u))&&void 0!==m?m:null}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})();const ZA=new ue("Application Initializer");let VS=(()=>{var n;class i{constructor(){var l;this.initialized=!1,this.done=!1,this.donePromise=new Promise((u,m)=>{this.resolve=u,this.reject=m}),this.appInits=null!==(l=re(ZA,{optional:!0}))&&void 0!==l?l:[]}runInitializers(){if(this.initialized)return;const l=[];for(const m of this.appInits){const y=m();if(Iv(y))l.push(y);else if(Rv(y)){const x=new Promise((C,U)=>{y.subscribe({complete:C,error:U})});l.push(x)}}const u=()=>{this.done=!0,this.resolve()};Promise.all(l).then(()=>{u()}).catch(m=>{this.reject(m)}),0===l.length&&u(),this.initialized=!0}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();const zS=new ue("appBootstrapListener");function QA(n,i){return Array.isArray(i)?i.reduce(QA,n):{...n,...i}}let lm=(()=>{var n;class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=re(cp),this.componentTypes=[],this.components=[],this.isStable=re(BS).hasPendingTasks.pipe((0,nn.U)(l=>!l)),this._injector=re(cl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,u){const m=l instanceof g0;if(!this._injector.get(VS).done)throw!m&&Es(l),new gn(405,!1);let x;x=m?l:this._injector.get(Wc).resolveComponentFactory(l),this.componentTypes.push(x.componentType);const C=function UD(n){return n.isBoundToModule}(x)?void 0:this._injector.get(Ce),W=x.create(ja.NULL,[],u||x.selector,C),J=W.location.nativeElement,Me=W.injector.get(YA,null);return null==Me||Me.registerApplication(J),W.onDestroy(()=>{this.detachView(W.hostView),Tb(this.components,W),null==Me||Me.unregisterApplication(J)}),this._loadComponent(W),W}tick(){if(this._runningTick)throw new gn(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this.internalErrorHandler(l)}finally{this._runningTick=!1}}attachView(l){const u=l;this._views.push(u),u.attachToAppRef(this)}detachView(l){const u=l;Tb(this._views,u),u.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l);const u=this._injector.get(zS,[]);[...this._bootstrapListeners,...u].forEach(m=>m(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>Tb(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new gn(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function Tb(n,i){const o=n.indexOf(i);o>-1&&n.splice(o,1)}let zD=(()=>{var n;class i{constructor(){this.zone=re(ks),this.applicationRef=re(lm)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){var l;null===(l=this._onMicrotaskEmptySubscription)||void 0===l||l.unsubscribe()}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function HD(){const n=re(ks),i=re(Xa);return o=>n.runOutsideAngular(()=>i.handleError(o))}let GD=(()=>{var n;class i{constructor(){this.subscription=new Nt.w0,this.initialized=!1,this.zone=re(ks),this.pendingTasks=re(BS)}initialize(){if(this.initialized)return;this.initialized=!0;let l=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(l=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ks.assertNotInAngularZone(),queueMicrotask(()=>{null!==l&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(l),l=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{var u;ks.assertInAngularZone(),null!==(u=l)&&void 0!==u||(l=this.pendingTasks.add())}))}ngOnDestroy(){this.subscription.unsubscribe()}}return(n=i).\u0275fac=function(l){return new(l||n)},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();const Db=new ue("LocaleId",{providedIn:"root",factory:()=>re(Db,Ti.Optional|Ti.SkipSelf)||function WD(){return typeof $localize<"u"&&$localize.locale||Ud}()}),jD=new ue("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"}),HS=new ue("PlatformDestroyListeners");let iT=(()=>{var n;class i{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,u){const m=function n_(n="zone.js",i){return"noop"===n?new WC:"zone.js"===n?new ks(i):n}(null==u?void 0:u.ngZone,function nT(n){var i,o;return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:null!==(i=null==n?void 0:n.eventCoalescing)&&void 0!==i&&i,shouldCoalesceRunChangeDetection:null!==(o=null==n?void 0:n.runCoalescing)&&void 0!==o&&o}}({eventCoalescing:null==u?void 0:u.ngZoneEventCoalescing,runCoalescing:null==u?void 0:u.ngZoneRunCoalescing}));return m.run(()=>{const y=function yi(n,i,o){return new pn(n,i,o)}(l.moduleType,this.injector,function tT(n){return[{provide:ks,useFactory:n},{provide:Dc,multi:!0,useFactory:()=>{const i=re(zD,{optional:!0});return()=>i.initialize()}},{provide:Dc,multi:!0,useFactory:()=>{const i=re(GD);return()=>{i.initialize()}}},{provide:cp,useFactory:HD}]}(()=>m)),x=y.injector.get(Xa,null);return m.runOutsideAngular(()=>{const C=m.onError.subscribe({next:U=>{x.handleError(U)}});y.onDestroy(()=>{Tb(this._modules,y),C.unsubscribe()})}),function JA(n,i,o){try{const l=o();return Iv(l)?l.catch(u=>{throw i.runOutsideAngular(()=>n.handleError(u)),u}):l}catch(l){throw i.runOutsideAngular(()=>n.handleError(l)),l}}(x,m,()=>{const C=y.injector.get(VS);return C.runInitializers(),C.donePromise.then(()=>(function eb(n){ar(n,"Expected localeId to be defined"),"string"==typeof n&&(Q_=n.toLowerCase().replace(/_/g,"-"))}(y.injector.get(Db,Ud)||Ud),this._moduleDoBootstrap(y),y))})})}bootstrapModule(l,u=[]){const m=QA({},u);return function kD(n,i,o){const l=new An(o);return Promise.resolve(l)}(0,0,l).then(y=>this.bootstrapModuleFactory(y,m))}_moduleDoBootstrap(l){const u=l.injector.get(lm);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(m=>u.bootstrap(m));else{if(!l.instance.ngDoBootstrap)throw new gn(-403,!1);l.instance.ngDoBootstrap(u)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new gn(404,!1);this._modules.slice().forEach(u=>u.destroy()),this._destroyListeners.forEach(u=>u());const l=this._injector.get(HS,null);l&&(l.forEach(u=>u()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(n=i).\u0275fac=function(l){return new(l||n)(ee(ja))},n.\u0275prov=Hi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})(),Vd=null;const rT=new ue("AllowMultipleToken");function sT(n,i,o=[]){const l=`Platform: ${i}`,u=new ue(l);return(m=[])=>{let y=$S();if(!y||y.injector.get(rT,!1)){const x=[...o,...m,{provide:u,useValue:!0}];n?n(x):function qD(n){if(Vd&&!Vd.get(rT,!1))throw new gn(400,!1);(function KA(){!function wi(n){an=n}(()=>{throw new gn(600,!1)})})(),Vd=n;const i=n.get(iT);(function aT(n){const i=n.get(Sx,null);null==i||i.forEach(o=>o())})(n)}(function oT(n=[],i){return ja.create({name:i,providers:[{provide:Om,useValue:"platform"},{provide:HS,useValue:new Set([()=>Vd=null])},...n]})}(x,l))}return function XD(n){const i=$S();if(!i)throw new gn(401,!1);return i}()}}function $S(){var n,i;return null!==(n=null===(i=Vd)||void 0===i?void 0:i.get(iT))&&void 0!==n?n:null}function KD(){}const nI=sT(null,"core",[]);let iI=(()=>{var n;class i{constructor(l){}}return(n=i).\u0275fac=function(l){return new(l||n)(ee(lm))},n.\u0275mod=Po({type:n}),n.\u0275inj=_s({}),i})();function TI(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function II(n,i){const o=Yi(n),l=i.elementInjector||kf();return new bp(o).create(l,i.projectableNodes,i.hostElement,i.environmentInjector)}function RI(n){const i=Yi(n);if(!i)return null;const o=new bp(i);return{get selector(){return o.selector},get type(){return o.componentType},get inputs(){return o.inputs},get outputs(){return o.outputs},get ngContentSelectors(){return o.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}},95:(Kn,zt,te)=>{"use strict";te.d(zt,{u5:()=>_i,Fd:()=>xa,qQ:()=>rl,Cf:()=>He,JU:()=>We,a5:()=>ki});var f=te(9212),Ye=(te(6814),te(7715)),Ie=te(5592),ht=te(7453),Fe=te(4829),Be=te(4564),Tt=te(8251),Pt=te(7400),yt=te(2714),ft=te(7398);const We=new f.OlP("NgValueAccessor");function st($){return null==$||("string"==typeof $||Array.isArray($))&&0===$.length}const He=new f.OlP("NgValidators");function Le($){return null}function ve($){return null!=$}function De($){return(0,f.QGY)($)?(0,Ye.D)($):$}function xe($){let L={};return $.forEach(ae=>{L=null!=ae?{...L,...ae}:L}),0===Object.keys(L).length?null:L}function Mt($,L){return L.map(ae=>ae($))}function un($){return $.map(L=>function ct($){return!$.validate}(L)?L:ae=>L.validate(ae))}function vn($){return null!=$?function En($){if(!$)return null;const L=$.filter(ve);return 0==L.length?null:function(ae){return xe(Mt(ae,L))}}(un($)):null}function oi($){return null!=$?function Pn($){if(!$)return null;const L=$.filter(ve);return 0==L.length?null:function(ae){return function Oe(...$){const L=(0,Be.jO)($),{args:ae,keys:G}=(0,ht.D)($),ye=new Ie.y(Kt=>{const{length:ci}=ae;if(!ci)return void Kt.complete();const Tr=new Array(ci);let Vr=ci,Ls=ci;for(let Lo=0;Lo<ci;Lo++){let go=!1;(0,Fe.Xf)(ae[Lo]).subscribe((0,Tt.x)(Kt,Ma=>{go||(go=!0,Ls--),Tr[Lo]=Ma},()=>Vr--,void 0,()=>{(!Vr||!go)&&(Ls||Kt.next(G?(0,yt.n)(G,Tr):Tr),Kt.complete())}))}});return L?ye.pipe((0,Pt.Z)(L)):ye}(Mt(ae,L).map(De)).pipe((0,ft.U)(xe))}}(un($)):null}class ai{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(L){this._rawValidators=L||[],this._composedValidatorFn=vn(this._rawValidators)}_setAsyncValidators(L){this._rawAsyncValidators=L||[],this._composedAsyncValidatorFn=oi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(L){this._onDestroyCallbacks.push(L)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(L=>L()),this._onDestroyCallbacks=[]}reset(L=void 0){this.control&&this.control.reset(L)}hasError(L,ae){return!!this.control&&this.control.hasError(L,ae)}getError(L,ae){return this.control?this.control.getError(L,ae):null}}class ki extends ai{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}const eo=new f.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>$s}),$s="always";let re=(()=>{var $;class L{}return($=L).\u0275fac=function(G){return new(G||$)},$.\u0275mod=f.oAB({type:$}),$.\u0275inj=f.cJS({}),L})();function Hl($){return"number"==typeof $?$:parseFloat($)}let Bo=(()=>{var $;class L{constructor(){this._validator=Le}ngOnChanges(G){if(this.inputName in G){const ye=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(ye),this._validator=this._enabled?this.createValidator(ye):Le,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}}return($=L).\u0275fac=function(G){return new(G||$)},$.\u0275dir=f.lG2({type:$,features:[f.TTD]}),L})();const _u={provide:He,useExisting:(0,f.Gpc)(()=>xa),multi:!0};let xa=(()=>{var $;class L extends Bo{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=G=>Hl(G),this.createValidator=G=>function ot($){return L=>{if(st(L.value)||st($))return null;const ae=parseFloat(L.value);return!isNaN(ae)&&ae>$?{max:{max:$,actual:L.value}}:null}}(G)}}return($=L).\u0275fac=(()=>{let ae;return function(ye){return(ae||(ae=f.n5z($)))(ye||$)}})(),$.\u0275dir=f.lG2({type:$,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(G,ye){2&G&&f.uIk("max",ye._enabled?ye.max:null)},inputs:{max:"max"},features:[f._Bn([_u]),f.qOj]}),L})();const vc={provide:He,useExisting:(0,f.Gpc)(()=>rl),multi:!0};let rl=(()=>{var $;class L extends Bo{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=G=>Hl(G),this.createValidator=G=>function Ae($){return L=>{if(st(L.value)||st($))return null;const ae=parseFloat(L.value);return!isNaN(ae)&&ae<$?{min:{min:$,actual:L.value}}:null}}(G)}}return($=L).\u0275fac=(()=>{let ae;return function(ye){return(ae||(ae=f.n5z($)))(ye||$)}})(),$.\u0275dir=f.lG2({type:$,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(G,ye){2&G&&f.uIk("min",ye._enabled?ye.min:null)},inputs:{min:"min"},features:[f._Bn([vc]),f.qOj]}),L})(),Ua=(()=>{var $;class L{}return($=L).\u0275fac=function(G){return new(G||$)},$.\u0275mod=f.oAB({type:$}),$.\u0275inj=f.cJS({imports:[re]}),L})(),_i=(()=>{var $;class L{static withConfig(G){var ye;return{ngModule:L,providers:[{provide:eo,useValue:null!==(ye=G.callSetDisabledState)&&void 0!==ye?ye:$s}]}}}return($=L).\u0275fac=function(G){return new(G||$)},$.\u0275mod=f.oAB({type:$}),$.\u0275inj=f.cJS({imports:[Ua]}),L})()},6593:(Kn,zt,te)=>{"use strict";te.d(zt,{Dx:()=>$n,b2:()=>Dt,q6:()=>oi});var f=te(9212),ie=te(6814);class Ye extends ie.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Ie extends Ye{static makeCurrent(){(0,ie.HT)(new Ie)}onAndCancel(qe,_t,ke){return qe.addEventListener(_t,ke),()=>{qe.removeEventListener(_t,ke)}}dispatchEvent(qe,_t){qe.dispatchEvent(_t)}remove(qe){qe.parentNode&&qe.parentNode.removeChild(qe)}createElement(qe,_t){return(_t=_t||this.getDefaultDocument()).createElement(qe)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(qe){return qe.nodeType===Node.ELEMENT_NODE}isShadowRoot(qe){return qe instanceof DocumentFragment}getGlobalEventTarget(qe,_t){return"window"===_t?window:"document"===_t?qe:"body"===_t?qe.body:null}getBaseHref(qe){const _t=function Fe(){return ht=ht||document.querySelector("base"),ht?ht.getAttribute("href"):null}();return null==_t?null:function Be(Bt){return new URL(Bt,document.baseURI).pathname}(_t)}resetBaseElement(){ht=null}getUserAgent(){return window.navigator.userAgent}getCookie(qe){return(0,ie.Mx)(document.cookie,qe)}}let ht=null,Pt=(()=>{var Bt;class qe{build(){return new XMLHttpRequest}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();const yt=new f.OlP("EventManagerPlugins");let Oe=(()=>{var Bt;class qe{constructor(ke,mt){this._zone=mt,this._eventNameToPlugin=new Map,ke.forEach(sn=>{sn.manager=this}),this._plugins=ke.slice().reverse()}addEventListener(ke,mt,sn){return this._findPluginFor(mt).addEventListener(ke,mt,sn)}getZone(){return this._zone}_findPluginFor(ke){let mt=this._eventNameToPlugin.get(ke);if(mt)return mt;if(mt=this._plugins.find(wn=>wn.supports(ke)),!mt)throw new f.vHH(5101,!1);return this._eventNameToPlugin.set(ke,mt),mt}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(yt),f.LFG(f.R0b))},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();class ft{constructor(qe){this._doc=qe}}const lt="ng-app-id";let tt=(()=>{var Bt;class qe{constructor(ke,mt,sn,wn={}){this.doc=ke,this.appId=mt,this.nonce=sn,this.platformId=wn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,ie.PM)(wn),this.resetHostNodes()}addStyles(ke){for(const mt of ke)1===this.changeUsageCount(mt,1)&&this.onStyleAdded(mt)}removeStyles(ke){for(const mt of ke)this.changeUsageCount(mt,-1)<=0&&this.onStyleRemoved(mt)}ngOnDestroy(){const ke=this.styleNodesInDOM;ke&&(ke.forEach(mt=>mt.remove()),ke.clear());for(const mt of this.getAllStyles())this.onStyleRemoved(mt);this.resetHostNodes()}addHost(ke){this.hostNodes.add(ke);for(const mt of this.getAllStyles())this.addStyleToHost(ke,mt)}removeHost(ke){this.hostNodes.delete(ke)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(ke){for(const mt of this.hostNodes)this.addStyleToHost(mt,ke)}onStyleRemoved(ke){var mt;const sn=this.styleRef;null===(mt=sn.get(ke))||void 0===mt||null===(mt=mt.elements)||void 0===mt||mt.forEach(wn=>wn.remove()),sn.delete(ke)}collectServerRenderedStyles(){var ke;const mt=null===(ke=this.doc.head)||void 0===ke?void 0:ke.querySelectorAll(`style[${lt}="${this.appId}"]`);if(null!=mt&&mt.length){const sn=new Map;return mt.forEach(wn=>{null!=wn.textContent&&sn.set(wn.textContent,wn)}),sn}return null}changeUsageCount(ke,mt){const sn=this.styleRef;if(sn.has(ke)){const wn=sn.get(ke);return wn.usage+=mt,wn.usage}return sn.set(ke,{usage:mt,elements:[]}),mt}getStyleElement(ke,mt){const sn=this.styleNodesInDOM,wn=null==sn?void 0:sn.get(mt);if((null==wn?void 0:wn.parentNode)===ke)return sn.delete(mt),wn.removeAttribute(lt),wn;{const ti=this.doc.createElement("style");return this.nonce&&ti.setAttribute("nonce",this.nonce),ti.textContent=mt,this.platformIsServer&&ti.setAttribute(lt,this.appId),ke.appendChild(ti),ti}}addStyleToHost(ke,mt){var sn;const wn=this.getStyleElement(ke,mt),ti=this.styleRef,Ii=null===(sn=ti.get(mt))||void 0===sn?void 0:sn.elements;Ii?Ii.push(wn):ti.set(mt,{elements:[wn],usage:1})}resetHostNodes(){const ke=this.hostNodes;ke.clear(),ke.add(this.doc.head)}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(ie.K0),f.LFG(f.AFp),f.LFG(f.Ojb,8),f.LFG(f.Lbi))},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();const We={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Rt=/%COMP%/g,rt=new f.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function He(Bt,qe){return qe.map(_t=>_t.replace(Rt,Bt))}let pe=(()=>{var Bt;class qe{constructor(ke,mt,sn,wn,ti,Ii,Ui,$r=null){this.eventManager=ke,this.sharedStylesHost=mt,this.appId=sn,this.removeStylesOnCompDestroy=wn,this.doc=ti,this.platformId=Ii,this.ngZone=Ui,this.nonce=$r,this.rendererByCompId=new Map,this.platformIsServer=(0,ie.PM)(Ii),this.defaultRenderer=new ge(ke,ti,Ui,this.platformIsServer)}createRenderer(ke,mt){if(!ke||!mt)return this.defaultRenderer;this.platformIsServer&&mt.encapsulation===f.ifc.ShadowDom&&(mt={...mt,encapsulation:f.ifc.Emulated});const sn=this.getOrCreateRenderer(ke,mt);return sn instanceof an?sn.applyToHost(ke):sn instanceof ut&&sn.applyStyles(),sn}getOrCreateRenderer(ke,mt){const sn=this.rendererByCompId;let wn=sn.get(mt.id);if(!wn){const ti=this.doc,Ii=this.ngZone,Ui=this.eventManager,$r=this.sharedStylesHost,ar=this.removeStylesOnCompDestroy,Yn=this.platformIsServer;switch(mt.encapsulation){case f.ifc.Emulated:wn=new an(Ui,$r,mt,this.appId,ar,ti,Ii,Yn);break;case f.ifc.ShadowDom:return new at(Ui,$r,ke,mt,ti,Ii,this.nonce,Yn);default:wn=new ut(Ui,$r,mt,ar,ti,Ii,Yn)}sn.set(mt.id,wn)}return wn}ngOnDestroy(){this.rendererByCompId.clear()}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(Oe),f.LFG(tt),f.LFG(f.AFp),f.LFG(rt),f.LFG(ie.K0),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(f.Ojb))},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();class ge{constructor(qe,_t,ke,mt){this.eventManager=qe,this.doc=_t,this.ngZone=ke,this.platformIsServer=mt,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(qe,_t){return _t?this.doc.createElementNS(We[_t]||_t,qe):this.doc.createElement(qe)}createComment(qe){return this.doc.createComment(qe)}createText(qe){return this.doc.createTextNode(qe)}appendChild(qe,_t){(ot(qe)?qe.content:qe).appendChild(_t)}insertBefore(qe,_t,ke){qe&&(ot(qe)?qe.content:qe).insertBefore(_t,ke)}removeChild(qe,_t){qe&&qe.removeChild(_t)}selectRootElement(qe,_t){let ke="string"==typeof qe?this.doc.querySelector(qe):qe;if(!ke)throw new f.vHH(-5104,!1);return _t||(ke.textContent=""),ke}parentNode(qe){return qe.parentNode}nextSibling(qe){return qe.nextSibling}setAttribute(qe,_t,ke,mt){if(mt){_t=mt+":"+_t;const sn=We[mt];sn?qe.setAttributeNS(sn,_t,ke):qe.setAttribute(_t,ke)}else qe.setAttribute(_t,ke)}removeAttribute(qe,_t,ke){if(ke){const mt=We[ke];mt?qe.removeAttributeNS(mt,_t):qe.removeAttribute(`${ke}:${_t}`)}else qe.removeAttribute(_t)}addClass(qe,_t){qe.classList.add(_t)}removeClass(qe,_t){qe.classList.remove(_t)}setStyle(qe,_t,ke,mt){mt&(f.JOm.DashCase|f.JOm.Important)?qe.style.setProperty(_t,ke,mt&f.JOm.Important?"important":""):qe.style[_t]=ke}removeStyle(qe,_t,ke){ke&f.JOm.DashCase?qe.style.removeProperty(_t):qe.style[_t]=""}setProperty(qe,_t,ke){null!=qe&&(qe[_t]=ke)}setValue(qe,_t){qe.nodeValue=_t}listen(qe,_t,ke){if("string"==typeof qe&&!(qe=(0,ie.q)().getGlobalEventTarget(this.doc,qe)))throw new Error(`Unsupported event target ${qe} for event ${_t}`);return this.eventManager.addEventListener(qe,_t,this.decoratePreventDefault(ke))}decoratePreventDefault(qe){return _t=>{if("__ngUnwrap__"===_t)return qe;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>qe(_t)):qe(_t))&&_t.preventDefault()}}}function ot(Bt){return"TEMPLATE"===Bt.tagName&&void 0!==Bt.content}class at extends ge{constructor(qe,_t,ke,mt,sn,wn,ti,Ii){super(qe,sn,wn,Ii),this.sharedStylesHost=_t,this.hostEl=ke,this.shadowRoot=ke.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ui=He(mt.id,mt.styles);for(const $r of Ui){const ar=document.createElement("style");ti&&ar.setAttribute("nonce",ti),ar.textContent=$r,this.shadowRoot.appendChild(ar)}}nodeOrShadowRoot(qe){return qe===this.hostEl?this.shadowRoot:qe}appendChild(qe,_t){return super.appendChild(this.nodeOrShadowRoot(qe),_t)}insertBefore(qe,_t,ke){return super.insertBefore(this.nodeOrShadowRoot(qe),_t,ke)}removeChild(qe,_t){return super.removeChild(this.nodeOrShadowRoot(qe),_t)}parentNode(qe){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(qe)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ut extends ge{constructor(qe,_t,ke,mt,sn,wn,ti,Ii){super(qe,sn,wn,ti),this.sharedStylesHost=_t,this.removeStylesOnCompDestroy=mt,this.styles=Ii?He(Ii,ke.styles):ke.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class an extends ut{constructor(qe,_t,ke,mt,sn,wn,ti,Ii){const Ui=mt+"-"+ke.id;super(qe,_t,ke,sn,wn,ti,Ii,Ui),this.contentAttr=function st(Bt){return"_ngcontent-%COMP%".replace(Rt,Bt)}(Ui),this.hostAttr=function bt(Bt){return"_nghost-%COMP%".replace(Rt,Bt)}(Ui)}applyToHost(qe){this.applyStyles(),this.setAttribute(qe,this.hostAttr,"")}createElement(qe,_t){const ke=super.createElement(qe,_t);return super.setAttribute(ke,this.contentAttr,""),ke}}let zn=(()=>{var Bt;class qe extends ft{constructor(ke){super(ke)}supports(ke){return!0}addEventListener(ke,mt,sn){return ke.addEventListener(mt,sn,!1),()=>this.removeEventListener(ke,mt,sn)}removeEventListener(ke,mt,sn){return ke.removeEventListener(mt,sn)}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(ie.K0))},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();const wi=["alt","control","meta","shift"],Ot={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Le={alt:Bt=>Bt.altKey,control:Bt=>Bt.ctrlKey,meta:Bt=>Bt.metaKey,shift:Bt=>Bt.shiftKey};let ve=(()=>{var Bt;class qe extends ft{constructor(ke){super(ke)}supports(ke){return null!=qe.parseEventName(ke)}addEventListener(ke,mt,sn){const wn=qe.parseEventName(mt),ti=qe.eventCallback(wn.fullKey,sn,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,ie.q)().onAndCancel(ke,wn.domEventName,ti))}static parseEventName(ke){const mt=ke.toLowerCase().split("."),sn=mt.shift();if(0===mt.length||"keydown"!==sn&&"keyup"!==sn)return null;const wn=qe._normalizeKey(mt.pop());let ti="",Ii=mt.indexOf("code");if(Ii>-1&&(mt.splice(Ii,1),ti="code."),wi.forEach($r=>{const ar=mt.indexOf($r);ar>-1&&(mt.splice(ar,1),ti+=$r+".")}),ti+=wn,0!=mt.length||0===wn.length)return null;const Ui={};return Ui.domEventName=sn,Ui.fullKey=ti,Ui}static matchEventFullKeyCode(ke,mt){let sn=Ot[ke.key]||ke.key,wn="";return mt.indexOf("code.")>-1&&(sn=ke.code,wn="code."),!(null==sn||!sn)&&(sn=sn.toLowerCase()," "===sn?sn="space":"."===sn&&(sn="dot"),wi.forEach(ti=>{ti!==sn&&(0,Le[ti])(ke)&&(wn+=ti+".")}),wn+=sn,wn===mt)}static eventCallback(ke,mt,sn){return wn=>{qe.matchEventFullKeyCode(wn,ke)&&sn.runGuarded(()=>mt(wn))}}static _normalizeKey(ke){return"esc"===ke?"escape":ke}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(ie.K0))},Bt.\u0275prov=f.Yz7({token:Bt,factory:Bt.\u0275fac}),qe})();const oi=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:ie.bD},{provide:f.g9A,useValue:function un(){Ie.makeCurrent()},multi:!0},{provide:ie.K0,useFactory:function vn(){return(0,f.RDi)(document),document},deps:[]}]),Si=new f.OlP(""),Xt=[{provide:f.rWj,useClass:class Tt{addToWindow(qe){f.dqk.getAngularTestability=(ke,mt=!0)=>{const sn=qe.findTestabilityInTree(ke,mt);if(null==sn)throw new f.vHH(5103,!1);return sn},f.dqk.getAllAngularTestabilities=()=>qe.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>qe.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(ke=>{const mt=f.dqk.getAllAngularTestabilities();let sn=mt.length,wn=!1;const ti=function(Ii){wn=wn||Ii,sn--,0==sn&&ke(wn)};mt.forEach(Ii=>{Ii.whenStable(ti)})})}findTestabilityInTree(qe,_t,ke){if(null==_t)return null;const mt=qe.getTestability(_t);return null!=mt?mt:ke?(0,ie.q)().isShadowRoot(_t)?this.findTestabilityInTree(qe,_t.host,!0):this.findTestabilityInTree(qe,_t.parentElement,!0):null}},deps:[]},{provide:f.lri,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]}],Nt=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function En(){return new f.qLn},deps:[]},{provide:yt,useClass:zn,multi:!0,deps:[ie.K0,f.R0b,f.Lbi]},{provide:yt,useClass:ve,multi:!0,deps:[ie.K0]},pe,tt,Oe,{provide:f.FYo,useExisting:pe},{provide:ie.JF,useClass:Pt,deps:[]},[]];let Dt=(()=>{var Bt;class qe{constructor(ke){}static withServerTransition(ke){return{ngModule:qe,providers:[{provide:f.AFp,useValue:ke.appId}]}}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(Si,12))},Bt.\u0275mod=f.oAB({type:Bt}),Bt.\u0275inj=f.cJS({providers:[...Nt,...Xt],imports:[ie.ez,f.hGG]}),qe})(),$n=(()=>{var Bt;class qe{constructor(ke){this._doc=ke}getTitle(){return this._doc.title}setTitle(ke){this._doc.title=ke||""}}return(Bt=qe).\u0275fac=function(ke){return new(ke||Bt)(f.LFG(ie.K0))},Bt.\u0275prov=f.Yz7({token:Bt,factory:function(ke){let mt=null;return mt=ke?new ke:function ai(){return new $n((0,f.LFG)(ie.K0))}(),mt},providedIn:"root"}),qe})();typeof window<"u"&&window},899:(Kn,zt,te)=>{"use strict";te.d(zt,{gz:()=>Oi,y6:()=>gi,OD:()=>yn,eC:()=>kt,wm:()=>hi,wN:()=>Ws,F0:()=>Mi,rH:()=>ql,Bz:()=>Ru,Hx:()=>Ur});var f=te(9212),ie=te(5592),Ye=te(4674),ht=te(7715),Fe=te(2096),Be=te(5619),Tt=te(2572);const yt=(0,te(2306).d)(E=>function(){E(this),this.name="EmptyError",this.message="no elements in sequence"});var Oe=te(1631),ft=te(2737);function lt(E=1/0){return(0,Oe.z)(ft.y,E)}var We=te(4564);function Rt(...E){return function tt(){return lt(1)}()((0,ht.D)(E,(0,We.yG)(E)))}var Ke=te(4829);function Je(E){return new ie.y(A=>{(0,Ke.Xf)(E()).subscribe(A)})}var et=te(8407);function $t(E,A){const O=(0,Ye.m)(E)?E:()=>E,S=N=>N.error(O());return new ie.y(A?N=>A.schedule(S,0,N):S)}const rt=new ie.y(E=>E.complete());var He=te(7394),pe=te(9360),ge=te(8251);function Ue(){return(0,pe.e)((E,A)=>{let O=null;E._refCount++;const S=(0,ge.x)(A,void 0,void 0,void 0,()=>{if(!E||E._refCount<=0||0<--E._refCount)return void(O=null);const N=E._connection,K=O;O=null,N&&(!K||N===K)&&N.unsubscribe(),A.unsubscribe()});E.subscribe(S),S.closed||(O=E.connect())})}class Ae extends ie.y{constructor(A,O){super(),this.source=A,this.subjectFactory=O,this._subject=null,this._refCount=0,this._connection=null,(0,pe.A)(A)&&(this.lift=A.lift)}_subscribe(A){return this.getSubject().subscribe(A)}getSubject(){const A=this._subject;return(!A||A.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:A}=this;this._subject=this._connection=null,null==A||A.unsubscribe()}connect(){let A=this._connection;if(!A){A=this._connection=new He.w0;const O=this.getSubject();A.add(this.source.subscribe((0,ge.x)(O,void 0,()=>{this._teardown(),O.complete()},S=>{this._teardown(),O.error(S)},()=>this._teardown()))),A.closed&&(this._connection=null,A=He.w0.EMPTY)}return A}refCount(){return Ue()(this)}}var ot=te(8645),at=te(6814),ut=te(7398),an=te(4664);function zn(E){return E<=0?()=>rt:(0,pe.e)((A,O)=>{let S=0;A.subscribe((0,ge.x)(O,N=>{++S<=E&&(O.next(N),E<=S&&O.complete())}))})}var Ot=te(2181);function Le(E){return(0,pe.e)((A,O)=>{let S=!1;A.subscribe((0,ge.x)(O,N=>{S=!0,O.next(N)},()=>{S||O.next(E),O.complete()}))})}function ve(E=De){return(0,pe.e)((A,O)=>{let S=!1;A.subscribe((0,ge.x)(O,N=>{S=!0,O.next(N)},()=>S?O.complete():O.error(E())))})}function De(){return new yt}function xe(E,A){const O=arguments.length>=2;return S=>S.pipe(E?(0,Ot.h)((N,K)=>E(N,K,S)):ft.y,zn(1),O?Le(A):ve(()=>new yt))}function Mt(E,A){return(0,Ye.m)(A)?(0,Oe.z)(E,A,1):(0,Oe.z)(E,1)}function ct(E,A,O){const S=(0,Ye.m)(E)||A||O?{next:E,error:A,complete:O}:E;return S?(0,pe.e)((N,K)=>{var le;null===(le=S.subscribe)||void 0===le||le.call(S);let it=!0;N.subscribe((0,ge.x)(K,Ct=>{var vt;null===(vt=S.next)||void 0===vt||vt.call(S,Ct),K.next(Ct)},()=>{var Ct;it=!1,null===(Ct=S.complete)||void 0===Ct||Ct.call(S),K.complete()},Ct=>{var vt;it=!1,null===(vt=S.error)||void 0===vt||vt.call(S,Ct),K.error(Ct)},()=>{var Ct,vt;it&&(null===(Ct=S.unsubscribe)||void 0===Ct||Ct.call(S)),null===(vt=S.finalize)||void 0===vt||vt.call(S)}))}):ft.y}function un(E){return(0,pe.e)((A,O)=>{let K,S=null,N=!1;S=A.subscribe((0,ge.x)(O,void 0,void 0,le=>{K=(0,Ke.Xf)(E(le,un(E)(A))),S?(S.unsubscribe(),S=null,K.subscribe(O)):N=!0})),N&&(S.unsubscribe(),S=null,K.subscribe(O))})}function Pn(E){return E<=0?()=>rt:(0,pe.e)((A,O)=>{let S=[];A.subscribe((0,ge.x)(O,N=>{S.push(N),E<S.length&&S.shift()},()=>{for(const N of S)O.next(N);O.complete()},void 0,()=>{S=null}))})}function Xt(E){return(0,pe.e)((A,O)=>{try{A.subscribe(O)}finally{O.add(E)}})}var Nt=te(2420),nn=te(6593);const kt="primary",Qn=Symbol("RouteTitle");class ai{constructor(A){this.params=A||{}}has(A){return Object.prototype.hasOwnProperty.call(this.params,A)}get(A){if(this.has(A)){const O=this.params[A];return Array.isArray(O)?O[0]:O}return null}getAll(A){if(this.has(A)){const O=this.params[A];return Array.isArray(O)?O:[O]}return[]}get keys(){return Object.keys(this.params)}}function $n(E){return new ai(E)}function ki(E,A,O){const S=O.path.split("/");if(S.length>E.length||"full"===O.pathMatch&&(A.hasChildren()||S.length<E.length))return null;const N={};for(let K=0;K<S.length;K++){const le=S[K],it=E[K];if(le.startsWith(":"))N[le.substring(1)]=it;else if(le!==it.path)return null}return{consumed:E.slice(0,S.length),posParams:N}}function or(E,A){const O=E?Rn(E):void 0,S=A?Rn(A):void 0;if(!O||!S||O.length!=S.length)return!1;let N;for(let K=0;K<O.length;K++)if(N=O[K],!mi(E[N],A[N]))return!1;return!0}function Rn(E){return[...Object.keys(E),...Object.getOwnPropertySymbols(E)]}function mi(E,A){if(Array.isArray(E)&&Array.isArray(A)){if(E.length!==A.length)return!1;const O=[...E].sort(),S=[...A].sort();return O.every((N,K)=>S[K]===N)}return E===A}function di(E){return E.length>0?E[E.length-1]:null}function Mr(E){return function Ie(E){return!!E&&(E instanceof ie.y||(0,Ye.m)(E.lift)&&(0,Ye.m)(E.subscribe))}(E)?E:(0,f.QGY)(E)?(0,ht.D)(Promise.resolve(E)):(0,Fe.of)(E)}const Or={exact:function es(E,A,O){if(!ds(E.segments,A.segments)||!Cr(E.segments,A.segments,O)||E.numberOfChildren!==A.numberOfChildren)return!1;for(const S in A.children)if(!E.children[S]||!es(E.children[S],A.children[S],O))return!1;return!0},subset:qr},gn={exact:function ur(E,A){return or(E,A)},subset:function xi(E,A){return Object.keys(A).length<=Object.keys(E).length&&Object.keys(A).every(O=>mi(E[O],A[O]))},ignored:()=>!0};function wr(E,A,O){return Or[O.paths](E.root,A.root,O.matrixParams)&&gn[O.queryParams](E.queryParams,A.queryParams)&&!("exact"===O.fragment&&E.fragment!==A.fragment)}function qr(E,A,O){return Jn(E,A,A.segments,O)}function Jn(E,A,O,S){if(E.segments.length>O.length){const N=E.segments.slice(0,O.length);return!(!ds(N,O)||A.hasChildren()||!Cr(N,O,S))}if(E.segments.length===O.length){if(!ds(E.segments,O)||!Cr(E.segments,O,S))return!1;for(const N in A.children)if(!E.children[N]||!qr(E.children[N],A.children[N],S))return!1;return!0}{const N=O.slice(0,E.segments.length),K=O.slice(E.segments.length);return!!(ds(E.segments,N)&&Cr(E.segments,N,S)&&E.children[kt])&&Jn(E.children[kt],A,K,S)}}function Cr(E,A,O){return A.every((S,N)=>gn[O](E[N].parameters,S.parameters))}class us{constructor(A=new Mn([],{}),O={},S=null){this.root=A,this.queryParams=O,this.fragment=S}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$n(this.queryParams)),this._queryParamMap}toString(){return Lr.serialize(this)}}class Mn{constructor(A,O){this.segments=A,this.children=O,this.parent=null,Object.values(O).forEach(S=>S.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mr(this)}}class Ei{constructor(A,O){this.path=A,this.parameters=O}get parameterMap(){return this._parameterMap||(this._parameterMap=$n(this.parameters)),this._parameterMap}toString(){return wn(this)}}function ds(E,A){return E.length===A.length&&E.every((O,S)=>O.path===A[S].path)}let Ur=(()=>{var E;class A{}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:()=>new Xr,providedIn:"root"}),A})();class Xr{parse(A){const O=new Hi(A);return new us(O.parseRootSegment(),O.parseQueryParams(),O.parseFragment())}serialize(A){const O=`/${ys(A.root,!0)}`,S=function Ii(E){const A=Object.keys(E).map(O=>{const S=E[O];return Array.isArray(S)?S.map(N=>`${qe(O)}=${qe(N)}`).join("&"):`${qe(O)}=${qe(S)}`}).filter(O=>!!O);return A.length?`?${A.join("&")}`:""}(A.queryParams);return`${O}${S}${"string"==typeof A.fragment?`#${function _t(E){return encodeURI(E)}(A.fragment)}`:""}`}}const Lr=new Xr;function mr(E){return E.segments.map(A=>wn(A)).join("/")}function ys(E,A){if(!E.hasChildren())return mr(E);if(A){const O=E.children[kt]?ys(E.children[kt],!1):"",S=[];return Object.entries(E.children).forEach(([N,K])=>{N!==kt&&S.push(`${N}:${ys(K,!1)}`)}),S.length>0?`${O}(${S.join("//")})`:O}{const O=function Qs(E,A){let O=[];return Object.entries(E.children).forEach(([S,N])=>{S===kt&&(O=O.concat(A(N,S)))}),Object.entries(E.children).forEach(([S,N])=>{S!==kt&&(O=O.concat(A(N,S)))}),O}(E,(S,N)=>N===kt?[ys(E.children[kt],!1)]:[`${N}:${ys(S,!1)}`]);return 1===Object.keys(E.children).length&&null!=E.children[kt]?`${mr(E)}/${O[0]}`:`${mr(E)}/(${O.join("//")})`}}function Bt(E){return encodeURIComponent(E).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qe(E){return Bt(E).replace(/%3B/gi,";")}function ke(E){return Bt(E).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function mt(E){return decodeURIComponent(E)}function sn(E){return mt(E.replace(/\+/g,"%20"))}function wn(E){return`${ke(E.path)}${function ti(E){return Object.keys(E).map(A=>`;${ke(A)}=${ke(E[A])}`).join("")}(E.parameters)}`}const Ui=/^[^\/()?;#]+/;function $r(E){const A=E.match(Ui);return A?A[0]:""}const ar=/^[^\/()?;=#]+/,Hs=/^[^=?&#]+/,$s=/^[^&#]+/;class Hi{constructor(A){this.url=A,this.remaining=A}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Mn([],{}):new Mn([],this.parseChildren())}parseQueryParams(){const A={};if(this.consumeOptional("?"))do{this.parseQueryParam(A)}while(this.consumeOptional("&"));return A}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const A=[];for(this.peekStartsWith("(")||A.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),A.push(this.parseSegment());let O={};this.peekStartsWith("/(")&&(this.capture("/"),O=this.parseParens(!0));let S={};return this.peekStartsWith("(")&&(S=this.parseParens(!1)),(A.length>0||Object.keys(O).length>0)&&(S[kt]=new Mn(A,O)),S}parseSegment(){const A=$r(this.remaining);if(""===A&&this.peekStartsWith(";"))throw new f.vHH(4009,!1);return this.capture(A),new Ei(mt(A),this.parseMatrixParams())}parseMatrixParams(){const A={};for(;this.consumeOptional(";");)this.parseParam(A);return A}parseParam(A){const O=function Yn(E){const A=E.match(ar);return A?A[0]:""}(this.remaining);if(!O)return;this.capture(O);let S="";if(this.consumeOptional("=")){const N=$r(this.remaining);N&&(S=N,this.capture(S))}A[mt(O)]=mt(S)}parseQueryParam(A){const O=function eo(E){const A=E.match(Hs);return A?A[0]:""}(this.remaining);if(!O)return;this.capture(O);let S="";if(this.consumeOptional("=")){const le=function fo(E){const A=E.match($s);return A?A[0]:""}(this.remaining);le&&(S=le,this.capture(S))}const N=sn(O),K=sn(S);if(A.hasOwnProperty(N)){let le=A[N];Array.isArray(le)||(le=[le],A[N]=le),le.push(K)}else A[N]=K}parseParens(A){const O={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const S=$r(this.remaining),N=this.remaining[S.length];if("/"!==N&&")"!==N&&";"!==N)throw new f.vHH(4010,!1);let K;S.indexOf(":")>-1?(K=S.slice(0,S.indexOf(":")),this.capture(K),this.capture(":")):A&&(K=kt);const le=this.parseChildren();O[K]=1===Object.keys(le).length?le[kt]:new Mn([],le),this.consumeOptional("//")}return O}peekStartsWith(A){return this.remaining.startsWith(A)}consumeOptional(A){return!!this.peekStartsWith(A)&&(this.remaining=this.remaining.substring(A.length),!0)}capture(A){if(!this.consumeOptional(A))throw new f.vHH(4011,!1)}}function Gs(E){return E.segments.length>0?new Mn([],{[kt]:E}):E}function _s(E){const A={};for(const S of Object.keys(E.children)){const K=_s(E.children[S]);if(S===kt&&0===K.segments.length&&K.hasChildren())for(const[le,it]of Object.entries(K.children))A[le]=it;else(K.segments.length>0||K.hasChildren())&&(A[S]=K)}return function Cs(E){if(1===E.numberOfChildren&&E.children[kt]){const A=E.children[kt];return new Mn(E.segments.concat(A.segments),A.children)}return E}(new Mn(E.segments,A))}function er(E){return E instanceof us}function po(E){var A;let O;const K=Gs(function S(le){const it={};for(const vt of le.children){const Ln=S(vt);it[vt.outlet]=Ln}const Ct=new Mn(le.url,it);return le===E&&(O=Ct),Ct}(E.root));return null!==(A=O)&&void 0!==A?A:K}function As(E,A,O,S){let N=E;for(;N.parent;)N=N.parent;if(0===A.length)return Ts(N,N,N,O,S);const K=function ts(E){if("string"==typeof E[0]&&1===E.length&&"/"===E[0])return new Ti(!0,0,E);let A=0,O=!1;const S=E.reduce((N,K,le)=>{if("object"==typeof K&&null!=K){if(K.outlets){const it={};return Object.entries(K.outlets).forEach(([Ct,vt])=>{it[Ct]="string"==typeof vt?vt.split("/"):vt}),[...N,{outlets:it}]}if(K.segmentPath)return[...N,K.segmentPath]}return"string"!=typeof K?[...N,K]:0===le?(K.split("/").forEach((it,Ct)=>{0==Ct&&"."===it||(0==Ct&&""===it?O=!0:".."===it?A++:""!=it&&N.push(it))}),N):[...N,K]},[]);return new Ti(O,A,S)}(A);if(K.toRoot())return Ts(N,N,new Mn([],{}),O,S);const le=function li(E,A,O){if(E.isAbsolute)return new ir(A,!0,0);if(!O)return new ir(A,!1,NaN);if(null===O.parent)return new ir(O,!0,0);const S=Sr(E.commands[0])?0:1;return function Mo(E,A,O){let S=E,N=A,K=O;for(;K>N;){if(K-=N,S=S.parent,!S)throw new f.vHH(4005,!1);N=S.segments.length}return new ir(S,!1,N-K)}(O,O.segments.length-1+S,E.numberOfDoubleDots)}(K,N,E),it=le.processChildren?Rs(le.segmentGroup,le.index,K.commands):gr(le.segmentGroup,le.index,K.commands);return Ts(N,le.segmentGroup,it,O,S)}function Sr(E){return"object"==typeof E&&null!=E&&!E.outlets&&!E.segmentPath}function fs(E){return"object"==typeof E&&null!=E&&E.outlets}function Ts(E,A,O,S,N){let le,K={};S&&Object.entries(S).forEach(([Ct,vt])=>{K[Ct]=Array.isArray(vt)?vt.map(Ln=>`${Ln}`):`${vt}`}),le=E===A?O:Rr(E,A,O);const it=Gs(_s(le));return new us(it,K,N)}function Rr(E,A,O){const S={};return Object.entries(E.children).forEach(([N,K])=>{S[N]=K===A?O:Rr(K,A,O)}),new Mn(E.segments,S)}class Ti{constructor(A,O,S){if(this.isAbsolute=A,this.numberOfDoubleDots=O,this.commands=S,A&&S.length>0&&Sr(S[0]))throw new f.vHH(4003,!1);const N=S.find(fs);if(N&&N!==di(S))throw new f.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ir{constructor(A,O,S){this.segmentGroup=A,this.processChildren=O,this.index=S}}function gr(E,A,O){if(E||(E=new Mn([],{})),0===E.segments.length&&E.hasChildren())return Rs(E,A,O);const S=function to(E,A,O){let S=0,N=A;const K={match:!1,pathIndex:0,commandIndex:0};for(;N<E.segments.length;){if(S>=O.length)return K;const le=E.segments[N],it=O[S];if(fs(it))break;const Ct=`${it}`,vt=S<O.length-1?O[S+1]:null;if(N>0&&void 0===Ct)break;if(Ct&&vt&&"object"==typeof vt&&void 0===vt.outlets){if(!me(Ct,vt,le))return K;S+=2}else{if(!me(Ct,{},le))return K;S++}N++}return{match:!0,pathIndex:N,commandIndex:S}}(E,A,O),N=O.slice(S.commandIndex);if(S.match&&S.pathIndex<E.segments.length){const K=new Mn(E.segments.slice(0,S.pathIndex),{});return K.children[kt]=new Mn(E.segments.slice(S.pathIndex),E.children),Rs(K,0,N)}return S.match&&0===N.length?new Mn(E.segments,{}):S.match&&!E.hasChildren()?ue(E,A,O):S.match?Rs(E,0,N):ue(E,A,O)}function Rs(E,A,O){if(0===O.length)return new Mn(E.segments,{});{const S=function bs(E){return fs(E[0])?E[0].outlets:{[kt]:E}}(O),N={};if(Object.keys(S).some(K=>K!==kt)&&E.children[kt]&&1===E.numberOfChildren&&0===E.children[kt].segments.length){const K=Rs(E.children[kt],A,O);return new Mn(E.segments,K.children)}return Object.entries(S).forEach(([K,le])=>{"string"==typeof le&&(le=[le]),null!==le&&(N[K]=gr(E.children[K],A,le))}),Object.entries(E.children).forEach(([K,le])=>{void 0===S[K]&&(N[K]=le)}),new Mn(E.segments,N)}}function ue(E,A,O){const S=E.segments.slice(0,A);let N=0;for(;N<O.length;){const K=O[N];if(fs(K)){const Ct=be(K.outlets);return new Mn(S,Ct)}if(0===N&&Sr(O[0])){S.push(new Ei(E.segments[A].path,Z(O[0]))),N++;continue}const le=fs(K)?K.outlets[kt]:`${K}`,it=N<O.length-1?O[N+1]:null;le&&it&&Sr(it)?(S.push(new Ei(le,Z(it))),N+=2):(S.push(new Ei(le,{})),N++)}return new Mn(S,{})}function be(E){const A={};return Object.entries(E).forEach(([O,S])=>{"string"==typeof S&&(S=[S]),null!==S&&(A[O]=ue(new Mn([],{}),0,S))}),A}function Z(E){const A={};return Object.entries(E).forEach(([O,S])=>A[O]=`${S}`),A}function me(E,A,O){return E==O.path&&or(A,O.parameters)}const Qe="imperative";class Gt{constructor(A,O){this.id=A,this.url=O}}class yn extends Gt{constructor(A,O,S="imperative",N=null){super(A,O),this.type=0,this.navigationTrigger=S,this.restoredState=N}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class B extends Gt{constructor(A,O,S){super(A,O),this.urlAfterRedirects=S,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Y extends Gt{constructor(A,O,S,N){super(A,O),this.reason=S,this.code=N,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fe extends Gt{constructor(A,O,S,N){super(A,O),this.reason=S,this.code=N,this.type=16}}class Ne extends Gt{constructor(A,O,S,N){super(A,O),this.error=S,this.target=N,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Et extends Gt{constructor(A,O,S,N){super(A,O),this.urlAfterRedirects=S,this.state=N,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xe extends Gt{constructor(A,O,S,N){super(A,O),this.urlAfterRedirects=S,this.state=N,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wt extends Gt{constructor(A,O,S,N,K){super(A,O),this.urlAfterRedirects=S,this.state=N,this.shouldActivate=K,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Yt extends Gt{constructor(A,O,S,N){super(A,O),this.urlAfterRedirects=S,this.state=N,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cn extends Gt{constructor(A,O,S,N){super(A,O),this.urlAfterRedirects=S,this.state=N,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zt{constructor(A){this.route=A,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Cn{constructor(A){this.route=A,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Gn{constructor(A){this.snapshot=A,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class On{constructor(A){this.snapshot=A,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $i{constructor(A){this.snapshot=A,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dr{constructor(A){this.snapshot=A,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T{constructor(A,O,S){this.routerEvent=A,this.position=O,this.anchor=S,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ee{}class F{constructor(A){this.url=A}}class Ze{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new gi,this.attachRef=null}}let gi=(()=>{var E;class A{constructor(){this.contexts=new Map}onChildOutletCreated(S,N){const K=this.getOrCreateContext(S);K.outlet=N,this.contexts.set(S,K)}onChildOutletDestroyed(S){const N=this.getContext(S);N&&(N.outlet=null,N.attachRef=null)}onOutletDeactivated(){const S=this.contexts;return this.contexts=new Map,S}onOutletReAttached(S){this.contexts=S}getOrCreateContext(S){let N=this.getContext(S);return N||(N=new Ze,this.contexts.set(S,N)),N}getContext(S){return this.contexts.get(S)||null}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();class Pr{constructor(A){this._root=A}get root(){return this._root.value}parent(A){const O=this.pathFromRoot(A);return O.length>1?O[O.length-2]:null}children(A){const O=ns(A,this._root);return O?O.children.map(S=>S.value):[]}firstChild(A){const O=ns(A,this._root);return O&&O.children.length>0?O.children[0].value:null}siblings(A){const O=Ro(A,this._root);return O.length<2?[]:O[O.length-2].children.map(N=>N.value).filter(N=>N!==A)}pathFromRoot(A){return Ro(A,this._root).map(O=>O.value)}}function ns(E,A){if(E===A.value)return A;for(const O of A.children){const S=ns(E,O);if(S)return S}return null}function Ro(E,A){if(E===A.value)return[A];for(const O of A.children){const S=Ro(E,O);if(S.length)return S.unshift(A),S}return[]}class Zr{constructor(A,O){this.value=A,this.children=O}toString(){return`TreeNode(${this.value})`}}function Ps(E){const A={};return E&&E.children.forEach(O=>A[O.value.outlet]=O),A}class mo extends Pr{constructor(A,O){super(A),this.snapshot=O,Vl(this,A)}toString(){return this.snapshot.toString()}}function tr(E,A){const O=function is(E,A){const le=new qo([],{},{},"",{},kt,A,null,{});return new ka("",new Zr(le,[]))}(0,A),S=new Be.X([new Ei("",{})]),N=new Be.X({}),K=new Be.X({}),le=new Be.X({}),it=new Be.X(""),Ct=new Oi(S,N,le,it,K,kt,A,O.root);return Ct.snapshot=O.root,new mo(new Zr(Ct,[]),O)}class Oi{constructor(A,O,S,N,K,le,it,Ct){var vt,Ln;this.urlSubject=A,this.paramsSubject=O,this.queryParamsSubject=S,this.fragmentSubject=N,this.dataSubject=K,this.outlet=le,this.component=it,this._futureSnapshot=Ct,this.title=null!==(vt=null===(Ln=this.dataSubject)||void 0===Ln?void 0:Ln.pipe((0,ut.U)(Ri=>Ri[Qn])))&&void 0!==vt?vt:(0,Fe.of)(void 0),this.url=A,this.params=O,this.queryParams=S,this.fragment=N,this.data=K}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ut.U)(A=>$n(A)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ut.U)(A=>$n(A)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ba(E,A,O="emptyOnly"){var S;let N;const{routeConfig:K}=E;var le;return N=null===A||"always"!==O&&""!==(null==K?void 0:K.path)&&(A.component||null!==(S=A.routeConfig)&&void 0!==S&&S.loadComponent)?{params:{...E.params},data:{...E.data},resolve:{...E.data,...null!==(le=E._resolvedData)&&void 0!==le?le:{}}}:{params:{...A.params,...E.params},data:{...A.data,...E.data},resolve:{...E.data,...A.data,...null==K?void 0:K.data,...E._resolvedData}},K&&gc(K)&&(N.resolve[Qn]=K.title),N}class qo{get title(){var A;return null===(A=this.data)||void 0===A?void 0:A[Qn]}constructor(A,O,S,N,K,le,it,Ct,vt){this.url=A,this.params=O,this.queryParams=S,this.fragment=N,this.data=K,this.outlet=le,this.component=it,this.routeConfig=Ct,this._resolve=vt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=$n(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$n(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(S=>S.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ka extends Pr{constructor(A,O){super(O),this.url=A,Vl(this,O)}toString(){return ba(this._root)}}function Vl(E,A){A.value._routerState=E,A.children.forEach(O=>Vl(E,O))}function ba(E){const A=E.children.length>0?` { ${E.children.map(ba).join(", ")} } `:"";return`${E.value}${A}`}function el(E){if(E.snapshot){const A=E.snapshot,O=E._futureSnapshot;E.snapshot=O,or(A.queryParams,O.queryParams)||E.queryParamsSubject.next(O.queryParams),A.fragment!==O.fragment&&E.fragmentSubject.next(O.fragment),or(A.params,O.params)||E.paramsSubject.next(O.params),function Ci(E,A){if(E.length!==A.length)return!1;for(let O=0;O<E.length;++O)if(!or(E[O],A[O]))return!1;return!0}(A.url,O.url)||E.urlSubject.next(O.url),or(A.data,O.data)||E.dataSubject.next(O.data)}else E.snapshot=E._futureSnapshot,E.dataSubject.next(E._futureSnapshot.data)}function tl(E,A){const O=or(E.params,A.params)&&function pr(E,A){return ds(E,A)&&E.every((O,S)=>or(O.parameters,A[S].parameters))}(E.url,A.url);return O&&!(!E.parent!=!A.parent)&&(!E.parent||tl(E.parent,A.parent))}function gc(E){return"string"==typeof E.title||null===E.title}let nl=(()=>{var E;class A{constructor(){this.activated=null,this._activatedRoute=null,this.name=kt,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.parentContexts=(0,f.f3M)(gi),this.location=(0,f.f3M)(f.s_b),this.changeDetector=(0,f.f3M)(f.sBO),this.environmentInjector=(0,f.f3M)(f.lqb),this.inputBinder=(0,f.f3M)(_l,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(S){if(S.name){const{firstChange:N,previousValue:K}=S.name;if(N)return;this.isTrackedInParentContexts(K)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(K)),this.initializeOutletWithName()}}ngOnDestroy(){var S;this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),null===(S=this.inputBinder)||void 0===S||S.unsubscribeFromRouteData(this)}isTrackedInParentContexts(S){var N;return(null===(N=this.parentContexts.getContext(S))||void 0===N?void 0:N.outlet)===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const S=this.parentContexts.getContext(this.name);null!=S&&S.route&&(S.attachRef?this.attach(S.attachRef,S.route):this.activateWith(S.route,S.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new f.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new f.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new f.vHH(4012,!1);this.location.detach();const S=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(S.instance),S}attach(S,N){var K;this.activated=S,this._activatedRoute=N,this.location.insert(S.hostView),null===(K=this.inputBinder)||void 0===K||K.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(S.instance)}deactivate(){if(this.activated){const S=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(S)}}activateWith(S,N){var K;if(this.isActivated)throw new f.vHH(4013,!1);this._activatedRoute=S;const le=this.location,Ct=S.snapshot.component,vt=this.parentContexts.getOrCreateContext(this.name).children,Ln=new zd(S,vt,le.injector);this.activated=le.createComponent(Ct,{index:le.length,injector:Ln,environmentInjector:null!=N?N:this.environmentInjector}),this.changeDetector.markForCheck(),null===(K=this.inputBinder)||void 0===K||K.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275dir=f.lG2({type:E,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[f.TTD]}),A})();class zd{constructor(A,O,S){this.route=A,this.childContexts=O,this.parent=S}get(A,O){return A===Oi?this.route:A===gi?this.childContexts:this.parent.get(A,O)}}const _l=new f.OlP("");let wo=(()=>{var E;class A{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(S){this.unsubscribeFromRouteData(S),this.subscribeToRouteData(S)}unsubscribeFromRouteData(S){var N;null===(N=this.outletDataSubscriptions.get(S))||void 0===N||N.unsubscribe(),this.outletDataSubscriptions.delete(S)}subscribeToRouteData(S){const{activatedRoute:N}=S,K=(0,Tt.a)([N.queryParams,N.params,N.data]).pipe((0,an.w)(([le,it,Ct],vt)=>(Ct={...le,...it,...Ct},0===vt?(0,Fe.of)(Ct):Promise.resolve(Ct)))).subscribe(le=>{if(!S.isActivated||!S.activatedComponentRef||S.activatedRoute!==N||null===N.component)return void this.unsubscribeFromRouteData(S);const it=(0,f.qFp)(N.component);if(it)for(const{templateName:Ct}of it.inputs)S.activatedComponentRef.setInput(Ct,le[Ct]);else this.unsubscribeFromRouteData(S)});this.outletDataSubscriptions.set(S,K)}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac}),A})();function bl(E,A,O){if(O&&E.shouldReuseRoute(A.value,O.value.snapshot)){const S=O.value;S._futureSnapshot=A.value;const N=function zl(E,A,O){return A.children.map(S=>{for(const N of O.children)if(E.shouldReuseRoute(S.value,N.value.snapshot))return bl(E,S,N);return bl(E,S)})}(E,A,O);return new Zr(S,N)}{if(E.shouldAttach(A.value)){const K=E.retrieve(A.value);if(null!==K){const le=K.route;return le.value._futureSnapshot=A.value,le.children=A.children.map(it=>bl(E,it)),le}}const S=function yu(E){return new Oi(new Be.X(E.url),new Be.X(E.params),new Be.X(E.queryParams),new Be.X(E.fragment),new Be.X(E.data),E.outlet,E.component,E)}(A.value),N=A.children.map(K=>bl(E,K));return new Zr(S,N)}}const il="ngNavigationCancelingError";function Hl(E,A){const{redirectTo:O,navigationBehaviorOptions:S}=er(A)?{redirectTo:A,navigationBehaviorOptions:void 0}:A,N=Bo(!1,0,A);return N.url=O,N.navigationBehaviorOptions=S,N}function Bo(E,A,O){const S=new Error("NavigationCancelingError: "+(E||""));return S[il]=!0,S.cancellationCode=A,O&&(S.url=O),S}function xa(E){return E&&E[il]}let vc=(()=>{var E;class A{}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275cmp=f.Xpm({type:E,selectors:[["ng-component"]],standalone:!0,features:[f.jDz],decls:1,vars:0,template:function(S,N){1&S&&f._UZ(0,"router-outlet")},dependencies:[nl],encapsulation:2}),A})();function xs(E){const A=E.children&&E.children.map(xs),O=A?{...E,children:A}:{...E};return!O.component&&!O.loadComponent&&(A||O.loadChildren)&&O.outlet&&O.outlet!==kt&&(O.component=vc),O}function Es(E){return E.outlet||kt}function Ea(E){var A;if(!E)return null;if(null!==(A=E.routeConfig)&&void 0!==A&&A._injector)return E.routeConfig._injector;for(let O=E.parent;O;O=O.parent){const S=O.routeConfig;if(null!=S&&S._loadedInjector)return S._loadedInjector;if(null!=S&&S._injector)return S._injector}return null}class Xo{constructor(A,O,S,N,K){this.routeReuseStrategy=A,this.futureState=O,this.currState=S,this.forwardEvent=N,this.inputBindingEnabled=K}activate(A){const O=this.futureState._root,S=this.currState?this.currState._root:null;this.deactivateChildRoutes(O,S,A),el(this.futureState.root),this.activateChildRoutes(O,S,A)}deactivateChildRoutes(A,O,S){const N=Ps(O);A.children.forEach(K=>{const le=K.value.outlet;this.deactivateRoutes(K,N[le],S),delete N[le]}),Object.values(N).forEach(K=>{this.deactivateRouteAndItsChildren(K,S)})}deactivateRoutes(A,O,S){const N=A.value,K=O?O.value:null;if(N===K)if(N.component){const le=S.getContext(N.outlet);le&&this.deactivateChildRoutes(A,O,le.children)}else this.deactivateChildRoutes(A,O,S);else K&&this.deactivateRouteAndItsChildren(O,S)}deactivateRouteAndItsChildren(A,O){A.value.component&&this.routeReuseStrategy.shouldDetach(A.value.snapshot)?this.detachAndStoreRouteSubtree(A,O):this.deactivateRouteAndOutlet(A,O)}detachAndStoreRouteSubtree(A,O){const S=O.getContext(A.value.outlet),N=S&&A.value.component?S.children:O,K=Ps(A);for(const le of Object.keys(K))this.deactivateRouteAndItsChildren(K[le],N);if(S&&S.outlet){const le=S.outlet.detach(),it=S.children.onOutletDeactivated();this.routeReuseStrategy.store(A.value.snapshot,{componentRef:le,route:A,contexts:it})}}deactivateRouteAndOutlet(A,O){const S=O.getContext(A.value.outlet),N=S&&A.value.component?S.children:O,K=Ps(A);for(const le of Object.keys(K))this.deactivateRouteAndItsChildren(K[le],N);S&&(S.outlet&&(S.outlet.deactivate(),S.children.onOutletDeactivated()),S.attachRef=null,S.route=null)}activateChildRoutes(A,O,S){const N=Ps(O);A.children.forEach(K=>{this.activateRoutes(K,N[K.value.outlet],S),this.forwardEvent(new dr(K.value.snapshot))}),A.children.length&&this.forwardEvent(new On(A.value.snapshot))}activateRoutes(A,O,S){const N=A.value,K=O?O.value:null;if(el(N),N===K)if(N.component){const le=S.getOrCreateContext(N.outlet);this.activateChildRoutes(A,O,le.children)}else this.activateChildRoutes(A,O,S);else if(N.component){const le=S.getOrCreateContext(N.outlet);if(this.routeReuseStrategy.shouldAttach(N.snapshot)){const it=this.routeReuseStrategy.retrieve(N.snapshot);this.routeReuseStrategy.store(N.snapshot,null),le.children.onOutletReAttached(it.contexts),le.attachRef=it.componentRef,le.route=it.route.value,le.outlet&&le.outlet.attach(it.componentRef,it.route.value),el(it.route.value),this.activateChildRoutes(A,null,le.children)}else{const it=Ea(N.snapshot);le.attachRef=null,le.route=N,le.injector=it,le.outlet&&le.outlet.activateWith(N,le.injector),this.activateChildRoutes(A,null,le.children)}}else this.activateChildRoutes(A,null,S)}}class Ua{constructor(A){this.path=A,this.route=this.path[this.path.length-1]}}class vr{constructor(A,O){this.component=A,this.route=O}}function hn(E,A,O){const S=E._root;return rs(S,A?A._root:null,O,[S.value])}function rr(E,A){const O=Symbol(),S=A.get(E,O);return S===O?"function"!=typeof E||(0,f.Z0I)(E)?A.get(E):E:S}function rs(E,A,O,S,N={canDeactivateChecks:[],canActivateChecks:[]}){const K=Ps(A);return E.children.forEach(le=>{(function Ar(E,A,O,S,N={canDeactivateChecks:[],canActivateChecks:[]}){const K=E.value,le=A?A.value:null,it=O?O.getContext(E.value.outlet):null;if(le&&K.routeConfig===le.routeConfig){const Ct=function xr(E,A,O){if("function"==typeof O)return O(E,A);switch(O){case"pathParamsChange":return!ds(E.url,A.url);case"pathParamsOrQueryParamsChange":return!ds(E.url,A.url)||!or(E.queryParams,A.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tl(E,A)||!or(E.queryParams,A.queryParams);default:return!tl(E,A)}}(le,K,K.routeConfig.runGuardsAndResolvers);Ct?N.canActivateChecks.push(new Ua(S)):(K.data=le.data,K._resolvedData=le._resolvedData),rs(E,A,K.component?it?it.children:null:O,S,N),Ct&&it&&it.outlet&&it.outlet.isActivated&&N.canDeactivateChecks.push(new vr(it.outlet.component,le))}else le&&Oo(A,it,N),N.canActivateChecks.push(new Ua(S)),rs(E,null,K.component?it?it.children:null:O,S,N)})(le,K[le.value.outlet],O,S.concat([le.value]),N),delete K[le.value.outlet]}),Object.entries(K).forEach(([le,it])=>Oo(it,O.getContext(le),N)),N}function Oo(E,A,O){const S=Ps(E),N=E.value;Object.entries(S).forEach(([K,le])=>{Oo(le,N.component?A?A.children.getContext(K):null:A,O)}),O.canDeactivateChecks.push(new vr(N.component&&A&&A.outlet&&A.outlet.isActivated?A.outlet.component:null,N))}function _i(E){return"function"==typeof E}function Tr(E){return E instanceof yt||"EmptyError"===(null==E?void 0:E.name)}const Vr=Symbol("INITIAL_VALUE");function Ls(){return(0,an.w)(E=>(0,Tt.a)(E.map(A=>A.pipe(zn(1),function wi(...E){const A=(0,We.yG)(E);return(0,pe.e)((O,S)=>{(A?Rt(E,O,A):Rt(E,O)).subscribe(S)})}(Vr)))).pipe((0,ut.U)(A=>{for(const O of A)if(!0!==O){if(O===Vr)return Vr;if(!1===O||O instanceof us)return O}return!0}),(0,Ot.h)(A=>A!==Vr),zn(1)))}function Fi(E){return(0,et.z)(ct(A=>{if(er(A))throw Hl(0,A)}),(0,ut.U)(A=>!0===A))}class oa{constructor(A){this.segmentGroup=A||null}}class Ds extends Error{constructor(A){super(),this.urlTree=A}}function Nr(E){return $t(new oa(E))}class vo{constructor(A,O){this.urlSerializer=A,this.urlTree=O}lineralizeSegments(A,O){let S=[],N=O.root;for(;;){if(S=S.concat(N.segments),0===N.numberOfChildren)return(0,Fe.of)(S);if(N.numberOfChildren>1||!N.children[kt])return $t(new f.vHH(4e3,!1));N=N.children[kt]}}applyRedirectCommands(A,O,S){const N=this.applyRedirectCreateUrlTree(O,this.urlSerializer.parse(O),A,S);if(O.startsWith("/"))throw new Ds(N);return N}applyRedirectCreateUrlTree(A,O,S,N){const K=this.createSegmentGroup(A,O.root,S,N);return new us(K,this.createQueryParams(O.queryParams,this.urlTree.queryParams),O.fragment)}createQueryParams(A,O){const S={};return Object.entries(A).forEach(([N,K])=>{if("string"==typeof K&&K.startsWith(":")){const it=K.substring(1);S[N]=O[it]}else S[N]=K}),S}createSegmentGroup(A,O,S,N){const K=this.createSegments(A,O.segments,S,N);let le={};return Object.entries(O.children).forEach(([it,Ct])=>{le[it]=this.createSegmentGroup(A,Ct,S,N)}),new Mn(K,le)}createSegments(A,O,S,N){return O.map(K=>K.path.startsWith(":")?this.findPosParam(A,K,N):this.findOrReturn(K,S))}findPosParam(A,O,S){const N=S[O.path.substring(1)];if(!N)throw new f.vHH(4001,!1);return N}findOrReturn(A,O){let S=0;for(const N of O){if(N.path===A.path)return O.splice(S),N;S++}return A}}const aa={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function bc(E,A,O,S,N){const K=wu(E,A,O);return K.matched?(S=function rl(E,A){var O;return E.providers&&!E._injector&&(E._injector=(0,f.MMx)(E.providers,A,`Route: ${E.path}`)),null!==(O=E._injector)&&void 0!==O?O:A}(A,S),function Kr(E,A,O,S){const N=A.canMatch;if(!N||0===N.length)return(0,Fe.of)(!0);const K=N.map(le=>{const it=rr(le,E);return Mr(function ye(E){return E&&_i(E.canMatch)}(it)?it.canMatch(A,O):(0,f.r_H)(E,()=>it(A,O)))});return(0,Fe.of)(K).pipe(Ls(),Fi())}(S,A,O).pipe((0,ut.U)(le=>!0===le?K:{...aa}))):(0,Fe.of)(K)}function wu(E,A,O){var S,N;if("**"===A.path)return function xc(E){return{matched:!0,parameters:E.length>0?di(E).parameters:{},consumedSegments:E,remainingSegments:[],positionalParamSegments:{}}}(O);if(""===A.path)return"full"===A.pathMatch&&(E.hasChildren()||O.length>0)?{...aa}:{matched:!0,consumedSegments:[],remainingSegments:O,parameters:{},positionalParamSegments:{}};const le=(A.matcher||ki)(O,E,A);if(!le)return{...aa};const it={};Object.entries(null!==(S=le.posParams)&&void 0!==S?S:{}).forEach(([vt,Ln])=>{it[vt]=Ln.path});const Ct=le.consumed.length>0?{...it,...le.consumed[le.consumed.length-1].parameters}:it;return{matched:!0,consumedSegments:le.consumed,remainingSegments:O.slice(le.consumed.length),parameters:Ct,positionalParamSegments:null!==(N=le.posParams)&&void 0!==N?N:{}}}function Ec(E,A,O,S){return O.length>0&&function dm(E,A,O){return O.some(S=>Va(E,A,S)&&Es(S)!==kt)}(E,O,S)?{segmentGroup:new Mn(A,Su(S,new Mn(O,E.children))),slicedSegments:[]}:0===O.length&&function la(E,A,O){return O.some(S=>Va(E,A,S))}(E,O,S)?{segmentGroup:new Mn(E.segments,ff(E,0,O,S,E.children)),slicedSegments:O}:{segmentGroup:new Mn(E.segments,E.children),slicedSegments:O}}function ff(E,A,O,S,N){const K={};for(const le of S)if(Va(E,O,le)&&!N[Es(le)]){const it=new Mn([],{});K[Es(le)]=it}return{...N,...K}}function Su(E,A){const O={};O[kt]=A;for(const S of E)if(""===S.path&&Es(S)!==kt){const N=new Mn([],{});O[Es(S)]=N}return O}function Va(E,A,O){return(!(E.hasChildren()||A.length>0)||"full"!==O.pathMatch)&&""===O.path}class Gl{}class Zo{constructor(A,O,S,N,K,le,it){this.injector=A,this.configLoader=O,this.rootComponentType=S,this.config=N,this.urlTree=K,this.paramsInheritanceStrategy=le,this.urlSerializer=it,this.applyRedirects=new vo(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(A){return new f.vHH(4002,`'${A.segmentGroup}'`)}recognize(){const A=Ec(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(A).pipe((0,ut.U)(O=>{const S=new qo([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},kt,this.rootComponentType,null,{}),N=new Zr(S,O),K=new ka("",N),le=function hs(E,A,O=null,S=null){return As(po(E),A,O,S)}(S,[],this.urlTree.queryParams,this.urlTree.fragment);return le.queryParams=this.urlTree.queryParams,K.url=this.urlSerializer.serialize(le),this.inheritParamsAndData(K._root,null),{state:K,tree:le}}))}match(A){return this.processSegmentGroup(this.injector,this.config,A,kt).pipe(un(S=>{if(S instanceof Ds)return this.urlTree=S.urlTree,this.match(S.urlTree.root);throw S instanceof oa?this.noMatchError(S):S}))}inheritParamsAndData(A,O){const S=A.value,N=Ba(S,O,this.paramsInheritanceStrategy);S.params=Object.freeze(N.params),S.data=Object.freeze(N.data),A.children.forEach(K=>this.inheritParamsAndData(K,S))}processSegmentGroup(A,O,S,N){return 0===S.segments.length&&S.hasChildren()?this.processChildren(A,O,S):this.processSegment(A,O,S,S.segments,N,!0).pipe((0,ut.U)(K=>K instanceof Zr?[K]:[]))}processChildren(A,O,S){const N=[];for(const K of Object.keys(S.children))"primary"===K?N.unshift(K):N.push(K);return(0,ht.D)(N).pipe(Mt(K=>{const le=S.children[K],it=function Os(E,A){const O=E.filter(S=>Es(S)===A);return O.push(...E.filter(S=>Es(S)!==A)),O}(O,K);return this.processSegmentGroup(A,it,le,K)}),function vn(E,A){return(0,pe.e)(function En(E,A,O,S,N){return(K,le)=>{let it=O,Ct=A,vt=0;K.subscribe((0,ge.x)(le,Ln=>{const Ri=vt++;Ct=it?E(Ct,Ln,Ri):(it=!0,Ln),S&&le.next(Ct)},N&&(()=>{it&&le.next(Ct),le.complete()})))}}(E,A,arguments.length>=2,!0))}((K,le)=>(K.push(...le),K)),Le(null),function oi(E,A){const O=arguments.length>=2;return S=>S.pipe(E?(0,Ot.h)((N,K)=>E(N,K,S)):ft.y,Pn(1),O?Le(A):ve(()=>new yt))}(),(0,Oe.z)(K=>{if(null===K)return Nr(S);const le=H(K);return function Br(E){E.sort((A,O)=>A.value.outlet===kt?-1:O.value.outlet===kt?1:A.value.outlet.localeCompare(O.value.outlet))}(le),(0,Fe.of)(le)}))}processSegment(A,O,S,N,K,le){return(0,ht.D)(O).pipe(Mt(it=>{var Ct;return this.processSegmentAgainstRoute(null!==(Ct=it._injector)&&void 0!==Ct?Ct:A,O,it,S,N,K,le).pipe(un(vt=>{if(vt instanceof oa)return(0,Fe.of)(null);throw vt}))}),xe(it=>!!it),un(it=>{if(Tr(it))return function hm(E,A,O){return 0===A.length&&!E.children[O]}(S,N,K)?(0,Fe.of)(new Gl):Nr(S);throw it}))}processSegmentAgainstRoute(A,O,S,N,K,le,it){return function pf(E,A,O,S){return!!(Es(E)===S||S!==kt&&Va(A,O,E))&&wu(A,E,O).matched}(S,N,K,le)?void 0===S.redirectTo?this.matchSegmentAgainstRoute(A,N,S,K,le):this.allowRedirects&&it?this.expandSegmentAgainstRouteUsingRedirect(A,N,O,S,K,le):Nr(N):Nr(N)}expandSegmentAgainstRouteUsingRedirect(A,O,S,N,K,le){const{matched:it,consumedSegments:Ct,positionalParamSegments:vt,remainingSegments:Ln}=wu(O,N,K);if(!it)return Nr(O);N.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const Ri=this.applyRedirects.applyRedirectCommands(Ct,N.redirectTo,vt);return this.applyRedirects.lineralizeSegments(N,Ri).pipe((0,Oe.z)(jr=>this.processSegment(A,S,O,jr.concat(Ln),le,!1)))}matchSegmentAgainstRoute(A,O,S,N,K){const le=bc(O,S,N,A);return"**"===S.path&&(O.children={}),le.pipe((0,an.w)(it=>{var Ct;return it.matched?(A=null!==(Ct=S._injector)&&void 0!==Ct?Ct:A,this.getChildConfig(A,S,N).pipe((0,an.w)(({routes:vt})=>{var Ln,Ri,jr;const Ir=null!==(Ln=S._loadedInjector)&&void 0!==Ln?Ln:A,{consumedSegments:Bn,remainingSegments:Wa,parameters:ta}=it,_o=new qo(Bn,ta,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function z(E){return E.data||{}}(S),Es(S),null!==(Ri=null!==(jr=S.component)&&void 0!==jr?jr:S._loadedComponent)&&void 0!==Ri?Ri:null,S,function ce(E){return E.resolve||{}}(S)),{segmentGroup:Aa,slicedSegments:Ho}=Ec(O,Bn,Wa,vt);if(0===Ho.length&&Aa.hasChildren())return this.processChildren(Ir,vt,Aa).pipe((0,ut.U)(da=>null===da?null:new Zr(_o,da)));if(0===vt.length&&0===Ho.length)return(0,Fe.of)(new Zr(_o,[]));const bo=Es(S)===K;return this.processSegment(Ir,vt,Aa,Ho,bo?kt:K,!0).pipe((0,ut.U)(da=>new Zr(_o,da instanceof Zr?[da]:[])))}))):Nr(O)}))}getChildConfig(A,O,S){return O.children?(0,Fe.of)({routes:O.children,injector:A}):O.loadChildren?void 0!==O._loadedRoutes?(0,Fe.of)({routes:O._loadedRoutes,injector:O._loadedInjector}):function en(E,A,O,S){const N=A.canLoad;if(void 0===N||0===N.length)return(0,Fe.of)(!0);const K=N.map(le=>{const it=rr(le,E);return Mr(function $(E){return E&&_i(E.canLoad)}(it)?it.canLoad(A,O):(0,f.r_H)(E,()=>it(A,O)))});return(0,Fe.of)(K).pipe(Ls(),Fi())}(A,O,S).pipe((0,Oe.z)(N=>N?this.configLoader.loadChildren(A,O).pipe(ct(K=>{O._loadedRoutes=K.routes,O._loadedInjector=K.injector})):function $l(E){return $t(Bo(!1,3))}())):(0,Fe.of)({routes:[],injector:A})}}function D(E){const A=E.value.routeConfig;return A&&""===A.path}function H(E){const A=[],O=new Set;for(const S of E){if(!D(S)){A.push(S);continue}const N=A.find(K=>S.value.routeConfig===K.value.routeConfig);void 0!==N?(N.children.push(...S.children),O.add(N)):A.push(S)}for(const S of O){const N=H(S.children);A.push(new Zr(S.value,N))}return A.filter(S=>!O.has(S))}function ln(E){const A=E.children.map(O=>ln(O)).flat();return[E,...A]}function bi(E){return(0,an.w)(A=>{const O=E(A);return O?(0,ht.D)(O).pipe((0,ut.U)(()=>A)):(0,Fe.of)(A)})}let cr=(()=>{var E;class A{buildTitle(S){let N,K=S.root;for(;void 0!==K;){var le;N=null!==(le=this.getResolvedTitleForRoute(K))&&void 0!==le?le:N,K=K.children.find(it=>it.outlet===kt)}return N}getResolvedTitleForRoute(S){return S.data[Qn]}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:()=>(0,f.f3M)(Ji),providedIn:"root"}),A})(),Ji=(()=>{var E;class A extends cr{constructor(S){super(),this.title=S}updateTitle(S){const N=this.buildTitle(S);void 0!==N&&this.title.setTitle(N)}}return(E=A).\u0275fac=function(S){return new(S||E)(f.LFG(nn.Dx))},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();const Dr=new f.OlP("",{providedIn:"root",factory:()=>({})}),Ms=new f.OlP("ROUTES");let Ns=(()=>{var E;class A{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,f.f3M)(f.Sil)}loadComponent(S){if(this.componentLoaders.get(S))return this.componentLoaders.get(S);if(S._loadedComponent)return(0,Fe.of)(S._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(S);const N=Mr(S.loadComponent()).pipe((0,ut.U)(Gr),ct(le=>{this.onLoadEndListener&&this.onLoadEndListener(S),S._loadedComponent=le}),Xt(()=>{this.componentLoaders.delete(S)})),K=new Ae(N,()=>new ot.x).pipe(Ue());return this.componentLoaders.set(S,K),K}loadChildren(S,N){if(this.childrenLoaders.get(N))return this.childrenLoaders.get(N);if(N._loadedRoutes)return(0,Fe.of)({routes:N._loadedRoutes,injector:N._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(N);const le=function So(E,A,O,S){return Mr(E.loadChildren()).pipe((0,ut.U)(Gr),(0,Oe.z)(N=>N instanceof f.YKP||Array.isArray(N)?(0,Fe.of)(N):(0,ht.D)(A.compileModuleAsync(N))),(0,ut.U)(N=>{S&&S(E);let K,le,it=!1;return Array.isArray(N)?(le=N,!0):(K=N.create(O).injector,le=K.get(Ms,[],{optional:!0,self:!0}).flat()),{routes:le.map(xs),injector:K}}))}(N,this.compiler,S,this.onLoadEndListener).pipe(Xt(()=>{this.childrenLoaders.delete(N)})),it=new Ae(le,()=>new ot.x).pipe(Ue());return this.childrenLoaders.set(N,it),it}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();function Gr(E){return function ro(E){return E&&"object"==typeof E&&"default"in E}(E)?E.default:E}let Fs=(()=>{var E;class A{}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:()=>(0,f.f3M)(Uo),providedIn:"root"}),A})(),Uo=(()=>{var E;class A{shouldProcessUrl(S){return!0}extract(S){return S}merge(S,N){return S}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();const wa=new f.OlP(""),Mc=new f.OlP("");function Wl(E,A,O){const S=E.get(Mc),N=E.get(at.K0);return E.get(f.R0b).runOutsideAngular(()=>{if(!N.startViewTransition||S.skipNextTransition)return S.skipNextTransition=!1,Promise.resolve();let K;const le=new Promise(vt=>{K=vt}),it=N.startViewTransition(()=>(K(),function kr(E){return new Promise(A=>{(0,f.T8G)(A,{injector:E})})}(E))),{onViewTransitionCreated:Ct}=S;return Ct&&(0,f.r_H)(E,()=>Ct({transition:it,from:A,to:O})),le})}let jl=(()=>{var E;class A{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ot.x,this.transitionAbortSubject=new ot.x,this.configLoader=(0,f.f3M)(Ns),this.environmentInjector=(0,f.f3M)(f.lqb),this.urlSerializer=(0,f.f3M)(Ur),this.rootContexts=(0,f.f3M)(gi),this.location=(0,f.f3M)(at.Ye),this.inputBindingEnabled=null!==(0,f.f3M)(_l,{optional:!0}),this.titleStrategy=(0,f.f3M)(cr),this.options=(0,f.f3M)(Dr,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,f.f3M)(Fs),this.createViewTransition=(0,f.f3M)(wa,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Fe.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=K=>this.events.next(new Cn(K)),this.configLoader.onLoadStartListener=K=>this.events.next(new Zt(K))}complete(){var S;null===(S=this.transitions)||void 0===S||S.complete()}handleNavigationRequest(S){var N;const K=++this.navigationId;null===(N=this.transitions)||void 0===N||N.next({...this.transitions.value,...S,id:K})}setupNavigations(S,N,K){return this.transitions=new Be.X({id:0,currentUrlTree:N,currentRawUrl:N,extractedUrl:this.urlHandlingStrategy.extract(N),urlAfterRedirects:this.urlHandlingStrategy.extract(N),rawUrl:N,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Qe,restoredState:null,currentSnapshot:K.snapshot,targetSnapshot:null,currentRouterState:K,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Ot.h)(le=>0!==le.id),(0,ut.U)(le=>({...le,extractedUrl:this.urlHandlingStrategy.extract(le.rawUrl)})),(0,an.w)(le=>{this.currentTransition=le;let it=!1,Ct=!1;return(0,Fe.of)(le).pipe(ct(vt=>{this.currentNavigation={id:vt.id,initialUrl:vt.rawUrl,extractedUrl:vt.extractedUrl,trigger:vt.source,extras:vt.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,an.w)(vt=>{var Ln;const Ri=!S.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),jr=null!==(Ln=vt.extras.onSameUrlNavigation)&&void 0!==Ln?Ln:S.onSameUrlNavigation;if(!Ri&&"reload"!==jr){const Ir="";return this.events.next(new fe(vt.id,this.urlSerializer.serialize(vt.rawUrl),Ir,0)),vt.resolve(null),rt}if(this.urlHandlingStrategy.shouldProcessUrl(vt.rawUrl))return(0,Fe.of)(vt).pipe((0,an.w)(Ir=>{var Bn,Wa;const ta=null===(Bn=this.transitions)||void 0===Bn?void 0:Bn.getValue();return this.events.next(new yn(Ir.id,this.urlSerializer.serialize(Ir.extractedUrl),Ir.source,Ir.restoredState)),ta!==(null===(Wa=this.transitions)||void 0===Wa?void 0:Wa.getValue())?rt:Promise.resolve(Ir)}),function Te(E,A,O,S,N,K){return(0,Oe.z)(le=>function $d(E,A,O,S,N,K,le="emptyOnly"){return new Zo(E,A,O,S,N,le,K).recognize()}(E,A,O,S,le.extractedUrl,N,K).pipe((0,ut.U)(({state:it,tree:Ct})=>({...le,targetSnapshot:it,urlAfterRedirects:Ct}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,S.config,this.urlSerializer,this.paramsInheritanceStrategy),ct(Ir=>{le.targetSnapshot=Ir.targetSnapshot,le.urlAfterRedirects=Ir.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Ir.urlAfterRedirects};const Bn=new Et(Ir.id,this.urlSerializer.serialize(Ir.extractedUrl),this.urlSerializer.serialize(Ir.urlAfterRedirects),Ir.targetSnapshot);this.events.next(Bn)}));if(Ri&&this.urlHandlingStrategy.shouldProcessUrl(vt.currentRawUrl)){const{id:Ir,extractedUrl:Bn,source:Wa,restoredState:ta,extras:_o}=vt,Aa=new yn(Ir,this.urlSerializer.serialize(Bn),Wa,ta);this.events.next(Aa);const Ho=tr(0,this.rootComponentType).snapshot;return this.currentTransition=le={...vt,targetSnapshot:Ho,urlAfterRedirects:Bn,extras:{..._o,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=Bn,(0,Fe.of)(le)}{const Ir="";return this.events.next(new fe(vt.id,this.urlSerializer.serialize(vt.extractedUrl),Ir,1)),vt.resolve(null),rt}}),ct(vt=>{const Ln=new Xe(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects),vt.targetSnapshot);this.events.next(Ln)}),(0,ut.U)(vt=>(this.currentTransition=le={...vt,guards:hn(vt.targetSnapshot,vt.currentSnapshot,this.rootContexts)},le)),function Lo(E,A){return(0,Oe.z)(O=>{const{targetSnapshot:S,currentSnapshot:N,guards:{canActivateChecks:K,canDeactivateChecks:le}}=O;return 0===le.length&&0===K.length?(0,Fe.of)({...O,guardsResult:!0}):function go(E,A,O,S){return(0,ht.D)(E).pipe((0,Oe.z)(N=>function ko(E,A,O,S,N){const K=A&&A.routeConfig?A.routeConfig.canDeactivate:null;if(!K||0===K.length)return(0,Fe.of)(!0);const le=K.map(it=>{var Ct;const vt=null!==(Ct=Ea(A))&&void 0!==Ct?Ct:N,Ln=rr(it,vt);return Mr(function G(E){return E&&_i(E.canDeactivate)}(Ln)?Ln.canDeactivate(E,A,O,S):(0,f.r_H)(vt,()=>Ln(E,A,O,S))).pipe(xe())});return(0,Fe.of)(le).pipe(Ls())}(N.component,N.route,O,A,S)),xe(N=>!0!==N,!0))}(le,S,N,E).pipe((0,Oe.z)(it=>it&&function no(E){return"boolean"==typeof E}(it)?function Ma(E,A,O,S){return(0,ht.D)(A).pipe(Mt(N=>Rt(function Ai(E,A){return null!==E&&A&&A(new Gn(E)),(0,Fe.of)(!0)}(N.route.parent,S),function No(E,A){return null!==E&&A&&A(new $i(E)),(0,Fe.of)(!0)}(N.route,S),function Ni(E,A,O){const S=A[A.length-1],K=A.slice(0,A.length-1).reverse().map(le=>function fi(E){const A=E.routeConfig?E.routeConfig.canActivateChild:null;return A&&0!==A.length?{node:E,guards:A}:null}(le)).filter(le=>null!==le).map(le=>Je(()=>{const it=le.guards.map(Ct=>{var vt;const Ln=null!==(vt=Ea(le.node))&&void 0!==vt?vt:O,Ri=rr(Ct,Ln);return Mr(function ae(E){return E&&_i(E.canActivateChild)}(Ri)?Ri.canActivateChild(S,E):(0,f.r_H)(Ln,()=>Ri(S,E))).pipe(xe())});return(0,Fe.of)(it).pipe(Ls())}));return(0,Fe.of)(K).pipe(Ls())}(E,N.path,O),function io(E,A,O){const S=A.routeConfig?A.routeConfig.canActivate:null;if(!S||0===S.length)return(0,Fe.of)(!0);const N=S.map(K=>Je(()=>{var le;const it=null!==(le=Ea(A))&&void 0!==le?le:O,Ct=rr(K,it);return Mr(function L(E){return E&&_i(E.canActivate)}(Ct)?Ct.canActivate(A,E):(0,f.r_H)(it,()=>Ct(A,E))).pipe(xe())}));return(0,Fe.of)(N).pipe(Ls())}(E,N.route,O))),xe(N=>!0!==N,!0))}(S,K,E,A):(0,Fe.of)(it)),(0,ut.U)(it=>({...O,guardsResult:it})))})}(this.environmentInjector,vt=>this.events.next(vt)),ct(vt=>{if(le.guardsResult=vt.guardsResult,er(vt.guardsResult))throw Hl(0,vt.guardsResult);const Ln=new Wt(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects),vt.targetSnapshot,!!vt.guardsResult);this.events.next(Ln)}),(0,Ot.h)(vt=>!!vt.guardsResult||(this.cancelNavigationTransition(vt,"",3),!1)),bi(vt=>{if(vt.guards.canActivateChecks.length)return(0,Fe.of)(vt).pipe(ct(Ln=>{const Ri=new Yt(Ln.id,this.urlSerializer.serialize(Ln.extractedUrl),this.urlSerializer.serialize(Ln.urlAfterRedirects),Ln.targetSnapshot);this.events.next(Ri)}),(0,an.w)(Ln=>{let Ri=!1;return(0,Fe.of)(Ln).pipe(function jt(E,A){return(0,Oe.z)(O=>{const{targetSnapshot:S,guards:{canActivateChecks:N}}=O;if(!N.length)return(0,Fe.of)(O);const K=new Set(N.map(Ct=>Ct.route)),le=new Set;for(const Ct of K)if(!le.has(Ct))for(const vt of ln(Ct))le.add(vt);let it=0;return(0,ht.D)(le).pipe(Mt(Ct=>K.has(Ct)?function de(E,A,O,S){const N=E.routeConfig,K=E._resolve;return void 0!==(null==N?void 0:N.title)&&!gc(N)&&(K[Qn]=N.title),function Ki(E,A,O,S){const N=Rn(E);if(0===N.length)return(0,Fe.of)({});const K={};return(0,ht.D)(N).pipe((0,Oe.z)(le=>function lr(E,A,O,S){var N;const K=null!==(N=Ea(A))&&void 0!==N?N:S,le=rr(E,K);return Mr(le.resolve?le.resolve(A,O):(0,f.r_H)(K,()=>le(A,O)))}(E[le],A,O,S).pipe(xe(),ct(it=>{K[le]=it}))),Pn(1),function Si(E){return(0,ut.U)(()=>E)}(K),un(le=>Tr(le)?rt:$t(le)))}(K,E,A,S).pipe((0,ut.U)(le=>(E._resolvedData=le,E.data=Ba(E,E.parent,O).resolve,null)))}(Ct,S,E,A):(Ct.data=Ba(Ct,Ct.parent,E).resolve,(0,Fe.of)(void 0))),ct(()=>it++),Pn(1),(0,Oe.z)(Ct=>it===le.size?(0,Fe.of)(O):rt))})}(this.paramsInheritanceStrategy,this.environmentInjector),ct({next:()=>Ri=!0,complete:()=>{Ri||this.cancelNavigationTransition(Ln,"",2)}}))}),ct(Ln=>{const Ri=new cn(Ln.id,this.urlSerializer.serialize(Ln.extractedUrl),this.urlSerializer.serialize(Ln.urlAfterRedirects),Ln.targetSnapshot);this.events.next(Ri)}))}),bi(vt=>{const Ln=Ri=>{var jr;const Ir=[];null!==(jr=Ri.routeConfig)&&void 0!==jr&&jr.loadComponent&&!Ri.routeConfig._loadedComponent&&Ir.push(this.configLoader.loadComponent(Ri.routeConfig).pipe(ct(Bn=>{Ri.component=Bn}),(0,ut.U)(()=>{})));for(const Bn of Ri.children)Ir.push(...Ln(Bn));return Ir};return(0,Tt.a)(Ln(vt.targetSnapshot.root)).pipe(Le(null),zn(1))}),bi(()=>this.afterPreactivation()),(0,an.w)(()=>{var vt;const{currentSnapshot:Ln,targetSnapshot:Ri}=le,jr=null===(vt=this.createViewTransition)||void 0===vt?void 0:vt.call(this,this.environmentInjector,Ln.root,Ri.root);return jr?(0,ht.D)(jr).pipe((0,ut.U)(()=>le)):(0,Fe.of)(le)}),(0,ut.U)(vt=>{const Ln=function Hd(E,A,O){const S=bl(E,A._root,O?O._root:void 0);return new mo(S,A)}(S.routeReuseStrategy,vt.targetSnapshot,vt.currentRouterState);return this.currentTransition=le={...vt,targetRouterState:Ln},this.currentNavigation.targetRouterState=Ln,le}),ct(()=>{this.events.next(new ee)}),((E,A,O,S)=>(0,ut.U)(N=>(new Xo(A,N.targetRouterState,N.currentRouterState,O,S).activate(E),N)))(this.rootContexts,S.routeReuseStrategy,vt=>this.events.next(vt),this.inputBindingEnabled),zn(1),ct({next:vt=>{var Ln;it=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new B(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects))),null===(Ln=this.titleStrategy)||void 0===Ln||Ln.updateTitle(vt.targetRouterState.snapshot),vt.resolve(!0)},complete:()=>{it=!0}}),function Dt(E){return(0,pe.e)((A,O)=>{(0,Ke.Xf)(E).subscribe((0,ge.x)(O,()=>O.complete(),Nt.Z)),!O.closed&&A.subscribe(O)})}(this.transitionAbortSubject.pipe(ct(vt=>{throw vt}))),Xt(()=>{var vt;it||Ct||this.cancelNavigationTransition(le,"",1),(null===(vt=this.currentNavigation)||void 0===vt?void 0:vt.id)===le.id&&(this.currentNavigation=null)}),un(vt=>{if(Ct=!0,xa(vt))this.events.next(new Y(le.id,this.urlSerializer.serialize(le.extractedUrl),vt.message,vt.cancellationCode)),function _u(E){return xa(E)&&er(E.url)}(vt)?this.events.next(new F(vt.url)):le.resolve(!1);else{var Ln;this.events.next(new Ne(le.id,this.urlSerializer.serialize(le.extractedUrl),vt,null!==(Ln=le.targetSnapshot)&&void 0!==Ln?Ln:void 0));try{le.resolve(S.errorHandler(vt))}catch(Ri){le.reject(Ri)}}return rt}))}))}cancelNavigationTransition(S,N,K){const le=new Y(S.id,this.urlSerializer.serialize(S.extractedUrl),N,K);this.events.next(le),S.resolve(!1)}isUpdatingInternalState(){var S,N;return(null===(S=this.currentTransition)||void 0===S?void 0:S.extractedUrl.toString())!==(null===(N=this.currentTransition)||void 0===N?void 0:N.currentUrlTree.toString())}isUpdatedBrowserUrl(){var S,N;return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==(null===(S=this.currentTransition)||void 0===S?void 0:S.extractedUrl.toString())&&!(null!==(N=this.currentTransition)&&void 0!==N&&N.extras.skipLocationChange)}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();function za(E){return E!==Qe}let Ws=(()=>{var E;class A{}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:()=>(0,f.f3M)(Vo),providedIn:"root"}),A})();class Sa{shouldDetach(A){return!1}store(A,O){}shouldAttach(A){return!1}retrieve(A){return null}shouldReuseRoute(A,O){return A.routeConfig===O.routeConfig}}let Vo=(()=>{var E;class A extends Sa{}return(E=A).\u0275fac=(()=>{let O;return function(N){return(O||(O=f.n5z(E)))(N||E)}})(),E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})(),Ha=(()=>{var E;class A{}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:()=>(0,f.f3M)(yo),providedIn:"root"}),A})(),yo=(()=>{var E;class A extends Ha{constructor(){super(...arguments),this.location=(0,f.f3M)(at.Ye),this.urlSerializer=(0,f.f3M)(Ur),this.options=(0,f.f3M)(Dr,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,f.f3M)(Fs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new us,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=tr(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){var S,N;return"computed"!==this.canceledNavigationResolution?this.currentPageId:null!==(S=null===(N=this.restoredState())||void 0===N?void 0:N.\u0275routerPageId)&&void 0!==S?S:this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(S){return this.location.subscribe(N=>{"popstate"===N.type&&S(N.url,N.state)})}handleRouterEvent(S,N){if(S instanceof yn)this.stateMemento=this.createStateMemento();else if(S instanceof fe)this.rawUrlTree=N.initialUrl;else if(S instanceof Et){if("eager"===this.urlUpdateStrategy&&!N.extras.skipLocationChange){const K=this.urlHandlingStrategy.merge(N.finalUrl,N.initialUrl);this.setBrowserUrl(K,N)}}else S instanceof ee?(this.currentUrlTree=N.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(N.finalUrl,N.initialUrl),this.routerState=N.targetRouterState,"deferred"===this.urlUpdateStrategy&&(N.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,N))):S instanceof Y&&(3===S.code||2===S.code)?this.restoreHistory(N):S instanceof Ne?this.restoreHistory(N,!0):S instanceof B&&(this.lastSuccessfulId=S.id,this.currentPageId=this.browserPageId)}setBrowserUrl(S,N){const K=this.urlSerializer.serialize(S);if(this.location.isCurrentPathEqualTo(K)||N.extras.replaceUrl){const it={...N.extras.state,...this.generateNgRouterState(N.id,this.browserPageId)};this.location.replaceState(K,"",it)}else{const le={...N.extras.state,...this.generateNgRouterState(N.id,this.browserPageId+1)};this.location.go(K,"",le)}}restoreHistory(S,N=!1){if("computed"===this.canceledNavigationResolution){const le=this.currentPageId-this.browserPageId;0!==le?this.location.historyGo(le):this.currentUrlTree===S.finalUrl&&0===le&&(this.resetState(S),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(N&&this.resetState(S),this.resetUrlToCurrentUrlTree())}resetState(S){var N;this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,null!==(N=S.finalUrl)&&void 0!==N?N:this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(S,N){return"computed"===this.canceledNavigationResolution?{navigationId:S,\u0275routerPageId:N}:{navigationId:S}}}return(E=A).\u0275fac=(()=>{let O;return function(N){return(O||(O=f.n5z(E)))(N||E)}})(),E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();var Ko=function(E){return E[E.COMPLETE=0]="COMPLETE",E[E.FAILED=1]="FAILED",E[E.REDIRECTING=2]="REDIRECTING",E}(Ko||{});function Yl(E,A){E.events.pipe((0,Ot.h)(O=>O instanceof B||O instanceof Y||O instanceof Ne||O instanceof fe),(0,ut.U)(O=>O instanceof B||O instanceof fe?Ko.COMPLETE:O instanceof Y&&(0===O.code||1===O.code)?Ko.REDIRECTING:Ko.FAILED),(0,Ot.h)(O=>O!==Ko.REDIRECTING),zn(1)).subscribe(()=>{A()})}function Cu(E){throw E}const Jo={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},El={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Mi=(()=>{var E;class A{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){var S,N;this.disposed=!1,this.isNgZoneEnabled=!1,this.console=(0,f.f3M)(f.c2e),this.stateManager=(0,f.f3M)(Ha),this.options=(0,f.f3M)(Dr,{optional:!0})||{},this.pendingTasks=(0,f.f3M)(f.I6F),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,f.f3M)(jl),this.urlSerializer=(0,f.f3M)(Ur),this.location=(0,f.f3M)(at.Ye),this.urlHandlingStrategy=(0,f.f3M)(Fs),this._events=new ot.x,this.errorHandler=this.options.errorHandler||Cu,this.navigated=!1,this.routeReuseStrategy=(0,f.f3M)(Ws),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=null!==(S=null===(N=(0,f.f3M)(Ms,{optional:!0}))||void 0===N?void 0:N.flat())&&void 0!==S?S:[],this.componentInputBindingEnabled=!!(0,f.f3M)(_l,{optional:!0}),this.eventsSubscription=new He.w0,this.isNgZoneEnabled=(0,f.f3M)(f.R0b)instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:K=>{this.console.warn(K)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const S=this.navigationTransitions.events.subscribe(N=>{try{const K=this.navigationTransitions.currentTransition,le=this.navigationTransitions.currentNavigation;if(null!==K&&null!==le)if(this.stateManager.handleRouterEvent(N,le),N instanceof Y&&0!==N.code&&1!==N.code)this.navigated=!0;else if(N instanceof B)this.navigated=!0;else if(N instanceof F){const it=this.urlHandlingStrategy.merge(N.url,K.currentRawUrl),Ct={skipLocationChange:K.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||za(K.source)};this.scheduleNavigation(it,Qe,null,Ct,{resolve:K.resolve,reject:K.reject,promise:K.promise})}(function Qo(E){return!(E instanceof ee||E instanceof F)})(N)&&this._events.next(N)}catch(K){this.navigationTransitions.transitionAbortSubject.next(K)}});this.eventsSubscription.add(S)}resetRootComponentType(S){this.routerState.root.component=S,this.navigationTransitions.rootComponentType=S}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qe,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((S,N)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(S,"popstate",N)},0)}))}navigateToSyncWithBrowser(S,N,K){const le={replaceUrl:!0},it=null!=K&&K.navigationId?K:null;if(K){const vt={...K};delete vt.navigationId,delete vt.\u0275routerPageId,0!==Object.keys(vt).length&&(le.state=vt)}const Ct=this.parseUrl(S);this.scheduleNavigation(Ct,N,it,le)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(S){this.config=S.map(xs),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(S,N={}){const{relativeTo:K,queryParams:le,fragment:it,queryParamsHandling:Ct,preserveFragment:vt}=N,Ln=vt?this.currentUrlTree.fragment:it;let jr,Ri=null;switch(Ct){case"merge":Ri={...this.currentUrlTree.queryParams,...le};break;case"preserve":Ri=this.currentUrlTree.queryParams;break;default:Ri=le||null}null!==Ri&&(Ri=this.removeEmptyProps(Ri));try{jr=po(K?K.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof S[0]||!S[0].startsWith("/"))&&(S=[]),jr=this.currentUrlTree.root}return As(jr,S,Ri,null!=Ln?Ln:null)}navigateByUrl(S,N={skipLocationChange:!1}){const K=er(S)?S:this.parseUrl(S),le=this.urlHandlingStrategy.merge(K,this.rawUrlTree);return this.scheduleNavigation(le,Qe,null,N)}navigate(S,N={skipLocationChange:!1}){return function Ml(E){for(let A=0;A<E.length;A++)if(null==E[A])throw new f.vHH(4008,!1)}(S),this.navigateByUrl(this.createUrlTree(S,N),N)}serializeUrl(S){return this.urlSerializer.serialize(S)}parseUrl(S){try{return this.urlSerializer.parse(S)}catch{return this.urlSerializer.parse("/")}}isActive(S,N){let K;if(K=!0===N?{...Jo}:!1===N?{...El}:N,er(S))return wr(this.currentUrlTree,S,K);const le=this.parseUrl(S);return wr(this.currentUrlTree,le,K)}removeEmptyProps(S){return Object.keys(S).reduce((N,K)=>{const le=S[K];return null!=le&&(N[K]=le),N},{})}scheduleNavigation(S,N,K,le,it){if(this.disposed)return Promise.resolve(!1);let Ct,vt,Ln;it?(Ct=it.resolve,vt=it.reject,Ln=it.promise):Ln=new Promise((jr,Ir)=>{Ct=jr,vt=Ir});const Ri=this.pendingTasks.add();return Yl(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Ri))}),this.navigationTransitions.handleNavigationRequest({source:N,restoredState:K,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:S,extras:le,resolve:Ct,reject:vt,promise:Ln,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ln.catch(jr=>Promise.reject(jr))}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})(),ql=(()=>{var E;class A{constructor(S,N,K,le,it,Ct){var vt;this.router=S,this.route=N,this.tabIndexAttribute=K,this.renderer=le,this.el=it,this.locationStrategy=Ct,this.href=null,this.commands=null,this.onChanges=new ot.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const Ln=null===(vt=it.nativeElement.tagName)||void 0===vt?void 0:vt.toLowerCase();this.isAnchorElement="a"===Ln||"area"===Ln,this.isAnchorElement?this.subscription=S.events.subscribe(Ri=>{Ri instanceof B&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(S){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",S)}ngOnChanges(S){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(S){null!=S?(this.commands=Array.isArray(S)?S:[S],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(S,N,K,le,it){return!!(null===this.urlTree||this.isAnchorElement&&(0!==S||N||K||le||it||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){var S;null===(S=this.subscription)||void 0===S||S.unsubscribe()}updateHref(){var S;this.href=null!==this.urlTree&&this.locationStrategy?null===(S=this.locationStrategy)||void 0===S?void 0:S.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const N=null===this.href?null:(0,f.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",N)}applyAttributeValue(S,N){const K=this.renderer,le=this.el.nativeElement;null!==N?K.setAttribute(le,S,N):K.removeAttribute(le,S)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(E=A).\u0275fac=function(S){return new(S||E)(f.Y36(Mi),f.Y36(Oi),f.$8M("tabindex"),f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(at.S$))},E.\u0275dir=f.lG2({type:E,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(S,N){1&S&&f.NdJ("click",function(le){return N.onClick(le.button,le.ctrlKey,le.shiftKey,le.altKey,le.metaKey)}),2&S&&f.uIk("target",N.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",f.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",f.VuI],replaceUrl:["replaceUrl","replaceUrl",f.VuI],routerLink:"routerLink"},standalone:!0,features:[f.Xq5,f.TTD]}),A})();class wl{}let hi=(()=>{var E;class A{preload(S,N){return N().pipe(un(()=>(0,Fe.of)(null)))}}return(E=A).\u0275fac=function(S){return new(S||E)},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})(),pm=(()=>{var E;class A{constructor(S,N,K,le,it){this.router=S,this.injector=K,this.preloadingStrategy=le,this.loader=it}setUpPreloading(){this.subscription=this.router.events.pipe((0,Ot.h)(S=>S instanceof B),Mt(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(S,N){const K=[];for(const vt of N){var le,it;vt.providers&&!vt._injector&&(vt._injector=(0,f.MMx)(vt.providers,S,`Route: ${vt.path}`));const Ln=null!==(le=vt._injector)&&void 0!==le?le:S,Ri=null!==(it=vt._loadedInjector)&&void 0!==it?it:Ln;var Ct;(vt.loadChildren&&!vt._loadedRoutes&&void 0===vt.canLoad||vt.loadComponent&&!vt._loadedComponent)&&K.push(this.preloadConfig(Ln,vt)),(vt.children||vt._loadedRoutes)&&K.push(this.processRoutes(Ri,null!==(Ct=vt.children)&&void 0!==Ct?Ct:vt._loadedRoutes))}return(0,ht.D)(K).pipe(lt())}preloadConfig(S,N){return this.preloadingStrategy.preload(N,()=>{let K;K=N.loadChildren&&void 0===N.canLoad?this.loader.loadChildren(S,N):(0,Fe.of)(null);const le=K.pipe((0,Oe.z)(it=>{var Ct;return null===it?(0,Fe.of)(void 0):(N._loadedRoutes=it.routes,N._loadedInjector=it.injector,this.processRoutes(null!==(Ct=it.injector)&&void 0!==Ct?Ct:S,it.routes))}));if(N.loadComponent&&!N._loadedComponent){const it=this.loader.loadComponent(N);return(0,ht.D)([le,it]).pipe(lt())}return le})}}return(E=A).\u0275fac=function(S){return new(S||E)(f.LFG(Mi),f.LFG(f.Sil),f.LFG(f.lqb),f.LFG(wl),f.LFG(Ns))},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),A})();const Gd=new f.OlP("");let Au=(()=>{var E;class A{constructor(S,N,K,le,it={}){this.urlSerializer=S,this.transitions=N,this.viewportScroller=K,this.zone=le,this.options=it,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},it.scrollPositionRestoration=it.scrollPositionRestoration||"disabled",it.anchorScrolling=it.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof yn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=S.navigationTrigger,this.restoredId=S.restoredState?S.restoredState.navigationId:0):S instanceof B?(this.lastId=S.id,this.scheduleScrollEvent(S,this.urlSerializer.parse(S.urlAfterRedirects).fragment)):S instanceof fe&&0===S.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(S,this.urlSerializer.parse(S.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof T&&(S.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(S.position):S.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(S.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(S,N){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new T(S,"popstate"===this.lastSource?this.store[this.restoredId]:null,N))})},0)})}ngOnDestroy(){var S,N;null===(S=this.routerEventsSubscription)||void 0===S||S.unsubscribe(),null===(N=this.scrollEventsSubscription)||void 0===N||N.unsubscribe()}}return(E=A).\u0275fac=function(S){f.$Z()},E.\u0275prov=f.Yz7({token:E,factory:E.\u0275fac}),A})();function Is(E,A){return{\u0275kind:E,\u0275providers:A}}function gf(){const E=(0,f.f3M)(f.zs3);return A=>{var O,S;const N=E.get(f.z2F);if(A!==N.components[0])return;const K=E.get(Mi),le=E.get(qt);1===E.get(sr)&&K.initialNavigation(),null===(O=E.get(Co,null,f.XFs.Optional))||void 0===O||O.setUpPreloading(),null===(S=E.get(Gd,null,f.XFs.Optional))||void 0===S||S.init(),K.resetRootComponentType(N.componentTypes[0]),le.closed||(le.next(),le.complete(),le.unsubscribe())}}const qt=new f.OlP("",{factory:()=>new ot.x}),sr=new f.OlP("",{providedIn:"root",factory:()=>1}),Co=new f.OlP("");function Ao(E){return Is(0,[{provide:Co,useExisting:pm},{provide:wl,useExisting:E}])}function Sc(E){return Is(9,[{provide:wa,useValue:Wl},{provide:Mc,useValue:{skipNextTransition:!(null==E||!E.skipInitialTransition),...E}}])}const js=new f.OlP("ROUTER_FORROOT_GUARD"),ua=[at.Ye,{provide:Ur,useClass:Xr},Mi,gi,{provide:Oi,useFactory:function Tu(E){return E.routerState.root},deps:[Mi]},Ns,[]];let Ru=(()=>{var E;class A{constructor(S){}static forRoot(S,N){return{ngModule:A,providers:[ua,[],{provide:Ms,multi:!0,useValue:S},{provide:js,useFactory:al,deps:[[Mi,new f.FiY,new f.tp0]]},{provide:Dr,useValue:N||{}},null!=N&&N.useHash?{provide:at.S$,useClass:at.Do}:{provide:at.S$,useClass:at.b0},{provide:Gd,useFactory:()=>{const E=(0,f.f3M)(at.EM),A=(0,f.f3M)(f.R0b),O=(0,f.f3M)(Dr),S=(0,f.f3M)(jl),N=(0,f.f3M)(Ur);return O.scrollOffset&&E.setOffset(O.scrollOffset),new Au(N,S,E,A,O)}},null!=N&&N.preloadingStrategy?Ao(N.preloadingStrategy).\u0275providers:[],null!=N&&N.initialNavigation?_f(N):[],null!=N&&N.bindToComponentInputs?Is(8,[wo,{provide:_l,useExisting:wo}]).\u0275providers:[],null!=N&&N.enableViewTransitions?Sc().\u0275providers:[],[{provide:ea,useFactory:gf},{provide:f.tb,multi:!0,useExisting:ea}]]}}static forChild(S){return{ngModule:A,providers:[{provide:Ms,multi:!0,useValue:S}]}}}return(E=A).\u0275fac=function(S){return new(S||E)(f.LFG(js,8))},E.\u0275mod=f.oAB({type:E}),E.\u0275inj=f.cJS({}),A})();function al(E){return"guarded"}function _f(E){return["disabled"===E.initialNavigation?Is(3,[{provide:f.ip1,multi:!0,useFactory:()=>{const A=(0,f.f3M)(Mi);return()=>{A.setUpLocationChangeListener()}}},{provide:sr,useValue:2}]).\u0275providers:[],"enabledBlocking"===E.initialNavigation?Is(2,[{provide:sr,useValue:0},{provide:f.ip1,multi:!0,deps:[f.zs3],useFactory:A=>{const O=A.get(at.V_,Promise.resolve());return()=>O.then(()=>new Promise(S=>{const N=A.get(Mi),K=A.get(qt);Yl(N,()=>{S(!0)}),A.get(jl).afterPreactivation=()=>(S(!0),K.closed?(0,Fe.of)(void 0):K),N.initialNavigation()}))}}]).\u0275providers:[]]}const ea=new f.OlP("")},7346:(Kn,zt,te)=>{"use strict";te.d(zt,{y4:()=>qr,De:()=>wr,dy:()=>ur,oU:()=>po,ki:()=>ke,O1:()=>Rr,d8:()=>Bt,jP:()=>fo,UN:()=>Ti,r4:()=>Rs,SH:()=>di,xs:()=>to,j:()=>As,H:()=>Sr,bk:()=>ir,DN:()=>Cs,Wn:()=>ts,vk:()=>li});var f=te(5861),ie=te(9212),Ye=te(899),Ie=te(6814);class ht{constructor(){this.m=new Map}reset(be){this.m=new Map(Object.entries(be))}get(be,Z){const me=this.m.get(be);return void 0!==me?me:Z}getBoolean(be,Z=!1){const me=this.m.get(be);return void 0===me?Z:"string"==typeof me?"true"===me:!!me}getNumber(be,Z){const me=parseFloat(this.m.get(be));return isNaN(me)?void 0!==Z?Z:NaN:me}set(be,Z){this.m.set(be,Z)}}const Fe=new ht,lt=ue=>We(ue),We=(ue=window)=>{if(typeof ue>"u")return[];ue.Ionic=ue.Ionic||{};let be=ue.Ionic.platforms;return null==be&&(be=ue.Ionic.platforms=Rt(ue),be.forEach(Z=>ue.document.documentElement.classList.add(`plt-${Z}`))),be},Rt=ue=>{const be=Fe.get("platform");return Object.keys(wi).filter(Z=>{const me=null==be?void 0:be[Z];return"function"==typeof me?me(ue):wi[Z](ue)})},Je=ue=>!!(an(ue,/iPad/i)||an(ue,/Macintosh/i)&&pe(ue)),rt=ue=>an(ue,/android|sink/i),pe=ue=>zn(ue,"(any-pointer:coarse)"),Ue=ue=>Ae(ue)||ot(ue),Ae=ue=>!!(ue.cordova||ue.phonegap||ue.PhoneGap),ot=ue=>{const be=ue.Capacitor;return!(null==be||!be.isNative)},an=(ue,be)=>be.test(ue.navigator.userAgent),zn=(ue,be)=>{var Z;return null===(Z=ue.matchMedia)||void 0===Z?void 0:Z.call(ue,be).matches},wi={ipad:Je,iphone:ue=>an(ue,/iPhone/i),ios:ue=>an(ue,/iPhone|iPod/i)||Je(ue),android:rt,phablet:ue=>{const be=ue.innerWidth,Z=ue.innerHeight,me=Math.min(be,Z),Qe=Math.max(be,Z);return me>390&&me<520&&Qe>620&&Qe<800},tablet:ue=>{const be=ue.innerWidth,Z=ue.innerHeight,me=Math.min(be,Z),Qe=Math.max(be,Z);return Je(ue)||(ue=>rt(ue)&&!an(ue,/mobile/i))(ue)||me>460&&me<820&&Qe>780&&Qe<1400},cordova:Ae,capacitor:ot,electron:ue=>an(ue,/electron/i),pwa:ue=>{var be;return!!(null!==(be=ue.matchMedia)&&void 0!==be&&be.call(ue,"(display-mode: standalone)").matches||ue.navigator.standalone)},mobile:pe,mobileweb:ue=>pe(ue)&&!Ue(ue),desktop:ue=>!pe(ue),hybrid:Ue};var De=te(191),xe=te(3630),Mt=te(8645),ct=te(2438),un=te(5619),En=te(2572),vn=te(2096),Pn=te(7582),oi=te(2181),Si=te(4664),Xt=te(2737),Nt=te(9360),Dt=te(8251);function kt(ue,be){return ue===be}var Qn=te(95);const ai=["tabsInner"];let or=(()=>{class ue{constructor(Z,me){this.doc=Z,this.backButton=new Mt.x,this.keyboardDidShow=new Mt.x,this.keyboardDidHide=new Mt.x,this.pause=new Mt.x,this.resume=new Mt.x,this.resize=new Mt.x,me.run(()=>{var Qe;let Gt;this.win=Z.defaultView,this.backButton.subscribeWithPriority=function(yn,B){return this.subscribe(Y=>Y.register(yn,fe=>me.run(()=>B(fe))))},mi(this.pause,Z,"pause",me),mi(this.resume,Z,"resume",me),mi(this.backButton,Z,"ionBackButton",me),mi(this.resize,this.win,"resize",me),mi(this.keyboardDidShow,this.win,"ionKeyboardDidShow",me),mi(this.keyboardDidHide,this.win,"ionKeyboardDidHide",me),this._readyPromise=new Promise(yn=>{Gt=yn}),null!==(Qe=this.win)&&void 0!==Qe&&Qe.cordova?Z.addEventListener("deviceready",()=>{Gt("cordova")},{once:!0}):Gt("dom")})}is(Z){return((ue,be)=>("string"==typeof ue&&(be=ue,ue=void 0),lt(ue).includes(be)))(this.win,Z)}platforms(){return lt(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(Z){return Rn(this.win.location.href,Z)}isLandscape(){return!this.isPortrait()}isPortrait(){var Z,me;return null===(Z=(me=this.win).matchMedia)||void 0===Z?void 0:Z.call(me,"(orientation: portrait)").matches}testUserAgent(Z){const me=this.win.navigator;return!!(null!=me&&me.userAgent&&me.userAgent.indexOf(Z)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.LFG(Ie.K0),ie.LFG(ie.R0b))},ue.\u0275prov=ie.Yz7({token:ue,factory:ue.\u0275fac,providedIn:"root"}),ue})();const Rn=(ue,be)=>{be=be.replace(/[[\]\\]/g,"\\$&");const me=new RegExp("[\\?&]"+be+"=([^&#]*)").exec(ue);return me?decodeURIComponent(me[1].replace(/\+/g," ")):null},mi=(ue,be,Z,me)=>{be&&be.addEventListener(Z,Qe=>{me.run(()=>{ue.next(null!=Qe?Qe.detail:void 0)})})};let di=(()=>{class ue{constructor(Z,me,Qe,Gt){this.location=me,this.serializer=Qe,this.router=Gt,this.direction=Or,this.animated=gn,this.guessDirection="forward",this.lastNavId=-1,Gt&&Gt.events.subscribe(yn=>{if(yn instanceof Ye.OD){const B=yn.restoredState?yn.restoredState.navigationId:yn.id;this.guessDirection=B<this.lastNavId?"back":"forward",this.guessAnimation=yn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?yn.id:B}}),Z.backButton.subscribeWithPriority(0,yn=>{this.pop(),yn()})}navigateForward(Z,me={}){return this.setDirection("forward",me.animated,me.animationDirection,me.animation),this.navigate(Z,me)}navigateBack(Z,me={}){return this.setDirection("back",me.animated,me.animationDirection,me.animation),this.navigate(Z,me)}navigateRoot(Z,me={}){return this.setDirection("root",me.animated,me.animationDirection,me.animation),this.navigate(Z,me)}back(Z={animated:!0,animationDirection:"back"}){return this.setDirection("back",Z.animated,Z.animationDirection,Z.animation),this.location.back()}pop(){var Z=this;return(0,f.Z)(function*(){let me=Z.topOutlet;for(;me;){if(yield me.pop())return!0;me=me.parentOutlet}return!1})()}setDirection(Z,me,Qe,Gt){this.direction=Z,this.animated=Mr(Z,me,Qe),this.animationBuilder=Gt}setTopOutlet(Z){this.topOutlet=Z}consumeTransition(){let me,Z="root";const Qe=this.animationBuilder;return"auto"===this.direction?(Z=this.guessDirection,me=this.guessAnimation):(me=this.animated,Z=this.direction),this.direction=Or,this.animated=gn,this.animationBuilder=void 0,{direction:Z,animation:me,animationBuilder:Qe}}navigate(Z,me){if(Array.isArray(Z))return this.router.navigate(Z,me);{const Qe=this.serializer.parse(Z.toString());return void 0!==me.queryParams&&(Qe.queryParams={...me.queryParams}),void 0!==me.fragment&&(Qe.fragment=me.fragment),this.router.navigateByUrl(Qe,me)}}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.LFG(or),ie.LFG(Ie.Ye),ie.LFG(Ye.Hx),ie.LFG(Ye.F0,8))},ue.\u0275prov=ie.Yz7({token:ue,factory:ue.\u0275fac,providedIn:"root"}),ue})();const Mr=(ue,be,Z)=>{if(!1!==be){if(void 0!==Z)return Z;if("forward"===ue||"back"===ue)return ue;if("root"===ue&&!0===be)return"forward"}},Or="auto",gn=void 0;let wr=(()=>{class ue{get(Z,me){const Qe=es();return Qe?Qe.get(Z,me):null}getBoolean(Z,me){const Qe=es();return!!Qe&&Qe.getBoolean(Z,me)}getNumber(Z,me){const Qe=es();return Qe?Qe.getNumber(Z,me):0}}return ue.\u0275fac=function(Z){return new(Z||ue)},ue.\u0275prov=ie.Yz7({token:ue,factory:ue.\u0275fac,providedIn:"root"}),ue})();const ur=new ie.OlP("USERCONFIG"),es=()=>{if(typeof window<"u"){const ue=window.Ionic;if(null!=ue&&ue.config)return ue.config}return null};class xi{constructor(be={}){this.data=be}get(be){return this.data[be]}}let qr=(()=>{class ue{constructor(){this.zone=(0,ie.f3M)(ie.R0b),this.applicationRef=(0,ie.f3M)(ie.z2F)}create(Z,me,Qe){return new Jn(Z,me,this.applicationRef,this.zone,Qe)}}return ue.\u0275fac=function(Z){return new(Z||ue)},ue.\u0275prov=ie.Yz7({token:ue,factory:ue.\u0275fac}),ue})();class Jn{constructor(be,Z,me,Qe,Gt){this.environmentInjector=be,this.injector=Z,this.applicationRef=me,this.zone=Qe,this.elementReferenceKey=Gt,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(be,Z,me,Qe){return this.zone.run(()=>new Promise(Gt=>{const yn={...me};void 0!==this.elementReferenceKey&&(yn[this.elementReferenceKey]=be),Gt(Cr(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,be,Z,yn,Qe,this.elementReferenceKey))}))}removeViewFromDom(be,Z){return this.zone.run(()=>new Promise(me=>{const Qe=this.elRefMap.get(Z);if(Qe){Qe.destroy(),this.elRefMap.delete(Z);const Gt=this.elEventsMap.get(Z);Gt&&(Gt(),this.elEventsMap.delete(Z))}me()}))}}const Cr=(ue,be,Z,me,Qe,Gt,yn,B,Y,fe,Ne)=>{const Et=ie.zs3.create({providers:pr(Y),parent:Z}),Xe=(0,ie.LMc)(B,{environmentInjector:be,elementInjector:Et}),Wt=Xe.instance,Yt=Xe.location.nativeElement;if(Y&&(Ne&&void 0!==Wt[Ne]&&console.error(`[Ionic Error]: ${Ne} is a reserved property when using ${yn.tagName.toLowerCase()}. Rename or remove the "${Ne}" property from ${B.name}.`),Object.assign(Wt,Y)),fe)for(const Zt of fe)Yt.classList.add(Zt);const cn=Mn(ue,Wt,Yt);return yn.appendChild(Yt),me.attachView(Xe.hostView),Qe.set(Yt,Xe),Gt.set(Yt,cn),Yt},us=[De.L,De.a,De.b,De.c,De.d],Mn=(ue,be,Z)=>ue.run(()=>{const me=us.filter(Qe=>"function"==typeof be[Qe]).map(Qe=>{const Gt=yn=>be[Qe](yn.detail);return Z.addEventListener(Qe,Gt),()=>Z.removeEventListener(Qe,Gt)});return()=>me.forEach(Qe=>Qe())}),Ei=new ie.OlP("NavParamsToken"),pr=ue=>[{provide:Ei,useValue:ue},{provide:xi,useFactory:ds,deps:[Ei]}],ds=ue=>new xi(ue),Qs=(ue,be)=>{const Z=ue.prototype;be.forEach(me=>{Object.defineProperty(Z,me,{get(){return this.el[me]},set(Qe){this.z.runOutsideAngular(()=>this.el[me]=Qe)}})})},Ur=(ue,be)=>{const Z=ue.prototype;be.forEach(me=>{Z[me]=function(){const Qe=arguments;return this.z.runOutsideAngular(()=>this.el[me].apply(this.el,Qe))}})},Xr=(ue,be,Z)=>{Z.forEach(me=>ue[me]=(0,ct.R)(be,me))};function Lr(ue){return function(Z){const{defineCustomElementFn:me,inputs:Qe,methods:Gt}=ue;return void 0!==me&&me(),Qe&&Qs(Z,Qe),Gt&&Ur(Z,Gt),Z}}const mr=["alignment","animated","arrow","keepContentsMounted","backdropDismiss","cssClass","dismissOnSelect","enterAnimation","event","isOpen","keyboardClose","leaveAnimation","mode","showBackdrop","translucent","trigger","triggerAction","reference","size","side"],ys=["present","dismiss","onDidDismiss","onWillDismiss"];let Bt=(()=>{let ue=class{constructor(Z,me,Qe){this.z=Qe,this.isCmpOpen=!1,this.el=me.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,Z.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,Z.detectChanges()}),Xr(this,this.el,["ionPopoverDidPresent","ionPopoverWillPresent","ionPopoverWillDismiss","ionPopoverDidDismiss","didPresent","willPresent","willDismiss","didDismiss"])}};return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(ie.sBO),ie.Y36(ie.SBq),ie.Y36(ie.R0b))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["ion-popover"]],contentQueries:function(Z,me,Qe){if(1&Z&&ie.Suo(Qe,ie.Rgc,5),2&Z){let Gt;ie.iGM(Gt=ie.CRH())&&(me.template=Gt.first)}},inputs:{alignment:"alignment",animated:"animated",arrow:"arrow",keepContentsMounted:"keepContentsMounted",backdropDismiss:"backdropDismiss",cssClass:"cssClass",dismissOnSelect:"dismissOnSelect",enterAnimation:"enterAnimation",event:"event",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger",triggerAction:"triggerAction",reference:"reference",size:"size",side:"side"}}),ue=(0,Pn.gn)([Lr({inputs:mr,methods:ys})],ue),ue})();const qe=["animated","keepContentsMounted","backdropBreakpoint","backdropDismiss","breakpoints","canDismiss","cssClass","enterAnimation","event","handle","handleBehavior","initialBreakpoint","isOpen","keyboardClose","leaveAnimation","mode","presentingElement","showBackdrop","translucent","trigger"],_t=["present","dismiss","onDidDismiss","onWillDismiss","setCurrentBreakpoint","getCurrentBreakpoint"];let ke=(()=>{let ue=class{constructor(Z,me,Qe){this.z=Qe,this.isCmpOpen=!1,this.el=me.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,Z.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,Z.detectChanges()}),Xr(this,this.el,["ionModalDidPresent","ionModalWillPresent","ionModalWillDismiss","ionModalDidDismiss","ionBreakpointDidChange","didPresent","willPresent","willDismiss","didDismiss"])}};return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(ie.sBO),ie.Y36(ie.SBq),ie.Y36(ie.R0b))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["ion-modal"]],contentQueries:function(Z,me,Qe){if(1&Z&&ie.Suo(Qe,ie.Rgc,5),2&Z){let Gt;ie.iGM(Gt=ie.CRH())&&(me.template=Gt.first)}},inputs:{animated:"animated",keepContentsMounted:"keepContentsMounted",backdropBreakpoint:"backdropBreakpoint",backdropDismiss:"backdropDismiss",breakpoints:"breakpoints",canDismiss:"canDismiss",cssClass:"cssClass",enterAnimation:"enterAnimation",event:"event",handle:"handle",handleBehavior:"handleBehavior",initialBreakpoint:"initialBreakpoint",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",presentingElement:"presentingElement",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger"}}),ue=(0,Pn.gn)([Lr({inputs:qe,methods:_t})],ue),ue})();const sn=(ue,be)=>((ue=ue.filter(Z=>Z.stackId!==be.stackId)).push(be),ue),Ii=(ue,be)=>{const Z=ue.createUrlTree(["."],{relativeTo:be});return ue.serializeUrl(Z)},Ui=(ue,be)=>!be||ue.stackId!==be.stackId,$r=(ue,be)=>{if(!ue)return;const Z=ar(be);for(let me=0;me<Z.length;me++){if(me>=ue.length)return Z[me];if(Z[me]!==ue[me])return}},ar=ue=>ue.split("/").map(be=>be.trim()).filter(be=>""!==be),Yn=ue=>{ue&&(ue.ref.destroy(),ue.unlistenEvents())};class Hs{constructor(be,Z,me,Qe,Gt,yn){this.containerEl=Z,this.router=me,this.navCtrl=Qe,this.zone=Gt,this.location=yn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==be?ar(be):void 0}createView(be,Z){var me;const Qe=Ii(this.router,Z),Gt=null==be||null===(me=be.location)||void 0===me?void 0:me.nativeElement,yn=Mn(this.zone,be.instance,Gt);return{id:this.nextId++,stackId:$r(this.tabsPrefix,Qe),unlistenEvents:yn,element:Gt,ref:be,url:Qe}}getExistingView(be){const Z=Ii(this.router,be),me=this.views.find(Qe=>Qe.url===Z);return me&&me.ref.changeDetectorRef.reattach(),me}setActive(be){var Z,me;const Qe=this.navCtrl.consumeTransition();let{direction:Gt,animation:yn,animationBuilder:B}=Qe;const Y=this.activeView,fe=Ui(be,Y);fe&&(Gt="back",yn=void 0);const Ne=this.views.slice();let Et;const Xe=this.router;Xe.getCurrentNavigation?Et=Xe.getCurrentNavigation():null!==(Z=Xe.navigations)&&void 0!==Z&&Z.value&&(Et=Xe.navigations.value),null!==(me=Et)&&void 0!==me&&null!==(me=me.extras)&&void 0!==me&&me.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Wt=this.views.includes(be),Yt=this.insertView(be,Gt);Wt||be.ref.changeDetectorRef.detectChanges();const cn=be.animationBuilder;return void 0===B&&"back"===Gt&&!fe&&void 0!==cn&&(B=cn),Y&&(Y.animationBuilder=B),this.zone.runOutsideAngular(()=>this.wait(()=>(Y&&Y.ref.changeDetectorRef.detach(),be.ref.changeDetectorRef.reattach(),this.transition(be,Y,yn,this.canGoBack(1),!1,B).then(()=>eo(be,Yt,Ne,this.location,this.zone)).then(()=>({enteringView:be,direction:Gt,animation:yn,tabSwitch:fe})))))}canGoBack(be,Z=this.getActiveStackId()){return this.getStack(Z).length>be}pop(be,Z=this.getActiveStackId()){return this.zone.run(()=>{const me=this.getStack(Z);if(me.length<=be)return Promise.resolve(!1);const Qe=me[me.length-be-1];let Gt=Qe.url;const yn=Qe.savedData;if(yn){var B;const fe=yn.get("primary");null!=fe&&null!==(B=fe.route)&&void 0!==B&&null!==(B=B._routerState)&&void 0!==B&&B.snapshot.url&&(Gt=fe.route._routerState.snapshot.url)}const{animationBuilder:Y}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Gt,{...Qe.savedExtras,animation:Y}).then(()=>!0)})}startBackTransition(){const be=this.activeView;if(be){const Z=this.getStack(be.stackId),me=Z[Z.length-2],Qe=me.animationBuilder;return this.wait(()=>this.transition(me,be,"back",this.canGoBack(2),!0,Qe))}return Promise.resolve()}endBackTransition(be){be?(this.skipTransition=!0,this.pop(1)):this.activeView&&$s(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(be){const Z=this.getStack(be);return Z.length>0?Z[Z.length-1]:void 0}getRootUrl(be){const Z=this.getStack(be);return Z.length>0?Z[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}getActiveView(){return this.activeView}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(Yn),this.activeView=void 0,this.views=[]}getStack(be){return this.views.filter(Z=>Z.stackId===be)}insertView(be,Z){return this.activeView=be,this.views=((ue,be,Z)=>"root"===Z?sn(ue,be):"forward"===Z?((ue,be)=>(ue.indexOf(be)>=0?ue=ue.filter(me=>me.stackId!==be.stackId||me.id<=be.id):ue.push(be),ue))(ue,be):((ue,be)=>ue.indexOf(be)>=0?ue.filter(me=>me.stackId!==be.stackId||me.id<=be.id):sn(ue,be))(ue,be))(this.views,be,Z),this.views.slice()}transition(be,Z,me,Qe,Gt,yn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(Z===be)return Promise.resolve(!1);const B=be?be.element:void 0,Y=Z?Z.element:void 0,fe=this.containerEl;return B&&B!==Y&&(B.classList.add("ion-page"),B.classList.add("ion-page-invisible"),B.parentElement!==fe&&fe.appendChild(B),fe.commit)?fe.commit(B,Y,{duration:void 0===me?0:void 0,direction:me,showGoBack:Qe,progressAnimation:Gt,animationBuilder:yn}):Promise.resolve(!1)}wait(be){var Z=this;return(0,f.Z)(function*(){void 0!==Z.runningTask&&(yield Z.runningTask,Z.runningTask=void 0);const me=Z.runningTask=be();return me.finally(()=>Z.runningTask=void 0),me})()}}const eo=(ue,be,Z,me,Qe)=>"function"==typeof requestAnimationFrame?new Promise(Gt=>{requestAnimationFrame(()=>{$s(ue,be,Z,me,Qe),Gt()})}):Promise.resolve(),$s=(ue,be,Z,me,Qe)=>{Qe.run(()=>Z.filter(Gt=>!be.includes(Gt)).forEach(Yn)),be.forEach(Gt=>{const B=me.path().split("?")[0].split("#")[0];if(Gt!==ue&&Gt.url!==B){const Y=Gt.element;Y.setAttribute("aria-hidden","true"),Y.classList.add("ion-page-hidden"),Gt.ref.changeDetectorRef.detach()}})};let fo=(()=>{class ue{constructor(Z,me,Qe,Gt,yn,B,Y,fe){this.parentOutlet=fe,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new un.X(null),this.activated=null,this._activatedRoute=null,this.name=Ye.eC,this.stackWillChange=new ie.vpe,this.stackDidChange=new ie.vpe,this.activateEvents=new ie.vpe,this.deactivateEvents=new ie.vpe,this.parentContexts=(0,ie.f3M)(Ye.y6),this.location=(0,ie.f3M)(ie.s_b),this.environmentInjector=(0,ie.f3M)(ie.lqb),this.inputBinder=(0,ie.f3M)(Gs,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,ie.f3M)(wr),this.navCtrl=(0,ie.f3M)(di),this.nativeEl=Gt.nativeElement,this.name=Z||Ye.eC,this.tabsPrefix="true"===me?Ii(yn,Y):void 0,this.stackCtrl=new Hs(this.tabsPrefix,this.nativeEl,yn,this.navCtrl,B,Qe),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(Z){this.nativeEl.animation=Z}set animated(Z){this.nativeEl.animated=Z}set swipeGesture(Z){this._swipeGesture=Z,this.nativeEl.swipeHandler=Z?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:me=>this.stackCtrl.endBackTransition(me)}:void 0}ngOnDestroy(){var Z;this.stackCtrl.destroy(),null===(Z=this.inputBinder)||void 0===Z||Z.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const Z=this.getContext();null!=Z&&Z.route&&this.activateWith(Z.route,Z.injector)}new Promise(Z=>(0,xe.c)(this.nativeEl,Z)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(Z,me){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const me=this.getContext();this.activatedView.savedData=new Map(me.children.contexts);const Qe=this.activatedView.savedData.get("primary");if(Qe&&me.route&&(Qe.route={...me.route}),this.activatedView.savedExtras={},me.route){const Gt=me.route.snapshot;this.activatedView.savedExtras.queryParams=Gt.queryParams,this.activatedView.savedExtras.fragment=Gt.fragment}}const Z=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(Z)}}activateWith(Z,me){var Qe;if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=Z;let Gt,yn=this.stackCtrl.getExistingView(Z);if(yn){Gt=this.activated=yn.ref;const fe=yn.savedData;fe&&(this.getContext().children.contexts=fe),this.updateActivatedRouteProxy(Gt.instance,Z)}else{var B;const fe=Z._futureSnapshot,Ne=this.parentContexts.getOrCreateContext(this.name).children,Et=new un.X(null),Xe=this.createActivatedRouteProxy(Et,Z),Wt=new Hi(Xe,Ne,this.location.injector),Yt=null!==(B=fe.routeConfig.component)&&void 0!==B?B:fe.component;Gt=this.activated=this.location.createComponent(Yt,{index:this.location.length,injector:Wt,environmentInjector:null!=me?me:this.environmentInjector}),Et.next(Gt.instance),yn=this.stackCtrl.createView(this.activated,Z),this.proxyMap.set(Gt.instance,Xe),this.currentActivatedRoute$.next({component:Gt.instance,activatedRoute:Z})}null===(Qe=this.inputBinder)||void 0===Qe||Qe.bindActivatedRouteToOutletComponent(this),this.activatedView=yn,this.navCtrl.setTopOutlet(this);const Y=this.stackCtrl.getActiveView();this.stackWillChange.emit({enteringView:yn,tabSwitch:Ui(yn,Y)}),this.stackCtrl.setActive(yn).then(fe=>{this.activateEvents.emit(Gt.instance),this.stackDidChange.emit(fe)})}canGoBack(Z=1,me){return this.stackCtrl.canGoBack(Z,me)}pop(Z=1,me){return this.stackCtrl.pop(Z,me)}getLastUrl(Z){const me=this.stackCtrl.getLastUrl(Z);return me?me.url:void 0}getLastRouteView(Z){return this.stackCtrl.getLastUrl(Z)}getRootView(Z){return this.stackCtrl.getRootUrl(Z)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(Z,me){const Qe=new Ye.gz;return Qe._futureSnapshot=me._futureSnapshot,Qe._routerState=me._routerState,Qe.snapshot=me.snapshot,Qe.outlet=me.outlet,Qe.component=me.component,Qe._paramMap=this.proxyObservable(Z,"paramMap"),Qe._queryParamMap=this.proxyObservable(Z,"queryParamMap"),Qe.url=this.proxyObservable(Z,"url"),Qe.params=this.proxyObservable(Z,"params"),Qe.queryParams=this.proxyObservable(Z,"queryParams"),Qe.fragment=this.proxyObservable(Z,"fragment"),Qe.data=this.proxyObservable(Z,"data"),Qe}proxyObservable(Z,me){return Z.pipe((0,oi.h)(Qe=>!!Qe),(0,Si.w)(Qe=>this.currentActivatedRoute$.pipe((0,oi.h)(Gt=>null!==Gt&&Gt.component===Qe),(0,Si.w)(Gt=>Gt&&Gt.activatedRoute[me]),function nn(ue,be=Xt.y){return ue=null!=ue?ue:kt,(0,Nt.e)((Z,me)=>{let Qe,Gt=!0;Z.subscribe((0,Dt.x)(me,yn=>{const B=be(yn);(Gt||!ue(Qe,B))&&(Gt=!1,Qe=B,me.next(yn))}))})}())))}updateActivatedRouteProxy(Z,me){const Qe=this.proxyMap.get(Z);if(!Qe)throw new Error("Could not find activated route proxy for view");Qe._futureSnapshot=me._futureSnapshot,Qe._routerState=me._routerState,Qe.snapshot=me.snapshot,Qe.outlet=me.outlet,Qe.component=me.component,this.currentActivatedRoute$.next({component:Z,activatedRoute:me})}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.$8M("name"),ie.$8M("tabs"),ie.Y36(Ie.Ye),ie.Y36(ie.SBq),ie.Y36(Ye.F0),ie.Y36(ie.R0b),ie.Y36(Ye.gz),ie.Y36(ue,12))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackWillChange:"stackWillChange",stackDidChange:"stackDidChange",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),ue})();class Hi{constructor(be,Z,me){this.route=be,this.childContexts=Z,this.parent=me}get(be,Z){return be===Ye.gz?this.route:be===Ye.y6?this.childContexts:this.parent.get(be,Z)}}const Gs=new ie.OlP("");let _s=(()=>{class ue{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(Z){this.unsubscribeFromRouteData(Z),this.subscribeToRouteData(Z)}unsubscribeFromRouteData(Z){var me;null===(me=this.outletDataSubscriptions.get(Z))||void 0===me||me.unsubscribe(),this.outletDataSubscriptions.delete(Z)}subscribeToRouteData(Z){const{activatedRoute:me}=Z,Qe=(0,En.a)([me.queryParams,me.params,me.data]).pipe((0,Si.w)(([Gt,yn,B],Y)=>(B={...Gt,...yn,...B},0===Y?(0,vn.of)(B):Promise.resolve(B)))).subscribe(Gt=>{if(!Z.isActivated||!Z.activatedComponentRef||Z.activatedRoute!==me||null===me.component)return void this.unsubscribeFromRouteData(Z);const yn=(0,ie.qFp)(me.component);if(yn)for(const{templateName:B}of yn.inputs)Z.activatedComponentRef.setInput(B,Gt[B]);else this.unsubscribeFromRouteData(Z)});this.outletDataSubscriptions.set(Z,Qe)}}return ue.\u0275fac=function(Z){return new(Z||ue)},ue.\u0275prov=ie.Yz7({token:ue,factory:ue.\u0275fac}),ue})();const Cs=()=>({provide:Gs,useFactory:er,deps:[Ye.F0]});function er(ue){return null!=ue&&ue.componentInputBindingEnabled?new _s:null}const hs=["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"];let po=(()=>{let ue=class{constructor(Z,me,Qe,Gt,yn,B){this.routerOutlet=Z,this.navCtrl=me,this.config=Qe,this.r=Gt,this.z=yn,B.detach(),this.el=this.r.nativeElement}onClick(Z){var me;const Qe=this.defaultHref||this.config.get("backButtonDefaultHref");null!==(me=this.routerOutlet)&&void 0!==me&&me.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),Z.preventDefault()):null!=Qe&&(this.navCtrl.navigateBack(Qe,{animation:this.routerAnimation}),Z.preventDefault())}};return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(fo,8),ie.Y36(di),ie.Y36(wr),ie.Y36(ie.SBq),ie.Y36(ie.R0b),ie.Y36(ie.sBO))},ue.\u0275dir=ie.lG2({type:ue,hostBindings:function(Z,me){1&Z&&ie.NdJ("click",function(Gt){return me.onClick(Gt)})},inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"}}),ue=(0,Pn.gn)([Lr({inputs:hs})],ue),ue})(),As=(()=>{class ue{constructor(Z,me,Qe,Gt,yn){this.locationStrategy=Z,this.navCtrl=me,this.elementRef=Qe,this.router=Gt,this.routerLink=yn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var Z;if(null!==(Z=this.routerLink)&&void 0!==Z&&Z.urlTree){const me=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=me}}onClick(Z){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),Z.preventDefault()}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(Ie.S$),ie.Y36(di),ie.Y36(ie.SBq),ie.Y36(Ye.F0),ie.Y36(Ye.rH,8))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(Z,me){1&Z&&ie.NdJ("click",function(Gt){return me.onClick(Gt)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[ie.TTD]}),ue})(),Sr=(()=>{class ue{constructor(Z,me,Qe,Gt,yn){this.locationStrategy=Z,this.navCtrl=me,this.elementRef=Qe,this.router=Gt,this.routerLink=yn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var Z;if(null!==(Z=this.routerLink)&&void 0!==Z&&Z.urlTree){const me=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=me}}onClick(){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation)}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(Ie.S$),ie.Y36(di),ie.Y36(ie.SBq),ie.Y36(Ye.F0),ie.Y36(Ye.rH,8))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["a","routerLink",""],["area","routerLink",""]],hostBindings:function(Z,me){1&Z&&ie.NdJ("click",function(){return me.onClick()})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[ie.TTD]}),ue})();const fs=["animated","animation","root","rootParams","swipeGesture"],Ts=["push","insert","insertPages","pop","popTo","popToRoot","removeIndex","setRoot","setPages","getActive","getByIndex","canGoBack","getPrevious"];let Rr=(()=>{let ue=class{constructor(Z,me,Qe,Gt,yn,B){this.z=yn,B.detach(),this.el=Z.nativeElement,Z.nativeElement.delegate=Gt.create(me,Qe),Xr(this,this.el,["ionNavDidChange","ionNavWillChange"])}};return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(ie.SBq),ie.Y36(ie.lqb),ie.Y36(ie.zs3),ie.Y36(qr),ie.Y36(ie.R0b),ie.Y36(ie.sBO))},ue.\u0275dir=ie.lG2({type:ue,inputs:{animated:"animated",animation:"animation",root:"root",rootParams:"rootParams",swipeGesture:"swipeGesture"}}),ue=(0,Pn.gn)([Lr({inputs:fs,methods:Ts})],ue),ue})(),Ti=(()=>{class ue{constructor(Z){this.navCtrl=Z,this.ionTabsWillChange=new ie.vpe,this.ionTabsDidChange=new ie.vpe,this.tabBarSlot="bottom"}ngAfterContentInit(){this.detectSlotChanges()}ngAfterContentChecked(){this.detectSlotChanges()}onStackWillChange({enteringView:Z,tabSwitch:me}){const Qe=Z.stackId;me&&void 0!==Qe&&this.ionTabsWillChange.emit({tab:Qe})}onStackDidChange({enteringView:Z,tabSwitch:me}){const Qe=Z.stackId;me&&void 0!==Qe&&(this.tabBar&&(this.tabBar.selectedTab=Qe),this.ionTabsDidChange.emit({tab:Qe}))}select(Z){const me="string"==typeof Z,Qe=me?Z:Z.detail.tab,Gt=this.outlet.getActiveStackId()===Qe,yn=`${this.outlet.tabsPrefix}/${Qe}`;if(me||Z.stopPropagation(),Gt){const B=this.outlet.getActiveStackId(),Y=this.outlet.getLastRouteView(B);if((null==Y?void 0:Y.url)===yn)return;const fe=this.outlet.getRootView(Qe);return this.navCtrl.navigateRoot(yn,{...fe&&yn===fe.url&&fe.savedExtras,animated:!0,animationDirection:"back"})}{const B=this.outlet.getLastRouteView(Qe);return this.navCtrl.navigateRoot((null==B?void 0:B.url)||yn,{...null==B?void 0:B.savedExtras,animated:!0,animationDirection:"back"})}}getSelected(){return this.outlet.getActiveStackId()}detectSlotChanges(){this.tabBars.forEach(Z=>{const me=Z.el.getAttribute("slot");me!==this.tabBarSlot&&(this.tabBarSlot=me,this.relocateTabBar())})}relocateTabBar(){const Z=this.tabBar.el;"top"===this.tabBarSlot?this.tabsInner.nativeElement.before(Z):this.tabsInner.nativeElement.after(Z)}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(di))},ue.\u0275dir=ie.lG2({type:ue,selectors:[["ion-tabs"]],viewQuery:function(Z,me){if(1&Z&&ie.Gf(ai,7,ie.SBq),2&Z){let Qe;ie.iGM(Qe=ie.CRH())&&(me.tabsInner=Qe.first)}},hostBindings:function(Z,me){1&Z&&ie.NdJ("ionTabButtonClick",function(Gt){return me.select(Gt)})},outputs:{ionTabsWillChange:"ionTabsWillChange",ionTabsDidChange:"ionTabsDidChange"}}),ue})();const ts=ue=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(ue):"function"==typeof requestAnimationFrame?requestAnimationFrame(ue):setTimeout(ue);let ir=(()=>{class ue{constructor(Z,me){this.injector=Z,this.elementRef=me,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(Z){this.elementRef.nativeElement.value=this.lastValue=Z,li(this.elementRef)}handleValueChange(Z,me){Z===this.elementRef.nativeElement&&(me!==this.lastValue&&(this.lastValue=me,this.onChange(me)),li(this.elementRef))}_handleBlurEvent(Z){Z===this.elementRef.nativeElement&&(this.onTouched(),li(this.elementRef))}registerOnChange(Z){this.onChange=Z}registerOnTouched(Z){this.onTouched=Z}setDisabledState(Z){this.elementRef.nativeElement.disabled=Z}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let Z;try{Z=this.injector.get(Qn.a5)}catch{}if(!Z)return;Z.statusChanges&&(this.statusChanges=Z.statusChanges.subscribe(()=>li(this.elementRef)));const me=Z.control;me&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Gt=>{if(typeof me[Gt]<"u"){const yn=me[Gt].bind(me);me[Gt]=(...B)=>{yn(...B),li(this.elementRef)}}})}}return ue.\u0275fac=function(Z){return new(Z||ue)(ie.Y36(ie.zs3),ie.Y36(ie.SBq))},ue.\u0275dir=ie.lG2({type:ue,hostBindings:function(Z,me){1&Z&&ie.NdJ("ionBlur",function(Gt){return me._handleBlurEvent(Gt.target)})}}),ue})();const li=ue=>{ts(()=>{const be=ue.nativeElement,Z=null!=be.value&&be.value.toString().length>0,me=Mo(be);bs(be,me);const Qe=be.closest("ion-item");Qe&&bs(Qe,Z?[...me,"item-has-value"]:me)})},Mo=ue=>{const be=ue.classList,Z=[];for(let me=0;me<be.length;me++){const Qe=be.item(me);null!==Qe&&gr(Qe,"ng-")&&Z.push(`ion-${Qe.substring(3)}`)}return Z},bs=(ue,be)=>{const Z=ue.classList;Z.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),Z.add(...be)},gr=(ue,be)=>ue.substring(0,be.length)===be;class Rs{shouldDetach(be){return!1}shouldAttach(be){return!1}store(be,Z){}retrieve(be){return null}shouldReuseRoute(be,Z){if(be.routeConfig!==Z.routeConfig)return!1;const me=be.params,Qe=Z.params,Gt=Object.keys(me),yn=Object.keys(Qe);if(Gt.length!==yn.length)return!1;for(const B of Gt)if(Qe[B]!==me[B])return!1;return!0}}class to{constructor(be){this.ctrl=be}create(be){return this.ctrl.create(be||{})}dismiss(be,Z,me){return this.ctrl.dismiss(be,Z,me)}getTop(){return this.ctrl.getTop()}}},1929:(Kn,zt,te)=>{"use strict";te.d(zt,{dr:()=>vn,W2:()=>mi,Gu:()=>xi,wd:()=>ts,sr:()=>Mo,Pc:()=>dr});var f=te(9212),ie=te(95),Ye=te(7346),Ie=te(7582),ht=te(2438),Fe=te(6814),lt=(te(899),te(4913),te(2325),te(3433),te(6615),te(6535),te(2905)),tt=te(8958),Rt=(te(5613),te(9207)),Je=(te(1848),te(771));te(2019);const st=lt.i,He=["*"],Ot=(T,ee)=>{const F=T.prototype;ee.forEach(re=>{Object.defineProperty(F,re,{get(){return this.el[re]},set(Ze){this.z.runOutsideAngular(()=>this.el[re]=Ze)},configurable:!0})})},Le=(T,ee)=>{const F=T.prototype;ee.forEach(re=>{F[re]=function(){const Ze=arguments;return this.z.runOutsideAngular(()=>this.el[re].apply(this.el,Ze))}})};function xe(T){return function(F){const{defineCustomElementFn:re,inputs:Ze,methods:gi}=T;return void 0!==re&&re(),Ze&&Ot(F,Ze),gi&&Le(F,gi),F}}let vn=(()=>{let T=class{constructor(F,re,Ze){this.z=Ze,F.detach(),this.el=re.nativeElement}};return T.\u0275fac=function(F){return new(F||T)(f.Y36(f.sBO),f.Y36(f.SBq),f.Y36(f.R0b))},T.\u0275cmp=f.Xpm({type:T,selectors:[["ion-app"]],ngContentSelectors:He,decls:1,vars:0,template:function(F,re){1&F&&(f.F$t(),f.Hsn(0))},encapsulation:2,changeDetection:0}),T=(0,Ie.gn)([xe({})],T),T})(),mi=(()=>{let T=class{constructor(F,re,Ze){this.z=Ze,F.detach(),this.el=re.nativeElement,((T,ee,F)=>{F.forEach(re=>T[re]=(0,ht.R)(ee,re))})(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return T.\u0275fac=function(F){return new(F||T)(f.Y36(f.sBO),f.Y36(f.SBq),f.Y36(f.R0b))},T.\u0275cmp=f.Xpm({type:T,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:He,decls:1,vars:0,template:function(F,re){1&F&&(f.F$t(),f.Hsn(0))},encapsulation:2,changeDetection:0}),T=(0,Ie.gn)([xe({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],T),T})(),xi=(()=>{let T=class{constructor(F,re,Ze){this.z=Ze,F.detach(),this.el=re.nativeElement}};return T.\u0275fac=function(F){return new(F||T)(f.Y36(f.sBO),f.Y36(f.SBq),f.Y36(f.R0b))},T.\u0275cmp=f.Xpm({type:T,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:He,decls:1,vars:0,template:function(F,re){1&F&&(f.F$t(),f.Hsn(0))},encapsulation:2,changeDetection:0}),T=(0,Ie.gn)([xe({inputs:["collapse","mode","translucent"]})],T),T})(),ts=(()=>{let T=class{constructor(F,re,Ze){this.z=Ze,F.detach(),this.el=re.nativeElement}};return T.\u0275fac=function(F){return new(F||T)(f.Y36(f.sBO),f.Y36(f.SBq),f.Y36(f.R0b))},T.\u0275cmp=f.Xpm({type:T,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:He,decls:1,vars:0,template:function(F,re){1&F&&(f.F$t(),f.Hsn(0))},encapsulation:2,changeDetection:0}),T=(0,Ie.gn)([xe({inputs:["color","size"]})],T),T})(),Mo=(()=>{let T=class{constructor(F,re,Ze){this.z=Ze,F.detach(),this.el=re.nativeElement}};return T.\u0275fac=function(F){return new(F||T)(f.Y36(f.sBO),f.Y36(f.SBq),f.Y36(f.R0b))},T.\u0275cmp=f.Xpm({type:T,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:He,decls:1,vars:0,template:function(F,re){1&F&&(f.F$t(),f.Hsn(0))},encapsulation:2,changeDetection:0}),T=(0,Ie.gn)([xe({inputs:["color","mode"]})],T),T})();const Qe={provide:ie.Cf,useExisting:(0,f.Gpc)(()=>Gt),multi:!0};let Gt=(()=>{class T extends ie.Fd{}return T.\u0275fac=(()=>{let ee;return function(re){return(ee||(ee=f.n5z(T)))(re||T)}})(),T.\u0275dir=f.lG2({type:T,selectors:[["ion-input","type","number","max","","formControlName",""],["ion-input","type","number","max","","formControl",""],["ion-input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(F,re){2&F&&f.uIk("max",re._enabled?re.max:null)},features:[f._Bn([Qe]),f.qOj]}),T})();const yn={provide:ie.Cf,useExisting:(0,f.Gpc)(()=>B),multi:!0};let B=(()=>{class T extends ie.qQ{}return T.\u0275fac=(()=>{let ee;return function(re){return(ee||(ee=f.n5z(T)))(re||T)}})(),T.\u0275dir=f.lG2({type:T,selectors:[["ion-input","type","number","min","","formControlName",""],["ion-input","type","number","min","","formControl",""],["ion-input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(F,re){2&F&&f.uIk("min",re._enabled?re.min:null)},features:[f._Bn([yn]),f.qOj]}),T})(),Yt=(()=>{class T extends Ye.xs{constructor(){super(Rt.m),this.angularDelegate=(0,f.f3M)(Ye.y4),this.injector=(0,f.f3M)(f.zs3),this.environmentInjector=(0,f.f3M)(f.lqb)}create(F){return super.create({...F,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return T.\u0275fac=function(F){return new(F||T)},T.\u0275prov=f.Yz7({token:T,factory:T.\u0275fac}),T})();class Zt extends Ye.xs{constructor(){super(Rt.c),this.angularDelegate=(0,f.f3M)(Ye.y4),this.injector=(0,f.f3M)(f.zs3),this.environmentInjector=(0,f.f3M)(f.lqb)}create(ee){return super.create({...ee,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}const Gn=(T,ee,F)=>()=>{if(ee.defaultView&&typeof window<"u"){(0,tt.s)({...T,_zoneGate:gi=>F.run(gi)});const Ze="__zone_symbol__addEventListener"in ee.body?"__zone_symbol__addEventListener":"addEventListener";return function rt(){var T=[];if(typeof window<"u"){var ee=window;(!ee.customElements||ee.Element&&(!ee.Element.prototype.closest||!ee.Element.prototype.matches||!ee.Element.prototype.remove||!ee.Element.prototype.getRootNode))&&T.push(te.e(6748).then(te.t.bind(te,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||ee.NodeList&&!ee.NodeList.prototype.forEach||!ee.fetch||!function(){try{var re=new URL("b","http://a");return re.pathname="c%20d","http://a/c%20d"===re.href&&re.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&T.push(te.e(2214).then(te.t.bind(te,2668,23)))}return Promise.all(T)}().then(()=>((T,ee)=>{if(!(typeof window>"u"))return st(),(0,Je.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]],{"type":["typeChanged"],"disabled":["disabledChanged"],"side":["sideChanged"],"swipeGesture":["swipeGestureChanged"]}],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]},null,{"activated":["activatedChanged"]}],[1,"ion-fab-list",{"activated":[4],"side":[1]},null,{"activated":["activatedChanged"]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"positionAnchor":[1,"position-anchor"],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"swipeGesture":[1,"swipe-gesture"],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"swipeGesture":["swipeGestureChanged"],"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]},null,{"value":["valueChanged"]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]],{"value":["valueChanged"],"disabled":["disabledChanged"],"readonly":["readonlyChanged"]}]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]},null,{"threshold":["thresholdChanged"],"disabled":["disabledChanged"]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]},null,{"value":["valueChanged"]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]],{"color":["colorChanged"],"swipeGesture":["swipeGestureChanged"],"value":["valueChanged"],"disabled":["disabledChanged"]}]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]},null,{"selectedTab":["selectedTabChanged"]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"placeholder":["placeholderChanged"],"value":["valueChanged"]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"value":["valueChanged"],"showCancelButton":["showCancelButtonChanged"]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"activated":[32]},null,{"disabled":["disabledChanged"]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]},null,{"swipeGesture":["swipeGestureChanged"],"root":["rootChanged"]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[514],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]],{"maxItems":["maxItemsChanged"],"itemsBeforeCollapse":["maxItemsChanged"],"itemsAfterCollapse":["maxItemsChanged"]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]},null,{"url":["onUpdate"],"component":["onUpdate"],"componentProps":["onComponentProps"]}],[0,"ion-route-redirect",{"from":[1],"to":[1]},null,{"from":["propDidChange"],"to":["propDidChange"]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]},null,{"active":["changeActive"]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]},null,{"src":["srcChanged"]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]},null,{"debounce":["debounceChanged"],"min":["minChanged"],"max":["maxChanged"],"activeBarStart":["activeBarStartChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]},null,{"visible":["visibleChanged"],"disabled":["updateState"],"when":["updateState"]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]],{"counterFormatter":["counterFormatterChanged"]}],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]},null,{"color":["colorChanged"],"position":["positionChanged"]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]},null,{"disabled":["styleChanged"],"isExpanded":["styleChanged"],"placeholder":["styleChanged"],"value":["styleChanged"]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"forceRenderDate":[32],"confirm":[64],"reset":[64],"cancel":[64]},null,{"disabled":["disabledChanged"],"min":["minChanged"],"max":["maxChanged"],"yearValues":["yearValuesChanged"],"monthValues":["monthValuesChanged"],"dayValues":["dayValuesChanged"],"hourValues":["hourValuesChanged"],"minuteValues":["minuteValuesChanged"],"value":["valueChanged"]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}],[32,"ion-picker-column",{"col":[16]},null,{"col":["colChanged"]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]},null,{"value":["valueChanged"],"checked":["styleChanged"],"color":["styleChanged"],"disabled":["styleChanged"]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"compareWith":[1,"compare-with"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]],{"value":["valueChanged"]}]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]},null,{"disabled":["disabledChanged"]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]},null,{"name":["loadIcon"],"src":["loadIcon"],"icon":["loadIcon"],"ios":["loadIcon"],"md":["loadIcon"]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]],{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"],"buttons":["buttonsChanged"],"inputs":["inputsChanged"]}]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]},null,{"swipeHandler":["swipeHandlerChanged"]}],[33,"ion-title",{"color":[513],"size":[1]},null,{"size":["sizeChanged"]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"disabled":[4],"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]},null,{"value":["valueChange"]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"trigger":["onTriggerChange"],"triggerAction":["onTriggerChange"],"isOpen":["onIsOpenChange"]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1],"legacy":[4]},null,{"checked":["styleChanged"],"disabled":["styleChanged"]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),ee)})(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Ye.Wn,jmp:gi=>F.runOutsideAngular(gi),ael(gi,Pr,ns,Ro){gi[Ze](Pr,ns,Ro)},rel(gi,Pr,ns,Ro){gi.removeEventListener(Pr,ns,Ro)}}))}};let dr=(()=>{class T{static forRoot(F){return{ngModule:T,providers:[{provide:Ye.dy,useValue:F},{provide:f.ip1,useFactory:Gn,multi:!0,deps:[Ye.dy,Fe.K0,f.R0b]},(0,Ye.DN)()]}}}return T.\u0275fac=function(F){return new(F||T)},T.\u0275mod=f.oAB({type:T}),T.\u0275inj=f.cJS({providers:[Ye.y4,Yt,Zt],imports:[Fe.ez]}),T})()},5861:(Kn,zt,te)=>{"use strict";function f(Ye,Ie,ht,Fe,Be,Tt,Pt){try{var yt=Ye[Tt](Pt),Oe=yt.value}catch(ft){return void ht(ft)}yt.done?Ie(Oe):Promise.resolve(Oe).then(Fe,Be)}function ie(Ye){return function(){var Ie=this,ht=arguments;return new Promise(function(Fe,Be){var Tt=Ye.apply(Ie,ht);function Pt(Oe){f(Tt,Fe,Be,Pt,yt,"next",Oe)}function yt(Oe){f(Tt,Fe,Be,Pt,yt,"throw",Oe)}Pt(void 0)})}}te.d(zt,{Z:()=>ie})},7582:(Kn,zt,te)=>{"use strict";function ht(Le,ve,De,xe){var un,Mt=arguments.length,ct=Mt<3?ve:null===xe?xe=Object.getOwnPropertyDescriptor(ve,De):xe;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ct=Reflect.decorate(Le,ve,De,xe);else for(var En=Le.length-1;En>=0;En--)(un=Le[En])&&(ct=(Mt<3?un(ct):Mt>3?un(ve,De,ct):un(ve,De))||ct);return Mt>3&&ct&&Object.defineProperty(ve,De,ct),ct}function ft(Le,ve,De,xe){return new(De||(De=Promise))(function(ct,un){function En(oi){try{Pn(xe.next(oi))}catch(Si){un(Si)}}function vn(oi){try{Pn(xe.throw(oi))}catch(Si){un(Si)}}function Pn(oi){oi.done?ct(oi.value):function Mt(ct){return ct instanceof De?ct:new De(function(un){un(ct)})}(oi.value).then(En,vn)}Pn((xe=xe.apply(Le,ve||[])).next())})}function rt(Le){return this instanceof rt?(this.v=Le,this):new rt(Le)}function st(Le,ve,De){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Mt,xe=De.apply(Le,ve||[]),ct=[];return Mt={},un("next"),un("throw"),un("return"),Mt[Symbol.asyncIterator]=function(){return this},Mt;function un(Xt){xe[Xt]&&(Mt[Xt]=function(Nt){return new Promise(function(Dt,nn){ct.push([Xt,Nt,Dt,nn])>1||En(Xt,Nt)})})}function En(Xt,Nt){try{!function vn(Xt){Xt.value instanceof rt?Promise.resolve(Xt.value.v).then(Pn,oi):Si(ct[0][2],Xt)}(xe[Xt](Nt))}catch(Dt){Si(ct[0][3],Dt)}}function Pn(Xt){En("next",Xt)}function oi(Xt){En("throw",Xt)}function Si(Xt,Nt){Xt(Nt),ct.shift(),ct.length&&En(ct[0][0],ct[0][1])}}function He(Le){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var De,ve=Le[Symbol.asyncIterator];return ve?ve.call(Le):(Le=function Rt(Le){var ve="function"==typeof Symbol&&Symbol.iterator,De=ve&&Le[ve],xe=0;if(De)return De.call(Le);if(Le&&"number"==typeof Le.length)return{next:function(){return Le&&xe>=Le.length&&(Le=void 0),{value:Le&&Le[xe++],done:!Le}}};throw new TypeError(ve?"Object is not iterable.":"Symbol.iterator is not defined.")}(Le),De={},xe("next"),xe("throw"),xe("return"),De[Symbol.asyncIterator]=function(){return this},De);function xe(ct){De[ct]=Le[ct]&&function(un){return new Promise(function(En,vn){!function Mt(ct,un,En,vn){Promise.resolve(vn).then(function(Pn){ct({value:Pn,done:En})},un)}(En,vn,(un=Le[ct](un)).done,un.value)})}}}te.d(zt,{FC:()=>st,KL:()=>He,gn:()=>ht,mG:()=>ft,qq:()=>rt}),"function"==typeof SuppressedError&&SuppressedError}},Kn=>{Kn(Kn.s=6058)}]);